import{r as um,a as ex,b as vo,c as ne,d as $,e as To,f as Oe,g as N,h as rj,i as tx,j as rx,k as Z,l as n_,m as nx,n as ax,o as a_,p as nj,q as ix,s as aj,t as Oo,u as ox,v as ux,w as cx,x as sx,y as dx,z as lx,A as fx,B as i_,C as px,D as o_,E as ij,F as yx,G as _x,H as mx,I as u_,J as bx,K as gx,L as oj,M as hx,N as uj,O as vx}from"./vendor-BeMshUoW.js";var XH=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function GH(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var o=i.default;if(typeof o=="function"){var u=function a(){return this instanceof a?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};u.prototype=o.prototype}else u={};return Object.defineProperty(u,"__esModule",{value:!0}),Object.keys(i).forEach(function(a){var t=Object.getOwnPropertyDescriptor(i,a);Object.defineProperty(u,a,t.get?t:{enumerable:!0,get:function(){return i[a]}})}),u}var Be={},Po={},Qe={},qo={},Ne={},jo={},Ce={},Ue={},wm;function cj(){if(wm)return Ue;wm=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.ActionContextKey=Ue.ActionContext=void 0;const i=um;let o=class By{constructor(t={}){this.map=(0,i.Map)(t)}setDefault(t,e){return this.has(t)?this:this.set(t,e)}set(t,e){return this.setRaw(t.name,e)}setRaw(t,e){return new By(this.map.set(t,e))}delete(t){return new By(this.map.delete(t.name))}get(t){return this.getRaw(t.name)}getRaw(t){return this.map.get(t)}getSafe(t){if(!this.has(t))throw new Error(`Context entry ${t.name} is required but not available`);return this.get(t)}has(t){return this.hasRaw(t.name)}hasRaw(t){return this.map.has(t)}merge(...t){let e=this;for(const r of t)for(const n of r.keys())e=e.set(n,r.get(n));return e}keys(){return[...this.map.keys()].map(t=>new u(t))}toJS(){return this.map.toJS()}toString(){return`ActionContext(${JSON.stringify(this.map.toJS())})`}[Symbol.for("nodejs.util.inspect.custom")](){return`ActionContext(${JSON.stringify(this.map.toJS(),null,"  ")})`}static ensureActionContext(t){return t instanceof By?t:new By((0,i.Map)(t??{}))}};Ue.ActionContext=o;class u{constructor(t){this.name=t}}return Ue.ActionContextKey=u,Ue}var Mo={},Rm;function sj(){if(Rm)return Mo;Rm=1,Object.defineProperty(Mo,"__esModule",{value:!0}),Mo.Bus=void 0;let i=class{constructor(u){this.actors=[],this.observers=[],this.dependencyLinks=new Map,Object.assign(this,u),this.failMessage=`All actors over bus ${this.name} failed to handle an action`}subscribe(u){this.actors.push(u),this.reorderForDependencies()}subscribeObserver(u){this.observers.push(u)}unsubscribe(u){const a=this.actors.indexOf(u);return a>=0?(this.actors.splice(a,1),!0):!1}unsubscribeObserver(u){const a=this.observers.indexOf(u);return a>=0?(this.observers.splice(a,1),!0):!1}publish(u){return this.actors.map(a=>({actor:a,reply:a.test(u)}))}onRun(u,a,t){for(const e of this.observers)e.onRun(u,a,t)}addDependencies(u,a){for(const t of a){let e=this.dependencyLinks.get(t);e||(e=[],this.dependencyLinks.set(t,e)),e.push(u)}this.reorderForDependencies()}reorderForDependencies(){if(this.dependencyLinks.size>0){const u=[];for(const a of this.dependencyLinks.keys()){const t=this.actors.indexOf(a);t>=0&&(this.actors.splice(t,1),u.push(a))}for(;u.length>0;){let a=-1;for(let e=0;e<u.length;e++){let r=!0;for(const n of this.dependencyLinks.get(u[e]))if(!this.actors.includes(n)&&u.includes(n)){r=!1;break}if(r){a=e;break}}if(a<0)throw new Error(`Cyclic dependency links detected in bus ${this.name}`);const t=u.splice(a,1)[0];this.actors.push(t)}}}};return Mo.Bus=i,Mo}var xo={},Pm;function Tx(){if(Pm)return xo;Pm=1,Object.defineProperty(xo,"__esModule",{value:!0}),xo.BusIndexed=void 0;const i=sj();let o=class extends i.Bus{constructor(a){super(a),this.actorsIndex={}}subscribe(a){const t=this.getActorIdentifiers(a)??["_undefined_"];for(const e of t){let r=this.actorsIndex[e];r||(r=this.actorsIndex[e]=[]),r.push(a),super.subscribe(a)}}unsubscribe(a){const t=this.getActorIdentifiers(a)??["_undefined_"];let e=!1;for(const r of t){const n=this.actorsIndex[r];if(n){const c=n.indexOf(a);c>=0&&n.splice(c,1),n.length===0&&delete this.actorsIndex[r]}e=e||super.unsubscribe(a)}return e}publish(a){const t=this.getActionIdentifier(a);return t?[...this.actorsIndex[t]||[],...this.actorsIndex._undefined_||[]].map(r=>({actor:r,reply:r.test(a)})):super.publish(a)}getActorIdentifiers(a){const t=this.actorIdentifierFields.reduce((e,r)=>e[r],a);if(t)return Array.isArray(t)?t:[t]}getActionIdentifier(a){return this.actionIdentifierFields.reduce((t,e)=>t[e],a)}};return xo.BusIndexed=o,xo}var Do={},qm;function dj(){if(qm)return Do;qm=1,Object.defineProperty(Do,"__esModule",{value:!0}),Do.CONTEXT_KEY_LOGGER=void 0;const i=cj();return Do.CONTEXT_KEY_LOGGER=new i.ActionContextKey("@comunica/core:log"),Do}var Eo={},jm;function Ox(){if(jm)return Eo;jm=1,Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.ActionObserver=void 0;let i=class{constructor(u){Object.assign(this,u)}};return Eo.ActionObserver=i,Eo}var Lo={},Mm;function Ax(){if(Mm)return Lo;Mm=1,Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.Actor=void 0;const i=dj();let o=class oo{constructor(a){this.beforeActors=[],Object.assign(this,a),this.bus.subscribe(this),this.beforeActors.length>0&&this.bus.addDependencies(this,this.beforeActors),a.busFailMessage&&(this.bus.failMessage=a.busFailMessage)}static getContextLogger(a){return a.get(i.CONTEXT_KEY_LOGGER)}runObservable(a,t){const e=this.run(a,t);return this.bus.onRun(this,a,e),e}getDefaultLogData(a,t){const e=t?t():{};return e.actor=this.name,e}logTrace(a,t,e){const r=oo.getContextLogger(a);r&&r.trace(t,this.getDefaultLogData(a,e))}logDebug(a,t,e){const r=oo.getContextLogger(a);r&&r.debug(t,this.getDefaultLogData(a,e))}logInfo(a,t,e){const r=oo.getContextLogger(a);r&&r.info(t,this.getDefaultLogData(a,e))}logWarn(a,t,e){const r=oo.getContextLogger(a);r&&r.warn(t,this.getDefaultLogData(a,e))}logError(a,t,e){const r=oo.getContextLogger(a);r&&r.error(t,this.getDefaultLogData(a,e))}logFatal(a,t,e){const r=oo.getContextLogger(a);r&&r.fatal(t,this.getDefaultLogData(a,e))}};return Lo.Actor=o,Lo}var Io={},xm;function Sx(){if(xm)return Io;xm=1,Object.defineProperty(Io,"__esModule",{value:!0}),Io.Mediator=void 0;let i=class W_{constructor(u){Object.assign(this,u)}publish(u){const a=this.bus.publish(u);if(a.length===0)throw new Error(`No actors are able to reply to a message in the bus ${this.bus.name}`);return a}async mediateActor(u){return await this.mediateWith(u,this.publish(u))}async mediateTestable(u){return(await this.mediateActor(u)).mapAsync((t,e)=>t.runObservable(u,e))}async mediate(u){return(await this.mediateTestable(u)).getOrThrow()}constructFailureMessage(u,a){const t=`
        `;return`${this.bus.failMessage.replaceAll(/\$\{(.*?)\}/gu,(r,n)=>W_.getObjectValue({action:u},n.split("."))||r)}
    Error messages of failing actors:${t}${a.join(t)}`}static getObjectValue(u,a){if(a.length===0)return u;if(u)return W_.getObjectValue(u[a[0]],a.slice(1))}};return Io.Mediator=i,Io}var ie={},Dm;function Fx(){if(Dm)return ie;Dm=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.TestResultFailed=ie.TestResultPassed=ie.failTest=ie.passTestVoidWithSideData=ie.passTestWithSideData=ie.passTestVoid=ie.passTest=void 0;function i(n){return new e(n,void 0)}ie.passTest=i;function o(){return new e(!0,void 0)}ie.passTestVoid=o;function u(n,c){return new e(n,c)}ie.passTestWithSideData=u;function a(n){return new e(!0,n)}ie.passTestVoidWithSideData=a;function t(n){return new r(n)}ie.failTest=t;class e{constructor(c,s){this.value=c,this.sideData=s}isPassed(){return!0}isFailed(){return!1}get(){return this.value}getOrThrow(){return this.value}getSideData(){return this.sideData}getFailMessage(){}map(c){return new e(c(this.value,this.sideData),this.sideData)}async mapAsync(c){return new e(await c(this.value,this.sideData),this.sideData)}}ie.TestResultPassed=e;class r{constructor(c){this.failMessage=c}isPassed(){return!1}isFailed(){return!0}get(){}getOrThrow(){throw new Error(this.getFailMessage())}getSideData(){throw new Error(this.getFailMessage())}getFailMessage(){return this.failMessage}map(){return this}async mapAsync(){return this}}return ie.TestResultFailed=r,ie}var Em;function O(){return Em||(Em=1,(function(i){var o=Ce&&Ce.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ce&&Ce.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(cj(),i),u(sj(),i),u(Tx(),i),u(dj(),i),u(Ox(),i),u(Ax(),i),u(Sx(),i),u(Fx(),i)})(Ce)),Ce}var Lm;function wx(){if(Lm)return jo;Lm=1,Object.defineProperty(jo,"__esModule",{value:!0}),jo.ActorInit=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return jo.ActorInit=o,jo}var Im;function Rx(){return Im||(Im=1,(function(i){var o=Ne&&Ne.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ne&&Ne.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(wx(),i)})(Ne)),Ne}var $m;function lj(){if($m)return qo;$m=1,Object.defineProperty(qo,"__esModule",{value:!0}),qo.ActorInitQueryBase=void 0;const i=Rx(),o=O();let u=class extends i.ActorInit{async test(t){return(0,o.passTestVoid)()}async run(t){throw new Error("ActorInitSparql#run is not supported in the browser.")}};return qo.ActorInitQueryBase=u,qo}var $o={},Bm;function Px(){if(Bm)return $o;Bm=1,Object.defineProperty($o,"__esModule",{value:!0}),$o.ActorInitQuery=void 0;const i=lj();typeof process>"u"&&(globalThis.process=ex());class o extends i.ActorInitQueryBase{}return $o.ActorInitQuery=o,$o}var Bo={},He={},H={},Qm;function fj(){if(Qm)return H;Qm=1,Object.defineProperty(H,"__esModule",{value:!0}),H.KeysStatistics=H.KeysRdfJoin=H.KeysMergeBindingsContext=H.KeysRdfUpdateQuads=H.KeysQuerySourceIdentify=H.KeysRdfParseHtmlScript=H.KeysRdfParseJsonLd=H.KeysQueryOperation=H.KeysExpressionEvaluator=H.KeysInitQuery=H.KeysHttpProxy=H.KeysHttpMemento=H.KeysHttpWayback=H.KeysHttp=H.KeysCore=void 0;const i=O();return H.KeysCore={log:i.CONTEXT_KEY_LOGGER},H.KeysHttp={includeCredentials:new i.ActionContextKey("@comunica/bus-http:include-credentials"),auth:new i.ActionContextKey("@comunica/bus-http:auth"),fetch:new i.ActionContextKey("@comunica/bus-http:fetch"),httpTimeout:new i.ActionContextKey("@comunica/bus-http:http-timeout"),httpBodyTimeout:new i.ActionContextKey("@comunica/bus-http:http-body-timeout"),httpRetryCount:new i.ActionContextKey("@comunica/bus-http:http-retry-count"),httpRetryDelayFallback:new i.ActionContextKey("@comunica/bus-http:http-retry-delay-fallback"),httpRetryDelayLimit:new i.ActionContextKey("@comunica/bus-http:http-retry-delay-limit"),httpRetryStatusCodes:new i.ActionContextKey("@comunica/bus-http:http-retry-status-codes")},H.KeysHttpWayback={recoverBrokenLinks:new i.ActionContextKey("@comunica/bus-http:recover-broken-links")},H.KeysHttpMemento={datetime:new i.ActionContextKey("@comunica/actor-http-memento:datetime")},H.KeysHttpProxy={httpProxyHandler:new i.ActionContextKey("@comunica/actor-http-proxy:httpProxyHandler")},H.KeysInitQuery={querySourcesUnidentified:new i.ActionContextKey("@comunica/actor-init-query:querySourcesUnidentified"),initialBindings:new i.ActionContextKey("@comunica/actor-init-query:initialBindings"),queryFormat:new i.ActionContextKey("@comunica/actor-init-query:queryFormat"),graphqlSingularizeVariables:new i.ActionContextKey("@comunica/actor-init-query:singularizeVariables"),lenient:new i.ActionContextKey("@comunica/actor-init-query:lenient"),queryString:new i.ActionContextKey("@comunica/actor-init-query:queryString"),query:new i.ActionContextKey("@comunica/actor-init-query:query"),baseIRI:new i.ActionContextKey("@comunica/actor-init-query:baseIRI"),functionArgumentsCache:new i.ActionContextKey("@comunica/actor-init-query:functionArgumentsCache"),queryTimestamp:new i.ActionContextKey("@comunica/actor-init-query:queryTimestamp"),queryTimestampHighResolution:new i.ActionContextKey("@comunica/actor-init-query:queryTimestampHighResolution"),extensionFunctionCreator:new i.ActionContextKey("@comunica/actor-init-query:extensionFunctionCreator"),extensionFunctions:new i.ActionContextKey("@comunica/actor-init-query:extensionFunctions"),cliArgsHandlers:new i.ActionContextKey("@comunica/actor-init-query:cliArgsHandlers"),explain:new i.ActionContextKey("@comunica/actor-init-query:explain"),physicalQueryPlanLogger:new i.ActionContextKey("@comunica/actor-init-query:physicalQueryPlanLogger"),physicalQueryPlanNode:new i.ActionContextKey("@comunica/actor-init-query:physicalQueryPlanNode"),jsonLdContext:new i.ActionContextKey("@context"),invalidateCache:new i.ActionContextKey("@comunica/actor-init-query:invalidateCache"),dataFactory:new i.ActionContextKey("@comunica/actor-init-query:dataFactory"),distinctConstruct:new i.ActionContextKey("@comunica/actor-init-query:distinctConstruct")},H.KeysExpressionEvaluator={extensionFunctionCreator:new i.ActionContextKey("@comunica/utils-expression-evaluator:extensionFunctionCreator"),superTypeProvider:new i.ActionContextKey("@comunica/utils-expression-evaluator:superTypeProvider"),defaultTimeZone:new i.ActionContextKey("@comunica/utils-expression-evaluator:defaultTimeZone"),actionContext:new i.ActionContextKey("@comunica/utils-expression-evaluator:actionContext")},H.KeysQueryOperation={operation:new i.ActionContextKey("@comunica/bus-query-operation:operation"),joinLeftMetadata:new i.ActionContextKey("@comunica/bus-query-operation:joinLeftMetadata"),joinRightMetadatas:new i.ActionContextKey("@comunica/bus-query-operation:joinRightMetadatas"),joinBindings:new i.ActionContextKey("@comunica/bus-query-operation:joinBindings"),readOnly:new i.ActionContextKey("@comunica/bus-query-operation:readOnly"),isPathArbitraryLengthDistinctKey:new i.ActionContextKey("@comunica/bus-query-operation:isPathArbitraryLengthDistinct"),limitIndicator:new i.ActionContextKey("@comunica/bus-query-operation:limitIndicator"),unionDefaultGraph:new i.ActionContextKey("@comunica/bus-query-operation:unionDefaultGraph"),querySources:new i.ActionContextKey("@comunica/bus-query-operation:querySources")},H.KeysRdfParseJsonLd={documentLoader:new i.ActionContextKey("@comunica/actor-rdf-parse-jsonld:documentLoader"),strictValues:new i.ActionContextKey("@comunica/actor-rdf-parse-jsonld:strictValues"),parserOptions:new i.ActionContextKey("@comunica/actor-rdf-parse-jsonld:parserOptions")},H.KeysRdfParseHtmlScript={processingHtmlScript:new i.ActionContextKey("@comunica/actor-rdf-parse-html-script:processingHtmlScript"),extractAllScripts:new i.ActionContextKey("extractAllScripts")},H.KeysQuerySourceIdentify={sourceIds:new i.ActionContextKey("@comunica/bus-query-source-identify:sourceIds"),hypermediaSourcesAggregatedStores:new i.ActionContextKey("@comunica/bus-query-source-identify:hypermediaSourcesAggregatedStores"),traverse:new i.ActionContextKey("@comunica/bus-query-source-identify:traverse")},H.KeysRdfUpdateQuads={destination:new i.ActionContextKey("@comunica/bus-rdf-update-quads:destination")},H.KeysMergeBindingsContext={sourcesBinding:new i.ActionContextKey("@comunica/bus-merge-bindings-context:sourcesBinding")},H.KeysRdfJoin={lastPhysicalJoin:new i.ActionContextKey("@comunica/bus-rdf-join:lastPhysicalJoin")},H.KeysStatistics={discoveredLinks:new i.ActionContextKey("@comunica/statistic:discoveredLinks"),dereferencedLinks:new i.ActionContextKey("@comunica/statistic:dereferencedLinks"),intermediateResults:new i.ActionContextKey("@comunica/statistic:intermediateResults")},H}var Nm;function q(){return Nm||(Nm=1,(function(i){var o=He&&He.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=He&&He.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(fj(),i)})(He)),He}var Cm;function qx(){if(Cm)return Bo;Cm=1,Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.QueryEngineBase=void 0;const i=q(),o=O();let u=class Z_{constructor(t){this.actorInitQuery=t}async queryBindings(t,e){return this.queryOfType(t,e,"bindings")}async queryQuads(t,e){return this.queryOfType(t,e,"quads")}async queryBoolean(t,e){return this.queryOfType(t,e,"boolean")}async queryVoid(t,e){return this.queryOfType(t,e,"void")}async queryOfType(t,e,r){const n=await this.query(t,e);if(n.resultType===r)return await n.execute();throw new Error(`Query result type '${r}' was expected, while '${n.resultType}' was found.`)}async query(t,e){const r=await this.queryOrExplain(t,e);if("explain"in r)throw new Error("Tried to explain a query when in query-only mode");return r}async explain(t,e,r){return e.explain=r,await this.queryOrExplain(t,e)}async queryOrExplain(t,e){const r=o.ActionContext.ensureActionContext(e);r.get(i.KeysInitQuery.invalidateCache)&&await this.invalidateHttpCache();const{result:n}=await this.actorInitQuery.mediatorQueryProcess.mediate({query:t,context:r});return"explain"in n?n:Z_.internalToFinalResult(n)}async getResultMediaTypes(t){return t=o.ActionContext.ensureActionContext(t),(await this.actorInitQuery.mediatorQueryResultSerializeMediaTypeCombiner.mediate({context:t,mediaTypes:!0})).mediaTypes}async getResultMediaTypeFormats(t){return t=o.ActionContext.ensureActionContext(t),(await this.actorInitQuery.mediatorQueryResultSerializeMediaTypeFormatCombiner.mediate({context:t,mediaTypeFormats:!0})).mediaTypeFormats}async resultToString(t,e,r){if(r=o.ActionContext.ensureActionContext(r),!e)switch(t.resultType){case"bindings":e="application/json";break;case"quads":e="application/trig";break;default:e="simple";break}const n={...await Z_.finalToInternalResult(t),context:r};return(await this.actorInitQuery.mediatorQueryResultSerialize.mediate({context:r,handle:n,handleMediaType:e})).handle}invalidateHttpCache(t,e){return e=o.ActionContext.ensureActionContext(e),this.actorInitQuery.mediatorHttpInvalidate.mediate({url:t,context:e})}static internalToFinalResult(t){switch(t.type){case"bindings":return{resultType:"bindings",execute:async()=>t.bindingsStream,metadata:async()=>{const e=await t.metadata();return e.variables=e.variables.map(r=>r.variable),e},context:t.context};case"quads":return{resultType:"quads",execute:async()=>t.quadStream,metadata:async()=>await t.metadata(),context:t.context};case"boolean":return{resultType:"boolean",execute:async()=>t.execute(),context:t.context};case"void":return{resultType:"void",execute:async()=>t.execute(),context:t.context}}}static async finalToInternalResult(t){switch(t.resultType){case"bindings":return{type:"bindings",bindingsStream:await t.execute(),metadata:async()=>{const e=await t.metadata();return e.variables=e.variables.map(r=>({variable:r,canBeUndef:!1})),e}};case"quads":return{type:"quads",quadStream:await t.execute(),metadata:async()=>await t.metadata()};case"boolean":return{type:"boolean",execute:()=>t.execute()};case"void":return{type:"void",execute:()=>t.execute()}}}};return Bo.QueryEngineBase=u,Bo}var Um;function pj(){return Um||(Um=1,(function(i){var o=Qe&&Qe.__createBinding||(Object.create?(function(t,e,r,n){n===void 0&&(n=r);var c=Object.getOwnPropertyDescriptor(e,r);(!c||("get"in c?!e.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,c)}):(function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]})),u=Qe&&Qe.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&o(e,t,r)};Object.defineProperty(i,"__esModule",{value:!0}),i.QueryEngineBase=void 0,u(lj(),i),u(Px(),i);var a=qx();Object.defineProperty(i,"QueryEngineBase",{enumerable:!0,get:function(){return a.QueryEngineBase}})})(Qe)),Qe}var Ve={},Qo={},ze={},O_={},Hm;function jx(){return Hm||(Hm=1,Object.defineProperty(O_,"__esModule",{value:!0})),O_}var A_={},Vm;function Mx(){return Vm||(Vm=1,Object.defineProperty(A_,"__esModule",{value:!0})),A_}var S_={},zm;function xx(){return zm||(zm=1,Object.defineProperty(S_,"__esModule",{value:!0})),S_}var F_={},Xm;function Dx(){return Xm||(Xm=1,Object.defineProperty(F_,"__esModule",{value:!0})),F_}var w_={},Gm;function Ex(){return Gm||(Gm=1,Object.defineProperty(w_,"__esModule",{value:!0})),w_}var R_={},Jm;function Lx(){return Jm||(Jm=1,Object.defineProperty(R_,"__esModule",{value:!0})),R_}var P_={},Km;function Ix(){return Km||(Km=1,Object.defineProperty(P_,"__esModule",{value:!0})),P_}var q_={},Ym;function $x(){return Ym||(Ym=1,Object.defineProperty(q_,"__esModule",{value:!0})),q_}var j_={},Wm;function Bx(){return Wm||(Wm=1,Object.defineProperty(j_,"__esModule",{value:!0})),j_}var M_={},Zm;function Qx(){return Zm||(Zm=1,Object.defineProperty(M_,"__esModule",{value:!0})),M_}var x_={},km;function Nx(){return km||(km=1,Object.defineProperty(x_,"__esModule",{value:!0})),x_}var D_={},eb;function Cx(){return eb||(eb=1,Object.defineProperty(D_,"__esModule",{value:!0})),D_}var E_={},tb;function Ux(){return tb||(tb=1,Object.defineProperty(E_,"__esModule",{value:!0})),E_}var L_={},rb;function Hx(){return rb||(rb=1,Object.defineProperty(L_,"__esModule",{value:!0})),L_}var I_={},nb;function Vx(){return nb||(nb=1,Object.defineProperty(I_,"__esModule",{value:!0})),I_}var $_={},ab;function zx(){return ab||(ab=1,Object.defineProperty($_,"__esModule",{value:!0})),$_}var B_={},ib;function Xx(){return ib||(ib=1,Object.defineProperty(B_,"__esModule",{value:!0})),B_}var Q_={},ob;function Gx(){return ob||(ob=1,Object.defineProperty(Q_,"__esModule",{value:!0})),Q_}var N_={},ub;function Jx(){return ub||(ub=1,Object.defineProperty(N_,"__esModule",{value:!0})),N_}var No={},cb;function Kx(){if(cb)return No;cb=1,Object.defineProperty(No,"__esModule",{value:!0}),No.Logger=void 0;let i=class yj{static getLevelOrdinal(u){return yj.LEVELS[u]}};return No.Logger=i,i.LEVELS={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},No}var Co={},sb;function Yx(){if(sb)return Co;sb=1,Object.defineProperty(Co,"__esModule",{value:!0}),Co.ExpressionType=void 0;var i;return(function(o){o.Aggregate="aggregate",o.Existence="existence",o.Operator="operator",o.Term="term",o.Variable="variable"})(i||(Co.ExpressionType=i={})),Co}var db;function Ee(){return db||(db=1,(function(i){var o=ze&&ze.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ze&&ze.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(jx(),i),u(Mx(),i),u(xx(),i),u(Dx(),i),u(Ex(),i),u(Lx(),i),u(Ix(),i),u($x(),i),u(Bx(),i),u(Qx(),i),u(Nx(),i),u(Cx(),i),u(Ux(),i),u(Hx(),i),u(Vx(),i),u(zx(),i),u(Xx(),i),u(Gx(),i),u(Jx(),i),u(Kx(),i),u(Yx(),i)})(ze)),ze}var lb;function Wx(){if(lb)return Qo;lb=1,Object.defineProperty(Qo,"__esModule",{value:!0}),Qo.LoggerVoid=void 0;const i=Ee();let o=class extends i.Logger{debug(){}error(){}fatal(){}info(){}trace(){}warn(){}};return Qo.LoggerVoid=o,Qo}var fb;function Zx(){return fb||(fb=1,(function(i){var o=Ve&&Ve.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ve&&Ve.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(Wx(),i)})(Ve)),Ve}var Xe={},Ge={},pb;function _j(){if(pb)return Ge;pb=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.MediatorFunctionFactory=Ge.ActorFunctionFactory=void 0;const i=O();let o=class extends i.Actor{constructor(t){super(t)}};Ge.ActorFunctionFactory=o;class u extends i.Mediator{}return Ge.MediatorFunctionFactory=u,Ge}var Uo={},yb;function kx(){if(yb)return Uo;yb=1,Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.ActorFunctionFactoryDedicated=void 0;const i=O(),o=_j();let u=class extends o.ActorFunctionFactory{constructor(t){super(t)}async test(t){return this.functionNames.includes(t.functionName)&&(this.termFunction||!t.requireTermExpression)?(0,i.passTestVoid)():(0,i.failTest)(`Actor ${this.name} can not provide implementation for "${t.functionName}", only for ${this.termFunction?"":"non-termExpression "}${this.functionNames.join(" and ")}.`)}};return Uo.ActorFunctionFactoryDedicated=u,Uo}var Ho={},_b;function eD(){if(_b)return Ho;_b=1,Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.BusFunctionFactory=void 0;const i=O();let o=class extends i.BusIndexed{constructor(a){super({...a,actorIdentifierFields:["functionNames"],actionIdentifierFields:["functionName"]})}};return Ho.BusFunctionFactory=o,Ho}var Je={},C_={},Vo={},Ke={},zo={},mb;function tD(){if(mb)return zo;mb=1,Object.defineProperty(zo,"__esModule",{value:!0}),zo.asTermType=void 0;function i(o){if(o==="namedNode"||o==="literal"||o==="blankNode"||o==="quad")return o}return zo.asTermType=i,zo}var Xo={},bb;function rD(){if(bb)return Xo;bb=1,Object.defineProperty(Xo,"__esModule",{value:!0}),Xo.Variable=void 0;const i=Ee();class o{constructor(a){this.expressionType=i.ExpressionType.Variable,this.name=a}}return Xo.Variable=o,Xo}var I={},he={},gb;function so(){if(gb)return he;gb=1,Object.defineProperty(he,"__esModule",{value:!0}),he.SparqlOperator=he.TypeURL=he.typedLiteral=he.TypeAlias=void 0;const i=vo();var o;(function(r){r.SPARQL_NUMERIC="SPARQL_NUMERIC",r.SPARQL_STRINGLY="SPARQL_STRINGLY"})(o||(he.TypeAlias=o={}));const u=new i.DataFactory;function a(r,n){return u.literal(r,u.namedNode(n))}he.typedLiteral=a;var t;(function(r){r.XSD_ANY_URI="http://www.w3.org/2001/XMLSchema#anyURI",r.XSD_STRING="http://www.w3.org/2001/XMLSchema#string",r.RDF_LANG_STRING="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",r.XSD_BOOLEAN="http://www.w3.org/2001/XMLSchema#boolean",r.XSD_DATE_TIME="http://www.w3.org/2001/XMLSchema#dateTime",r.XSD_DATE_TIME_STAMP="http://www.w3.org/2001/XMLSchema#dateTimeStamp",r.XSD_DATE="http://www.w3.org/2001/XMLSchema#date",r.XSD_G_MONTH="http://www.w3.org/2001/XMLSchema#gMonth",r.XSD_G_MONTHDAY="http://www.w3.org/2001/XMLSchema#gMonthDay",r.XSD_G_YEAR="http://www.w3.org/2001/XMLSchema#gYear",r.XSD_G_YEAR_MONTH="http://www.w3.org/2001/XMLSchema#gYearMonth",r.XSD_TIME="http://www.w3.org/2001/XMLSchema#time",r.XSD_G_DAY="http://www.w3.org/2001/XMLSchema#gDay",r.XSD_DECIMAL="http://www.w3.org/2001/XMLSchema#decimal",r.XSD_FLOAT="http://www.w3.org/2001/XMLSchema#float",r.XSD_DOUBLE="http://www.w3.org/2001/XMLSchema#double",r.XSD_INTEGER="http://www.w3.org/2001/XMLSchema#integer",r.XSD_NON_POSITIVE_INTEGER="http://www.w3.org/2001/XMLSchema#nonPositiveInteger",r.XSD_NEGATIVE_INTEGER="http://www.w3.org/2001/XMLSchema#negativeInteger",r.XSD_LONG="http://www.w3.org/2001/XMLSchema#long",r.XSD_INT="http://www.w3.org/2001/XMLSchema#int",r.XSD_SHORT="http://www.w3.org/2001/XMLSchema#short",r.XSD_BYTE="http://www.w3.org/2001/XMLSchema#byte",r.XSD_NON_NEGATIVE_INTEGER="http://www.w3.org/2001/XMLSchema#nonNegativeInteger",r.XSD_POSITIVE_INTEGER="http://www.w3.org/2001/XMLSchema#positiveInteger",r.XSD_UNSIGNED_LONG="http://www.w3.org/2001/XMLSchema#unsignedLong",r.XSD_UNSIGNED_INT="http://www.w3.org/2001/XMLSchema#unsignedInt",r.XSD_UNSIGNED_SHORT="http://www.w3.org/2001/XMLSchema#unsignedShort",r.XSD_UNSIGNED_BYTE="http://www.w3.org/2001/XMLSchema#unsignedByte",r.XSD_NORMALIZED_STRING="http://www.w3.org/2001/XMLSchema#normalizedString",r.XSD_TOKEN="http://www.w3.org/2001/XMLSchema#token",r.XSD_LANGUAGE="http://www.w3.org/2001/XMLSchema#language",r.XSD_NM_TOKEN="http://www.w3.org/2001/XMLSchema#NMTOKEN",r.XSD_NAME="http://www.w3.org/2001/XMLSchema#name",r.XSD_NC_NAME="http://www.w3.org/2001/XMLSchema#NCName",r.XSD_ENTITY="http://www.w3.org/2001/XMLSchema#ENTITY",r.XSD_ID="http://www.w3.org/2001/XMLSchema#ID",r.XSD_ID_REF="http://www.w3.org/2001/XMLSchema#IDREF",r.XSD_DURATION="http://www.w3.org/2001/XMLSchema#duration",r.XSD_YEAR_MONTH_DURATION="http://www.w3.org/2001/XMLSchema#yearMonthDuration",r.XSD_DAY_TIME_DURATION="http://www.w3.org/2001/XMLSchema#dayTimeDuration"})(t||(he.TypeURL=t={}));var e;return(function(r){r.NOT="!",r.UMINUS="uminus",r.UPLUS="uplus",r.LOGICAL_OR="||",r.LOGICAL_AND="&&",r.EQUAL="=",r.NOT_EQUAL="!=",r.LT="<",r.GT=">",r.LTE="<=",r.GTE=">=",r.SAME_TERM="sameterm",r.IN="in",r.NOT_IN="notin",r.MULTIPLICATION="*",r.DIVISION="/",r.ADDITION="+",r.SUBTRACTION="-",r.IS_IRI="isiri",r.IS_URI="isuri",r.IS_BLANK="isblank",r.IS_LITERAL="isliteral",r.IS_NUMERIC="isnumeric",r.STR="str",r.LANG="lang",r.DATATYPE="datatype",r.IRI="iri",r.URI="uri",r.BNODE="bnode",r.STRDT="strdt",r.STRLANG="strlang",r.UUID="uuid",r.STRUUID="struuid",r.STRLEN="strlen",r.SUBSTR="substr",r.UCASE="ucase",r.LCASE="lcase",r.STRSTARTS="strstarts",r.STRENDS="strends",r.CONTAINS="contains",r.STRBEFORE="strbefore",r.STRAFTER="strafter",r.ENCODE_FOR_URI="encode_for_uri",r.CONCAT="concat",r.LANG_MATCHES="langmatches",r.REGEX="regex",r.REPLACE="replace",r.ABS="abs",r.ROUND="round",r.CEIL="ceil",r.FLOOR="floor",r.RAND="rand",r.NOW="now",r.YEAR="year",r.MONTH="month",r.DAY="day",r.HOURS="hours",r.MINUTES="minutes",r.SECONDS="seconds",r.TIMEZONE="timezone",r.TZ="tz",r.MD5="md5",r.SHA1="sha1",r.SHA256="sha256",r.SHA384="sha384",r.SHA512="sha512",r.TRIPLE="triple",r.SUBJECT="subject",r.PREDICATE="predicate",r.OBJECT="object",r.IS_TRIPLE="istriple",r.BOUND="bound",r.IF="if",r.COALESCE="coalesce"})(e||(he.SparqlOperator=e={})),he}var B={},hb;function go(){if(hb)return B;hb=1,Object.defineProperty(B,"__esModule",{value:!0}),B.NoAggregator=B.ExtensionFunctionError=B.InvalidExpression=B.InvalidArity=B.UnexpectedError=B.ParseError=B.EmptyAggregateError=B.IncompatibleLanguageOperation=B.InvalidTimezoneCall=B.CastError=B.InvalidArgumentTypes=B.InError=B.CoalesceError=B.RDFEqualTypeError=B.EBVCoercionError=B.UnboundVariableError=B.InvalidLexicalForm=B.isExpressionError=B.ExpressionError=void 0;class i extends Error{}B.ExpressionError=i;function o(T){return T instanceof i}B.isExpressionError=o;class u extends i{constructor(v){super(`Invalid lexical form '${g(v)}'`),this.arg=v}}B.InvalidLexicalForm=u;class a extends i{constructor(v,F){super(`Unbound variable '${g(v)}'`),this.variable=v,this.bindings=F}}B.UnboundVariableError=a;class t extends i{constructor(v){super(`Cannot coerce term to EBV '${g(v)}'`),this.arg=v}}B.EBVCoercionError=t;class e extends i{constructor(v){super("Equality test for literals with unsupported datatypes"),this.args=v}}B.RDFEqualTypeError=e;class r extends i{constructor(v){super("All COALESCE arguments threw errors"),this.errors=v}}B.CoalesceError=r;class n extends i{constructor(v){super(`Some argument to IN errorred and none where equal. ${v.map(F=>`(${F.toString()}) `).join("and ")}`),this.errors=v}}B.InError=n;class c extends i{constructor(v,F){super(`Argument types not valid for operator: '${g(F)}' with '${g(v)}`),this.args=v,this.op=F}}B.InvalidArgumentTypes=c;class s extends i{constructor(v,F){super(`Invalid cast: '${g(v)}' to '${g(F)}'`),this.arg=v}}B.CastError=s;class l extends i{constructor(v){super(`TIMEZONE call on ${v} which has no timezone`),this.dateString=v}}B.InvalidTimezoneCall=l;class d extends i{constructor(v,F){super(`Operation on incompatible language literals '${g(v)}' and '${g(F)}'`),this.arg1=v,this.arg2=F}}B.IncompatibleLanguageOperation=d;class f extends i{constructor(){super("Empty aggregate expression")}}B.EmptyAggregateError=f;class p extends i{constructor(v,F){super(`Failed to parse "${v}" as ${F}.`)}}B.ParseError=p;class _ extends Error{constructor(v,F){super(`Programmer Error '${v}'`),this.payload=F}}B.UnexpectedError=_;class y extends Error{constructor(v,F){super(`The number of args does not match the arity of the operator '${g(F)}'.`),this.args=v,this.op=F}}B.InvalidArity=y;class m extends Error{constructor(v){super(`Invalid SPARQL Expression '${g(v)}'`)}}B.InvalidExpression=m;class b extends Error{constructor(v,F){F instanceof Error?super(`Error thrown in ${v}: ${F.message}${F.stack?`
${F.stack}`:""}`):super(`Error thrown in ${v}`)}}B.ExtensionFunctionError=b;class h extends Error{constructor(v){super(`Aggregate expression ${g(v)} found, but no aggregate hook provided.`)}}B.NoAggregator=h;function g(T){return JSON.stringify(T)}return B}var ve={},vb;function nD(){if(vb)return ve;vb=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.serializeDuration=ve.serializeTime=ve.serializeDate=ve.serializeDateTime=void 0;function i(r,n=2){return r.toLocaleString(void 0,{minimumIntegerDigits:n,useGrouping:!1})}function o(r){return`${a({year:r.year,month:r.month,day:r.day})}T${t(r)}`}ve.serializeDateTime=o;function u(r){return r.zoneHours===void 0||r.zoneMinutes===void 0?"":r.zoneHours===0&&r.zoneMinutes===0?"Z":`${r.zoneHours>=0?`+${i(r.zoneHours)}`:i(r.zoneHours)}:${i(Math.abs(r.zoneMinutes))}`}function a(r){return`${i(r.year,4)}-${i(r.month)}-${i(r.day)}${u(r)}`}ve.serializeDate=a;function t(r){return`${i(r.hours)}:${i(r.minutes)}:${i(r.seconds)}${u(r)}`}ve.serializeTime=t;function e(r,n="PT0S"){if(!Object.values(r).some(m=>(m||0)!==0))return n;const c=Object.values(r).some(m=>(m||0)<0)?"-":"",s=r.year?`${Math.abs(r.year)}Y`:"",l=r.month?`${Math.abs(r.month)}M`:"",d=r.day?`${Math.abs(r.day)}D`:"",f=`${c}P${s}${l}${d}`;if(!(r.hours||r.minutes||r.seconds))return f;const p=r.hours?`${Math.abs(r.hours)}H`:"",_=r.minutes?`${Math.abs(r.minutes)}M`:"",y=r.seconds?`${Math.abs(r.seconds)}S`:"";return`${f}T${p}${_}${y}`}return ve.serializeDuration=e,ve}var U_={},J={},Go={},Tb;function mj(){if(Tb)return Go;Tb=1,Object.defineProperty(Go,"__esModule",{value:!0}),Go.OverloadTree=void 0;const i=ho(),o=c_();let u=class k_{constructor(t,e){this.identifier=t,this.implementation=void 0,this.generalOverloads=Object.create(null),this.literalOverLoads=[],this.depth=e??0,this.promotionCount=void 0}getSubtree(t){const e=(0,o.asGeneralType)(t);if(e)return this.generalOverloads[e];for(const[r,n]of this.literalOverLoads)if(t===r)return n}getImplementationExact(t){let e=this;for(const r of t)if(e=e.getSubtree(r),!e)return;return e.implementation}search(t,e,r){let n=r[this.identifier],c=0;for(;c<t.length&&(n!=null&&n.cache);){const d=t[c],f=(0,i.isLiteralTermExpression)(d);n=n.cache[f?f.dataType:d.termType],c++}if(c===t.length&&(n!=null&&n.func))return n.func;const s=[],l=0;if(t.length===0)return this.implementation;for(s.push(...this.getSubTreeWithArg(t[l],e).map(d=>({node:d,index:l+1})));s.length>0;){const{index:d,node:f}=s.pop();if(d===t.length&&f.implementation)return this.addToCache(r,t,f.implementation),f.implementation;s.push(...f.getSubTreeWithArg(t[d],e).map(p=>({node:p,index:d+1})))}}addToCache(t,e,r){function n(s,l){return l in s||(s[l]={}),s[l]}let c=n(t,this.identifier);for(const s of e){const l=(0,i.isLiteralTermExpression)(s),d=l?l.dataType:s.termType;c.cache=c.cache??{},c=n(c.cache,d)}c.func=r}addOverload(t,e){this._addOverload([...t],e,0)}_addOverload(t,e,r){const[n,...c]=t;if(!n){(this.promotionCount===void 0||r<=this.promotionCount)&&(this.promotionCount=r,this.implementation=e);return}let s=this.getSubtree(n);if(!s){const l=new k_(this.identifier,this.depth+1),d=(0,o.asGeneralType)(n);d&&(this.generalOverloads[d]=l);const f=(0,o.asOverrideType)(n);f&&this.literalOverLoads.push([f,l]),s=l}if(s._addOverload(c,e,r),o.typePromotion[n])for(const l of o.typePromotion[n])this.addPromotedOverload(l.typeToPromote,e,l.conversionFunction,c,r)}addPromotedOverload(t,e,r,n,c){let s=this.getSubtree(t);if(!s){const l=new k_(this.identifier,this.depth+1);this.literalOverLoads.push([t,l]),s=l}s._addOverload(n,l=>d=>e(l)([...d.slice(0,this.depth),r(d[this.depth]),...d.slice(this.depth+1,d.length)]),c+1)}getSubTreeWithArg(t,e){const r=[],n=(0,i.isLiteralTermExpression)(t);if(this.generalOverloads.term&&r.push(this.generalOverloads.term),this.generalOverloads[t.termType]&&r.push(this.generalOverloads[t.termType]),n){const c=(0,o.asKnownLiteralType)(n.dataType);let s;c?s=o.superTypeDictTable[c]:s=(0,o.getSuperTypes)(n.dataType,e);const l=this.literalOverLoads.filter(([d,f])=>d in s).map(([d,f])=>[s[d],f]);l.sort(([d,f],[p,_])=>d-p),r.push(...l.map(([d,f])=>f))}return r}};return Go.OverloadTree=u,Go}var Ob;function bj(){if(Ob)return J;Ob=1,Object.defineProperty(J,"__esModule",{value:!0}),J.expressionToVar=J.dateTime=J.langString=J.string=J.double=J.float=J.decimal=J.integer=J.bool=J.Builder=J.declare=void 0;const i=q(),o=ho(),u=ho(),a=so(),t=so(),e=go(),r=mj();function n(h){return new c(h)}J.declare=n;class c{constructor(g){this.overloadTree=new r.OverloadTree(g),this.collected=!1}collect(){if(this.collected)throw new Error("Builders can only be collected once!");return this.collected=!0,this.overloadTree}static wrapInvalidLexicalProtected(g){return T=>v=>{for(const[F,P]of v.entries())if(P instanceof u.NonLexicalLiteral)throw new e.InvalidLexicalForm(v[F].toRDF(T.context.getSafe(i.KeysInitQuery.dataFactory)));return g(T)(v)}}set(g,T,v=!0){return this.overloadTree.addOverload(g,v?c.wrapInvalidLexicalProtected(T):T),this}copy({from:g,to:T}){const v=this.overloadTree.getImplementationExact(g);if(!v)throw new e.UnexpectedError("Tried to copy implementation, but types not found",{from:g,to:T});return this.set(T,v)}onUnary(g,T,v=!0){return this.set([g],F=>([P])=>T(F)(P),v)}onUnaryTyped(g,T,v=!0){return this.set([g],F=>([P])=>T(F)(P.typedValue),v)}onBinary(g,T,v=!0){return this.set(g,F=>([P,j])=>T(F)(P,j),v)}onBinaryTyped(g,T,v=!0){return this.set(g,F=>([P,j])=>T(F)(P.typedValue,j.typedValue),v)}onTernaryTyped(g,T,v=!0){return this.set(g,F=>([P,j,x])=>T(F)(P.typedValue,j.typedValue,x.typedValue),v)}onTernary(g,T,v=!0){return this.set(g,F=>([P,j,x])=>T(F)(P,j,x),v)}onQuaternaryTyped(g,T,v=!0){return this.set(g,F=>([P,j,x,A])=>T(F)(P.typedValue,j.typedValue,x.typedValue,A.typedValue),v)}onTerm1(g,T=!1){return this.set(["term"],v=>([F])=>g(v)(F),T)}onTerm3(g){return this.set(["term","term","term"],T=>([v,F,P])=>g(T)(v,F,P))}onQuad1(g){return this.set(["quad"],T=>([v])=>g(T)(v))}onLiteral1(g,T=!0){return this.set(["literal"],v=>([F])=>g(v)(F),T)}onBoolean1(g,T=!0){return this.set([a.TypeURL.XSD_BOOLEAN],v=>([F])=>g(v)(F),T)}onBoolean1Typed(g,T=!0){return this.set([a.TypeURL.XSD_BOOLEAN],v=>([F])=>g(v)(F.typedValue),T)}onString1(g,T=!0){return this.set([a.TypeURL.XSD_STRING],v=>([F])=>g(v)(F),T)}onString1Typed(g,T=!0){return this.set([a.TypeURL.XSD_STRING],v=>([F])=>g(v)(F.typedValue),T)}onLangString1(g,T=!0){return this.set([a.TypeURL.RDF_LANG_STRING],v=>([F])=>g(v)(F),T)}onStringly1(g,T=!0){return this.set([a.TypeAlias.SPARQL_STRINGLY],v=>([F])=>g(v)(F),T)}onStringly1Typed(g,T=!0){return this.set([a.TypeAlias.SPARQL_STRINGLY],v=>([F])=>g(v)(F.typedValue),T)}onNumeric1(g,T=!0){return this.set([a.TypeAlias.SPARQL_NUMERIC],v=>([F])=>g(v)(F),T)}onDateTime1(g,T=!0){return this.set([a.TypeURL.XSD_DATE_TIME],v=>([F])=>g(v)(F),T)}numericConverter(g,T=!0){const v=F=>P=>g(F)(P.typedValue);return this.onUnary(t.TypeURL.XSD_INTEGER,F=>P=>l(v(F)(P)),T).onUnary(t.TypeURL.XSD_DECIMAL,F=>P=>d(v(F)(P)),T).onUnary(t.TypeURL.XSD_FLOAT,F=>P=>f(v(F)(P)),T).onUnary(t.TypeURL.XSD_DOUBLE,F=>P=>p(v(F)(P)),T)}arithmetic(g,T=!0){const v=F=>(P,j)=>g(F)(P.typedValue,j.typedValue);return this.onBinary([t.TypeURL.XSD_INTEGER,t.TypeURL.XSD_INTEGER],F=>(P,j)=>l(v(F)(P,j)),T).onBinary([t.TypeURL.XSD_DECIMAL,t.TypeURL.XSD_DECIMAL],F=>(P,j)=>d(v(F)(P,j)),T).onBinary([t.TypeURL.XSD_FLOAT,t.TypeURL.XSD_FLOAT],F=>(P,j)=>f(v(F)(P,j)),T).onBinary([t.TypeURL.XSD_DOUBLE,t.TypeURL.XSD_DOUBLE],F=>(P,j)=>p(v(F)(P,j)),T)}numberTest(g){return this.numeric(T=>([v,F])=>{const P=g(T)(v.typedValue,F.typedValue);return s(P)})}stringTest(g,T=!0){return this.set([a.TypeURL.XSD_STRING,a.TypeURL.XSD_STRING],v=>([F,P])=>{const j=g(v)(F.typedValue,P.typedValue);return s(j)},T)}booleanTest(g,T=!0){return this.set([a.TypeURL.XSD_BOOLEAN,a.TypeURL.XSD_BOOLEAN],v=>([F,P])=>{const j=g(v)(F.typedValue,P.typedValue);return s(j)},T)}dateTimeTest(g,T=!0){return this.set([a.TypeURL.XSD_DATE_TIME,a.TypeURL.XSD_DATE_TIME],v=>([F,P])=>{const j=g(v)(F.typedValue,P.typedValue);return s(j)},T)}numeric(g){return this.set([a.TypeAlias.SPARQL_NUMERIC,a.TypeAlias.SPARQL_NUMERIC],g)}}J.Builder=c;function s(h){return new o.BooleanLiteral(h)}J.bool=s;function l(h){return new o.IntegerLiteral(h)}J.integer=l;function d(h){return new o.DecimalLiteral(h)}J.decimal=d;function f(h){return new o.FloatLiteral(h)}J.float=f;function p(h){return new o.DoubleLiteral(h)}J.double=p;function _(h){return new o.StringLiteral(h)}J.string=_;function y(h,g){return new o.LangStringLiteral(h,g)}J.langString=y;function m(h,g){return new o.DateTimeLiteral(h,g)}J.dateTime=m;function b(h,g){return h.variable(g.name.slice(1))}return J.expressionToVar=b,J}var Ab;function c_(){return Ab||(Ab=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.typePromotion=i.isSubTypeOf=i.getSuperTypeDict=i.isInternalSubType=i.asGeneralType=i.asOverrideType=i.asKnownLiteralType=i.asTypeAlias=i.typeAliasCheck=i.extensionTableInit=i.getSuperTypes=i.superTypeDictTable=i.extensionTableInput=void 0;const o=ho(),u=bj(),a=so();i.extensionTableInput={[a.TypeURL.XSD_DATE_TIME_STAMP]:a.TypeURL.XSD_DATE_TIME,[a.TypeURL.XSD_DAY_TIME_DURATION]:a.TypeURL.XSD_DURATION,[a.TypeURL.XSD_YEAR_MONTH_DURATION]:a.TypeURL.XSD_DURATION,[a.TypeURL.RDF_LANG_STRING]:a.TypeAlias.SPARQL_STRINGLY,[a.TypeURL.XSD_STRING]:a.TypeAlias.SPARQL_STRINGLY,[a.TypeURL.XSD_NORMALIZED_STRING]:a.TypeURL.XSD_STRING,[a.TypeURL.XSD_TOKEN]:a.TypeURL.XSD_NORMALIZED_STRING,[a.TypeURL.XSD_LANGUAGE]:a.TypeURL.XSD_TOKEN,[a.TypeURL.XSD_NM_TOKEN]:a.TypeURL.XSD_TOKEN,[a.TypeURL.XSD_NAME]:a.TypeURL.XSD_TOKEN,[a.TypeURL.XSD_NC_NAME]:a.TypeURL.XSD_NAME,[a.TypeURL.XSD_ENTITY]:a.TypeURL.XSD_NC_NAME,[a.TypeURL.XSD_ID]:a.TypeURL.XSD_NC_NAME,[a.TypeURL.XSD_ID_REF]:a.TypeURL.XSD_NC_NAME,[a.TypeURL.XSD_DOUBLE]:a.TypeAlias.SPARQL_NUMERIC,[a.TypeURL.XSD_FLOAT]:a.TypeAlias.SPARQL_NUMERIC,[a.TypeURL.XSD_DECIMAL]:a.TypeAlias.SPARQL_NUMERIC,[a.TypeURL.XSD_INTEGER]:a.TypeURL.XSD_DECIMAL,[a.TypeURL.XSD_NON_POSITIVE_INTEGER]:a.TypeURL.XSD_INTEGER,[a.TypeURL.XSD_NEGATIVE_INTEGER]:a.TypeURL.XSD_NON_POSITIVE_INTEGER,[a.TypeURL.XSD_LONG]:a.TypeURL.XSD_INTEGER,[a.TypeURL.XSD_INT]:a.TypeURL.XSD_LONG,[a.TypeURL.XSD_SHORT]:a.TypeURL.XSD_INT,[a.TypeURL.XSD_BYTE]:a.TypeURL.XSD_SHORT,[a.TypeURL.XSD_NON_NEGATIVE_INTEGER]:a.TypeURL.XSD_INTEGER,[a.TypeURL.XSD_POSITIVE_INTEGER]:a.TypeURL.XSD_NON_NEGATIVE_INTEGER,[a.TypeURL.XSD_UNSIGNED_LONG]:a.TypeURL.XSD_NON_NEGATIVE_INTEGER,[a.TypeURL.XSD_UNSIGNED_INT]:a.TypeURL.XSD_UNSIGNED_LONG,[a.TypeURL.XSD_UNSIGNED_SHORT]:a.TypeURL.XSD_UNSIGNED_INT,[a.TypeURL.XSD_UNSIGNED_BYTE]:a.TypeURL.XSD_UNSIGNED_SHORT,[a.TypeURL.XSD_DATE_TIME]:"term",[a.TypeURL.XSD_BOOLEAN]:"term",[a.TypeURL.XSD_DATE]:"term",[a.TypeURL.XSD_G_MONTH]:"term",[a.TypeURL.XSD_G_MONTHDAY]:"term",[a.TypeURL.XSD_G_YEAR]:"term",[a.TypeURL.XSD_G_YEAR_MONTH]:"term",[a.TypeURL.XSD_TIME]:"term",[a.TypeURL.XSD_G_DAY]:"term",[a.TypeURL.XSD_DURATION]:"term",[a.TypeAlias.SPARQL_NUMERIC]:"term",[a.TypeAlias.SPARQL_STRINGLY]:"term",[a.TypeURL.XSD_ANY_URI]:"term"},i.superTypeDictTable=Object.create(null);function t(y,m){const b=m.cache.get(y);if(b)return b;const h=m.discoverer(y);if(h==="term"){const v=Object.create(null);return v.__depth=0,v[y]=0,m.cache.set(y,v),v}let g;const T=s(h);return T?g={...i.superTypeDictTable[T]}:g={...t(h,m)},g.__depth++,g[y]=g.__depth,m.cache.set(y,g),g}i.getSuperTypes=t;function e(){for(const[y,m]of Object.entries(i.extensionTableInput)){const b=y;i.superTypeDictTable[b]||r(b,m,i.superTypeDictTable)}}i.extensionTableInit=e,e();function r(y,m,b){if(m==="term"||m===void 0){const h=Object.create(null);h.__depth=0,h[y]=0,b[y]=h;return}b[m]||r(m,i.extensionTableInput[m],b),b[y]={...b[m],[y]:b[m].__depth+1,__depth:b[m].__depth+1}}i.typeAliasCheck=Object.create(null);function n(){for(const y of Object.values(a.TypeAlias))i.typeAliasCheck[y]=!0}n();function c(y){if(y in i.typeAliasCheck)return y}i.asTypeAlias=c;function s(y){if(y in i.superTypeDictTable)return y}i.asKnownLiteralType=s;function l(y){if(s(y)??y==="term")return y}i.asOverrideType=l;function d(y){if(y==="term"||(0,o.asTermType)(y))return y}i.asGeneralType=d;function f(y,m){return y!=="term"&&i.superTypeDictTable[y]&&i.superTypeDictTable[y][m]!==void 0}i.isInternalSubType=f;function p(y,m){const b=s(y);return b?i.superTypeDictTable[b]:t(y,m)}i.getSuperTypeDict=p;function _(y,m,b){return y==="term"?!1:p(y,b)[m]!==void 0}i.isSubTypeOf=_,i.typePromotion={[a.TypeURL.XSD_STRING]:[{typeToPromote:a.TypeURL.XSD_ANY_URI,conversionFunction:y=>(0,u.string)(y.str())}],[a.TypeURL.XSD_DOUBLE]:[{typeToPromote:a.TypeURL.XSD_FLOAT,conversionFunction:y=>(0,u.double)(y.typedValue)},{typeToPromote:a.TypeURL.XSD_DECIMAL,conversionFunction:y=>(0,u.double)(y.typedValue)}],[a.TypeURL.XSD_FLOAT]:[{typeToPromote:a.TypeURL.XSD_DECIMAL,conversionFunction:y=>(0,u.float)(y.typedValue)}]}})(U_)),U_}var Sb;function aD(){if(Sb)return I;Sb=1,Object.defineProperty(I,"__esModule",{value:!0}),I.isNonLexicalLiteral=I.NonLexicalLiteral=I.YearMonthDurationLiteral=I.DayTimeDurationLiteral=I.DurationLiteral=I.DateLiteral=I.TimeLiteral=I.DateTimeLiteral=I.StringLiteral=I.LangStringLiteral=I.BooleanLiteral=I.DoubleLiteral=I.FloatLiteral=I.DecimalLiteral=I.IntegerLiteral=I.NumericLiteral=I.Literal=I.isLiteralTermExpression=I.DefaultGraph=I.Quad=I.BlankNode=I.NamedNode=I.Term=void 0;const i=Ee(),o=so(),u=so(),a=go(),t=nD(),e=c_();let r=class{constructor(){this.expressionType=i.ExpressionType.Term}str(){throw new a.InvalidArgumentTypes([this],o.SparqlOperator.STR)}coerceEBV(){throw new a.EBVCoercionError(this)}};I.Term=r;class n extends r{constructor(R){super(),this.value=R,this.termType="namedNode"}toRDF(R){return R.namedNode(this.value)}str(){return this.value}}I.NamedNode=n;class c extends r{constructor(R){super(),this.termType="blankNode",this.value=R}toRDF(R){return typeof this.value=="string"?R.blankNode(this.value):this.value}}I.BlankNode=c;class s extends r{constructor(R,E,D,C){super(),this.subject=R,this.predicate=E,this.object=D,this.graph=C,this.termType="quad"}toRDF(R){return R.quad(this.subject.toRDF(R),this.predicate.toRDF(R),this.object.toRDF(R),this.graph.toRDF(R))}str(){return`Quad: [${this.subject.str()}, ${this.predicate.str()}, ${this.object.str()}, ${this.graph.str()}]`}}I.Quad=s;class l extends r{constructor(){super(),this.termType="defaultGraph"}toRDF(R){return R.defaultGraph()}str(){return"DefaultGraph"}}I.DefaultGraph=l;function d(M){if(M.termType==="literal")return M}I.isLiteralTermExpression=d;class f extends r{constructor(R,E,D,C){super(),this.typedValue=R,this.dataType=E,this.strValue=D,this.language=C,this.termType="literal"}toRDF(R){return R.literal(this.strValue??this.str(),this.language??R.namedNode(this.dataType))}str(){return this.strValue??this.typedValue.toString()}}I.Literal=f;class p extends f{constructor(R,E,D,C){super(R,E,D,C),this.typedValue=R,this.strValue=D,this.language=C}coerceEBV(){return!!this.typedValue}toRDF(R){const E=super.toRDF(R);return Number.isFinite(this.typedValue)||(E.value=E.value.replace("Infinity","INF")),E}str(){return this.strValue??this.specificFormatter(this.typedValue)}}I.NumericLiteral=p;class _ extends p{constructor(R,E,D,C){super(R,E??u.TypeURL.XSD_INTEGER,D,C),this.typedValue=R,this.strValue=D,this.language=C}specificFormatter(R){return R.toFixed(0)}}I.IntegerLiteral=_;class y extends p{constructor(R,E,D,C){super(R,E??u.TypeURL.XSD_DECIMAL,D,C),this.typedValue=R,this.strValue=D,this.language=C}specificFormatter(R){return R.toString()}}I.DecimalLiteral=y;class m extends p{constructor(R,E,D,C){super(R,E??u.TypeURL.XSD_FLOAT,D,C),this.typedValue=R,this.strValue=D,this.language=C}specificFormatter(R){return R.toString()}}I.FloatLiteral=m;class b extends p{constructor(R,E,D,C){super(R,E??u.TypeURL.XSD_DOUBLE,D,C),this.typedValue=R,this.strValue=D,this.language=C}specificFormatter(R){if(!Number.isFinite(R))return R>0?"INF":R<0?"-INF":"NaN";const E=R.toExponential(),[D,C]=E.split("e"),ce=C.replace(/\+/u,"");return`${D.includes(".")?D:`${D}.0`}E${ce}`}}I.DoubleLiteral=b;class h extends f{constructor(R,E,D){super(R,D??u.TypeURL.XSD_BOOLEAN,E),this.typedValue=R,this.strValue=E}coerceEBV(){return this.typedValue}}I.BooleanLiteral=h;class g extends f{constructor(R,E,D){super(R,D??u.TypeURL.RDF_LANG_STRING,R,E),this.typedValue=R,this.language=E}coerceEBV(){return this.str().length>0}}I.LangStringLiteral=g;class T extends f{constructor(R,E){super(R,E??u.TypeURL.XSD_STRING,R),this.typedValue=R}coerceEBV(){return this.str().length>0}}I.StringLiteral=T;class v extends f{constructor(R,E,D){super(R,D??u.TypeURL.XSD_DATE_TIME,E),this.typedValue=R,this.strValue=E}str(){return(0,t.serializeDateTime)(this.typedValue)}}I.DateTimeLiteral=v;class F extends f{constructor(R,E,D){super(R,D??u.TypeURL.XSD_TIME,E),this.typedValue=R,this.strValue=E}str(){return(0,t.serializeTime)(this.typedValue)}}I.TimeLiteral=F;class P extends f{constructor(R,E,D){super(R,D??u.TypeURL.XSD_DATE,E),this.typedValue=R,this.strValue=E}str(){return(0,t.serializeDate)(this.typedValue)}}I.DateLiteral=P;class j extends f{constructor(R,E,D){super(R,D??u.TypeURL.XSD_DURATION,E),this.typedValue=R,this.strValue=E}str(){return(0,t.serializeDuration)(this.typedValue)}}I.DurationLiteral=j;class x extends j{constructor(R,E,D){super(R,E,D??u.TypeURL.XSD_DAY_TIME_DURATION),this.typedValue=R,this.strValue=E}}I.DayTimeDurationLiteral=x;class A extends f{constructor(R,E,D){super(R,D??u.TypeURL.XSD_YEAR_MONTH_DURATION,E),this.typedValue=R,this.strValue=E}str(){return(0,t.serializeDuration)(this.typedValue,"P0M")}}I.YearMonthDurationLiteral=A;class L extends f{constructor(R,E,D,C,ce){super({toString:()=>"undefined"},E,C,ce),this.openWorldType=D}coerceEBV(){if((0,e.isSubTypeOf)(this.dataType,u.TypeURL.XSD_BOOLEAN,this.openWorldType)||(0,e.isSubTypeOf)(this.dataType,u.TypeAlias.SPARQL_NUMERIC,this.openWorldType))return!1;throw new a.EBVCoercionError(this)}toRDF(R){return R.literal(this.str(),this.language??R.namedNode(this.dataType))}str(){return this.strValue??""}}I.NonLexicalLiteral=L;function z(M){if(M instanceof L)return M}return I.isNonLexicalLiteral=z,I}var Jo={},Fb;function iD(){if(Fb)return Jo;Fb=1,Object.defineProperty(Jo,"__esModule",{value:!0}),Jo.Operator=void 0;const i=Ee();let o=class{constructor(a,t,e){this.name=a,this.args=t,this.apply=e,this.expressionType=i.ExpressionType.Operator}};return Jo.Operator=o,Jo}var Ko={},wb;function oD(){if(wb)return Ko;wb=1,Object.defineProperty(Ko,"__esModule",{value:!0}),Ko.Aggregate=void 0;const i=Ee();let o=class{constructor(a,t){this.name=a,this.expression=t,this.expressionType=i.ExpressionType.Aggregate}};return Ko.Aggregate=o,Ko}var Yo={},Rb;function uD(){if(Rb)return Yo;Rb=1,Object.defineProperty(Yo,"__esModule",{value:!0}),Yo.Existence=void 0;const i=Ee();let o=class{constructor(a){this.expression=a,this.expressionType=i.ExpressionType.Existence}};return Yo.Existence=o,Yo}var Pb;function ho(){return Pb||(Pb=1,(function(i){var o=Ke&&Ke.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ke&&Ke.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(tD(),i),u(rD(),i),u(aD(),i),u(iD(),i),u(oD(),i),u(uD(),i)})(Ke)),Ke}var ee={},V={},qb;function Xy(){if(qb)return V;qb=1,Object.defineProperty(V,"__esModule",{value:!0}),V.extractTimeZone=V.extractRawTimeZone=V.dayTimeDurationsToSeconds=V.yearMonthDurationsToMonths=V.trimToDayTimeDuration=V.trimToYearMonthDuration=V.toUTCDate=V.toJSDate=V.negateDuration=V.toDateTimeRepresentation=V.defaultedDateTimeRepresentation=V.simplifyDurationRepresentation=V.defaultedDurationRepresentation=V.defaultedYearMonthDurationRepresentation=V.defaultedDayTimeDurationRepresentation=void 0;function i(y){return{day:y.day??0,hours:y.hours??0,minutes:y.minutes??0,seconds:y.seconds??0}}V.defaultedDayTimeDurationRepresentation=i;function o(y){return{year:y.year??0,month:y.month??0}}V.defaultedYearMonthDurationRepresentation=o;function u(y){return{...i(y),...o(y)}}V.defaultedDurationRepresentation=u;function a(y){const m=u(y),b={},h=m.year+Math.trunc(m.month/12);h&&(b.year=h,m.month%=12),m.month&&(b.month=m.month);const g=m.day+Math.trunc(m.hours/24)+Math.trunc(m.minutes/1440)+Math.trunc(m.seconds/(1440*60));g&&(b.day=g,m.hours%=24,m.minutes%=1440,m.seconds%=1440*60);const T=m.hours+Math.trunc(m.minutes/60)+Math.trunc(m.seconds/3600);T&&(b.hours=T,m.minutes%=60,m.seconds%=3600);const v=m.minutes+Math.trunc(m.seconds/60);return v&&(b.minutes=v,m.seconds%=60),m.seconds&&(b.seconds=m.seconds),b}V.simplifyDurationRepresentation=a;function t(y){return{...y,day:y.day??1,hours:y.hours??0,month:y.month??1,year:y.year??0,seconds:y.seconds??0,minutes:y.minutes??0}}V.defaultedDateTimeRepresentation=t;function e({date:y,timeZone:m}){return{year:y.getFullYear(),month:y.getMonth()+1,day:y.getDate(),hours:y.getHours(),minutes:y.getMinutes(),seconds:y.getSeconds(),zoneHours:m.zoneHours,zoneMinutes:m.zoneMinutes}}V.toDateTimeRepresentation=e;function r(y){return{year:y.year===void 0?void 0:-1*y.year,month:y.month===void 0?void 0:-1*y.month,day:y.day===void 0?void 0:-1*y.day,hours:y.hours===void 0?void 0:-1*y.hours,minutes:y.minutes===void 0?void 0:-1*y.minutes,seconds:y.seconds===void 0?void 0:-1*y.seconds}}V.negateDuration=r;function n(y){const m=new Date(y.year,y.month-1,y.day,y.hours,y.minutes,Math.trunc(y.seconds),y.seconds%1*1e3);return y.year>=0&&y.year<100&&m.setFullYear(m.getFullYear()-1900),m}V.toJSDate=n;function c(y,m){const b=n(t(y)),h=b.getTimezoneOffset(),g=y.zoneHours??m.zoneHours,T=y.zoneMinutes??m.zoneMinutes;return new Date(b.getTime()-(h+g*60+T)*60*1e3)}V.toUTCDate=c;function s(y){return{year:y.year,month:y.month}}V.trimToYearMonthDuration=s;function l(y){return{day:y.day,hours:y.hours,minutes:y.minutes,seconds:y.seconds}}V.trimToDayTimeDuration=l;function d(y){return y.year*12+y.month}V.yearMonthDurationsToMonths=d;function f(y){return((y.day*24+y.hours)*60+y.minutes)*60+y.seconds}V.dayTimeDurationsToSeconds=f;function p(y){return/(Z|([+-]\d\d:\d\d))?$/u.exec(y)[0]}V.extractRawTimeZone=p;function _(y){return{zoneHours:y.getTimezoneOffset()/60,zoneMinutes:y.getTimezoneOffset()%60}}return V.extractTimeZone=_,V}var Fe={},jb;function gj(){if(jb)return Fe;jb=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.elapsedDuration=Fe.addDurationToDateTime=Fe.maximumDayInMonthFor=void 0;const i=Xy();function o(e,r,n=0){const c=e-n,s=r-n,l=Math.floor(c/s);return{intDiv:l,remainder:e-l*s}}function u(e,r){const{intDiv:n,remainder:c}=o(r,13,1),s=e+n;return[1,3,5,7,8,10,12].includes(c)?31:[4,6,9,11].includes(c)?30:c===2&&(o(s,400).remainder===0||o(s,100).remainder!==0&&o(s,4).remainder===0)?29:28}Fe.maximumDayInMonthFor=u;function a(e,r){const n={...e};let c=o(e.month+r.month,13,1);for(n.month=c.remainder,n.year=e.year+r.year+c.intDiv,c=o(e.seconds+r.seconds,60),n.seconds=c.remainder,c=o(e.minutes+r.minutes+c.intDiv,60),n.minutes=c.remainder,c=o(e.hours+r.hours+c.intDiv,24),n.hours=c.remainder,n.day=e.day+r.day+c.intDiv;;){let s;if(n.day<1)n.day+=u(n.year,n.month-1),s=-1;else if(n.day>u(n.year,n.month))n.day-=u(n.year,n.month),s=1;else break;c=o(n.month+s,13,1),n.month=c.remainder,n.year+=c.intDiv}return n}Fe.addDurationToDateTime=a;function t(e,r,n){const c=(0,i.toUTCDate)(e,n),s=(0,i.toUTCDate)(r,n),l=c.getTime()-s.getTime();return{day:Math.floor(l/(1e3*60*60*24)),hours:Math.floor(l%(1e3*60*60*24)/(1e3*60*60)),minutes:Math.floor(l%(1e3*60*60)/(1e3*60)),seconds:l%(1e3*60)}}return Fe.elapsedDuration=t,Fe}var Mb;function em(){if(Mb)return ee;Mb=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.parseDayTimeDuration=ee.parseYearMonthDuration=ee.parseDuration=ee.parseTime=ee.parseDate=ee.parseDateTime=ee.parseXSDDecimal=ee.parseXSDFloat=void 0;const i=Xy(),o=go(),u=gj();function a(p){const _=Number(p);return Number.isNaN(_)?p==="NaN"?Number.NaN:p==="INF"||p==="+INF"?Number.POSITIVE_INFINITY:p==="-INF"?Number.NEGATIVE_INFINITY:void 0:_}ee.parseXSDFloat=a;function t(p){const _=Number(p);return Number.isNaN(_)?void 0:_}ee.parseXSDDecimal=t;function e(p){const[_,y]=p.split("T");if(y===void 0)throw new o.ParseError(p,"dateTime");return{...n(_),...c(y)}}ee.parseDateTime=e;function r(p){if(p==="")return{zoneHours:void 0,zoneMinutes:void 0};if(p==="Z")return{zoneHours:0,zoneMinutes:0};const y=p.replaceAll(/^([+|-])(\d\d):(\d\d)$/gu,"$11!$2!$3").split("!").map(Number);return{zoneHours:y[0]*y[1],zoneMinutes:y[0]*y[2]}}function n(p){const _=p.replaceAll(/^(-)?([123456789]*\d{4})-(\d\d)-(\d\d)(Z|([+-]\d\d:\d\d))?$/gu,"$11!$2!$3!$4!$5");if(_===p)throw new o.ParseError(p,"date");const y=_.split("!"),m=y.slice(0,-1).map(Number),b={year:m[0]*m[1],month:m[2],day:m[3],...r(y[4])};if(!(b.month>=1&&b.month<=12)||!(b.day>=1&&b.day<=(0,u.maximumDayInMonthFor)(b.year,b.month)))throw new o.ParseError(p,"date");return b}ee.parseDate=n;function c(p){const _=p.replaceAll(/^(\d\d):(\d\d):(\d\d(\.\d+)?)(Z|([+-]\d\d:\d\d))?$/gu,"$1!$2!$3!$5");if(_===p)throw new o.ParseError(p,"time");const y=_.split("!"),m=y.slice(0,-1).map(Number),b={hours:m[0],minutes:m[1],seconds:m[2],...r(y[3])};if(b.seconds>=60||b.minutes>=60||b.hours>24||b.hours===24&&(b.minutes!==0||b.seconds!==0))throw new o.ParseError(p,"time");return b}function s(p){const _=c(p);return _.hours%=24,_}ee.parseTime=s;function l(p){const[_,y]=p.split("T"),m=_.replaceAll(/^(-)?P(\d+Y)?(\d+M)?(\d+D)?$/gu,"$11S!$2!$3!$4");if(m===_)throw new o.ParseError(p,"duration");const b=m.split("!");if(y!==void 0){const T=y.replaceAll(/^(\d+H)?(\d+M)?(\d+(\.\d+)?S)?$/gu,"$1!$2!$3");if(y===""||y===T)throw new o.ParseError(p,"duration");b.push(...T.split("!"))}const h=b.map(T=>T.slice(0,-1));if(!h.slice(1).some(Boolean))throw new o.ParseError(p,"duration");const g=Number(h[0]);return(0,i.simplifyDurationRepresentation)({year:h[1]?g*Number(h[1]):void 0,month:h[2]?g*Number(h[2]):void 0,day:h[3]?g*Number(h[3]):void 0,hours:h[4]?g*Number(h[4]):void 0,minutes:h[5]?g*Number(h[5]):void 0,seconds:h[6]?g*Number(h[6]):void 0})}ee.parseDuration=l;function d(p){const _=l(p);if(["hours","minutes","seconds","day"].some(y=>!!_[y]))throw new o.ParseError(p,"yearMonthDuration");return _}ee.parseYearMonthDuration=d;function f(p){const _=l(p);if(["year","month"].some(y=>!!_[y]))throw new o.ParseError(p,"dayTimeDuration");return _}return ee.parseDayTimeDuration=f,ee}var xb;function cD(){if(xb)return Vo;xb=1,Object.defineProperty(Vo,"__esModule",{value:!0}),Vo.TermTransformer=void 0;const i=ne(),o=$(),u=ho(),a=so(),t=go(),e=go(),r=em(),n=em(),c=c_();let s=class{constructor(d){this.superTypeProvider=d}transformRDFTermUnsafe(d){return this.transformTerm({term:d,type:o.Algebra.types.EXPRESSION,expressionType:o.Algebra.expressionTypes.TERM})}transformTerm(d){if(!d.term)throw new t.InvalidExpression(d);switch(d.term.termType){case"Variable":return new u.Variable(i.termToString(d.term));case"Literal":return this.transformLiteral(d.term);case"NamedNode":return new u.NamedNode(d.term.value);case"BlankNode":return new u.BlankNode(d.term.value);case"Quad":return new u.Quad(this.transformRDFTermUnsafe(d.term.subject),this.transformRDFTermUnsafe(d.term.predicate),this.transformRDFTermUnsafe(d.term.object),this.transformRDFTermUnsafe(d.term.graph));case"DefaultGraph":return new u.DefaultGraph}}transformLiteral(d){if(!d.datatype||[null,void 0,""].includes(d.datatype.value))return d.language?new u.LangStringLiteral(d.value,d.language):new u.StringLiteral(d.value);const f=d.datatype.value,p=(0,c.getSuperTypeDict)(f,this.superTypeProvider);try{if(a.TypeURL.XSD_STRING in p)return new u.StringLiteral(d.value,f);if(a.TypeURL.RDF_LANG_STRING in p)return new u.LangStringLiteral(d.value,d.language);if(a.TypeURL.XSD_YEAR_MONTH_DURATION in p)return new u.YearMonthDurationLiteral((0,r.parseYearMonthDuration)(d.value),d.value,f);if(a.TypeURL.XSD_DAY_TIME_DURATION in p)return new u.DayTimeDurationLiteral((0,r.parseDayTimeDuration)(d.value),d.value,f);if(a.TypeURL.XSD_DURATION in p)return new u.DurationLiteral((0,r.parseDuration)(d.value),d.value,f);if(a.TypeURL.XSD_DATE_TIME in p){const m=new Date(d.value);return Number.isNaN(m.getTime())?new u.NonLexicalLiteral(void 0,f,this.superTypeProvider,d.value):new u.DateTimeLiteral((0,r.parseDateTime)(d.value),d.value,f)}if(a.TypeURL.XSD_DATE in p)return new u.DateLiteral((0,r.parseDate)(d.value),d.value,f);if(a.TypeURL.XSD_TIME in p)return new u.TimeLiteral((0,r.parseTime)(d.value),d.value,f);if(a.TypeURL.XSD_BOOLEAN in p)return d.value!=="true"&&d.value!=="false"&&d.value!=="1"&&d.value!=="0"?new u.NonLexicalLiteral(void 0,f,this.superTypeProvider,d.value):new u.BooleanLiteral(d.value==="true"||d.value==="1",d.value);if(a.TypeURL.XSD_DECIMAL in p){const m=n.parseXSDDecimal(d.value);return m===void 0?new u.NonLexicalLiteral(void 0,f,this.superTypeProvider,d.value):a.TypeURL.XSD_INTEGER in p?new u.IntegerLiteral(m,f,d.value):new u.DecimalLiteral(m,f,d.value)}const _=a.TypeURL.XSD_FLOAT in p,y=a.TypeURL.XSD_DOUBLE in p;if(_||y){const m=n.parseXSDFloat(d.value);return m===void 0?new u.NonLexicalLiteral(void 0,f,this.superTypeProvider,d.value):_?new u.FloatLiteral(m,f,d.value):new u.DoubleLiteral(m,f,d.value)}return new u.Literal(d.value,f,d.value)}catch(_){if((0,e.isExpressionError)(_))return new u.NonLexicalLiteral(void 0,f,this.superTypeProvider,d.value);throw _}}};return Vo.TermTransformer=s,Vo}var Wo={},Db;function sD(){if(Db)return Wo;Db=1,Object.defineProperty(Wo,"__esModule",{value:!0}),Wo.prepareEvaluatorActionContext=void 0;const i=q(),o=To(),u=Xy();function a(t){let e=t;if(e.has(i.KeysInitQuery.extensionFunctionCreator)&&e.has(i.KeysInitQuery.extensionFunctions))throw new Error("Illegal simultaneous usage of extensionFunctionCreator and extensionFunctions in context");if(e.has(i.KeysInitQuery.extensionFunctionCreator))e=e.set(i.KeysExpressionEvaluator.extensionFunctionCreator,e.get(i.KeysInitQuery.extensionFunctionCreator));else if(e.has(i.KeysInitQuery.extensionFunctions)){const r=e.getSafe(i.KeysInitQuery.extensionFunctions);e=e.set(i.KeysExpressionEvaluator.extensionFunctionCreator,async n=>r[n.value])}else e=e.setDefault(i.KeysExpressionEvaluator.extensionFunctionCreator,async()=>{});return e=e.setDefault(i.KeysExpressionEvaluator.defaultTimeZone,(0,u.extractTimeZone)(e.getSafe(i.KeysInitQuery.queryTimestamp))),e=e.setDefault(i.KeysExpressionEvaluator.superTypeProvider,{cache:new o.LRUCache({max:1e3}),discoverer:()=>"term"}),e}return Wo.prepareEvaluatorActionContext=a,Wo}var Eb;function S(){return Eb||(Eb=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.LangStringLiteral=i.TimeLiteral=i.DurationLiteral=i.DateLiteral=i.DayTimeDurationLiteral=i.DateTimeLiteral=i.yearMonthDurationsToMonths=i.toUTCDate=i.toDateTimeRepresentation=i.negateDuration=i.extractRawTimeZone=i.defaultedYearMonthDurationRepresentation=i.defaultedDurationRepresentation=i.defaultedDayTimeDurationRepresentation=i.defaultedDateTimeRepresentation=i.dayTimeDurationsToSeconds=i.isSubTypeOf=i.SparqlOperator=i.TypeAlias=i.TypeURL=i.typedLiteral=i.InvalidArity=i.InvalidLexicalForm=i.ExtensionFunctionError=i.CastError=i.UnboundVariableError=i.NoAggregator=i.InError=i.CoalesceError=i.InvalidArgumentTypes=i.InvalidTimezoneCall=i.IncompatibleLanguageOperation=i.RDFEqualTypeError=i.EmptyAggregateError=i.isExpressionError=i.ExpressionError=i.Builder=i.expressionToVar=i.float=i.decimal=i.langString=i.dateTime=i.integer=i.double=i.string=i.bool=i.declare=i.prepareEvaluatorActionContext=i.OverloadTree=i.TermTransformer=void 0,i.trimToDayTimeDuration=i.trimToYearMonthDuration=i.parseDate=i.parseXSDFloat=i.parseXSDDecimal=i.parseYearMonthDuration=i.parseTime=i.parseDuration=i.parseDayTimeDuration=i.parseDateTime=i.elapsedDuration=i.addDurationToDateTime=i.isNonLexicalLiteral=i.StringLiteral=i.NonLexicalLiteral=i.FloatLiteral=i.IntegerLiteral=i.Literal=i.Existence=i.Aggregate=i.DoubleLiteral=i.DefaultGraph=i.DecimalLiteral=i.BlankNode=i.BooleanLiteral=i.NumericLiteral=i.Variable=i.NamedNode=i.Operator=i.Quad=i.YearMonthDurationLiteral=i.Term=void 0;var o=cD();Object.defineProperty(i,"TermTransformer",{enumerable:!0,get:function(){return o.TermTransformer}});var u=mj();Object.defineProperty(i,"OverloadTree",{enumerable:!0,get:function(){return u.OverloadTree}});var a=sD();Object.defineProperty(i,"prepareEvaluatorActionContext",{enumerable:!0,get:function(){return a.prepareEvaluatorActionContext}});var t=bj();Object.defineProperty(i,"declare",{enumerable:!0,get:function(){return t.declare}}),Object.defineProperty(i,"bool",{enumerable:!0,get:function(){return t.bool}}),Object.defineProperty(i,"string",{enumerable:!0,get:function(){return t.string}}),Object.defineProperty(i,"double",{enumerable:!0,get:function(){return t.double}}),Object.defineProperty(i,"integer",{enumerable:!0,get:function(){return t.integer}}),Object.defineProperty(i,"dateTime",{enumerable:!0,get:function(){return t.dateTime}}),Object.defineProperty(i,"langString",{enumerable:!0,get:function(){return t.langString}}),Object.defineProperty(i,"decimal",{enumerable:!0,get:function(){return t.decimal}}),Object.defineProperty(i,"float",{enumerable:!0,get:function(){return t.float}}),Object.defineProperty(i,"expressionToVar",{enumerable:!0,get:function(){return t.expressionToVar}}),Object.defineProperty(i,"Builder",{enumerable:!0,get:function(){return t.Builder}});var e=go();Object.defineProperty(i,"ExpressionError",{enumerable:!0,get:function(){return e.ExpressionError}}),Object.defineProperty(i,"isExpressionError",{enumerable:!0,get:function(){return e.isExpressionError}}),Object.defineProperty(i,"EmptyAggregateError",{enumerable:!0,get:function(){return e.EmptyAggregateError}}),Object.defineProperty(i,"RDFEqualTypeError",{enumerable:!0,get:function(){return e.RDFEqualTypeError}}),Object.defineProperty(i,"IncompatibleLanguageOperation",{enumerable:!0,get:function(){return e.IncompatibleLanguageOperation}}),Object.defineProperty(i,"InvalidTimezoneCall",{enumerable:!0,get:function(){return e.InvalidTimezoneCall}}),Object.defineProperty(i,"InvalidArgumentTypes",{enumerable:!0,get:function(){return e.InvalidArgumentTypes}}),Object.defineProperty(i,"CoalesceError",{enumerable:!0,get:function(){return e.CoalesceError}}),Object.defineProperty(i,"InError",{enumerable:!0,get:function(){return e.InError}}),Object.defineProperty(i,"NoAggregator",{enumerable:!0,get:function(){return e.NoAggregator}}),Object.defineProperty(i,"UnboundVariableError",{enumerable:!0,get:function(){return e.UnboundVariableError}}),Object.defineProperty(i,"CastError",{enumerable:!0,get:function(){return e.CastError}}),Object.defineProperty(i,"ExtensionFunctionError",{enumerable:!0,get:function(){return e.ExtensionFunctionError}}),Object.defineProperty(i,"InvalidLexicalForm",{enumerable:!0,get:function(){return e.InvalidLexicalForm}}),Object.defineProperty(i,"InvalidArity",{enumerable:!0,get:function(){return e.InvalidArity}});var r=so();Object.defineProperty(i,"typedLiteral",{enumerable:!0,get:function(){return r.typedLiteral}}),Object.defineProperty(i,"TypeURL",{enumerable:!0,get:function(){return r.TypeURL}}),Object.defineProperty(i,"TypeAlias",{enumerable:!0,get:function(){return r.TypeAlias}}),Object.defineProperty(i,"SparqlOperator",{enumerable:!0,get:function(){return r.SparqlOperator}});var n=c_();Object.defineProperty(i,"isSubTypeOf",{enumerable:!0,get:function(){return n.isSubTypeOf}});var c=Xy();Object.defineProperty(i,"dayTimeDurationsToSeconds",{enumerable:!0,get:function(){return c.dayTimeDurationsToSeconds}}),Object.defineProperty(i,"defaultedDateTimeRepresentation",{enumerable:!0,get:function(){return c.defaultedDateTimeRepresentation}}),Object.defineProperty(i,"defaultedDayTimeDurationRepresentation",{enumerable:!0,get:function(){return c.defaultedDayTimeDurationRepresentation}}),Object.defineProperty(i,"defaultedDurationRepresentation",{enumerable:!0,get:function(){return c.defaultedDurationRepresentation}}),Object.defineProperty(i,"defaultedYearMonthDurationRepresentation",{enumerable:!0,get:function(){return c.defaultedYearMonthDurationRepresentation}}),Object.defineProperty(i,"extractRawTimeZone",{enumerable:!0,get:function(){return c.extractRawTimeZone}}),Object.defineProperty(i,"negateDuration",{enumerable:!0,get:function(){return c.negateDuration}}),Object.defineProperty(i,"toDateTimeRepresentation",{enumerable:!0,get:function(){return c.toDateTimeRepresentation}}),Object.defineProperty(i,"toUTCDate",{enumerable:!0,get:function(){return c.toUTCDate}}),Object.defineProperty(i,"yearMonthDurationsToMonths",{enumerable:!0,get:function(){return c.yearMonthDurationsToMonths}});var s=ho();Object.defineProperty(i,"DateTimeLiteral",{enumerable:!0,get:function(){return s.DateTimeLiteral}}),Object.defineProperty(i,"DayTimeDurationLiteral",{enumerable:!0,get:function(){return s.DayTimeDurationLiteral}}),Object.defineProperty(i,"DateLiteral",{enumerable:!0,get:function(){return s.DateLiteral}}),Object.defineProperty(i,"DurationLiteral",{enumerable:!0,get:function(){return s.DurationLiteral}}),Object.defineProperty(i,"TimeLiteral",{enumerable:!0,get:function(){return s.TimeLiteral}}),Object.defineProperty(i,"LangStringLiteral",{enumerable:!0,get:function(){return s.LangStringLiteral}}),Object.defineProperty(i,"Term",{enumerable:!0,get:function(){return s.Term}}),Object.defineProperty(i,"YearMonthDurationLiteral",{enumerable:!0,get:function(){return s.YearMonthDurationLiteral}}),Object.defineProperty(i,"Quad",{enumerable:!0,get:function(){return s.Quad}}),Object.defineProperty(i,"Operator",{enumerable:!0,get:function(){return s.Operator}}),Object.defineProperty(i,"NamedNode",{enumerable:!0,get:function(){return s.NamedNode}}),Object.defineProperty(i,"Variable",{enumerable:!0,get:function(){return s.Variable}}),Object.defineProperty(i,"NumericLiteral",{enumerable:!0,get:function(){return s.NumericLiteral}}),Object.defineProperty(i,"BooleanLiteral",{enumerable:!0,get:function(){return s.BooleanLiteral}}),Object.defineProperty(i,"BlankNode",{enumerable:!0,get:function(){return s.BlankNode}}),Object.defineProperty(i,"DecimalLiteral",{enumerable:!0,get:function(){return s.DecimalLiteral}}),Object.defineProperty(i,"DefaultGraph",{enumerable:!0,get:function(){return s.DefaultGraph}}),Object.defineProperty(i,"DoubleLiteral",{enumerable:!0,get:function(){return s.DoubleLiteral}}),Object.defineProperty(i,"Aggregate",{enumerable:!0,get:function(){return s.Aggregate}}),Object.defineProperty(i,"Existence",{enumerable:!0,get:function(){return s.Existence}}),Object.defineProperty(i,"Literal",{enumerable:!0,get:function(){return s.Literal}}),Object.defineProperty(i,"IntegerLiteral",{enumerable:!0,get:function(){return s.IntegerLiteral}}),Object.defineProperty(i,"FloatLiteral",{enumerable:!0,get:function(){return s.FloatLiteral}}),Object.defineProperty(i,"NonLexicalLiteral",{enumerable:!0,get:function(){return s.NonLexicalLiteral}}),Object.defineProperty(i,"StringLiteral",{enumerable:!0,get:function(){return s.StringLiteral}}),Object.defineProperty(i,"isNonLexicalLiteral",{enumerable:!0,get:function(){return s.isNonLexicalLiteral}});var l=gj();Object.defineProperty(i,"addDurationToDateTime",{enumerable:!0,get:function(){return l.addDurationToDateTime}}),Object.defineProperty(i,"elapsedDuration",{enumerable:!0,get:function(){return l.elapsedDuration}});var d=em();Object.defineProperty(i,"parseDateTime",{enumerable:!0,get:function(){return d.parseDateTime}}),Object.defineProperty(i,"parseDayTimeDuration",{enumerable:!0,get:function(){return d.parseDayTimeDuration}}),Object.defineProperty(i,"parseDuration",{enumerable:!0,get:function(){return d.parseDuration}}),Object.defineProperty(i,"parseTime",{enumerable:!0,get:function(){return d.parseTime}}),Object.defineProperty(i,"parseYearMonthDuration",{enumerable:!0,get:function(){return d.parseYearMonthDuration}}),Object.defineProperty(i,"parseXSDDecimal",{enumerable:!0,get:function(){return d.parseXSDDecimal}}),Object.defineProperty(i,"parseXSDFloat",{enumerable:!0,get:function(){return d.parseXSDFloat}}),Object.defineProperty(i,"parseDate",{enumerable:!0,get:function(){return d.parseDate}});var f=Xy();Object.defineProperty(i,"trimToYearMonthDuration",{enumerable:!0,get:function(){return f.trimToYearMonthDuration}}),Object.defineProperty(i,"trimToDayTimeDuration",{enumerable:!0,get:function(){return f.trimToDayTimeDuration}})})(C_)),C_}var Lb;function hj(){if(Lb)return Je;Lb=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.TermFunctionBase=Je.ExpressionFunctionBase=void 0;const i=q(),o=S();class u{constructor({arity:e,operator:r,apply:n}){this.arity=e,this.operator=r,this.apply=n}checkArity(e){return Array.isArray(this.arity)?this.arity.includes(e.length):this.arity===Number.POSITIVE_INFINITY?!0:e.length===this.arity}}Je.ExpressionFunctionBase=u;class a extends u{constructor({arity:e,operator:r,overloads:n}){super({arity:e,operator:r,apply:async({args:c,exprEval:s,mapping:l})=>this.applyOnTerms(await Promise.all(c.map(d=>s.evaluatorExpressionEvaluation(d,l))),s)}),this.supportsTermExpressions=!0,this.overloads=n}applyOnTerms(e,r){return(this.overloads.search(e,r.context.getSafe(i.KeysExpressionEvaluator.superTypeProvider),r.context.getSafe(i.KeysInitQuery.functionArgumentsCache))??this.handleInvalidTypes(e))(r)(e)}handleInvalidTypes(e){throw new o.InvalidArgumentTypes(e,this.operator)}}return Je.TermFunctionBase=a,Je}var Ib;function w(){return Ib||(Ib=1,(function(i){var o=Xe&&Xe.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Xe&&Xe.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(_j(),i),u(kx(),i),u(eD(),i),u(hj(),i)})(Xe)),Xe}var Ye={},Zo={},$b;function vj(){if($b)return Zo;$b=1,Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.ActorQueryOperation=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return Zo.ActorQueryOperation=o,Zo}var ko={},We={},eu={},Bb;function dD(){if(Bb)return eu;Bb=1,Object.defineProperty(eu,"__esModule",{value:!0}),eu.MetadataValidationState=void 0;let i=class{constructor(){this.invalidateListeners=[],this.valid=!0}addInvalidateListener(u){this.invalidateListeners.push(u)}invalidate(){if(this.valid){this.valid=!1;for(const u of this.invalidateListeners)u()}}};return eu.MetadataValidationState=i,eu}var pe={},Qb;function lD(){if(Qb)return pe;Qb=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.cachifyMetadata=pe.validateMetadataBindings=pe.validateMetadataQuads=pe.getMetadataBindings=pe.getMetadataQuads=void 0;function i(e){return t(()=>new Promise((r,n)=>{e.getProperty("metadata",c=>r(c)),e.on("error",n)}).then(r=>u(r)))}pe.getMetadataQuads=i;function o(e){return t(()=>new Promise((r,n)=>{e.getProperty("metadata",c=>r(c)),e.on("error",n)}).then(r=>a(r)))}pe.getMetadataBindings=o;function u(e){for(const r of["cardinality"])if(!(r in e))throw new Error(`Invalid metadata: missing ${r} in ${JSON.stringify(e)}`);return e}pe.validateMetadataQuads=u;function a(e){for(const r of["cardinality","variables"])if(!(r in e))throw new Error(`Invalid metadata: missing ${r} in ${JSON.stringify(e)}`);return e}pe.validateMetadataBindings=a;function t(e){let r;return()=>(r||(r=e(),r.then(n=>n.state.addInvalidateListener(()=>{r=void 0})).catch(()=>{})),r)}return pe.cachifyMetadata=t,pe}var Nb;function ae(){return Nb||(Nb=1,(function(i){var o=We&&We.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=We&&We.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(dD(),i),u(lD(),i)})(We)),We}var Cb;function Tj(){if(Cb)return ko;Cb=1,Object.defineProperty(ko,"__esModule",{value:!0}),ko.ActorQueryOperationTyped=void 0;const i=q(),o=O(),u=ae(),a=vj();let t=class extends a.ActorQueryOperation{constructor(r,n){if(super({...r,operationName:n}),!this.operationName)throw new Error('A valid "operationName" argument must be provided.')}async test(r){if(!r.operation)return(0,o.failTest)("Missing field 'operation' in a query operation action.");if(r.operation.type!==this.operationName)return(0,o.failTest)(`Actor ${this.name} only supports ${this.operationName} operations, but got ${r.operation.type}`);const n=r.operation;return this.testOperation(n,r.context)}async run(r,n){const c=r.context.get(i.KeysInitQuery.physicalQueryPlanLogger);c&&(c.logOperation(r.operation.type,void 0,r.operation,r.context.get(i.KeysInitQuery.physicalQueryPlanNode),this.name,{}),r.context=r.context.set(i.KeysInitQuery.physicalQueryPlanNode,r.operation));const s=r.operation,l=r.context.set(i.KeysQueryOperation.operation,s),d=await this.runOperation(s,l,n);return"metadata"in d&&(d.metadata=(0,u.cachifyMetadata)(d.metadata)),d}};return ko.ActorQueryOperationTyped=t,ko}var tu={},Ub;function fD(){if(Ub)return tu;Ub=1,Object.defineProperty(tu,"__esModule",{value:!0}),tu.ActorQueryOperationTypedMediated=void 0;const i=Tj();let o=class extends i.ActorQueryOperationTyped{constructor(a,t){super(a,t)}};return tu.ActorQueryOperationTypedMediated=o,tu}var ru={},Hb;function pD(){if(Hb)return ru;Hb=1,Object.defineProperty(ru,"__esModule",{value:!0}),ru.BusQueryOperation=void 0;const i=O();let o=class extends i.BusIndexed{constructor(a){super({...a,actorIdentifierFields:["operationName"],actionIdentifierFields:["operation","type"]})}};return ru.BusQueryOperation=o,ru}var Vb;function X(){return Vb||(Vb=1,(function(i){var o=Ye&&Ye.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ye&&Ye.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(vj(),i),u(Tj(),i),u(fD(),i),u(pD(),i)})(Ye)),Ye}var Ze={},nu={},ke={},au={},zb;function yD(){if(zb)return au;zb=1,Object.defineProperty(au,"__esModule",{value:!0}),au.ActorContextPreprocess=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return au.ActorContextPreprocess=o,au}var Xb;function Gy(){return Xb||(Xb=1,(function(i){var o=ke&&ke.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ke&&ke.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(yD(),i)})(ke)),ke}var Gb;function _D(){if(Gb)return nu;Gb=1,Object.defineProperty(nu,"__esModule",{value:!0}),nu.ActorContextPreprocessConvertShortcuts=void 0;const i=Gy(),o=O();let u=class Oj extends i.ActorContextPreprocess{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}async run(t){return{context:Oj.expandShortcuts(t.context,this.contextKeyShortcuts)}}static expandShortcuts(t,e){for(const r of t.keys())e[r.name]&&(t=t.set(new o.ActionContextKey(e[r.name]),t.get(r)).delete(r));return t}};return nu.ActorContextPreprocessConvertShortcuts=u,nu}var Jb;function mD(){return Jb||(Jb=1,(function(i){var o=Ze&&Ze.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ze&&Ze.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(_D(),i)})(Ze)),Ze}var et={},iu={},Kb;function bD(){if(Kb)return iu;Kb=1,Object.defineProperty(iu,"__esModule",{value:!0}),iu.ActorContextPreprocessSetDefaults=void 0;const i=Gy(),o=q(),u=O(),a=vo();let t=class extends i.ActorContextPreprocess{constructor(r){super(r),this.defaultFunctionArgumentsCache={}}async test(r){return(0,u.passTestVoid)()}async run(r){let n=r.context;if(r.initialize){n=n.setDefault(o.KeysInitQuery.queryTimestamp,new Date).setDefault(o.KeysInitQuery.queryTimestampHighResolution,performance.now()).setDefault(o.KeysQuerySourceIdentify.sourceIds,new Map).setDefault(o.KeysCore.log,this.logger).setDefault(o.KeysInitQuery.functionArgumentsCache,this.defaultFunctionArgumentsCache).setDefault(o.KeysQuerySourceIdentify.hypermediaSourcesAggregatedStores,new Map).setDefault(o.KeysInitQuery.dataFactory,new a.DataFactory);let c={language:"sparql",version:"1.1"};n.has(o.KeysInitQuery.queryFormat)?(c=n.get(o.KeysInitQuery.queryFormat),c.language==="graphql"&&(n=n.setDefault(o.KeysInitQuery.graphqlSingularizeVariables,{}))):n=n.set(o.KeysInitQuery.queryFormat,c)}return{context:n}}};return iu.ActorContextPreprocessSetDefaults=t,iu}var Yb;function gD(){return Yb||(Yb=1,(function(i){var o=et&&et.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=et&&et.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(bD(),i)})(et)),et}var tt={},ou={},Wb;function hD(){if(Wb)return ou;Wb=1,Object.defineProperty(ou,"__esModule",{value:!0}),ou.ActorContextPreprocessSourceToDestination=void 0;const i=Gy(),o=q(),u=O();let a=class extends i.ActorContextPreprocess{constructor(e){super(e)}async test(e){return(0,u.passTestVoid)()}async run(e){if(e.context.get(o.KeysInitQuery.querySourcesUnidentified)&&!e.context.get(o.KeysRdfUpdateQuads.destination)){const r=e.context.get(o.KeysInitQuery.querySourcesUnidentified);if(r.length===1)return{context:e.context.set(o.KeysRdfUpdateQuads.destination,r[0])}}return e}};return ou.ActorContextPreprocessSourceToDestination=a,ou}var Zb;function vD(){return Zb||(Zb=1,(function(i){var o=tt&&tt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=tt&&tt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(hD(),i)})(tt)),tt}var rt={},uu={},cu={},H_={},nt={},su={},kb;function TD(){if(kb)return su;kb=1,Object.defineProperty(su,"__esModule",{value:!0}),su.BlankNodeScoped=void 0;let i=class{constructor(u,a){this.termType="BlankNode",this.value=u,this.skolemized=a}equals(u){return!!u&&u.termType==="BlankNode"&&u.value===this.value}};return su.BlankNodeScoped=i,su}var du={},eg;function OD(){if(eg)return du;eg=1,Object.defineProperty(du,"__esModule",{value:!0}),du.BlankNodeBindingsScoped=void 0;let i=class{constructor(u){this.termType="BlankNode",this.singleBindingsScope=!0,this.value=u}equals(u){return!!u&&u.termType==="BlankNode"&&u.value===this.value}};return du.BlankNodeBindingsScoped=i,du}var tg;function cm(){return tg||(tg=1,(function(i){var o=nt&&nt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=nt&&nt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(TD(),i),u(OD(),i)})(nt)),nt}var rg;function sm(){return rg||(rg=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.deskolemizeOperation=i.deskolemizeQuad=i.deskolemizeTermNestedThrowing=i.deskolemizeTerm=i.skolemizeBindingsStream=i.skolemizeQuadStream=i.skolemizeBindings=i.skolemizeQuad=i.skolemizeTerm=i.getSourceId=i.SKOLEM_PREFIX=void 0;const o=cm(),u=Oe(),a=$();i.SKOLEM_PREFIX="urn:comunica_skolem:source_";function t(_,y){let m=_.get(y.referenceValue);return m===void 0&&(m=`${_.size}`,_.set(y.referenceValue,m)),m}i.getSourceId=t;function e(_,y,m){return y.termType==="BlankNode"?new o.BlankNodeScoped(`bc_${m}_${y.value}`,_.namedNode(`${i.SKOLEM_PREFIX}${m}:${y.value}`)):y}i.skolemizeTerm=e;function r(_,y,m){return(0,u.mapTermsNested)(y,b=>e(_,b,m))}i.skolemizeQuad=r;function n(_,y,m){return y.map(b=>b.termType==="Quad"?r(_,b,m):e(_,b,m))}i.skolemizeBindings=n;function c(_,y,m){const b=y.map(g=>r(_,g,m));function h(){y.getProperty("metadata",g=>{b.setProperty("metadata",g),g.state.addInvalidateListener(h)})}return h(),b}i.skolemizeQuadStream=c;function s(_,y,m){const b=y.map(g=>n(_,g,m));function h(){y.getProperty("metadata",g=>{b.setProperty("metadata",g),g.state.addInvalidateListener(h)})}return h(),b}i.skolemizeBindingsStream=s;function l(_,y,m){if(y.termType==="BlankNode"&&"skolemized"in y&&(y=y.skolemized),y.termType==="NamedNode"&&y.value.startsWith(i.SKOLEM_PREFIX)){const b=y.value.indexOf(":",i.SKOLEM_PREFIX.length);if(y.value.slice(i.SKOLEM_PREFIX.length,b)===m){const g=y.value.slice(b+1,y.value.length);return _.blankNode(g)}return null}return y}i.deskolemizeTerm=l;function d(_,y,m){if(y.termType==="Quad")return(0,u.mapTermsNested)(y,h=>{const g=l(_,h,m);if(!g)throw new Error("Skolemized term is not in scope for this source");return g});const b=l(_,y,m);if(b===null)throw new Error("Skolemized term is not in scope for this source");return b}i.deskolemizeTermNestedThrowing=d;function f(_,y,m){return(0,u.mapTermsNested)(y,b=>l(_,b,m)??b)}i.deskolemizeQuad=f;function p(_,y,m){const b=new a.Factory;try{return a.Util.mapOperation(y,{[a.Algebra.types.PATTERN](h,g){return{result:Object.assign(g.createPattern(d(_,h.subject,m),d(_,h.predicate,m),d(_,h.object,m),d(_,h.graph,m)),{metadata:h.metadata}),recurse:!1}},[a.Algebra.types.PATH](h,g){return{result:Object.assign(g.createPath(d(_,h.subject,m),h.predicate,d(_,h.object,m),d(_,h.graph,m)),{metadata:h.metadata}),recurse:!1}}},b)}catch{}}i.deskolemizeOperation=p})(H_)),H_}var ng;function Aj(){if(ng)return cu;ng=1,Object.defineProperty(cu,"__esModule",{value:!0}),cu.QuerySourceSkolemized=void 0;const i=q(),o=ae(),u=N(),a=sm();let t=class{constructor(r,n){this.innerSource=r,this.sourceId=n}async getSelectorShape(r){return this.innerSource.getSelectorShape(r)}queryBindings(r,n,c){const s=n.getSafe(i.KeysInitQuery.dataFactory),l=(0,a.deskolemizeOperation)(s,r,this.sourceId);if(!l){const d=new u.ArrayIterator([],{autoStart:!1});return d.setProperty("metadata",{state:new o.MetadataValidationState,cardinality:{type:"exact",value:0},variables:[]}),d}return(0,a.skolemizeBindingsStream)(s,this.innerSource.queryBindings(l,n,c),this.sourceId)}queryBoolean(r,n){return this.innerSource.queryBoolean(r,n)}queryQuads(r,n){const c=n.getSafe(i.KeysInitQuery.dataFactory),s=(0,a.deskolemizeOperation)(c,r,this.sourceId);if(!s){const l=new u.ArrayIterator([],{autoStart:!1});return l.setProperty("metadata",{state:new o.MetadataValidationState,cardinality:{type:"exact",value:0}}),l}return(0,a.skolemizeQuadStream)(c,this.innerSource.queryQuads(s,n),this.sourceId)}queryVoid(r,n){return this.innerSource.queryVoid(r,n)}get referenceValue(){return this.innerSource.referenceValue}toString(){return`${this.innerSource.toString()}(SkolemID:${this.sourceId})`}};return cu.QuerySourceSkolemized=t,cu}var ag;function AD(){if(ag)return uu;ag=1,Object.defineProperty(uu,"__esModule",{value:!0}),uu.ActorContextPreprocessQuerySourceSkolemize=void 0;const i=Gy(),o=q(),u=O(),a=Aj(),t=sm();let e=class extends i.ActorContextPreprocess{constructor(n){super(n)}async test(n){return(0,u.passTestVoid)()}async run(n){let c=n.context;if(c.has(o.KeysQueryOperation.querySources)){c.has(o.KeysQuerySourceIdentify.sourceIds)||(c=c.set(o.KeysQuerySourceIdentify.sourceIds,new Map));const s=c.getSafe(o.KeysQuerySourceIdentify.sourceIds);let l=c.getSafe(o.KeysQueryOperation.querySources);l=l.map(d=>({source:new a.QuerySourceSkolemized(d.source,(0,t.getSourceId)(s,d.source)),context:d.context})),c=c.set(o.KeysQueryOperation.querySources,l)}return{context:c}}};return uu.ActorContextPreprocessQuerySourceSkolemize=e,uu}var ig;function Sj(){return ig||(ig=1,(function(i){var o=rt&&rt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=rt&&rt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(AD(),i),u(Aj(),i),u(sm(),i)})(rt)),rt}var at={},lu={},og;function SD(){if(og)return lu;og=1,Object.defineProperty(lu,"__esModule",{value:!0}),lu.MediatorCombinePipeline=void 0;const i=O();let o=class extends i.Mediator{constructor(a){super(a)}async mediate(a){let t;try{t=this.publish(a)}catch{return a}if(this.filterFailures){const c=[];for(const s of t)(await s.reply).isPassed()&&c.push(s);t=c}const e=[];if(t=await Promise.all(t.map(async({actor:c,reply:s},l)=>{try{const d=await s,f=d.getOrThrow();return e[l]=d.getSideData(),{actor:c,reply:f}}catch(d){throw new Error(this.constructFailureMessage(a,[d.message]))}})),this.order){const c=s=>{const l=this.field?s[this.field]:s;if(typeof l!="number")throw new TypeError("Cannot order elements that are not numbers.");return l};t=t.sort((s,l)=>(this.order==="increasing"?1:-1)*(c(s.reply)-c(l.reply)))}let r=a,n=0;for(const{actor:c}of t)r={...r,...await c.runObservable(r,e[n++])};return r}mediateWith(){throw new Error("Method not supported.")}};return lu.MediatorCombinePipeline=o,lu}var ug;function cg(){return ug||(ug=1,(function(i){var o=at&&at.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=at&&at.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(SD(),i)})(at)),at}var it={},fu={},ot={},pu={},sg;function FD(){if(sg)return pu;sg=1,Object.defineProperty(pu,"__esModule",{value:!0}),pu.ActorHashBindings=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return pu.ActorHashBindings=o,pu}var dg;function wD(){return dg||(dg=1,(function(i){var o=ot&&ot.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ot&&ot.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(FD(),i)})(ot)),ot}var lg;function RD(){if(lg)return fu;lg=1,Object.defineProperty(fu,"__esModule",{value:!0}),fu.ActorHashBindingsMurmur=void 0;const i=wD(),o=O(),u=rj();let a=class extends i.ActorHashBindings{async test(e){return(0,o.passTestVoid)()}async run(e){return{hashFunction:(r,n)=>{var s;let c=u();for(const l of n)c=c.hash(((s=r.get(l))==null?void 0:s.value)??"UNDEF");return c.result()}}}};return fu.ActorHashBindingsMurmur=a,fu}var fg;function PD(){return fg||(fg=1,(function(i){var o=it&&it.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=it&&it.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(RD(),i)})(it)),it}var ut={},yu={},pg;function qD(){if(pg)return yu;pg=1,Object.defineProperty(yu,"__esModule",{value:!0}),yu.MediatorRace=void 0;const i=O();let o=class extends i.Mediator{constructor(a){super(a)}mediateWith(a,t){return new Promise((e,r)=>{const n=[];for(const c of t)c.reply.then(s=>{s.isPassed()?e((0,i.passTestWithSideData)(c.actor,s.getSideData())):(n.push(s.getFailMessage()),n.length===t.length&&e((0,i.failTest)(this.constructFailureMessage(a,n))))}).catch(s=>{r(s)})})}};return yu.MediatorRace=o,yu}var yg;function re(){return yg||(yg=1,(function(i){var o=ut&&ut.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ut&&ut.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(qD(),i)})(ut)),ut}var ct={},_u={},st={},mu={},_g;function jD(){if(_g)return mu;_g=1,Object.defineProperty(mu,"__esModule",{value:!0}),mu.ActorHashQuads=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return mu.ActorHashQuads=o,mu}var mg;function MD(){return mg||(mg=1,(function(i){var o=st&&st.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=st&&st.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(jD(),i)})(st)),st}var bg;function xD(){if(bg)return _u;bg=1,Object.defineProperty(_u,"__esModule",{value:!0}),_u.ActorHashQuadsMurmur=void 0;const i=MD(),o=O(),u=rj();let a=class extends i.ActorHashQuads{async test(e){return(0,o.passTestVoid)()}async run(e){return{hashFunction:r=>{const n=u(r.subject.value);return n.hash(r.predicate.value),n.hash(r.object.value),n.hash(r.graph.value),n.result()}}}};return _u.ActorHashQuadsMurmur=a,_u}var gg;function DD(){return gg||(gg=1,(function(i){var o=ct&&ct.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ct&&ct.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(xD(),i)})(ct)),ct}var dt={},bu={},lt={},gu={},hg;function ED(){if(hg)return gu;hg=1,Object.defineProperty(gu,"__esModule",{value:!0}),gu.ActorOptimizeQueryOperation=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return gu.ActorOptimizeQueryOperation=o,gu}var vg;function be(){return vg||(vg=1,(function(i){var o=lt&&lt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=lt&&lt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(ED(),i)})(lt)),lt}var Tg;function LD(){if(Tg)return bu;Tg=1,Object.defineProperty(bu,"__esModule",{value:!0}),bu.ActorOptimizeQueryOperationRewriteCopy=void 0;const i=be(),o=q(),u=O(),a=$();let t=class extends i.ActorOptimizeQueryOperation{constructor(r){super(r)}async test(r){return(0,u.passTestVoid)()}async run(r){const n=r.context.getSafe(o.KeysInitQuery.dataFactory),c=new a.Factory(n);return{operation:a.Util.mapOperation(r.operation,{[a.Algebra.types.COPY](l,d){let f;return typeof l.destination=="string"&&typeof l.source=="string"&&l.destination===l.source||typeof l.destination!="string"&&typeof l.source!="string"&&l.destination.equals(l.source)?f=d.createCompositeUpdate([]):f=d.createCompositeUpdate([d.createDrop(l.destination,!0),d.createAdd(l.source,l.destination,l.silent)]),{result:f,recurse:!1}}},c),context:r.context}}};return bu.ActorOptimizeQueryOperationRewriteCopy=t,bu}var Og;function ID(){return Og||(Og=1,(function(i){var o=dt&&dt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=dt&&dt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(LD(),i)})(dt)),dt}var ft={},hu={},Ag;function $D(){if(Ag)return hu;Ag=1,Object.defineProperty(hu,"__esModule",{value:!0}),hu.ActorOptimizeQueryOperationRewriteMove=void 0;const i=be(),o=q(),u=O(),a=$();let t=class extends i.ActorOptimizeQueryOperation{constructor(r){super(r)}async test(r){return(0,u.passTestVoid)()}async run(r){const n=r.context.getSafe(o.KeysInitQuery.dataFactory),c=new a.Factory(n);return{operation:a.Util.mapOperation(r.operation,{[a.Algebra.types.MOVE](l,d){let f;if(typeof l.destination=="string"&&typeof l.source=="string"&&l.destination===l.source||typeof l.destination!="string"&&typeof l.source!="string"&&l.destination.equals(l.source))f=d.createCompositeUpdate([]);else{const p=[d.createDrop(l.destination,!0),d.createAdd(l.source,l.destination,l.silent),d.createDrop(l.source)];f=d.createCompositeUpdate(p)}return{result:f,recurse:!1}}},c),context:r.context}}};return hu.ActorOptimizeQueryOperationRewriteMove=t,hu}var Sg;function BD(){return Sg||(Sg=1,(function(i){var o=ft&&ft.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ft&&ft.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u($D(),i)})(ft)),ft}var pt={},vu={},Fg;function QD(){if(Fg)return vu;Fg=1,Object.defineProperty(vu,"__esModule",{value:!0}),vu.ActorOptimizeQueryOperationRewriteAdd=void 0;const i=be(),o=q(),u=O(),a=vo(),t=$(),e=new a.DataFactory;let r=class extends i.ActorOptimizeQueryOperation{constructor(c){super(c)}async test(c){return(0,u.passTestVoid)()}async run(c){const s=c.context.getSafe(o.KeysInitQuery.dataFactory),l=new t.Factory(s);return{operation:t.Util.mapOperation(c.operation,{[t.Algebra.types.ADD](f,p){const _=f.destination==="DEFAULT"?e.defaultGraph():f.destination,y=f.source==="DEFAULT"?e.defaultGraph():f.source;return{result:p.createDeleteInsert(void 0,[p.createPattern(e.variable("s"),e.variable("p"),e.variable("o"),_)],p.createPattern(e.variable("s"),e.variable("p"),e.variable("o"),y)),recurse:!1}}},l),context:c.context}}};return vu.ActorOptimizeQueryOperationRewriteAdd=r,vu}var wg;function ND(){return wg||(wg=1,(function(i){var o=pt&&pt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=pt&&pt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(QD(),i)})(pt)),pt}var yt={},Tu={},_t={},se={},Rg;function CD(){if(Rg)return se;Rg=1,Object.defineProperty(se,"__esModule",{value:!0}),se.estimateNpsCardinality=se.estimateJoinCardinality=se.estimateUnionCardinality=se.estimateSliceCardinality=se.estimateMinusCardinality=se.estimateCardinality=void 0;const i=vo(),o=$(),u=new i.DataFactory,a=new o.Factory(u);function t(l,d){const f=d.getCardinality(l);if(f)return f;switch(l.type){case o.Algebra.types.ASK:return{type:"exact",value:1,dataset:d.uri};case o.Algebra.types.LOAD:case o.Algebra.types.DELETE_INSERT:case o.Algebra.types.ADD:case o.Algebra.types.COMPOSITE_UPDATE:case o.Algebra.types.CLEAR:case o.Algebra.types.NOP:case o.Algebra.types.DROP:case o.Algebra.types.CREATE:case o.Algebra.types.MOVE:case o.Algebra.types.COPY:return{type:"exact",value:0,dataset:d.uri};case o.Algebra.types.PROJECT:case o.Algebra.types.FILTER:case o.Algebra.types.ORDER_BY:case o.Algebra.types.GROUP:case o.Algebra.types.CONSTRUCT:case o.Algebra.types.DISTINCT:case o.Algebra.types.REDUCED:case o.Algebra.types.EXTEND:case o.Algebra.types.FROM:case o.Algebra.types.GRAPH:return t(l.input,d);case o.Algebra.types.ZERO_OR_ONE_PATH:case o.Algebra.types.ZERO_OR_MORE_PATH:case o.Algebra.types.ONE_OR_MORE_PATH:case o.Algebra.types.INV:return t(l.path,d);case o.Algebra.types.PATH:return t(l.predicate,d);case o.Algebra.types.NPS:return s(l,d);case o.Algebra.types.LINK:return t(a.createPattern(u.variable("s"),l.iri,u.variable("o")),d);case o.Algebra.types.UNION:case o.Algebra.types.SEQ:case o.Algebra.types.ALT:return n(l.input,d);case o.Algebra.types.BGP:return c(l.patterns,d);case o.Algebra.types.JOIN:case o.Algebra.types.LEFT_JOIN:return c(l.input,d);case o.Algebra.types.SLICE:return r(l,d);case o.Algebra.types.MINUS:return e(l,d);case o.Algebra.types.VALUES:return{type:"exact",value:l.bindings.length,dataset:d.uri};case o.Algebra.types.SERVICE:case o.Algebra.types.DESCRIBE:case o.Algebra.types.EXPRESSION:case o.Algebra.types.PATTERN:return{type:"estimate",value:Number.POSITIVE_INFINITY,dataset:d.uri}}}se.estimateCardinality=t;function e(l,d){const f=t(l.input[0],d),p=t(l.input[1],d);return{type:"estimate",value:Math.max(f.value-p.value,0),dataset:d.uri}}se.estimateMinusCardinality=e;function r(l,d){const f=t(l.input,d);return f.value>0&&(f.value=Math.max(f.value-l.start,0),l.length!==void 0&&(f.value=Math.min(f.value,l.length))),f}se.estimateSliceCardinality=r;function n(l,d){const f={type:"exact",value:0,dataset:d.uri};for(const p of l){const _=t(p,d);_.type==="estimate"&&f.type==="exact"&&(f.type=_.type),_.value>0&&(f.value+=_.value)}return f}se.estimateUnionCardinality=n;function c(l,d){const f=[];for(const _ of l){const y=o.Util.inScopeVariables(_).map(b=>b.value),m=f.find(b=>y.some(h=>b.vars.has(h)));if(m){m.ops.push(_);for(const b of y)m.vars.add(b)}else f.push({ops:[_],vars:new Set(y)})}return{type:"estimate",value:f.map(_=>Math.min(..._.ops.map(y=>t(y,d).value))).reduce((_,y)=>_*y,1),dataset:d.uri}}se.estimateJoinCardinality=c;function s(l,d){const f=a.createSeq([...l.iris].reverse().map(m=>a.createLink(m))),p=t(f,d),_=a.createPattern(u.variable("s"),u.variable("p"),u.variable("o")),y=t(_,d);return{type:"estimate",value:Math.max(0,y.value-p.value),dataset:d.uri}}return se.estimateNpsCardinality=s,se}var Ou={},Pg;function UD(){if(Pg)return Ou;Pg=1,Object.defineProperty(Ou,"__esModule",{value:!0}),Ou.doesShapeAcceptOperation=void 0;function i(a,t,e){return o(a,a,t,e)}Ou.doesShapeAcceptOperation=i;function o(a,t,e,r){if(t.type==="conjunction")return t.children.every(c=>o(a,c,e,r));if(t.type==="disjunction")return t.children.some(c=>o(a,c,e,r));if(t.type==="arity")return o(a,t.child,e,r);if(((r==null?void 0:r.joinBindings)&&!t.joinBindings)??((r==null?void 0:r.filterBindings)&&!t.filterBindings))return!1;const n=t.operation;switch(n.operationType){case"type":return u(a,t,e,r)?n.type===e.type:!1;case"pattern":return u(a,t,e,r)?n.pattern.type===e.type:!1;case"wildcard":return!0}}function u(a,t,e,r){return!(e.input&&!(Array.isArray(e.input)?e.input:[e.input]).every(c=>o(a,a,c,r))||e.patterns&&!e.patterns.every(n=>o(a,a,n,r)))}return Ou}var Y={},qg;function HD(){if(qg)return Y;qg=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.removeOperationSource=Y.assignOperationSource=Y.getOperationSource=Y.testReadOnly=Y.validateQueryOutput=Y.getSafeVoid=Y.getSafeBoolean=Y.getSafeQuads=Y.getSafeBindings=void 0;const i=q(),o=O();function u(d){return r(d,"bindings"),d}Y.getSafeBindings=u;function a(d){return r(d,"quads"),d}Y.getSafeQuads=a;function t(d){return r(d,"boolean"),d}Y.getSafeBoolean=t;function e(d){return r(d,"void"),d}Y.getSafeVoid=e;function r(d,f){if(d.type!==f)throw new Error(`Invalid query output type: Expected '${f}' but got '${d.type}'`)}Y.validateQueryOutput=r;function n(d){return d.get(i.KeysQueryOperation.readOnly)?(0,o.failTest)("Attempted a write operation in read-only mode"):(0,o.passTestVoid)()}Y.testReadOnly=n;function c(d){var f;return(f=d.metadata)==null?void 0:f.scopedSource}Y.getOperationSource=c;function s(d,f){return d={...d},d.metadata=d.metadata?{...d.metadata}:{},d.metadata.scopedSource=f,d}Y.assignOperationSource=s;function l(d){var f;(f=d.metadata)==null||delete f.scopedSource,d.metadata&&Object.keys(d.metadata).length===0&&delete d.metadata}return Y.removeOperationSource=l,Y}var mt={},jg;function VD(){if(jg)return mt;jg=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.materializeOperation=mt.materializeTerm=void 0;const i=ne(),o=Oe(),u=$();function a(r,n){if(r.termType==="Variable"){const c=n.get(r);if(c)return c}return r.termType==="Quad"&&(0,o.someTermsNested)(r,c=>c.termType==="Variable")?(0,o.mapTermsNested)(r,c=>a(c,n)):r}mt.materializeTerm=a;function t(r,n,c,s,l={}){return l={strictTargetVariables:"strictTargetVariables"in l?l.strictTargetVariables:!1,bindFilter:"bindFilter"in l?l.bindFilter:!0,originalBindings:"originalBindings"in l?l.originalBindings:n},u.Util.mapOperation(r,{path(d,f){return{recurse:!1,result:Object.assign(f.createPath(a(d.subject,n),d.predicate,a(d.object,n),a(d.graph,n)),{metadata:d.metadata})}},pattern(d,f){return{recurse:!1,result:Object.assign(f.createPattern(a(d.subject,n),a(d.predicate,n),a(d.object,n),a(d.graph,n)),{metadata:d.metadata})}},join(d,f){return{recurse:!1,result:f.createJoin(d.input.map(p=>t(p,n,c,s,l)),d.input.every(p=>!p.metadata))}},extend(d){if(n.has(d.variable)){if(l.strictTargetVariables)throw new Error(`Tried to bind variable ${(0,i.termToString)(d.variable)} in a BIND operator.`);return{recurse:!0,result:t(d.input,n,c,s,l)}}return{recurse:!0,result:d}},group(d,f){if(l.strictTargetVariables){for(const _ of d.variables)if(n.has(_))throw new Error(`Tried to bind variable ${(0,i.termToString)(_)} in a GROUP BY operator.`);return{recurse:!0,result:d}}const p=d.variables.filter(_=>!n.has(_));return{recurse:!0,result:f.createGroup(d.input,p,d.aggregates)}},filter(d,f){const p=l.originalBindings;if(d.expression.expressionType!=="operator"||p.size===0)return{recurse:!1,result:d};const _=e(f,p),y=t(d.expression,n,c,s,l);let m=t(d.input,n,c,s,l);return _.length>0&&(m=f.createJoin([..._,m])),{recurse:!1,result:f.createFilter(m,y)}},project(d,f){const p=e(f,l.originalBindings,d.variables);let _=t(d.input,n,c,s,l);return p.length>0&&(_=f.createJoin([...p,_])),{recurse:!1,result:f.createProject(_,d.variables)}},values(d,f){if(l.strictTargetVariables){for(const p of d.variables)if(n.has(p))throw new Error(`Tried to bind variable ${(0,i.termToString)(p)} in a VALUES operator.`)}else{const p=d.variables.filter(y=>!n.has(y)),_=d.bindings.map(y=>{const m={...y};let b=!0;return n.forEach((h,g)=>{const T=(0,i.termToString)(g);T in m&&(h.equals(m[T])||(b=!1),delete m[T])}),b?m:void 0}).filter(Boolean);return{recurse:!0,result:f.createValues(p,_)}}return{recurse:!1,result:d}},expression(d,f){if(!l.bindFilter)return{recurse:!1,result:d};if(d.expressionType==="term")return{recurse:!1,result:f.createTermExpression(a(d.term,n))};if(d.expressionType==="operator")return d.operator==="bound"&&d.args.length===1&&d.args[0].expressionType==="term"&&[...n.keys()].some(p=>d.args[0].term.equals(p))?{recurse:!1,result:f.createTermExpression(f.dataFactory.literal("true",f.dataFactory.namedNode("http://www.w3.org/2001/XMLSchema#boolean")))}:{recurse:!0,result:d};if(d.expressionType==="aggregate"&&"variable"in d&&n.has(d.variable)){if(l.strictTargetVariables)throw new Error(`Tried to bind ${(0,i.termToString)(d.variable)} in a ${d.aggregator} aggregate.`);return{recurse:!0,result:d}}return{recurse:!0,result:d}}},c)}mt.materializeOperation=t;function e(r,n,c){const s=[];for(const[l,d]of n)if(!c||c.some(f=>f.equals(l))){const f={[(0,i.termToString)(l)]:d};s.push(r.createValues([l],[f]))}return s}return mt}var Mg;function Q(){return Mg||(Mg=1,(function(i){var o=_t&&_t.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=_t&&_t.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(CD(),i),u(UD(),i),u(HD(),i),u(VD(),i)})(_t)),_t}var xg;function zD(){if(xg)return Tu;xg=1,Object.defineProperty(Tu,"__esModule",{value:!0}),Tu.ActorOptimizeQueryOperationGroupSources=void 0;const i=be(),o=q(),u=O(),a=Q(),t=$();let e=class extends i.ActorOptimizeQueryOperation{constructor(n){super(n)}async test(n){return(0,a.getOperationSource)(n.operation)?(0,u.failTest)(`Actor ${this.name} does not work with top-level operation sources.`):(0,u.passTestVoid)()}async run(n){return{operation:await this.groupOperation(n.operation,n.context),context:n.context}}async groupOperation(n,c){var _;const s=c.getSafe(o.KeysInitQuery.dataFactory),l=new t.Factory(s);if((0,a.getOperationSource)(n)??!("input"in n))return n;if(!Array.isArray(n.input)){const y=await this.groupOperation(n.input,c);if((_=y.metadata)!=null&&_.scopedSource){const m=(0,a.getOperationSource)(y);(0,a.doesShapeAcceptOperation)(await m.source.getSelectorShape(c),n)&&(this.logDebug(c,`Hoist 1 source-specific operation into a single ${n.type} operation for ${m.source.toString()}`),(0,a.removeOperationSource)(y),n=(0,a.assignOperationSource)(n,m))}return{...n,input:y}}const d=await Promise.all(n.input.map(y=>this.groupOperation(y,c))),f=this.clusterOperationsWithEqualSources(d);if(f.length===1){const y=f[0],m=(0,a.getOperationSource)(f[0][0]);return{...await this.moveSourceAnnotationUpwardsIfPossible(n,y,m,c),input:y}}if(f.length===d.length)return{...n,input:d};let p;switch(n.type){case t.Algebra.types.JOIN:p=l.createJoin.bind(l);break;case t.Algebra.types.UNION:p=l.createUnion.bind(l);break;case t.Algebra.types.ALT:p=l.createAlt.bind(l);break;case t.Algebra.types.SEQ:p=l.createSeq.bind(l);break;default:throw new Error(`Unsupported operation '${n.type}' detected while grouping sources`)}return await this.groupOperationMulti(f,p,c)}async groupOperationMulti(n,c,s){let l=!0;const d=await Promise.all(n.map(async f=>{const p=(0,a.getOperationSource)(f[0]),_=await this.moveSourceAnnotationUpwardsIfPossible(c(f,!0),f,p,s);return(0,a.getOperationSource)(_)&&(l=!1),_}));return c(d,l)}clusterOperationsWithEqualSources(n){const c=new Map,s=[];for(const d of n){const f=(0,a.getOperationSource)(d);f?(c.has(f)||c.set(f,[]),c.get(f).push(d)):s.push(d)}const l=[];s.length>0&&l.push(s);for(const[d,f]of c.entries())l.push(f.map(p=>(0,a.assignOperationSource)(p,d)));return l}async moveSourceAnnotationUpwardsIfPossible(n,c,s,l){if(s&&(0,a.doesShapeAcceptOperation)(await s.source.getSelectorShape(l),n)){this.logDebug(l,`Hoist ${c.length} source-specific operations into a single ${n.type} operation for ${s.source.toString()}`),n=(0,a.assignOperationSource)(n,s);for(const d of c)(0,a.removeOperationSource)(d)}return n}};return Tu.ActorOptimizeQueryOperationGroupSources=e,Tu}var Dg;function XD(){return Dg||(Dg=1,(function(i){var o=yt&&yt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=yt&&yt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(zD(),i)})(yt)),yt}var bt={},Au={},Eg;function GD(){if(Eg)return Au;Eg=1,Object.defineProperty(Au,"__esModule",{value:!0}),Au.ActorOptimizeQueryOperationConstructDistinct=void 0;const i=be(),o=fj(),u=O(),a=$();let t=class extends i.ActorOptimizeQueryOperation{constructor(r){super(r)}async test(r){return r.context.has(o.KeysInitQuery.distinctConstruct)?(0,u.passTestVoid)():(0,u.failTest)(`${this.name} was not enabled by the query.`)}async run(r){return{operation:a.Util.mapOperation(r.operation,{construct(c,s){return{recurse:!1,result:s.createDistinct(s.createConstruct(c.input,c.template))}}}),context:r.context.delete(o.KeysInitQuery.distinctConstruct)}}};return Au.ActorOptimizeQueryOperationConstructDistinct=t,Au}var Lg;function JD(){return Lg||(Lg=1,(function(i){var o=bt&&bt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=bt&&bt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(GD(),i)})(bt)),bt}var gt={},Su={},ht={},Fu={},Ig;function KD(){if(Ig)return Fu;Ig=1,Object.defineProperty(Fu,"__esModule",{value:!0}),Fu.ActorQueryParse=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return Fu.ActorQueryParse=o,Fu}var $g;function Fj(){return $g||($g=1,(function(i){var o=ht&&ht.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ht&&ht.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(KD(),i)})(ht)),ht}var Bg;function YD(){if(Bg)return Su;Bg=1,Object.defineProperty(Su,"__esModule",{value:!0}),Su.ActorQueryParseSparql=void 0;const i=Fj(),o=q(),u=O(),a=$(),t=tx();let e=class extends i.ActorQueryParse{constructor(n){super(n),this.prefixes=Object.freeze(this.prefixes)}async test(n){return n.queryFormat&&n.queryFormat.language!=="sparql"?(0,u.failTest)("This actor can only parse SPARQL queries"):(0,u.passTestVoid)()}async run(n){const c=n.context.getSafe(o.KeysInitQuery.dataFactory),l=new t.Parser({prefixes:this.prefixes,baseIRI:n.baseIRI,sparqlStar:!0,factory:c}).parse(n.query);return{baseIRI:l.type==="query"?l.base:void 0,operation:(0,a.translate)(l,{quads:!0,prefixes:this.prefixes,blankToVariable:!0,baseIRI:n.baseIRI,dataFactory:c})}}};return Su.ActorQueryParseSparql=e,Su}var Qg;function WD(){return Qg||(Qg=1,(function(i){var o=gt&&gt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=gt&&gt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(YD(),i)})(gt)),gt}var vt={},wu={},Ng;function ZD(){if(Ng)return wu;Ng=1,Object.defineProperty(wu,"__esModule",{value:!0}),wu.ActorQueryParseGraphql=void 0;const i=Fj(),o=q(),u=O(),a=rx();let t=class extends i.ActorQueryParse{constructor(r){super(r),this.graphqlToSparql=new a.Converter({requireContext:!0})}async test(r){var n;return((n=r.queryFormat)==null?void 0:n.language)!=="graphql"?(0,u.failTest)("This actor can only parse GraphQL queries"):(0,u.passTestVoid)()}async run(r){const n=r.context.get(o.KeysInitQuery.jsonLdContext)||{},c={singularizeVariables:r.context.get(o.KeysInitQuery.graphqlSingularizeVariables)};return{operation:await this.graphqlToSparql.graphqlToSparqlAlgebra(r.query,n,c)}}};return wu.ActorQueryParseGraphql=t,wu}var Cg;function kD(){return Cg||(Cg=1,(function(i){var o=vt&&vt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=vt&&vt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(ZD(),i)})(vt)),vt}var Tt={},Ru={},Ot={},Pu={},At={},qu={},Ug;function wj(){if(Ug)return qu;Ug=1,Object.defineProperty(qu,"__esModule",{value:!0}),qu.ActorAbstractMediaTyped=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}async run(a){if("handle"in a){const t=a;return{handle:await this.runHandle(t.handle,t.handleMediaType,a.context)}}if("mediaTypes"in a)return{mediaTypes:await this.getMediaTypes(a.context)};if("mediaTypeFormats"in a)return{mediaTypeFormats:await this.getMediaTypeFormats(a.context)};throw new Error("Either a handle, mediaTypes or mediaTypeFormats action needs to be provided")}async test(a){if("handle"in a){const t=a;return(await this.testHandle(t.handle,t.handleMediaType,a.context)).map(e=>({handle:e}))}return"mediaTypes"in a?(await this.testMediaType(a.context)).map(t=>({mediaTypes:t})):"mediaTypeFormats"in a?(await this.testMediaTypeFormats(a.context)).map(t=>({mediaTypeFormats:t})):(0,i.failTest)("Either a handle, mediaTypes or mediaTypeFormats action needs to be provided")}};return qu.ActorAbstractMediaTyped=o,qu}var ju={},Hg;function eE(){if(Hg)return ju;Hg=1,Object.defineProperty(ju,"__esModule",{value:!0}),ju.ActorAbstractMediaTypedFixed=void 0;const i=O(),o=wj();let u=class extends o.ActorAbstractMediaTyped{constructor(t){super(t);const e=this.priorityScale||this.priorityScale===0?this.priorityScale:1;if(this.mediaTypePriorities)for(const[r,[n,c]]of Object.entries(this.mediaTypePriorities).entries())this.mediaTypePriorities[n]=e*c;this.mediaTypePriorities=Object.freeze(this.mediaTypePriorities),this.mediaTypeFormats=Object.freeze(this.mediaTypeFormats)}async testHandle(t,e,r){return!e||!(e in this.mediaTypePriorities)?(0,i.failTest)(`Unrecognized media type: ${e}`):await this.testHandleChecked(t,r)}async testMediaType(t){return(0,i.passTestVoid)()}async getMediaTypes(t){return this.mediaTypePriorities}async testMediaTypeFormats(t){return(0,i.passTestVoid)()}async getMediaTypeFormats(t){return this.mediaTypeFormats}};return ju.ActorAbstractMediaTypedFixed=u,ju}var Vg;function Ao(){return Vg||(Vg=1,(function(i){var o=At&&At.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=At&&At.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(wj(),i),u(eE(),i)})(At)),At}var zg;function tE(){if(zg)return Pu;zg=1,Object.defineProperty(Pu,"__esModule",{value:!0}),Pu.ActorQueryResultSerialize=void 0;const i=Ao();let o=class extends i.ActorAbstractMediaTyped{constructor(a){super(a)}};return Pu.ActorQueryResultSerialize=o,Pu}var Mu={},Xg;function rE(){if(Xg)return Mu;Xg=1,Object.defineProperty(Mu,"__esModule",{value:!0}),Mu.ActorQueryResultSerializeFixedMediaTypes=void 0;const i=Ao(),o=O();let u=class extends i.ActorAbstractMediaTypedFixed{constructor(t){super(t)}async testHandleChecked(t,e){return(0,o.passTestVoid)()}};return Mu.ActorQueryResultSerializeFixedMediaTypes=u,Mu}var Gg;function Ae(){return Gg||(Gg=1,(function(i){var o=Ot&&Ot.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ot&&Ot.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(tE(),i),u(rE(),i)})(Ot)),Ot}var Jg;function nE(){if(Jg)return Ru;Jg=1,Object.defineProperty(Ru,"__esModule",{value:!0}),Ru.ActorQueryResultSerializeJson=void 0;const i=Ae(),o=O(),u=N(),a=ne(),t=Z();let e=class extends i.ActorQueryResultSerializeFixedMediaTypes{constructor(n){super(n)}async testHandleChecked(n,c){return["bindings","quads","boolean"].includes(n.type)?(0,o.passTestVoid)():(0,o.failTest)("This actor can only handle bindings or quad streams.")}async runHandle(n,c,s){const l=new t.Readable;if(l._read=()=>{},n.type==="bindings"||n.type==="quads"){let d=n.type==="bindings"?(0,u.wrap)(n.bindingsStream).map(p=>JSON.stringify(Object.fromEntries([...p].map(([_,y])=>[_.value,a.termToString(y)])))):(0,u.wrap)(n.quadStream).map(p=>JSON.stringify(a.quadToStringQuad(p))),f=!0;d=d.map(p=>{const _=`${f?"":","}
${p}`;return f=!1,_}).prepend(["["]).append([`
]
`]),l.wrap(d)}else try{l.push(`${JSON.stringify(await n.execute())}
`),l.push(null)}catch(d){setTimeout(()=>l.emit("error",d))}return{data:l}}};return Ru.ActorQueryResultSerializeJson=e,Ru}var Kg;function aE(){return Kg||(Kg=1,(function(i){var o=Tt&&Tt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Tt&&Tt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(nE(),i)})(Tt)),Tt}var St={},xu={},Yg;function iE(){if(Yg)return xu;Yg=1,Object.defineProperty(xu,"__esModule",{value:!0}),xu.ActorQueryResultSerializeSimple=void 0;const i=Ae(),o=O(),u=N(),a=ne(),t=Z();let e=class mo extends i.ActorQueryResultSerializeFixedMediaTypes{constructor(n){super(n)}async testHandleChecked(n,c){return["bindings","quads","boolean","void"].includes(n.type)?(0,o.passTestVoid)():(0,o.failTest)("This actor can only handle bindings streams, quad streams, booleans, or updates.")}static termToString(n){return n.termType==="Quad"?(0,a.termToString)(n):n.value}async runHandle(n,c,s){const l=new t.Readable;return n.type==="bindings"?l.wrap(n.bindingsStream.map(d=>`${[...d].map(([f,p])=>`?${f.value}: ${mo.termToString(p)}`).join(`
`)}

`)):n.type==="quads"?l.wrap(n.quadStream.map(d=>`subject: ${mo.termToString(d.subject)}
predicate: ${mo.termToString(d.predicate)}
object: ${mo.termToString(d.object)}
graph: ${mo.termToString(d.graph)}

`)):l.wrap((0,u.wrap)(n.type==="boolean"?n.execute().then(d=>[`${d}
`]):n.execute().then(()=>[`ok
`]))),{data:l}}};return xu.ActorQueryResultSerializeSimple=e,xu}var Wg;function oE(){return Wg||(Wg=1,(function(i){var o=St&&St.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=St&&St.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(iE(),i)})(St)),St}var Ft={},Du={},Zg;function uE(){if(Zg)return Du;Zg=1,Object.defineProperty(Du,"__esModule",{value:!0}),Du.ActorQueryResultSerializeSparqlCsv=void 0;const i=Ae(),o=O(),u=Z();let a=class Qy extends i.ActorQueryResultSerializeFixedMediaTypes{constructor(e){super(e)}static bindingToCsvBindings(e){if(!e)return"";let r=e.value;if(e.termType==="Literal")r=`${r}`;else if(e.termType==="BlankNode")r=`_:${r}`;else if(e.termType==="Quad"){let n=Qy.bindingToCsvBindings(e.object);e.object.termType==="Literal"&&(n=`"${n.replaceAll('"','""')}"`),r=`<< ${Qy.bindingToCsvBindings(e.subject)} ${Qy.bindingToCsvBindings(e.predicate)} ${n} >>`}else r=`<${r}>`;return/[",\n\r]/u.test(r)&&(r=`"${r.replaceAll('"','""')}"`),r}async testHandleChecked(e,r){return e.type!=="bindings"?(0,o.failTest)("This actor can only handle bindings streams."):(0,o.passTestVoid)()}async runHandle(e,r,n){const c=e,s=new u.Readable,l=await c.metadata();return s.push(`${l.variables.map(d=>d.variable.value).join(",")}\r
`),s.wrap(c.bindingsStream.map(d=>`${l.variables.map(f=>Qy.bindingToCsvBindings(d.get(f.variable))).join(",")}\r
`)),{data:s}}};return Du.ActorQueryResultSerializeSparqlCsv=a,Du}var kg;function cE(){return kg||(kg=1,(function(i){var o=Ft&&Ft.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ft&&Ft.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(uE(),i)})(Ft)),Ft}var wt={},Eu={},eh;function sE(){if(eh)return Eu;eh=1,Object.defineProperty(Eu,"__esModule",{value:!0}),Eu.ActorQueryResultSerializeSparqlTsv=void 0;const i=Ae(),o=O(),u=n_(),a=Z();let t=class Rj extends i.ActorQueryResultSerializeFixedMediaTypes{constructor(r){super(r)}static bindingToTsvBindings(r){return r?(0,u.termToString)(r).replaceAll("	","\\t").replaceAll(`
`,"\\n").replaceAll("\r","\\r"):""}async testHandleChecked(r,n){return r.type!=="bindings"?(0,o.failTest)("This actor can only handle bindings streams."):(0,o.passTestVoid)()}async runHandle(r,n,c){const s=r,l=new a.Readable,d=await s.metadata();return l.push(`${d.variables.map(f=>f.variable.value).join("	")}
`),l.wrap(s.bindingsStream.map(f=>`${d.variables.map(p=>Rj.bindingToTsvBindings(f.get(p.variable))).join("	")}
`)),{data:l}}};return Eu.ActorQueryResultSerializeSparqlTsv=t,Eu}var th;function dE(){return th||(th=1,(function(i){var o=wt&&wt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=wt&&wt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(sE(),i)})(wt)),wt}var Rt={},Lu={},Iu={},rh;function lE(){if(rh)return Iu;rh=1,Object.defineProperty(Iu,"__esModule",{value:!0}),Iu.XmlSerializer=void 0;let i=class{constructor(){this.stack=[]}open(u,a){const t=`${this.identation()+this.formatTag(u,a,"open")}
`;return this.stack.push(u),t}close(){const u=this.stack.pop();if(u===void 0)throw new Error("There is no tag left to close");return`${this.identation()+this.formatTag(u,{},"close")}
`}serializeNode(u){if(u.children===void 0)return`${this.identation()+this.formatTag(u.name,u.attributes,"self-closing")}
`;if(typeof u.children=="string")return`${this.identation()+this.formatTag(u.name,u.attributes,"open")+this.escape(u.children)+this.formatTag(u.name,{},"close")}
`;const a=[];a.push(`${this.identation()+this.formatTag(u.name,u.attributes,"open")}
`),this.stack.push(u.name);for(const t of u.children)a.push(this.serializeNode(t));return this.stack.pop(),a.push(`${this.identation()+this.formatTag(u.name,{},"close")}
`),a.join("")}identation(){return this.stack.map(u=>"  ").join("")}formatTag(u,a,t){return`<${t==="close"?"/":""}${u}${Object.entries(a??{}).map(e=>` ${e[0]}="${this.escape(e[1])}"`)}${t==="self-closing"?"/":""}>`}escape(u){return u.replaceAll(/["&'<>]/gu,(a=>{switch(a){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}}))}};return Iu.XmlSerializer=i,i.header=`<?xml version="1.0" encoding="UTF-8"?>
`,Iu}var nh;function fE(){if(nh)return Lu;nh=1,Object.defineProperty(Lu,"__esModule",{value:!0}),Lu.ActorQueryResultSerializeSparqlXml=void 0;const i=Ae(),o=O(),u=N(),a=Z(),t=lE();let e=class Pj extends i.ActorQueryResultSerializeFixedMediaTypes{constructor(n){super(n)}static bindingToXmlBindings(n,c){return{name:"binding",attributes:{name:c.value},children:[this.valueToXmlValue(n)]}}static valueToXmlValue(n){let c;switch(n.termType){case"Literal":return n.language?c={"xml:lang":n.language}:n.datatype&&n.datatype.value!=="http://www.w3.org/2001/XMLSchema#string"?c={datatype:n.datatype.value}:c={},{name:"literal",attributes:c,children:n.value};case"BlankNode":return{name:"bnode",children:n.value};case"Quad":return{name:"triple",children:[{name:"subject",children:[this.valueToXmlValue(n.subject)]},{name:"predicate",children:[this.valueToXmlValue(n.predicate)]},{name:"object",children:[this.valueToXmlValue(n.object)]}]};default:return{name:"uri",children:n.value}}}async testHandleChecked(n,c){return["bindings","boolean"].includes(n.type)?(0,o.passTestVoid)():(0,o.failTest)("This actor can only handle bindings streams or booleans.")}async runHandle(n,c,s){const l=new a.Readable;l._read=()=>{};const d=new t.XmlSerializer,f=await n.metadata();if(l.push(t.XmlSerializer.header),l.push(d.open("sparql",{xmlns:"http://www.w3.org/2005/sparql-results#"})),l.push(d.serializeNode({name:"head",children:f.variables.map(p=>({name:"variable",attributes:{name:p.variable.value}}))})),n.type==="bindings"){function*p(){yield d.close(),yield d.close()}l.push(d.open("results"));const _=(0,u.wrap)(n.bindingsStream).map(y=>d.serializeNode({name:"result",children:[...y].map(([m,b])=>Pj.bindingToXmlBindings(b,m))})).append((0,u.wrap)(p()));l.wrap(_)}else try{const p=await n.execute();l.push(d.serializeNode({name:"boolean",children:p.toString()})),l.push(d.close()),setTimeout(()=>l.push(null))}catch(p){setTimeout(()=>l.emit("error",p))}return{data:l}}};return Lu.ActorQueryResultSerializeSparqlXml=e,Lu}var ah;function pE(){return ah||(ah=1,(function(i){var o=Rt&&Rt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Rt&&Rt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(fE(),i)})(Rt)),Rt}var Pt={},$u={},ih;function yE(){if(ih)return $u;ih=1,Object.defineProperty($u,"__esModule",{value:!0}),$u.ActorQueryResultSerializeTable=void 0;const i=Ae(),o=q(),u=O(),a=ne(),t=Oe(),e=Z();let r=class tm extends i.ActorQueryResultSerializeFixedMediaTypes{constructor(c){super(c),this.padding=tm.repeat(" ",this.columnWidth)}static repeat(c,s){return c.repeat(s)}async testHandleChecked(c,s){return["bindings","quads"].includes(c.type)?(0,u.passTestVoid)():(0,u.failTest)("This actor can only handle bindings or quad streams.")}termToString(c){return c.termType==="Quad"?(0,a.termToString)(c):c.value}pad(c){return c.length<=this.columnWidth?c+this.padding.slice(c.length):`${c.slice(0,this.columnWidth-1)}`}pushHeader(c,s){const l=s.map(d=>this.pad(d.value)).join(" ");c.push(`${l}
${tm.repeat("-",l.length)}
`)}createRow(c,s){return`${c.map(l=>s.has(l)?this.termToString(s.get(l)):"").map(l=>this.pad(l)).join(" ")}
`}async runHandle(c,s,l){const d=new e.Readable;let f;if(c.type==="bindings"){f=c.bindingsStream.map(_=>this.createRow(p,_));const p=(await c.metadata()).variables.map(_=>_.variable);this.pushHeader(d,p)}else{f=c.quadStream.map(_=>`${(0,t.getTerms)(_).map(y=>this.pad(this.termToString(y))).join(" ")}
`);const p=c.context.getSafe(o.KeysInitQuery.dataFactory);this.pushHeader(d,t.QUAD_TERM_NAMES.map(_=>p.variable(_)))}return d.wrap(f),{data:d}}};return $u.ActorQueryResultSerializeTable=r,$u}var oh;function _E(){return oh||(oh=1,(function(i){var o=Pt&&Pt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Pt&&Pt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(yE(),i)})(Pt)),Pt}var qt={},Bu={},uh;function ch(){if(uh)return Bu;uh=1,Object.defineProperty(Bu,"__esModule",{value:!0}),Bu.ActorQueryResultSerializeTree=void 0;const i=Ae(),o=q(),u=O(),a=Z(),t=nx();let e=class qj extends i.ActorQueryResultSerializeFixedMediaTypes{constructor(n){super(n)}static async bindingsStreamToGraphQl(n,c,s){const l=u.ActionContext.ensureActionContext(c),d=new t.Converter(s),f={singularizeVariables:l.get(o.KeysInitQuery.graphqlSingularizeVariables)??{}};return d.bindingsToTree(await n.map(p=>Object.fromEntries([...p].map(([_,y])=>[_.value,y]))).toArray(),f)}async testHandleChecked(n){return n.type!=="bindings"?(0,u.failTest)("This actor can only handle bindings streams."):(0,u.passTestVoid)()}async runHandle(n,c){const s=new a.Readable;return s._read=()=>{s._read=()=>{},qj.bindingsStreamToGraphQl(n.bindingsStream,n.context,{materializeRdfJsTerms:!0}).then(l=>{s.push(JSON.stringify(l,null,"  ")),s.push(null)}).catch(l=>s.emit("error",l))},{data:s}}};return Bu.ActorQueryResultSerializeTree=e,Bu}var sh;function mE(){return sh||(sh=1,(function(i){var o=qt&&qt.__createBinding||(Object.create?(function(e,r,n,c){c===void 0&&(c=n);var s=Object.getOwnPropertyDescriptor(r,n);(!s||("get"in s?!r.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return r[n]}}),Object.defineProperty(e,c,s)}):(function(e,r,n,c){c===void 0&&(c=n),e[c]=r[n]})),u=qt&&qt.__exportStar||function(e,r){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&o(r,e,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.bindingsStreamToGraphQl=void 0;const a=ch(),{bindingsStreamToGraphQl:t}=a.ActorQueryResultSerializeTree;i.bindingsStreamToGraphQl=t,u(ch(),i)})(qt)),qt}var jt={},Qu={},dh;function bE(){if(dh)return Qu;dh=1,Object.defineProperty(Qu,"__esModule",{value:!0}),Qu.MediatorCombineUnion=void 0;const i=O();let o=class extends i.Mediator{constructor(a){super(a),this.combiner=this.createCombiner()}async mediate(a){let t;try{t=this.publish(a)}catch{t=[]}if(this.filterFailures){const n=[];for(const c of t)(await c.reply).isPassed()&&n.push(c);t=n}const e=[];await Promise.all(t.map(async({reply:n},c)=>{const s=await n,l=s.getOrThrow();return e[c]=s.getSideData(),l}));const r=await Promise.all(t.map((n,c)=>n.actor.runObservable(a,e[c])));return this.combiner(r)}mediateWith(){throw new Error("Method not supported.")}createCombiner(){return a=>{const t={};return t[this.field]={},[{}].concat(a.map(e=>e[this.field])).forEach(e=>{t[this.field]={...e,...t[this.field]}}),t}}};return Qu.MediatorCombineUnion=o,Qu}var lh;function Me(){return lh||(lh=1,(function(i){var o=jt&&jt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=jt&&jt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(bE(),i)})(jt)),jt}var Mt={},Nu={},fh;function gE(){if(fh)return Nu;fh=1,Object.defineProperty(Nu,"__esModule",{value:!0}),Nu.MediatorNumber=void 0;const i=O();let o=class extends i.Mediator{constructor(a){super(a),this.indexPicker=this.createIndexPicker()}createIndexPicker(){switch(this.type){case"min":return a=>a.reduce((t,e,r)=>{const n=this.getOrDefault(e[this.field],Number.POSITIVE_INFINITY);return n!==null&&(Number.isNaN(t[0])||t[0]>n)?[n,r]:t},[Number.NaN,-1])[1];case"max":return a=>a.reduce((t,e,r)=>{const n=this.getOrDefault(e[this.field],Number.NEGATIVE_INFINITY);return n!==null&&(Number.isNaN(t[0])||t[0]<n)?[n,r]:t},[Number.NaN,-1])[1];default:throw new Error(`No valid "type" value was given, must be either 'min' or 'max', but got: ${this.type}`)}}getOrDefault(a,t){return a===void 0?t:a}async mediateWith(a,t){let e=await Promise.all(t.map(({reply:l})=>l));const r=[];if(this.ignoreFailures){const l={};l[this.field]=null,e=e.map(d=>d.isFailed()?(r.push(d.getFailMessage()),(0,i.passTestWithSideData)(l,void 0)):d)}const n=[],c=e.map((l,d)=>{const f=l.getOrThrow();return n[d]=l.getSideData(),f}),s=this.indexPicker(c);return s<0?(0,i.failTest)(this.constructFailureMessage(a,r)):(0,i.passTestWithSideData)(t[s].actor,n[s])}};return Nu.MediatorNumber=o,Nu}var ph;function yo(){return ph||(ph=1,(function(i){var o=Mt&&Mt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Mt&&Mt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(gE(),i)})(Mt)),Mt}var xt={},Cu={},Dt={},Uu={},we={},yh;function dm(){if(yh)return we;yh=1,Object.defineProperty(we,"__esModule",{value:!0}),we.ActorDereferenceBase=we.isHardError=we.emptyReadable=void 0;const i=q(),o=O(),u=Z();function a(){const r=new u.Readable;return r.push(null),r}we.emptyReadable=a;function t(r){return!r.get(i.KeysInitQuery.lenient)}we.isHardError=t;let e=class extends o.Actor{constructor(n){super(n)}async dereferenceErrorHandler(n,c,s){if(t(n.context))throw c;return this.logWarn(n.context,c.message,()=>({url:n.url})),{...s,data:a()}}};return we.ActorDereferenceBase=e,we}var _h;function hE(){if(_h)return Uu;_h=1,Object.defineProperty(Uu,"__esModule",{value:!0}),Uu.ActorDereference=void 0;const i=dm();let o=class extends i.ActorDereferenceBase{constructor(a){super(a)}async handleDereferenceErrors(a,t,e,r=0){return this.dereferenceErrorHandler(a,t,{url:a.url,exists:!1,headers:e,requestTime:r})}};return Uu.ActorDereference=o,Uu}var Et={},mh;function vE(){if(mh)return Et;mh=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.ActorDereferenceParse=Et.getMediaTypeFromExtension=void 0;const i=O(),o=Z(),u=dm();function a(e,r){const n=e.lastIndexOf(".");return n>=0&&(r==null?void 0:r[e.slice(n+1)])||""}Et.getMediaTypeFromExtension=a;let t=class extends u.ActorDereferenceBase{constructor(r){super(r)}async test(r){return(0,i.passTestVoid)()}handleDereferenceStreamErrors(r,n){return(0,u.isHardError)(r.context)||(n.on("error",c=>{this.logWarn(r.context,c.message,()=>({url:r.url})),n.push(null)}),n=n.pipe(new o.PassThrough({objectMode:!0}))),n}async run(r){var l,d,f,p;const{context:n}=r,c=await this.mediatorDereference.mediate({...r,mediaTypes:async()=>{var _,y;return(y=await((_=this.mediatorParseMediatypes)==null?void 0:_.mediate({context:n,mediaTypes:!0})))==null?void 0:y.mediaTypes}});let s;if(c.exists)try{s=(await this.mediatorParse.mediate({context:n,handle:{context:n,...c,metadata:await this.getMetadata(c)},handleMediaType:c.mediaType||r.mediaType||a(c.url,this.mediaMappings)})).handle,s.data=this.handleDereferenceStreamErrors(r,s.data)}catch(_){await((d=(l=c.data).close)==null?void 0:d.call(l)),s=await this.dereferenceErrorHandler(r,_,{})}else await((p=(f=c.data).close)==null?void 0:p.call(f)),s={data:(0,u.emptyReadable)()};return{...c,...s}}};return Et.ActorDereferenceParse=t,Et}var bh;function lm(){return bh||(bh=1,(function(i){var o=Dt&&Dt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Dt&&Dt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(hE(),i),u(vE(),i),u(dm(),i)})(Dt)),Dt}var gh;function TE(){if(gh)return Cu;gh=1,Object.defineProperty(Cu,"__esModule",{value:!0}),Cu.ActorDereferenceFallback=void 0;const i=lm(),o=O();let u=class extends i.ActorDereference{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}async run(t){return this.handleDereferenceErrors(t,new Error(`Could not dereference '${t.url}'`))}};return Cu.ActorDereferenceFallback=u,Cu}var hh;function OE(){return hh||(hh=1,(function(i){var o=xt&&xt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=xt&&xt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(TE(),i)})(xt)),xt}var Lt={},Hu={},It={},Vu={},vh;function AE(){if(vh)return Vu;vh=1,Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.ActorRdfJoinEntriesSort=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return Vu.ActorRdfJoinEntriesSort=o,Vu}var Th;function jj(){return Th||(Th=1,(function(i){var o=It&&It.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=It&&It.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(AE(),i)})(It)),It}var Oh;function SE(){if(Oh)return Hu;Oh=1,Object.defineProperty(Hu,"__esModule",{value:!0}),Hu.ActorRdfJoinEntriesSortCardinality=void 0;const i=jj(),o=O();let u=class extends i.ActorRdfJoinEntriesSort{constructor(t){super(t)}async test(t){return(0,o.passTest)({accuracy:t.entries.length===0?1:t.entries.reduce((e,r)=>e+(Number.isFinite(r.metadata.cardinality.value)?1:0),0)/t.entries.length})}async run(t){return{entries:[...t.entries].sort((r,n)=>r.metadata.cardinality.value-n.metadata.cardinality.value)}}};return Hu.ActorRdfJoinEntriesSortCardinality=u,Hu}var Ah;function FE(){return Ah||(Ah=1,(function(i){var o=Lt&&Lt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Lt&&Lt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(SE(),i)})(Lt)),Lt}var $t={},Bt={},Qt={},zu={},Sh;function wE(){if(Sh)return zu;Sh=1,Object.defineProperty(zu,"__esModule",{value:!0}),zu.ActorRdfJoinSelectivity=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return zu.ActorRdfJoinSelectivity=o,zu}var Fh;function RE(){return Fh||(Fh=1,(function(i){var o=Qt&&Qt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Qt&&Qt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(wE(),i)})(Qt)),Qt}var wh;function PE(){if(wh)return Bt;wh=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.JoinTypes=Bt.ActorRdfJoinSelectivityVariableCounting=void 0;const i=RE(),o=O(),u=$();let a=class uo extends i.ActorRdfJoinSelectivity{constructor(r){super(r)}async test(r){return(0,o.passTest)({accuracy:.5})}static getPatternCost(r){let n=1;return r.subject.termType==="Variable"&&(n+=4),(r.predicate.termType==="Variable"||r.type===u.Algebra.types.PATH)&&(n+=1),r.object.termType==="Variable"&&(n+=2),r.graph.termType==="Variable"&&(n+=1),n/9}static getJoinTypes(r,n){const c=[];return r.subject.termType==="Variable"?(r.subject.equals(n.subject)&&c.push(t.unboundSS),n.type==="pattern"&&r.subject.equals(n.predicate)&&c.push(t.unboundSP),r.subject.equals(n.object)&&c.push(t.unboundSO),r.subject.equals(n.graph)&&c.push(t.unboundSG)):(r.subject.equals(n.subject)&&c.push(t.boundSS),n.type==="pattern"&&r.subject.equals(n.predicate)&&c.push(t.boundSP),r.subject.equals(n.object)&&c.push(t.boundSO),r.subject.equals(n.graph)&&c.push(t.boundSG)),r.type==="pattern"&&(r.predicate.termType==="Variable"?(r.predicate.equals(n.subject)&&c.push(t.unboundPS),n.type==="pattern"&&r.predicate.equals(n.predicate)&&c.push(t.unboundPP),r.predicate.equals(n.object)&&c.push(t.unboundPO),r.predicate.equals(n.graph)&&c.push(t.unboundPG)):(r.predicate.equals(n.subject)&&c.push(t.boundPS),n.type==="pattern"&&r.predicate.equals(n.predicate)&&c.push(t.boundPP),r.predicate.equals(n.object)&&c.push(t.boundPO),r.predicate.equals(n.graph)&&c.push(t.boundPG))),r.object.termType==="Variable"?(r.object.equals(n.subject)&&c.push(t.unboundOS),n.type==="pattern"&&r.object.equals(n.predicate)&&c.push(t.unboundOP),r.object.equals(n.object)&&c.push(t.unboundOO),r.object.equals(n.graph)&&c.push(t.unboundOG)):(r.object.equals(n.subject)&&c.push(t.boundOS),n.type==="pattern"&&r.object.equals(n.predicate)&&c.push(t.boundOP),r.object.equals(n.object)&&c.push(t.boundOO),r.object.equals(n.graph)&&c.push(t.boundOG)),r.graph.termType==="Variable"?(r.graph.equals(n.subject)&&c.push(t.unboundGS),n.type==="pattern"&&r.graph.equals(n.predicate)&&c.push(t.unboundGP),r.graph.equals(n.object)&&c.push(t.unboundGO),r.graph.equals(n.graph)&&c.push(t.unboundGG)):(r.graph.equals(n.subject)&&c.push(t.boundGS),n.type==="pattern"&&r.graph.equals(n.predicate)&&c.push(t.boundGP),r.graph.equals(n.object)&&c.push(t.boundGO),r.graph.equals(n.graph)&&c.push(t.boundGG)),c}static getOperationsPairwiseJoinCost(r,n){let c=uo.MAX_PAIRWISE_COST;for(const s of uo.getJoinTypes(r,n))switch(s){case t.boundSS:c-=4;break;case t.boundSP:c-=6;break;case t.boundSO:c-=2;break;case t.boundSG:c-=6;break;case t.boundPS:c-=6;break;case t.boundPP:return 1;case t.boundPO:c-=6;break;case t.boundPG:c-=6;break;case t.boundOS:c-=2;break;case t.boundOP:c-=6;break;case t.boundOO:c-=2;break;case t.boundOG:c-=6;break;case t.boundGS:c-=6;break;case t.boundGP:c-=6;break;case t.boundGO:c-=6;break;case t.boundGG:c-=6;break;case t.unboundSS:c-=2;break;case t.unboundSP:c-=3;break;case t.unboundSO:c-=1;break;case t.unboundSG:c-=3;break;case t.unboundPS:c-=3;break;case t.unboundPP:c-=3;break;case t.unboundPO:c-=3;break;case t.unboundPG:c-=3;break;case t.unboundOS:c-=1;break;case t.unboundOP:c-=3;break;case t.unboundOO:c-=1;break;case t.unboundOG:c-=3;break;case t.unboundGS:c-=3;break;case t.unboundGP:c-=3;break;case t.unboundGO:c-=3;break;case t.unboundGG:c-=3;break}return c/uo.MAX_PAIRWISE_COST}static getOperationsJoinCost(r){const n=[];for(const l of r)u.Util.recurseOperation(l,{[u.Algebra.types.PATTERN](d){return n.push(d),!1},[u.Algebra.types.PATH](d){return n.push(d),!1}});let c=0,s=0;for(const l of n)for(const d of n)l!==d&&(c+=uo.getOperationsPairwiseJoinCost(l,d),s++);return s===0?1:c/s*n.reduce((l,d)=>l*uo.getPatternCost(d),1)}async run(r){return r.entries.length<=1?{selectivity:1}:{selectivity:uo.getOperationsJoinCost(r.entries.map(n=>n.operation))}}};Bt.ActorRdfJoinSelectivityVariableCounting=a,a.MAX_PAIRWISE_COST=82;var t;return(function(e){e[e.boundSS=0]="boundSS",e[e.boundSP=1]="boundSP",e[e.boundSO=2]="boundSO",e[e.boundSG=3]="boundSG",e[e.boundPS=4]="boundPS",e[e.boundPP=5]="boundPP",e[e.boundPO=6]="boundPO",e[e.boundPG=7]="boundPG",e[e.boundOS=8]="boundOS",e[e.boundOP=9]="boundOP",e[e.boundOO=10]="boundOO",e[e.boundOG=11]="boundOG",e[e.boundGS=12]="boundGS",e[e.boundGP=13]="boundGP",e[e.boundGO=14]="boundGO",e[e.boundGG=15]="boundGG",e[e.unboundSS=16]="unboundSS",e[e.unboundSP=17]="unboundSP",e[e.unboundSO=18]="unboundSO",e[e.unboundSG=19]="unboundSG",e[e.unboundPS=20]="unboundPS",e[e.unboundPP=21]="unboundPP",e[e.unboundPO=22]="unboundPO",e[e.unboundPG=23]="unboundPG",e[e.unboundOS=24]="unboundOS",e[e.unboundOP=25]="unboundOP",e[e.unboundOO=26]="unboundOO",e[e.unboundOG=27]="unboundOG",e[e.unboundGS=28]="unboundGS",e[e.unboundGP=29]="unboundGP",e[e.unboundGO=30]="unboundGO",e[e.unboundGG=31]="unboundGG"})(t||(Bt.JoinTypes=t={})),Bt}var Rh;function qE(){return Rh||(Rh=1,(function(i){var o=$t&&$t.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=$t&&$t.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(PE(),i)})($t)),$t}var Nt={},Xu={},Ct={},Gu={},Ph;function jE(){if(Ph)return Gu;Ph=1,Object.defineProperty(Gu,"__esModule",{value:!0}),Gu.ActorRdfMetadata=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return Gu.ActorRdfMetadata=o,Gu}var qh;function Mj(){return qh||(qh=1,(function(i){var o=Ct&&Ct.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ct&&Ct.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(jE(),i)})(Ct)),Ct}var jh;function ME(){if(jh)return Xu;jh=1,Object.defineProperty(Xu,"__esModule",{value:!0}),Xu.ActorRdfMetadataPrimaryTopic=void 0;const i=Mj(),o=O(),u=Z();let a=class extends i.ActorRdfMetadata{constructor(e){super(e)}async test(e){return e.triples?(0,o.failTest)("This actor only supports non-triple quad streams."):(0,o.passTestVoid)()}async run(e){const r=new u.Readable({objectMode:!0}),n=new u.Readable({objectMode:!0}),c=()=>{r._read=n._read=()=>{},e.quads.on("error",f=>{r.emit("error",f),n.emit("error",f)});const s={};let l;const d={};e.quads.on("data",f=>{f.predicate.value==="http://rdfs.org/ns/void#subset"&&f.object.value===e.url?l=f.subject.value:f.predicate.value==="http://xmlns.com/foaf/0.1/primaryTopic"&&(d[f.object.value]=f.subject.value);let p=s[f.graph.value];p||(p=s[f.graph.value]=[]),p.push(f)}),e.quads.on("end",()=>{const f=l?d[l]:void 0;for(const p in s)if(p===f){for(const _ of s[p])n.push(_);if(this.metadataToData)for(const _ of s[p])r.push(_)}else{for(const _ of s[p])r.push(_);if(!f&&this.dataToMetadataOnInvalidMetadataGraph)for(const _ of s[p])n.push(_)}r.push(null),n.push(null)})};return r._read=n._read=()=>{c()},{data:r,metadata:n}}};return Xu.ActorRdfMetadataPrimaryTopic=a,Xu}var Mh;function xE(){return Mh||(Mh=1,(function(i){var o=Nt&&Nt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Nt&&Nt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(ME(),i)})(Nt)),Nt}var Ut={},Ju={},xh;function DE(){if(xh)return Ju;xh=1,Object.defineProperty(Ju,"__esModule",{value:!0}),Ju.ActorRdfMetadataAll=void 0;const i=Mj(),o=O(),u=Z();let a=class extends i.ActorRdfMetadata{constructor(e){super(e)}async test(e){return(0,o.passTestVoid)()}async run(e){const r=new u.Readable({objectMode:!0}),n=new u.Readable({objectMode:!0});e.quads.on("error",s=>{r.emit("error",s),n.emit("error",s)}),e.quads.on("end",()=>{r.push(null),n.push(null)});const c=r._read=n._read=s=>{for(;s>0;){const l=e.quads.read();if(l===null)return e.quads.once("readable",()=>c(s));s--,r.push(l),n.push(l)}};return{data:r,metadata:n}}};return Ju.ActorRdfMetadataAll=a,Ju}var Dh;function EE(){return Dh||(Dh=1,(function(i){var o=Ut&&Ut.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ut&&Ut.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(DE(),i)})(Ut)),Ut}var Ht={},Ku={},Vt={},Yu={},Eh;function LE(){if(Eh)return Yu;Eh=1,Object.defineProperty(Yu,"__esModule",{value:!0}),Yu.ActorRdfMetadataAccumulate=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return Yu.ActorRdfMetadataAccumulate=o,Yu}var Lh;function fm(){return Lh||(Lh=1,(function(i){var o=Vt&&Vt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Vt&&Vt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(LE(),i)})(Vt)),Vt}var Ih;function IE(){if(Ih)return Ku;Ih=1,Object.defineProperty(Ku,"__esModule",{value:!0}),Ku.ActorRdfMetadataAccumulateCardinality=void 0;const i=fm(),o=O();let u=class extends i.ActorRdfMetadataAccumulate{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}async run(t){if(t.mode==="initialize")return{metadata:{cardinality:{type:"exact",value:0}}};const e={...t.accumulatedMetadata.cardinality};if(e.dataset){if(t.accumulatedMetadata.defaultGraph===e.dataset&&e.dataset!==t.appendingMetadata.cardinality.dataset)return{metadata:{cardinality:t.appendingMetadata.cardinality}};if(t.appendingMetadata.cardinality.dataset){if(e.dataset!==t.appendingMetadata.cardinality.dataset&&t.appendingMetadata.subsetOf===e.dataset)return{metadata:{cardinality:t.appendingMetadata.cardinality}};if(e.dataset===t.appendingMetadata.cardinality.dataset)return{metadata:{cardinality:e}};delete e.dataset}else return{metadata:{cardinality:e}}}return!t.appendingMetadata.cardinality||!Number.isFinite(t.appendingMetadata.cardinality.value)?(e.type="estimate",e.value=Number.POSITIVE_INFINITY):(t.appendingMetadata.cardinality.type==="estimate"&&(e.type="estimate"),e.value+=t.appendingMetadata.cardinality.value),{metadata:{cardinality:e}}}};return Ku.ActorRdfMetadataAccumulateCardinality=u,Ku}var $h;function $E(){return $h||($h=1,(function(i){var o=Ht&&Ht.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ht&&Ht.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(IE(),i)})(Ht)),Ht}var zt={},Wu={},Bh;function BE(){if(Bh)return Wu;Bh=1,Object.defineProperty(Wu,"__esModule",{value:!0}),Wu.ActorRdfMetadataAccumulatePageSize=void 0;const i=fm(),o=O();let u=class extends i.ActorRdfMetadataAccumulate{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}async run(t){return t.mode==="initialize"?{metadata:{}}:{metadata:{..."pageSize"in t.accumulatedMetadata||"pageSize"in t.appendingMetadata?{pageSize:(t.accumulatedMetadata.pageSize??0)+(t.appendingMetadata.pageSize??0)}:{}}}}};return Wu.ActorRdfMetadataAccumulatePageSize=u,Wu}var Qh;function QE(){return Qh||(Qh=1,(function(i){var o=zt&&zt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=zt&&zt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(BE(),i)})(zt)),zt}var Xt={},Zu={},Nh;function NE(){if(Nh)return Zu;Nh=1,Object.defineProperty(Zu,"__esModule",{value:!0}),Zu.ActorRdfMetadataAccumulateRequestTime=void 0;const i=fm(),o=O();let u=class extends i.ActorRdfMetadataAccumulate{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}async run(t){return t.mode==="initialize"?{metadata:{}}:{metadata:{..."requestTime"in t.accumulatedMetadata||"requestTime"in t.appendingMetadata?{requestTime:(t.accumulatedMetadata.requestTime??0)+(t.appendingMetadata.requestTime??0)}:{}}}}};return Zu.ActorRdfMetadataAccumulateRequestTime=u,Zu}var Ch;function CE(){return Ch||(Ch=1,(function(i){var o=Xt&&Xt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Xt&&Xt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(NE(),i)})(Xt)),Xt}var Gt={},ku={},Jt={},ec={},Uh;function UE(){if(Uh)return ec;Uh=1,Object.defineProperty(ec,"__esModule",{value:!0}),ec.ActorRdfMetadataExtract=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return ec.ActorRdfMetadataExtract=o,ec}var Hh;function Pe(){return Hh||(Hh=1,(function(i){var o=Jt&&Jt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Jt&&Jt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(UE(),i)})(Jt)),Jt}var Vh;function HE(){if(Vh)return ku;Vh=1,Object.defineProperty(ku,"__esModule",{value:!0}),ku.ActorRdfMetadataExtractHydraControls=void 0;const i=Pe(),o=O(),u=ax();let a=class ky extends i.ActorRdfMetadataExtract{constructor(e){super(e),this.parsedUriTemplateCache={}}async test(e){return(0,o.passTestVoid)()}getLinks(e,r){return Object.fromEntries(ky.LINK_TYPES.map(n=>{const c=r[n]||r[`${n}Page`],s=c&&c[e];return[n,s&&s.length>0?[s[0]]:[]]}))}parseUriTemplateCached(e){const r=this.parsedUriTemplateCache[e];return r||(this.parsedUriTemplateCache[e]=(0,u.parse)(e))}getSearchForms(e){const r=e.search,n=[];if(r)for(const c in r)for(const s of r[c]){const l=(e.template||{})[s]||[];if(l.length!==1)throw new Error(`Expected 1 hydra:template for ${s}`);const d=l[0],f=this.parseUriTemplateCached(d),p=Object.fromEntries(((e.mapping||{})[s]||[]).map(y=>{const m=((e.variable||{})[y]||[])[0],b=((e.property||{})[y]||[])[0];if(!m)throw new Error(`Expected a hydra:variable for ${y}`);if(!b)throw new Error(`Expected a hydra:property for ${y}`);return[b,m]})),_=y=>f.expand(Object.fromEntries(Object.keys(y).map(m=>[p[m],y[m]])));n.push({dataset:c,template:d,mappings:p,getUri:_})}return{values:n}}getHydraProperties(e){return new Promise((r,n)=>{e.on("error",n);const c={};e.on("data",s=>{if(s.predicate.value.startsWith(ky.HYDRA)){const l=s.predicate.value.slice(ky.HYDRA.length),d=c[l]||(c[l]={});(d[s.subject.value]||(d[s.subject.value]=[])).push(s.object.value)}}),e.on("end",()=>r(c))})}async run(e){const r={},n=await this.getHydraProperties(e.metadata);return Object.assign(r,this.getLinks(e.url,n)),r.searchForms=this.getSearchForms(n),{metadata:r}}};return ku.ActorRdfMetadataExtractHydraControls=a,a.HYDRA="http://www.w3.org/ns/hydra/core#",a.LINK_TYPES=["first","next","previous","last"],ku}var zh;function VE(){return zh||(zh=1,(function(i){var o=Gt&&Gt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Gt&&Gt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(HE(),i)})(Gt)),Gt}var Kt={},tc={},Xh;function zE(){if(Xh)return tc;Xh=1,Object.defineProperty(tc,"__esModule",{value:!0}),tc.ActorRdfMetadataExtractHydraCount=void 0;const i=Pe(),o=O();let u=class extends i.ActorRdfMetadataExtract{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}run(t){return new Promise((e,r)=>{t.metadata.on("error",r),t.metadata.on("data",n=>{this.predicates.includes(n.predicate.value)&&e({metadata:{cardinality:{type:"estimate",value:Number.parseInt(n.object.value,10),dataset:n.subject.value}}})}),t.metadata.on("end",()=>{e({metadata:{cardinality:{type:"estimate",value:0}}})})})}};return tc.ActorRdfMetadataExtractHydraCount=u,tc}var Gh;function XE(){return Gh||(Gh=1,(function(i){var o=Kt&&Kt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Kt&&Kt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(zE(),i)})(Kt)),Kt}var Yt={},rc={},Jh;function GE(){if(Jh)return rc;Jh=1,Object.defineProperty(rc,"__esModule",{value:!0}),rc.ActorRdfMetadataExtractHydraPagesize=void 0;const i=Pe(),o=O();let u=class extends i.ActorRdfMetadataExtract{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}async run(t){return new Promise((e,r)=>{t.metadata.on("error",r),t.metadata.on("data",n=>{this.predicates.includes(n.predicate.value)&&e({metadata:{pageSize:Number.parseInt(n.object.value,10)}})}),t.metadata.on("end",()=>{e({metadata:{}})})})}};return rc.ActorRdfMetadataExtractHydraPagesize=u,rc}var Kh;function JE(){return Kh||(Kh=1,(function(i){var o=Yt&&Yt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Yt&&Yt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(GE(),i)})(Yt)),Yt}var Wt={},nc={},Yh;function KE(){if(Yh)return nc;Yh=1,Object.defineProperty(nc,"__esModule",{value:!0}),nc.ActorRdfMetadataExtractRequestTime=void 0;const i=Pe(),o=O();let u=class extends i.ActorRdfMetadataExtract{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}async run(t){return{metadata:{requestTime:t.requestTime}}}};return nc.ActorRdfMetadataExtractRequestTime=u,nc}var Wh;function YE(){return Wh||(Wh=1,(function(i){var o=Wt&&Wt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Wt&&Wt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(KE(),i)})(Wt)),Wt}var Zt={},ac={},Zh;function WE(){if(Zh)return ac;Zh=1,Object.defineProperty(ac,"__esModule",{value:!0}),ac.ActorRdfMetadataExtractAllowHttpMethods=void 0;const i=Pe(),o=O();let u=class extends i.ActorRdfMetadataExtract{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}async run(t){var r,n;const e={};return(r=t.headers)!=null&&r.get("allow")&&(e.allowHttpMethods=(n=t.headers.get("allow"))==null?void 0:n.split(/, */u)),{metadata:e}}};return ac.ActorRdfMetadataExtractAllowHttpMethods=u,ac}var kh;function ZE(){return kh||(kh=1,(function(i){var o=Zt&&Zt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Zt&&Zt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(WE(),i)})(Zt)),Zt}var kt={},ic={},ev;function kE(){if(ev)return ic;ev=1,Object.defineProperty(ic,"__esModule",{value:!0}),ic.ActorRdfMetadataExtractPutAccepted=void 0;const i=Pe(),o=O();let u=class extends i.ActorRdfMetadataExtract{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}async run(t){var r,n;const e={};return(r=t.headers)!=null&&r.get("accept-put")&&(e.putAccepted=(n=t.headers.get("accept-put"))==null?void 0:n.split(/, */u)),{metadata:e}}};return ic.ActorRdfMetadataExtractPutAccepted=u,ic}var tv;function e0(){return tv||(tv=1,(function(i){var o=kt&&kt.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=kt&&kt.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(kE(),i)})(kt)),kt}var er={},oc={},rv;function t0(){if(rv)return oc;rv=1,Object.defineProperty(oc,"__esModule",{value:!0}),oc.ActorRdfMetadataExtractPatchSparqlUpdate=void 0;const i=Pe(),o=O();let u=class extends i.ActorRdfMetadataExtract{constructor(t){super(t)}async test(t){return(0,o.passTestVoid)()}async run(t){var r,n,c,s;const e={};return(((n=(r=t.headers)==null?void 0:r.get("accept-patch"))==null?void 0:n.includes("application/sparql-update"))??((s=(c=t.headers)==null?void 0:c.get("ms-author-via"))==null?void 0:s.includes("SPARQL")))&&(e.patchSparqlUpdate=!0),{metadata:e}}};return oc.ActorRdfMetadataExtractPatchSparqlUpdate=u,oc}var nv;function r0(){return nv||(nv=1,(function(i){var o=er&&er.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=er&&er.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(t0(),i)})(er)),er}var tr={},uc={},av;function n0(){if(av)return uc;av=1,Object.defineProperty(uc,"__esModule",{value:!0}),uc.ActorRdfMetadataExtractSparqlService=void 0;const i=Pe(),o=O(),u=a_();let a=class extends i.ActorRdfMetadataExtract{constructor(e){super(e)}async test(e){return(0,o.passTestVoid)()}async run(e){return new Promise((r,n)=>{e.metadata.on("error",n);const c=new Set([e.url]),s={},l=new Set,d=new Set,f=new Set;e.metadata.on("data",p=>{if(p.predicate.value==="http://rdfs.org/ns/void#subset"&&p.object.value===e.url)c.add(p.subject.value);else if(p.subject.value===s.defaultDataset||p.subject.termType==="BlankNode"||c.has(p.subject.value))switch(p.predicate.value){case"http://www.w3.org/ns/sparql-service-description#endpoint":s.sparqlService=p.object.termType==="Literal"?(0,u.resolve)(p.object.value,e.url):p.object.value,this.inferHttpsEndpoint&&e.url.startsWith("https")&&!p.object.value.startsWith("https")&&(s.sparqlService=s.sparqlService.replace(/^http:/u,"https:"));break;case"http://www.w3.org/ns/sparql-service-description#defaultDataset":s.defaultDataset=p.object.value;break;case"http://www.w3.org/ns/sparql-service-description#defaultGraph":s.defaultGraph=p.object.value;break;case"http://www.w3.org/ns/sparql-service-description#inputFormat":l.add(p.object.value);break;case"http://www.w3.org/ns/sparql-service-description#resultFormat":d.add(p.object.value);break;case"http://www.w3.org/ns/sparql-service-description#supportedLanguage":f.add(p.object.value);break;case"http://www.w3.org/ns/sparql-service-description#feature":p.object.value==="http://www.w3.org/ns/sparql-service-description#UnionDefaultGraph"?s.unionDefaultGraph=!0:p.object.value==="http://www.w3.org/ns/sparql-service-description#BasicFederatedQuery"&&(s.basicFederatedQuery=!0);break}}),e.metadata.on("end",()=>{r({metadata:{...s,...l.size>0?{inputFormats:[...l.values()]}:{},...d.size>0?{resultFormats:[...d.values()]}:{},...f.size>0?{supportedLanguages:[...f.values()]}:{}}})})})}};return uc.ActorRdfMetadataExtractSparqlService=a,uc}var iv;function a0(){return iv||(iv=1,(function(i){var o=tr&&tr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=tr&&tr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(n0(),i)})(tr)),tr}var rr={},cc={},V_={},ov;function xj(){return ov||(ov=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.VOID_CLASS_PARTITION=i.VOID_PROPERTY_PARTITION=i.VOID_DISTINCT_SUBJECTS=i.VOID_DISTINCT_OBJECTS=i.VOID_URI_REGEX_PATTERN=i.VOID_URI_SPACE=i.VOID_VOCABULARY=i.VOID_PROPERTY=i.VOID_CLASS=i.VOID_ENTITIES=i.VOID_TRIPLES=i.VOID_CLASSES=i.VOID_DATASET=i.VOID=i.SD_GRAPH=i.SD_FEATURE=i.SD_UNION_DEFAULT_GRAPH=i.SD_DEFAULT_GRAPH=i.SD_DEFAULT_DATASET=i.SD=i.RDF_TYPE=void 0,i.RDF_TYPE="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",i.SD="http://www.w3.org/ns/sparql-service-description#",i.SD_DEFAULT_DATASET=`${i.SD}defaultDataset`,i.SD_DEFAULT_GRAPH=`${i.SD}defaultGraph`,i.SD_UNION_DEFAULT_GRAPH=`${i.SD}UnionDefaultGraph`,i.SD_FEATURE=`${i.SD}feature`,i.SD_GRAPH=`${i.SD}Graph`,i.VOID="http://rdfs.org/ns/void#",i.VOID_DATASET=`${i.VOID}Dataset`,i.VOID_CLASSES=`${i.VOID}classes`,i.VOID_TRIPLES=`${i.VOID}triples`,i.VOID_ENTITIES=`${i.VOID}entities`,i.VOID_CLASS=`${i.VOID}class`,i.VOID_PROPERTY=`${i.VOID}property`,i.VOID_VOCABULARY=`${i.VOID}vocabulary`,i.VOID_URI_SPACE=`${i.VOID}uriSpace`,i.VOID_URI_REGEX_PATTERN=`${i.VOID}uriRegexPattern`,i.VOID_DISTINCT_OBJECTS=`${i.VOID}distinctSubjects`,i.VOID_DISTINCT_SUBJECTS=`${i.VOID}distinctObjects`,i.VOID_PROPERTY_PARTITION=`${i.VOID}propertyPartition`,i.VOID_CLASS_PARTITION=`${i.VOID}classPartition`})(V_)),V_}var K={},uv;function i0(){if(uv)return K;uv=1,Object.defineProperty(K,"__esModule",{value:!0}),K.getClassPartitionEntities=K.getPredicateTriples=K.getPredicateSubjects=K.getPredicateObjects=K.getDistinctSubjects=K.getDistinctObjects=K.estimatePatternCardinalityRaw=K.matchPatternVocabularies=K.matchPatternResourceUris=K.estimatePatternCardinality=void 0;const i=xj();function o(d,f){const p={type:"exact",value:0};if(a(d,f)&&u(d,f)){const _=t(d,f);_>0&&(p.value=_,p.type="estimate")}return p}K.estimatePatternCardinality=o;function u(d,f){return!d.uriRegexPattern||f.subject.termType!=="NamedNode"||d.uriRegexPattern.test(f.subject.value)||f.object.termType!=="NamedNode"||d.uriRegexPattern.test(f.object.value)}K.matchPatternResourceUris=u;function a(d,f){return d.vocabularies!==void 0&&f.predicate.termType==="NamedNode"?d.vocabularies.some(p=>f.predicate.value.startsWith(p)):!0}K.matchPatternVocabularies=a;function t(d,f){if(f.subject.termType==="Variable"&&f.predicate.termType==="NamedNode"&&f.predicate.value===i.RDF_TYPE&&(f.object.termType==="NamedNode"||f.object.termType==="BlankNode"))return l(d,f.object);if(f.subject.termType==="Variable"&&f.predicate.termType==="Variable"&&f.object.termType==="Variable")return d.triples;if((f.subject.termType==="NamedNode"||f.subject.termType==="BlankNode")&&f.predicate.termType==="Variable"&&(f.object.termType==="Variable"||f.object.termType==="Literal")){const p=r(d);if(p>0)return d.triples/p}if(f.subject.termType==="Variable"&&f.predicate.termType==="NamedNode"&&(f.object.termType==="Variable"||f.object.termType==="Literal"))return s(d,f.predicate);if(f.subject.termType==="Variable"&&f.predicate.termType==="Variable"&&(f.object.termType==="NamedNode"||f.object.termType==="BlankNode"||f.object.termType==="Literal")){const p=e(d);if(p>0)return d.triples/p}if((f.subject.termType==="NamedNode"||f.subject.termType==="BlankNode")&&f.predicate.termType==="NamedNode"&&(f.object.termType==="Variable"||f.object.termType==="Literal")){const p=s(d,f.predicate),_=c(d,f.predicate);return _>0?p/_:p}if((f.subject.termType==="NamedNode"||f.subject.termType==="BlankNode")&&f.predicate.termType==="Variable"&&(f.object.termType==="NamedNode"||f.object.termType==="BlankNode")){const p=r(d),_=e(d);if(p>0&&_>0)return d.triples/(p*_)}if(f.subject.termType==="Variable"&&f.predicate.termType==="NamedNode"&&(f.object.termType==="NamedNode"||f.object.termType==="BlankNode")){const p=s(d,f.predicate),_=n(d,f.predicate);return _>0?p/_:p}if((f.subject.termType==="NamedNode"||f.subject.termType==="BlankNode")&&f.predicate.termType==="NamedNode"&&(f.object.termType==="NamedNode"||f.object.termType==="BlankNode")){const p=s(d,f.predicate),_=c(d,f.predicate),y=n(d,f.predicate);return _>0&&y>0?p/(_*y):p}return d.triples}K.estimatePatternCardinalityRaw=t;function e(d){return d.distinctObjects??d.entities??d.triples}K.getDistinctObjects=e;function r(d){return d.distinctSubjects??d.entities??d.triples}K.getDistinctSubjects=r;function n(d,f){if(d.propertyPartitions){const p=d.propertyPartitions[f.value];return(p==null?void 0:p.distinctObjects)??(p==null?void 0:p.triples)??0}return d.triples}K.getPredicateObjects=n;function c(d,f){if(d.propertyPartitions){const p=d.propertyPartitions[f.value];return(p==null?void 0:p.distinctSubjects)??(p==null?void 0:p.triples)??0}return d.triples}K.getPredicateSubjects=c;function s(d,f){var p;return d.propertyPartitions?((p=d.propertyPartitions[f.value])==null?void 0:p.triples)??0:d.triples}K.getPredicateTriples=s;function l(d,f){var p;return d.classPartitions?((p=d.classPartitions[f.value])==null?void 0:p.entities)??0:d.entities!==void 0&&d.classes?d.entities/d.classes:d.triples}return K.getClassPartitionEntities=l,K}var cv;function o0(){if(cv)return cc;cv=1,Object.defineProperty(cc,"__esModule",{value:!0}),cc.ActorRdfMetadataExtractVoid=void 0;const i=Pe(),o=O(),u=$(),a=xj(),t=i0();let e=class extends i.ActorRdfMetadataExtract{constructor(n){super(n)}async test(n){return(0,o.passTestVoid)()}async run(n){return new Promise((c,s)=>{const l=new Set,d=new Set,f={},p={},_={},y={},m={},b={},h={},g={},T={},v={},F={};let P,j,x=!1;n.metadata.on("error",s).on("data",A=>{switch(A.predicate.value){case a.RDF_TYPE:(A.object.value===a.SD_GRAPH||A.object.value===a.VOID_DATASET)&&l.add(A.subject.value);break;case a.VOID_TRIPLES:f[A.subject.value]=Number.parseInt(A.object.value,10);break;case a.VOID_ENTITIES:p[A.subject.value]=Number.parseInt(A.object.value,10);break;case a.VOID_CLASSES:y[A.subject.value]=Number.parseInt(A.object.value,10);break;case a.VOID_CLASS:F[A.subject.value]=A.object.value;break;case a.VOID_PROPERTY:T[A.subject.value]=A.object.value;break;case a.VOID_DISTINCT_OBJECTS:m[A.subject.value]=Number.parseInt(A.object.value,10);break;case a.VOID_DISTINCT_SUBJECTS:b[A.subject.value]=Number.parseInt(A.object.value,10);break;case a.VOID_VOCABULARY:_[A.subject.value]?_[A.subject.value].push(A.object.value):_[A.subject.value]=[A.object.value];break;case a.VOID_URI_SPACE:h[A.subject.value]||(h[A.subject.value]=new RegExp(`^${A.object.value}`,"u"));break;case a.VOID_URI_REGEX_PATTERN:h[A.subject.value]=new RegExp(A.object.value,"u");break;case a.VOID_PROPERTY_PARTITION:d.add(A.object.value),g[A.subject.value]?g[A.subject.value].push(A.object.value):g[A.subject.value]=[A.object.value];break;case a.VOID_CLASS_PARTITION:d.add(A.object.value),v[A.subject.value]?v[A.subject.value].push(A.object.value):v[A.subject.value]=[A.object.value];break;case a.SD_DEFAULT_DATASET:P=A.object.value;break;case a.SD_DEFAULT_GRAPH:j=A.object.value;break;case a.SD_FEATURE:A.object.value===a.SD_UNION_DEFAULT_GRAPH&&(x=!0);break}}).on("end",()=>{var M;const A=[],L=R=>{const E={};for(const D of g[R]){const C=T[D];C&&(E[C]={distinctObjects:m[D],distinctSubjects:b[D],triples:f[D]})}return E},z=R=>{const E={};for(const D of v[R]){const C=F[D];C&&(E[C]={entities:p[D],propertyPartitions:g[D]?L(D):void 0})}return E};P&&d.add(P),x&&j&&d.add(j),P&&j&&_[P]&&(_[j]=[..._[j]??[],..._[P]]);for(const R of d)l.delete(R);for(const R of l)if(f[R]){const E={entities:p[R],identifier:R,classes:y[R]??((M=v[R])==null?void 0:M.length)??0,classPartitions:v[R]?z(R):void 0,distinctObjects:m[R],distinctSubjects:b[R],propertyPartitions:g[R]?L(R):void 0,triples:f[R],uriRegexPattern:h[R],vocabularies:_[R]};A.push({uri:R,source:n.url,getCardinality:D=>{if(D.type===u.Algebra.types.PATTERN)return{...(0,t.estimatePatternCardinality)(E,D),dataset:R}}})}c({metadata:A.length>0?{datasets:A}:{}})})})}};return cc.ActorRdfMetadataExtractVoid=e,cc}var sv;function u0(){return sv||(sv=1,(function(i){var o=rr&&rr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=rr&&rr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(o0(),i)})(rr)),rr}var nr={},sc={},ar={},dc={},dv;function c0(){if(dv)return dc;dv=1,Object.defineProperty(dc,"__esModule",{value:!0}),dc.ActorRdfParse=void 0;const i=Ao();let o=class extends i.ActorAbstractMediaTyped{constructor(a){super(a)}};return dc.ActorRdfParse=o,dc}var lc={},lv;function s0(){if(lv)return lc;lv=1,Object.defineProperty(lc,"__esModule",{value:!0}),lc.ActorRdfParseFixedMediaTypes=void 0;const i=Ao(),o=O();let u=class extends i.ActorAbstractMediaTypedFixed{constructor(t){super(t)}async testHandleChecked(t){return(0,o.passTestVoid)()}};return lc.ActorRdfParseFixedMediaTypes=u,lc}var fv;function So(){return fv||(fv=1,(function(i){var o=ar&&ar.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ar&&ar.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(c0(),i),u(s0(),i)})(ar)),ar}var pv;function d0(){if(pv)return sc;pv=1,Object.defineProperty(sc,"__esModule",{value:!0}),sc.ActorRdfParseN3=void 0;const i=So(),o=q(),u=nj;let a=class extends i.ActorRdfParseFixedMediaTypes{constructor(e){super(e)}async runHandle(e,r,n){var l;const c=e.context.getSafe(o.KeysInitQuery.dataFactory);e.data.on("error",d=>s.emit("error",d));const s=e.data.pipe(new u.StreamParser({factory:c,baseIRI:(l=e.metadata)==null?void 0:l.baseIRI,format:r.endsWith("n3")?r:`${r}*`}));return{data:s,metadata:{triples:r==="text/turtle"||r==="application/n-triples"||r==="text/n3"}}}};return sc.ActorRdfParseN3=a,sc}var yv;function l0(){return yv||(yv=1,(function(i){var o=nr&&nr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=nr&&nr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(d0(),i)})(nr)),nr}var ir={},fc={},_v;function f0(){if(_v)return fc;_v=1,Object.defineProperty(fc,"__esModule",{value:!0}),fc.ActorRdfParseRdfXml=void 0;const i=So(),o=q(),u=ix();let a=class extends i.ActorRdfParseFixedMediaTypes{constructor(e){super(e)}async runHandle(e){var c;const r=e.context.getSafe(o.KeysInitQuery.dataFactory);e.data.on("error",s=>n.emit("error",s));const n=e.data.pipe(new u.RdfXmlParser({dataFactory:r,baseIRI:(c=e.metadata)==null?void 0:c.baseIRI}));return{data:n,metadata:{triples:!0}}}};return fc.ActorRdfParseRdfXml=a,fc}var mv;function p0(){return mv||(mv=1,(function(i){var o=ir&&ir.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ir&&ir.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(f0(),i)})(ir)),ir}var or={},pc={},bv;function y0(){if(bv)return pc;bv=1,Object.defineProperty(pc,"__esModule",{value:!0}),pc.ActorRdfParseXmlRdfa=void 0;const i=So(),o=q(),u=aj();let a=class extends i.ActorRdfParseFixedMediaTypes{constructor(e){super(e)}async runHandle(e,r,n){var d;const c=e.context.getSafe(o.KeysInitQuery.dataFactory),s=(e.headers&&e.headers.get("content-language"))??void 0;e.data.on("error",f=>l.emit("error",f));const l=e.data.pipe(new u.RdfaParser({dataFactory:c,baseIRI:(d=e.metadata)==null?void 0:d.baseIRI,profile:"xml",language:s}));return{data:l,metadata:{triples:!0}}}};return pc.ActorRdfParseXmlRdfa=a,pc}var gv;function _0(){return gv||(gv=1,(function(i){var o=or&&or.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=or&&or.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(y0(),i)})(or)),or}var ur={},yc={},_c={},hv;function m0(){if(hv)return _c;hv=1,Object.defineProperty(_c,"__esModule",{value:!0}),_c.PrefixWrappingIterator=void 0;const i=N();let o=class extends i.WrappingIterator{constructor(a){super(a==null?void 0:a.then(t=>(this.prefixes=t.prefixes,t)))}read(){if(this.prefixes){for(const a of Object.entries(this.prefixes))this.emit("prefix",...a);delete this.prefixes}return super.read()}};return _c.PrefixWrappingIterator=o,_c}var vv;function b0(){if(vv)return yc;vv=1,Object.defineProperty(yc,"__esModule",{value:!0}),yc.ActorRdfParseShaclc=void 0;const i=So(),o=Oo(),u=Z(),a=ox(),t=m0();let e=class extends i.ActorRdfParseFixedMediaTypes{constructor(n){super(n)}async runHandle(n,c,s){const l=new t.PrefixWrappingIterator((0,o.stringify)(n.data).then(f=>{var p;return(0,a.parse)(f,{extendedSyntax:c==="text/shaclc-ext",baseIRI:(p=n.metadata)==null?void 0:p.baseIRI})})),d=new u.Readable({objectMode:!0});return l.on("prefix",(...f)=>d.emit("prefix",...f)),{data:d.wrap(l),metadata:{triples:!0}}}};return yc.ActorRdfParseShaclc=e,yc}var Tv;function g0(){return Tv||(Tv=1,(function(i){var o=ur&&ur.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ur&&ur.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(b0(),i)})(ur)),ur}var cr={},mc={},Ov;function h0(){if(Ov)return mc;Ov=1,Object.defineProperty(mc,"__esModule",{value:!0}),mc.ActorRdfParseHtml=void 0;const i=So(),o=ux(),u=Z();class a extends i.ActorRdfParseFixedMediaTypes{constructor(e){super(e)}async runHandle(e,r,n){var _;const c=new u.Readable({objectMode:!0});c._read=()=>{};let s=0,l=1;function d(y){c.emit("error",y)}function f(){--l===0&&c.push(null)}const p={baseIRI:((_=e.metadata)==null?void 0:_.baseIRI)??"",context:n,emit:y=>{s--,c.push(y)},end:f,error:d,headers:e.headers};try{const y=await Promise.all(this.busRdfParseHtml.publish(p));l+=y.length;const m=[];for(const g of y){const{htmlParseListener:T}=await g.actor.run(p,void 0);m.push(T)}const b=new o.Parser({onclosetag(){try{for(const g of m)g.onTagClose()}catch(g){d(g)}},onend(){try{for(const g of m)g.onEnd()}catch(g){d(g)}f()},onopentag(g,T){try{for(const v of m)v.onTagOpen(g,T)}catch(v){d(v)}},ontext(g){try{for(const T of m)T.onText(g)}catch(T){d(T)}}},{decodeEntities:!0,recognizeSelfClosing:!0,xmlMode:!1}),h=c._read=g=>{for(s=Math.max(g,s);s>0;){const T=e.data.read();if(T===null){e.data.once("readable",()=>h(0));return}b.write(T.toString())}};e.data.on("error",d).on("end",()=>b.end())}catch(y){setTimeout(()=>{c.emit("error",y)})}return{data:c}}}return mc.ActorRdfParseHtml=a,mc}var Av;function v0(){return Av||(Av=1,(function(i){var o=cr&&cr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=cr&&cr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(h0(),i)})(cr)),cr}var sr={},bc={},dr={},gc={},Sv;function T0(){if(Sv)return gc;Sv=1,Object.defineProperty(gc,"__esModule",{value:!0}),gc.ActorRdfParseHtml=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return gc.ActorRdfParseHtml=o,gc}var Fv;function pm(){return Fv||(Fv=1,(function(i){var o=dr&&dr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=dr&&dr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(T0(),i)})(dr)),dr}var wv;function O0(){if(wv)return bc;wv=1,Object.defineProperty(bc,"__esModule",{value:!0}),bc.ActorRdfParseHtmlMicrodata=void 0;const i=pm(),o=q(),u=O(),a=cx();let t=class extends i.ActorRdfParseHtml{constructor(r){super(r)}async test(r){return(0,u.passTestVoid)()}async run(r){const n=r.context.getSafe(o.KeysInitQuery.dataFactory),c=r.headers?r.headers.get("content-type"):null,s=c==null?void 0:c.includes("xml"),l=new a.MicrodataRdfParser({dataFactory:n,baseIRI:r.baseIRI,xmlMode:s});l.on("error",r.error),l.on("data",r.emit);const d=l.onEnd;return l.onEnd=()=>{d.call(l),r.end()},{htmlParseListener:l}}};return bc.ActorRdfParseHtmlMicrodata=t,bc}var Rv;function A0(){return Rv||(Rv=1,(function(i){var o=sr&&sr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=sr&&sr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(O0(),i)})(sr)),sr}var lr={},hc={},Pv;function S0(){if(Pv)return hc;Pv=1,Object.defineProperty(hc,"__esModule",{value:!0}),hc.ActorRdfParseHtmlRdfa=void 0;const i=pm(),o=q(),u=O(),a=aj();let t=class extends i.ActorRdfParseHtml{constructor(r){super(r)}async test(r){return(0,u.passTestVoid)()}async run(r){const n=r.context.getSafe(o.KeysInitQuery.dataFactory),c=r.headers?r.headers.get("content-type"):null,s=(r.headers&&r.headers.get("content-language"))??void 0,l=c&&c.includes("xml")?"xhtml":"html",d=new a.RdfaParser({dataFactory:n,baseIRI:r.baseIRI,profile:l,language:s});d.on("error",r.error),d.on("data",r.emit);const f=d.onEnd;return d.onEnd=()=>{f.call(d),r.end()},{htmlParseListener:d}}};return hc.ActorRdfParseHtmlRdfa=t,hc}var qv;function F0(){return qv||(qv=1,(function(i){var o=lr&&lr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=lr&&lr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(S0(),i)})(lr)),lr}var fr={},vc={},pr={},Tc={},jv;function w0(){if(jv)return Tc;jv=1,Object.defineProperty(Tc,"__esModule",{value:!0}),Tc.ActorRdfResolveHypermediaLinks=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return Tc.ActorRdfResolveHypermediaLinks=o,Tc}var Mv;function R0(){return Mv||(Mv=1,(function(i){var o=pr&&pr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=pr&&pr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(w0(),i)})(pr)),pr}var xv;function P0(){if(xv)return vc;xv=1,Object.defineProperty(vc,"__esModule",{value:!0}),vc.ActorRdfResolveHypermediaLinksNext=void 0;const i=R0(),o=O();let u=class extends i.ActorRdfResolveHypermediaLinks{constructor(t){super(t)}async test(t){return!t.metadata.next||t.metadata.next.length===0?(0,o.failTest)(`Actor ${this.name} requires a 'next' metadata entry.`):(0,o.passTestVoid)()}async run(t){return{links:t.metadata.next.map(e=>({url:e}))}}};return vc.ActorRdfResolveHypermediaLinksNext=u,vc}var Dv;function q0(){return Dv||(Dv=1,(function(i){var o=fr&&fr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=fr&&fr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(P0(),i)})(fr)),fr}var yr={},Oc={},_r={},Ac={},Ev;function j0(){if(Ev)return Ac;Ev=1,Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.ActorRdfResolveHypermediaLinksQueue=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return Ac.ActorRdfResolveHypermediaLinksQueue=o,Ac}var z_={},Lv;function M0(){return Lv||(Lv=1,Object.defineProperty(z_,"__esModule",{value:!0})),z_}var Sc={},Iv;function x0(){if(Iv)return Sc;Iv=1,Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.LinkQueueWrapper=void 0;let i=class{constructor(u){this.linkQueue=u}push(u,a){return this.linkQueue.push(u,a)}getSize(){return this.linkQueue.getSize()}isEmpty(){return this.linkQueue.isEmpty()}pop(){return this.linkQueue.pop()}peek(){return this.linkQueue.peek()}};return Sc.LinkQueueWrapper=i,Sc}var $v;function D0(){return $v||($v=1,(function(i){var o=_r&&_r.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=_r&&_r.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(j0(),i),u(M0(),i),u(x0(),i)})(_r)),_r}var Fc={},Bv;function Dj(){if(Bv)return Fc;Bv=1,Object.defineProperty(Fc,"__esModule",{value:!0}),Fc.LinkQueueFifo=void 0;let i=class{constructor(){this.links=[]}push(u){return this.links.push(u),!0}getSize(){return this.links.length}isEmpty(){return this.links.length===0}pop(){return this.links.shift()}peek(){return this.links[0]}};return Fc.LinkQueueFifo=i,Fc}var Qv;function E0(){if(Qv)return Oc;Qv=1,Object.defineProperty(Oc,"__esModule",{value:!0}),Oc.ActorRdfResolveHypermediaLinksQueueFifo=void 0;const i=D0(),o=O(),u=Dj();let a=class extends i.ActorRdfResolveHypermediaLinksQueue{constructor(e){super(e)}async test(e){return(0,o.passTestVoid)()}async run(e){return{linkQueue:new u.LinkQueueFifo}}};return Oc.ActorRdfResolveHypermediaLinksQueueFifo=a,Oc}var Nv;function L0(){return Nv||(Nv=1,(function(i){var o=yr&&yr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=yr&&yr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(E0(),i),u(Dj(),i)})(yr)),yr}var mr={},wc={},br={},Rc={},Cv;function I0(){if(Cv)return Rc;Cv=1,Object.defineProperty(Rc,"__esModule",{value:!0}),Rc.ActorRdfSerialize=void 0;const i=Ao();let o=class extends i.ActorAbstractMediaTyped{constructor(a){super(a)}};return Rc.ActorRdfSerialize=o,Rc}var Pc={},Uv;function $0(){if(Uv)return Pc;Uv=1,Object.defineProperty(Pc,"__esModule",{value:!0}),Pc.ActorRdfSerializeFixedMediaTypes=void 0;const i=Ao(),o=O();let u=class extends i.ActorAbstractMediaTypedFixed{constructor(t){super(t)}async testHandleChecked(){return(0,o.passTestVoid)()}};return Pc.ActorRdfSerializeFixedMediaTypes=u,Pc}var Hv;function ym(){return Hv||(Hv=1,(function(i){var o=br&&br.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=br&&br.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(I0(),i),u($0(),i)})(br)),br}var Vv;function B0(){if(Vv)return wc;Vv=1,Object.defineProperty(wc,"__esModule",{value:!0}),wc.ActorRdfSerializeN3=void 0;const i=ym(),o=nj;let u=class extends i.ActorRdfSerializeFixedMediaTypes{constructor(t){super(t)}async runHandle(t,e){const r=new o.StreamWriter({format:e});let n;return"pipe"in t.quadStream?(t.quadStream.on("error",c=>r.emit("error",c)),n=t.quadStream.pipe(r)):n=r.import(t.quadStream),{data:n,triples:e==="text/turtle"||e==="application/n-triples"||e==="text/n3"}}};return wc.ActorRdfSerializeN3=u,wc}var zv;function Q0(){return zv||(zv=1,(function(i){var o=mr&&mr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=mr&&mr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(B0(),i)})(mr)),mr}var gr={},qc={},Xv;function N0(){if(Xv)return qc;Xv=1,Object.defineProperty(qc,"__esModule",{value:!0}),qc.ActorRdfSerializeJsonLd=void 0;const i=ym(),o=sx();let u=class extends i.ActorRdfSerializeFixedMediaTypes{constructor(t){super(t)}async runHandle(t,e,r){const n=new o.JsonLdSerializer({space:" ".repeat(this.jsonStringifyIndentSpaces)});let c;return"pipe"in t.quadStream?(t.quadStream.on("error",s=>n.emit("error",s)),c=t.quadStream.pipe(n)):c=n.import(t.quadStream),{data:c}}};return qc.ActorRdfSerializeJsonLd=u,qc}var Gv;function C0(){return Gv||(Gv=1,(function(i){var o=gr&&gr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=gr&&gr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(N0(),i)})(gr)),gr}var hr={},jc={},Jv;function U0(){if(Jv)return jc;Jv=1,Object.defineProperty(jc,"__esModule",{value:!0}),jc.ActorRdfSerializeShaclc=void 0;const i=ym(),o=dx(),u=Z(),a=lx();let t=class extends i.ActorRdfSerializeFixedMediaTypes{constructor(r){super(r)}async runHandle(r,n){const c=new u.Readable;c._read=()=>{};try{const s={};r.quadStream.on("prefix",(d,f)=>{s[d]=f});const{text:l}=await(0,a.write)(await(0,o.default)(r.quadStream),{errorOnUnused:!0,extendedSyntax:n==="text/shaclc-ext",prefixes:s});c.push(l),c.push(null)}catch(s){c._read=()=>{c.emit("error",s)}}return{data:c,triples:!0}}};return jc.ActorRdfSerializeShaclc=t,jc}var Kv;function H0(){return Kv||(Kv=1,(function(i){var o=hr&&hr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=hr&&hr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(U0(),i)})(hr)),hr}var vr={},Mc={},Tr={},xc={},Yv;function Ej(){if(Yv)return xc;Yv=1,Object.defineProperty(xc,"__esModule",{value:!0}),xc.ActorRdfUpdateQuads=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return xc.ActorRdfUpdateQuads=o,xc}var Re={},Wv;function V0(){if(Wv)return Re;Wv=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.ActorRdfUpdateQuadsDestination=Re.deskolemize=Re.deskolemizeStream=void 0;const i=Sj(),o=q(),u=O(),a=Ej();function t(n,c,s){return c==null?void 0:c.map(l=>(0,i.deskolemizeQuad)(n,l,s))}Re.deskolemizeStream=t;function e(n){var d;const c=n.context.getSafe(o.KeysInitQuery.dataFactory),s=n.context.get(o.KeysRdfUpdateQuads.destination),l=(d=n.context.get(o.KeysQuerySourceIdentify.sourceIds))==null?void 0:d.get(s);return l?{...n,quadStreamInsert:t(c,n.quadStreamInsert,l),quadStreamDelete:t(c,n.quadStreamDelete,l)}:n}Re.deskolemize=e;let r=class extends a.ActorRdfUpdateQuads{async test(c){return(0,u.passTestVoid)()}async run(c){const s=await this.getDestination(c.context);return await this.getOutput(s,e(c))}async getOutput(c,s){return{execute:async()=>{await c.update({insert:s.quadStreamInsert,delete:s.quadStreamDelete}),await(s.deleteGraphs?c.deleteGraphs(s.deleteGraphs.graphs,s.deleteGraphs.requireExistence,s.deleteGraphs.dropGraphs):Promise.resolve()),await(s.createGraphs?c.createGraphs(s.createGraphs.graphs,s.createGraphs.requireNonExistence):Promise.resolve())}}}};return Re.ActorRdfUpdateQuadsDestination=r,Re}var X_={},Zv;function z0(){return Zv||(Zv=1,Object.defineProperty(X_,"__esModule",{value:!0})),X_}var de={},kv;function X0(){if(kv)return de;kv=1,Object.defineProperty(de,"__esModule",{value:!0}),de.getContextDestinationUrl=de.getContextDestination=de.getDataDestinationContext=de.getDataDestinationValue=de.getDataDestinationType=de.isDataDestinationRawType=void 0;const i=q();function o(n){return typeof n=="string"||"remove"in n}de.isDataDestinationRawType=o;function u(n){return typeof n=="string"?"":"remove"in n?"rdfjsStore":n.type}de.getDataDestinationType=u;function a(n){return o(n)?n:n.value}de.getDataDestinationValue=a;function t(n,c){return typeof n=="string"||"remove"in n||!n.context?c:c.merge(n.context)}de.getDataDestinationContext=t;function e(n){return n.get(i.KeysRdfUpdateQuads.destination)}de.getContextDestination=e;function r(n){if(n){let c=a(n);if(typeof c=="string"){const s=c.indexOf("#");return s>=0&&(c=c.slice(0,s)),c}}}return de.getContextDestinationUrl=r,de}var eT;function _m(){return eT||(eT=1,(function(i){var o=Tr&&Tr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Tr&&Tr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(Ej(),i),u(V0(),i),u(z0(),i),u(X0(),i)})(Tr)),Tr}var Dc={},tT;function G0(){if(tT)return Dc;tT=1,Object.defineProperty(Dc,"__esModule",{value:!0}),Dc.RdfJsQuadDestination=void 0;const i=fx(),o=ne();let u=class{constructor(t,e){this.dataFactory=t,this.store=e}async update(t){t.delete&&await(0,i.promisifyEventEmitter)(this.store.remove(t.delete)),t.insert&&await(0,i.promisifyEventEmitter)(this.store.import(t.insert))}async deleteGraphs(t,e,r){switch(t){case"ALL":await(0,i.promisifyEventEmitter)(this.store.deleteGraph(this.dataFactory.defaultGraph()));case"NAMED":const n=this.store.match(),c={};n.on("data",s=>{s.graph.termType!=="DefaultGraph"&&(c[(0,o.termToString)(s.graph)]=!0)}),await(0,i.promisifyEventEmitter)(n),await Promise.all(Object.keys(c).map(s=>(0,i.promisifyEventEmitter)(this.store.deleteGraph((0,o.stringToTerm)(s,this.dataFactory)))));break;default:for(const s of Array.isArray(t)?t:[t])await(0,i.promisifyEventEmitter)(this.store.deleteGraph(s))}}async createGraphs(t,e){if(e)for(const r of t){const n=this.store.match(void 0,void 0,void 0,r);await new Promise((c,s)=>{n.once("data",()=>{s(new Error(`Unable to create graph ${r.value} as it already exists`))}),n.on("end",c),n.on("error",s)})}}};return Dc.RdfJsQuadDestination=u,Dc}var rT;function J0(){if(rT)return Mc;rT=1,Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.ActorRdfUpdateQuadsRdfJsStore=void 0;const i=_m(),o=q(),u=O(),a=G0();let t=class extends i.ActorRdfUpdateQuadsDestination{constructor(r){super(r)}async test(r){var c;const n=(0,i.getContextDestination)(r.context);return!n||typeof n=="string"||!("remove"in n)&&"value"in n&&!((c=n.value)!=null&&c.remove)?(0,u.failTest)(`${this.name} received an invalid rdfjsStore.`):(0,u.passTestVoid)()}async getDestination(r){const n=(0,i.getContextDestination)(r);return new a.RdfJsQuadDestination(r.getSafe(o.KeysInitQuery.dataFactory),"remove"in n?n:n.value)}};return Mc.ActorRdfUpdateQuadsRdfJsStore=t,Mc}var nT;function K0(){return nT||(nT=1,(function(i){var o=vr&&vr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=vr&&vr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(J0(),i)})(vr)),vr}var Or={},Ec={},Lc={},aT;function Y0(){if(aT)return Lc;aT=1,Object.defineProperty(Lc,"__esModule",{value:!0}),Lc.ExpressionFunctionBnode=void 0;const i=w(),o=q(),u=cm(),a=S();let t=class rm extends i.ExpressionFunctionBase{constructor(){super({arity:Number.POSITIVE_INFINITY,operator:a.SparqlOperator.BNODE,apply:async r=>{const{args:n,mapping:c,exprEval:s}=r,l=n.length===1?await s.evaluatorExpressionEvaluation(n[0],c):void 0;let d;if(l){const p=rm.bnodeTree.search([l],s.context.getSafe(o.KeysExpressionEvaluator.superTypeProvider),s.context.getSafe(o.KeysInitQuery.functionArgumentsCache));if(!p)throw new a.InvalidArgumentTypes(n,a.SparqlOperator.BNODE);d=p(s)([l]).str()}const f=new u.BlankNodeBindingsScoped(d??`BNODE_${rm.bnodeCounter++}`);return new a.BlankNode(f)}})}checkArity(r){return r.length===0||r.length===1}};return Lc.ExpressionFunctionBnode=t,t.bnodeTree=(0,a.declare)(a.SparqlOperator.BNODE).onString1(()=>e=>e).collect(),t.bnodeCounter=0,Lc}var iT;function W0(){if(iT)return Ec;iT=1,Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.ActorFunctionFactoryExpressionBnode=void 0;const i=w(),o=S(),u=Y0();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.BNODE],termFunction:!1})}async run(e){return new u.ExpressionFunctionBnode}};return Ec.ActorFunctionFactoryExpressionBnode=a,Ec}var oT;function Z0(){return oT||(oT=1,(function(i){var o=Or&&Or.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Or&&Or.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(W0(),i)})(Or)),Or}var Ar={},Ic={},$c={},uT;function k0(){if(uT)return $c;uT=1,Object.defineProperty($c,"__esModule",{value:!0}),$c.ExpressionFunctionBound=void 0;const i=w(),o=q(),u=Ee(),a=S();let t=class extends i.ExpressionFunctionBase{constructor(){super({arity:1,operator:a.SparqlOperator.BOUND,apply:async({args:r,mapping:n,exprEval:c})=>{const s=r[0];if(s.expressionType!==u.ExpressionType.Variable)throw new a.InvalidArgumentTypes(r,a.SparqlOperator.BOUND);const l=n.has((0,a.expressionToVar)(c.context.getSafe(o.KeysInitQuery.dataFactory),s));return(0,a.bool)(l)}})}};return $c.ExpressionFunctionBound=t,$c}var cT;function eL(){if(cT)return Ic;cT=1,Object.defineProperty(Ic,"__esModule",{value:!0}),Ic.ActorFunctionFactoryExpressionBound=void 0;const i=w(),o=S(),u=k0();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.BOUND],termFunction:!1})}async run(e){return new u.ExpressionFunctionBound}};return Ic.ActorFunctionFactoryExpressionBound=a,Ic}var sT;function tL(){return sT||(sT=1,(function(i){var o=Ar&&Ar.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ar&&Ar.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(eL(),i)})(Ar)),Ar}var Sr={},Bc={},Qc={},dT;function rL(){if(dT)return Qc;dT=1,Object.defineProperty(Qc,"__esModule",{value:!0}),Qc.ExpressionFunctionCoalesce=void 0;const i=w(),o=S();let u=class extends i.ExpressionFunctionBase{constructor(){super({arity:Number.POSITIVE_INFINITY,operator:o.SparqlOperator.COALESCE,apply:async({args:t,mapping:e,exprEval:r})=>{const n=[];for(const c of t)try{return await r.evaluatorExpressionEvaluation(c,e)}catch(s){n.push(s)}throw new o.CoalesceError(n)}})}};return Qc.ExpressionFunctionCoalesce=u,Qc}var lT;function nL(){if(lT)return Bc;lT=1,Object.defineProperty(Bc,"__esModule",{value:!0}),Bc.ActorFunctionFactoryExpressionCoalesce=void 0;const i=w(),o=S(),u=rL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.COALESCE],termFunction:!1})}async run(e){return new u.ExpressionFunctionCoalesce}};return Bc.ActorFunctionFactoryExpressionCoalesce=a,Bc}var fT;function aL(){return fT||(fT=1,(function(i){var o=Sr&&Sr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Sr&&Sr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(nL(),i)})(Sr)),Sr}var Fr={},Nc={},Cc={},pT;function iL(){if(pT)return Cc;pT=1,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.ExpressionFunctionConcat=void 0;const i=w(),o=q(),u=S();let a=class nm extends i.ExpressionFunctionBase{constructor(){super({arity:Number.POSITIVE_INFINITY,operator:u.SparqlOperator.CONCAT,apply:async e=>{const{args:r,mapping:n,exprEval:c}=e,s=r.map(async _=>c.evaluatorExpressionEvaluation(_,n)).map(async _=>{const y=nm.concatTree.search([await _],c.context.getSafe(o.KeysExpressionEvaluator.superTypeProvider),c.context.getSafe(o.KeysInitQuery.functionArgumentsCache));if(!y)throw new u.InvalidArgumentTypes(r,u.SparqlOperator.CONCAT);return y(c)([await _])}),l=await Promise.all(s),f=l.map(_=>_.typedValue).join(""),p=nm.langAllEqual(l)?l[0].language:void 0;return p?(0,u.langString)(f,p):(0,u.string)(f)}})}static langAllEqual(e){return e.length>0&&e.every(r=>r.language===e[0].language)}};return Cc.ExpressionFunctionConcat=a,a.concatTree=(0,u.declare)(u.SparqlOperator.CONCAT).onStringly1(()=>t=>t).collect(),Cc}var yT;function oL(){if(yT)return Nc;yT=1,Object.defineProperty(Nc,"__esModule",{value:!0}),Nc.ActorFunctionFactoryExpressionConcat=void 0;const i=w(),o=S(),u=iL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.CONCAT],termFunction:!1})}async run(e){return new u.ExpressionFunctionConcat}};return Nc.ActorFunctionFactoryExpressionConcat=a,Nc}var _T;function uL(){return _T||(_T=1,(function(i){var o=Fr&&Fr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Fr&&Fr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(oL(),i)})(Fr)),Fr}var wr={},Uc={},Hc={},mT;function cL(){if(mT)return Hc;mT=1,Object.defineProperty(Hc,"__esModule",{value:!0}),Hc.NamedExtension=void 0;const i=hj(),o=q(),u=S();let a=class extends i.ExpressionFunctionBase{constructor({operator:e,functionDefinition:r}){super({arity:Number.POSITIVE_INFINITY,operator:e,apply:async({args:n,exprEval:c,mapping:s})=>{const l=await Promise.all(n.map(d=>c.evaluatorExpressionEvaluation(d,s)));try{return new u.TermTransformer(c.context.getSafe(o.KeysExpressionEvaluator.superTypeProvider)).transformRDFTermUnsafe(await r(l.map(d=>d.toRDF(c.context.getSafe(o.KeysInitQuery.dataFactory)))))}catch(d){throw new u.ExtensionFunctionError(this.operator,d)}}})}};return Hc.NamedExtension=a,Hc}var bT;function sL(){if(bT)return Uc;bT=1,Object.defineProperty(Uc,"__esModule",{value:!0}),Uc.ActorFunctionFactoryExpressionExtensions=void 0;const i=w(),o=q(),u=O(),a=vo(),t=cL();let e=class extends i.ActorFunctionFactory{constructor(n){super(n)}async test({context:n,functionName:c}){return await n.getSafe(o.KeysExpressionEvaluator.extensionFunctionCreator)(new a.DataFactory().namedNode(c))?(0,u.passTestVoid)():(0,u.failTest)(`Actor ${this.name} can only provide non-termExpression implementations for functions that are provided through config entries like: ${o.KeysInitQuery.extensionFunctionCreator.name} or ${o.KeysInitQuery.extensionFunctions.name}`)}async run({context:n,functionName:c}){const l=await n.getSafe(o.KeysExpressionEvaluator.extensionFunctionCreator)(new a.DataFactory().namedNode(c));return new t.NamedExtension({operator:c,functionDefinition:l})}};return Uc.ActorFunctionFactoryExpressionExtensions=e,Uc}var gT;function dL(){return gT||(gT=1,(function(i){var o=wr&&wr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=wr&&wr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(sL(),i)})(wr)),wr}var Rr={},Vc={},zc={},hT;function lL(){if(hT)return zc;hT=1,Object.defineProperty(zc,"__esModule",{value:!0}),zc.ExpressionFunctionIf=void 0;const i=w(),o=S();let u=class extends i.ExpressionFunctionBase{constructor(){super({arity:3,operator:o.SparqlOperator.IF,apply:async({args:t,mapping:e,exprEval:r})=>(await r.evaluatorExpressionEvaluation(t[0],e)).coerceEBV()?r.evaluatorExpressionEvaluation(t[1],e):r.evaluatorExpressionEvaluation(t[2],e)})}};return zc.ExpressionFunctionIf=u,zc}var vT;function fL(){if(vT)return Vc;vT=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.ActorFunctionFactoryExpressionIf=void 0;const i=w(),o=S(),u=lL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.IF],termFunction:!1})}async run(e){return new u.ExpressionFunctionIf}};return Vc.ActorFunctionFactoryExpressionIf=a,Vc}var TT;function pL(){return TT||(TT=1,(function(i){var o=Rr&&Rr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Rr&&Rr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(fL(),i)})(Rr)),Rr}var Pr={},Xc={},Gc={},OT;function yL(){if(OT)return Gc;OT=1,Object.defineProperty(Gc,"__esModule",{value:!0}),Gc.ExpressionFunctionLogicalAnd=void 0;const i=w(),o=S();let u=class extends i.ExpressionFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.LOGICAL_AND,apply:async({args:t,mapping:e,exprEval:r})=>{const[n,c]=t;try{if(!(await r.evaluatorExpressionEvaluation(n,e)).coerceEBV())return(0,o.bool)(!1);const f=(await r.evaluatorExpressionEvaluation(c,e)).coerceEBV();return(0,o.bool)(f)}catch(s){if((await r.evaluatorExpressionEvaluation(c,e)).coerceEBV())throw s;return(0,o.bool)(!1)}}})}};return Gc.ExpressionFunctionLogicalAnd=u,Gc}var AT;function _L(){if(AT)return Xc;AT=1,Object.defineProperty(Xc,"__esModule",{value:!0}),Xc.ActorFunctionFactoryExpressionLogicalAnd=void 0;const i=w(),o=S(),u=yL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.LOGICAL_AND],termFunction:!1})}async run(e){return new u.ExpressionFunctionLogicalAnd}};return Xc.ActorFunctionFactoryExpressionLogicalAnd=a,Xc}var ST;function mL(){return ST||(ST=1,(function(i){var o=Pr&&Pr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Pr&&Pr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(_L(),i)})(Pr)),Pr}var qr={},Jc={},Kc={},FT;function bL(){if(FT)return Kc;FT=1,Object.defineProperty(Kc,"__esModule",{value:!0}),Kc.ExpressionFunctionLogicalOr=void 0;const i=w(),o=S();let u=class extends i.ExpressionFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.LOGICAL_OR,apply:async({args:t,mapping:e,exprEval:r})=>{const[n,c]=t;try{if((await r.evaluatorExpressionEvaluation(n,e)).coerceEBV())return(0,o.bool)(!0);const f=(await r.evaluatorExpressionEvaluation(c,e)).coerceEBV();return(0,o.bool)(f)}catch(s){if(!(await r.evaluatorExpressionEvaluation(c,e)).coerceEBV())throw s;return(0,o.bool)(!0)}}})}};return Kc.ExpressionFunctionLogicalOr=u,Kc}var wT;function gL(){if(wT)return Jc;wT=1,Object.defineProperty(Jc,"__esModule",{value:!0}),Jc.ActorFunctionFactoryExpressionLogicalOr=void 0;const i=w(),o=S(),u=bL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.LOGICAL_OR],termFunction:!1})}async run(e){return new u.ExpressionFunctionLogicalOr}};return Jc.ActorFunctionFactoryExpressionLogicalOr=a,Jc}var RT;function hL(){return RT||(RT=1,(function(i){var o=qr&&qr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=qr&&qr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(gL(),i)})(qr)),qr}var jr={},Yc={},Wc={},PT;function vL(){if(PT)return Wc;PT=1,Object.defineProperty(Wc,"__esModule",{value:!0}),Wc.ExpressionFunctionSameTerm=void 0;const i=w(),o=q(),u=S();let a=class extends i.ExpressionFunctionBase{constructor(){super({arity:2,operator:u.SparqlOperator.SAME_TERM,apply:async({args:e,mapping:r,exprEval:n})=>{const c=n.context.getSafe(o.KeysInitQuery.dataFactory),[s,l]=e.map(p=>n.evaluatorExpressionEvaluation(p,r)),[d,f]=await Promise.all([s,l]);return(0,u.bool)(d.toRDF(c).equals(f.toRDF(c)))}})}};return Wc.ExpressionFunctionSameTerm=a,Wc}var qT;function TL(){if(qT)return Yc;qT=1,Object.defineProperty(Yc,"__esModule",{value:!0}),Yc.ActorFunctionFactoryExpressionSameTerm=void 0;const i=w(),o=S(),u=vL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.SAME_TERM],termFunction:!1})}async run(e){return new u.ExpressionFunctionSameTerm}};return Yc.ActorFunctionFactoryExpressionSameTerm=a,Yc}var jT;function OL(){return jT||(jT=1,(function(i){var o=jr&&jr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=jr&&jr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(TL(),i)})(jr)),jr}var Mr={},Zc={},kc={},MT;function AL(){if(MT)return kc;MT=1,Object.defineProperty(kc,"__esModule",{value:!0}),kc.TermFunctionAbs=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.ABS,overloads:(0,o.declare)(o.SparqlOperator.ABS).numericConverter(()=>t=>Math.abs(t)).collect()})}};return kc.TermFunctionAbs=u,kc}var xT;function SL(){if(xT)return Zc;xT=1,Object.defineProperty(Zc,"__esModule",{value:!0}),Zc.ActorFunctionFactoryTermAbs=void 0;const i=w(),o=S(),u=AL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.ABS],termFunction:!0})}async run(e){return new u.TermFunctionAbs}};return Zc.ActorFunctionFactoryTermAbs=a,Zc}var DT;function FL(){return DT||(DT=1,(function(i){var o=Mr&&Mr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Mr&&Mr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(SL(),i)})(Mr)),Mr}var xr={},es={},ts={},ET;function wL(){if(ET)return ts;ET=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.TermFunctionAddition=void 0;const i=w(),o=S(),u=i_();let a=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.ADDITION,overloads:(0,o.declare)(o.SparqlOperator.ADDITION).arithmetic(()=>(e,r)=>new u.BigNumber(e).plus(r).toNumber()).set([o.TypeURL.XSD_DATE_TIME,o.TypeURL.XSD_DAY_TIME_DURATION],()=>([e,r])=>new o.DateTimeLiteral((0,o.addDurationToDateTime)(e.typedValue,(0,o.defaultedDurationRepresentation)(r.typedValue)))).copy({from:[o.TypeURL.XSD_DATE_TIME,o.TypeURL.XSD_DAY_TIME_DURATION],to:[o.TypeURL.XSD_DATE_TIME,o.TypeURL.XSD_YEAR_MONTH_DURATION]}).set([o.TypeURL.XSD_DATE,o.TypeURL.XSD_DAY_TIME_DURATION],()=>([e,r])=>new o.DateLiteral((0,o.addDurationToDateTime)((0,o.defaultedDateTimeRepresentation)(e.typedValue),(0,o.defaultedDurationRepresentation)(r.typedValue)))).copy({from:[o.TypeURL.XSD_DATE,o.TypeURL.XSD_DAY_TIME_DURATION],to:[o.TypeURL.XSD_DATE,o.TypeURL.XSD_YEAR_MONTH_DURATION]}).set([o.TypeURL.XSD_TIME,o.TypeURL.XSD_DAY_TIME_DURATION],()=>([e,r])=>new o.TimeLiteral((0,o.addDurationToDateTime)((0,o.defaultedDateTimeRepresentation)(e.typedValue),(0,o.defaultedDurationRepresentation)(r.typedValue)))).copy({from:[o.TypeURL.XSD_TIME,o.TypeURL.XSD_DAY_TIME_DURATION],to:[o.TypeURL.XSD_TIME,o.TypeURL.XSD_YEAR_MONTH_DURATION]}).collect()})}};return ts.TermFunctionAddition=a,ts}var LT;function RL(){if(LT)return es;LT=1,Object.defineProperty(es,"__esModule",{value:!0}),es.ActorFunctionFactoryTermAddition=void 0;const i=w(),o=S(),u=wL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.ADDITION],termFunction:!0})}async run(e){return new u.TermFunctionAddition}};return es.ActorFunctionFactoryTermAddition=a,es}var IT;function PL(){return IT||(IT=1,(function(i){var o=xr&&xr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=xr&&xr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(RL(),i)})(xr)),xr}var Dr={},rs={},ns={},$T;function qL(){if($T)return ns;$T=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.TermFunctionCeil=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.CEIL,overloads:(0,o.declare)(o.SparqlOperator.CEIL).numericConverter(()=>t=>Math.ceil(t)).collect()})}};return ns.TermFunctionCeil=u,ns}var BT;function jL(){if(BT)return rs;BT=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.ActorFunctionFactoryTermCeil=void 0;const i=w(),o=S(),u=qL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.CEIL],termFunction:!0})}async run(e){return new u.TermFunctionCeil}};return rs.ActorFunctionFactoryTermCeil=a,rs}var QT;function ML(){return QT||(QT=1,(function(i){var o=Dr&&Dr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Dr&&Dr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(jL(),i)})(Dr)),Dr}var Er={},as={},is={},NT;function xL(){if(NT)return is;NT=1,Object.defineProperty(is,"__esModule",{value:!0}),is.TermFunctionContains=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.CONTAINS,overloads:(0,o.declare)(o.SparqlOperator.CONTAINS).onBinaryTyped([o.TypeAlias.SPARQL_STRINGLY,o.TypeURL.XSD_STRING],()=>(t,e)=>(0,o.bool)(t.includes(e))).onBinary([o.TypeURL.RDF_LANG_STRING,o.TypeURL.RDF_LANG_STRING],()=>(t,e)=>{if(t.language!==e.language)throw new o.IncompatibleLanguageOperation(t,e);return(0,o.bool)(t.typedValue.includes(e.typedValue))}).collect()})}};return is.TermFunctionContains=u,is}var CT;function DL(){if(CT)return as;CT=1,Object.defineProperty(as,"__esModule",{value:!0}),as.ActorFunctionFactoryTermContains=void 0;const i=w(),o=S(),u=xL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.CONTAINS],termFunction:!0})}async run(e){return new u.TermFunctionContains}};return as.ActorFunctionFactoryTermContains=a,as}var UT;function EL(){return UT||(UT=1,(function(i){var o=Er&&Er.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Er&&Er.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(DL(),i)})(Er)),Er}var Lr={},os={},us={},HT;function LL(){if(HT)return us;HT=1,Object.defineProperty(us,"__esModule",{value:!0}),us.TermFunctionDatatype=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.DATATYPE,overloads:(0,o.declare)(o.SparqlOperator.DATATYPE).onLiteral1(()=>t=>new o.NamedNode(t.dataType)).collect()})}};return us.TermFunctionDatatype=u,us}var VT;function IL(){if(VT)return os;VT=1,Object.defineProperty(os,"__esModule",{value:!0}),os.ActorFunctionFactoryTermDatatype=void 0;const i=w(),o=S(),u=LL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.DATATYPE],termFunction:!0})}async run(e){return new u.TermFunctionDatatype}};return os.ActorFunctionFactoryTermDatatype=a,os}var zT;function $L(){return zT||(zT=1,(function(i){var o=Lr&&Lr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Lr&&Lr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(IL(),i)})(Lr)),Lr}var Ir={},cs={},ss={},XT;function BL(){if(XT)return ss;XT=1,Object.defineProperty(ss,"__esModule",{value:!0}),ss.TermFunctionDay=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.DAY,overloads:(0,o.declare)(o.SparqlOperator.DAY).onDateTime1(()=>t=>(0,o.integer)(t.typedValue.day)).set([o.TypeURL.XSD_DATE],()=>([t])=>(0,o.integer)(t.typedValue.day)).collect()})}};return ss.TermFunctionDay=u,ss}var GT;function QL(){if(GT)return cs;GT=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.ActorFunctionFactoryTermDay=void 0;const i=w(),o=S(),u=BL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.DAY],termFunction:!0})}async run(e){return new u.TermFunctionDay}};return cs.ActorFunctionFactoryTermDay=a,cs}var JT;function NL(){return JT||(JT=1,(function(i){var o=Ir&&Ir.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ir&&Ir.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(QL(),i)})(Ir)),Ir}var $r={},ds={},ls={},KT;function CL(){if(KT)return ls;KT=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.TermFunctionDivision=void 0;const i=w(),o=S(),u=i_();let a=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.DIVISION,overloads:(0,o.declare)(o.SparqlOperator.DIVISION).arithmetic(()=>(e,r)=>new u.BigNumber(e).div(r).toNumber()).onBinaryTyped([o.TypeURL.XSD_INTEGER,o.TypeURL.XSD_INTEGER],()=>(e,r)=>{if(r===0)throw new o.ExpressionError("Integer division by 0");return(0,o.decimal)(new u.BigNumber(e).div(r).toNumber())}).collect()})}};return ls.TermFunctionDivision=a,ls}var YT;function UL(){if(YT)return ds;YT=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.ActorFunctionFactoryTermDivision=void 0;const i=w(),o=S(),u=CL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.DIVISION],termFunction:!0})}async run(e){return new u.TermFunctionDivision}};return ds.ActorFunctionFactoryTermDivision=a,ds}var WT;function HL(){return WT||(WT=1,(function(i){var o=$r&&$r.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=$r&&$r.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(UL(),i)})($r)),$r}var Br={},fs={},ps={},ZT;function VL(){if(ZT)return ps;ZT=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.TermFunctionEncodeForUri=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.ENCODE_FOR_URI,overloads:(0,o.declare)(o.SparqlOperator.ENCODE_FOR_URI).onStringly1Typed(()=>t=>(0,o.string)(encodeURI(t))).collect()})}};return ps.TermFunctionEncodeForUri=u,ps}var kT;function zL(){if(kT)return fs;kT=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.ActorFunctionFactoryTermEncodeForUri=void 0;const i=w(),o=S(),u=VL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.ENCODE_FOR_URI],termFunction:!0})}async run(e){return new u.TermFunctionEncodeForUri}};return fs.ActorFunctionFactoryTermEncodeForUri=a,fs}var eO;function XL(){return eO||(eO=1,(function(i){var o=Br&&Br.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Br&&Br.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(zL(),i)})(Br)),Br}var Qr={},ys={},_s={},tO;function GL(){if(tO)return _s;tO=1,Object.defineProperty(_s,"__esModule",{value:!0}),_s.TermFunctionEquality=void 0;const i=w(),o=q(),u=S();let a=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:u.SparqlOperator.EQUAL,overloads:(0,u.declare)(u.SparqlOperator.EQUAL).numberTest(()=>(e,r)=>e===r).stringTest(()=>(e,r)=>e.localeCompare(r)===0).set([u.TypeURL.RDF_LANG_STRING,u.TypeURL.RDF_LANG_STRING],()=>([e,r])=>(0,u.bool)(e.str()===r.str()&&e.language===r.language)).set([u.TypeAlias.SPARQL_STRINGLY,u.TypeAlias.SPARQL_STRINGLY],()=>()=>(0,u.bool)(!1)).booleanTest(()=>(e,r)=>e===r).dateTimeTest(e=>(r,n)=>(0,u.toUTCDate)(r,e.context.getSafe(o.KeysExpressionEvaluator.defaultTimeZone)).getTime()===(0,u.toUTCDate)(n,e.context.getSafe(o.KeysExpressionEvaluator.defaultTimeZone)).getTime()).copy({from:[u.TypeURL.XSD_DATE_TIME,u.TypeURL.XSD_DATE_TIME],to:[u.TypeURL.XSD_DATE,u.TypeURL.XSD_DATE]}).set(["quad","quad"],e=>([r,n])=>(0,u.bool)(this.applyOnTerms([r.subject,n.subject],e).coerceEBV()&&this.applyOnTerms([r.predicate,n.predicate],e).coerceEBV()&&this.applyOnTerms([r.object,n.object],e).coerceEBV()&&this.applyOnTerms([r.graph,n.graph],e).coerceEBV()),!1).set(["term","term"],e=>([r,n])=>{const c=r.toRDF(e.context.getSafe(o.KeysInitQuery.dataFactory)),s=n.toRDF(e.context.getSafe(o.KeysInitQuery.dataFactory)),l=c.equals(s);if(!l&&c.termType==="Literal"&&s.termType==="Literal")throw new u.RDFEqualTypeError([r,n]);return(0,u.bool)(l)},!1).set([u.TypeURL.XSD_DURATION,u.TypeURL.XSD_DURATION],()=>([e,r])=>(0,u.bool)((0,u.yearMonthDurationsToMonths)((0,u.defaultedYearMonthDurationRepresentation)(e.typedValue))===(0,u.yearMonthDurationsToMonths)((0,u.defaultedYearMonthDurationRepresentation)(r.typedValue))&&(0,u.dayTimeDurationsToSeconds)((0,u.defaultedDayTimeDurationRepresentation)(e.typedValue))===(0,u.dayTimeDurationsToSeconds)((0,u.defaultedDayTimeDurationRepresentation)(r.typedValue)))).set([u.TypeURL.XSD_TIME,u.TypeURL.XSD_TIME],e=>([r,n])=>(0,u.bool)((0,u.toUTCDate)((0,u.defaultedDateTimeRepresentation)(r.typedValue),e.context.getSafe(o.KeysExpressionEvaluator.defaultTimeZone)).getTime()===(0,u.toUTCDate)((0,u.defaultedDateTimeRepresentation)(n.typedValue),e.context.getSafe(o.KeysExpressionEvaluator.defaultTimeZone)).getTime())).collect()})}};return _s.TermFunctionEquality=a,_s}var rO;function JL(){if(rO)return ys;rO=1,Object.defineProperty(ys,"__esModule",{value:!0}),ys.ActorFunctionFactoryTermEquality=void 0;const i=w(),o=S(),u=GL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.EQUAL],termFunction:!0})}async run(e){return new u.TermFunctionEquality}};return ys.ActorFunctionFactoryTermEquality=a,ys}var nO;function KL(){return nO||(nO=1,(function(i){var o=Qr&&Qr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Qr&&Qr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(JL(),i)})(Qr)),Qr}var Nr={},ms={},bs={},aO;function YL(){if(aO)return bs;aO=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.TermFunctionFloor=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.FLOOR,overloads:(0,o.declare)(o.SparqlOperator.FLOOR).numericConverter(()=>t=>Math.floor(t)).collect()})}};return bs.TermFunctionFloor=u,bs}var iO;function WL(){if(iO)return ms;iO=1,Object.defineProperty(ms,"__esModule",{value:!0}),ms.ActorFunctionFactoryTermFloor=void 0;const i=w(),o=S(),u=YL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.FLOOR],termFunction:!0})}async run(e){return new u.TermFunctionFloor}};return ms.ActorFunctionFactoryTermFloor=a,ms}var oO;function ZL(){return oO||(oO=1,(function(i){var o=Nr&&Nr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Nr&&Nr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(WL(),i)})(Nr)),Nr}var Cr={},gs={},hs={},uO;function kL(){if(uO)return hs;uO=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.TermFunctionHours=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.HOURS,overloads:(0,o.declare)(o.SparqlOperator.HOURS).onDateTime1(()=>t=>(0,o.integer)(t.typedValue.hours)).set([o.TypeURL.XSD_TIME],()=>([t])=>(0,o.integer)(t.typedValue.hours)).collect()})}};return hs.TermFunctionHours=u,hs}var cO;function eI(){if(cO)return gs;cO=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.ActorFunctionFactoryTermHours=void 0;const i=w(),o=S(),u=kL();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.HOURS],termFunction:!0})}async run(e){return new u.TermFunctionHours}};return gs.ActorFunctionFactoryTermHours=a,gs}var sO;function tI(){return sO||(sO=1,(function(i){var o=Cr&&Cr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Cr&&Cr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(eI(),i)})(Cr)),Cr}var Ur={},vs={},Ts={},dO;function rI(){if(dO)return Ts;dO=1,Object.defineProperty(Ts,"__esModule",{value:!0}),Ts.TermFunctionIri=void 0;const i=w(),o=q(),u=S(),a=a_();let t=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:u.SparqlOperator.IRI,overloads:(0,u.declare)(u.SparqlOperator.IRI).set(["namedNode"],r=>n=>{const c=n[0],s=(0,a.resolve)(c.str(),r.context.get(o.KeysInitQuery.baseIRI)??"");return new u.NamedNode(s)}).onString1(r=>n=>{const c=(0,a.resolve)(n.str(),r.context.get(o.KeysInitQuery.baseIRI)??"");return new u.NamedNode(c)}).collect()})}};return Ts.TermFunctionIri=t,Ts}var lO;function nI(){if(lO)return vs;lO=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.ActorFunctionFactoryTermIri=void 0;const i=w(),o=S(),u=rI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.IRI,o.SparqlOperator.URI],termFunction:!0})}async run(e){return new u.TermFunctionIri}};return vs.ActorFunctionFactoryTermIri=a,vs}var fO;function aI(){return fO||(fO=1,(function(i){var o=Ur&&Ur.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ur&&Ur.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(nI(),i)})(Ur)),Ur}var Hr={},Os={},As={},pO;function iI(){if(pO)return As;pO=1,Object.defineProperty(As,"__esModule",{value:!0}),As.TermFunctionIsBlank=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.IS_BLANK,overloads:(0,o.declare)(o.SparqlOperator.IS_BLANK).onTerm1(()=>t=>(0,o.bool)(t.termType==="blankNode")).collect()})}};return As.TermFunctionIsBlank=u,As}var yO;function oI(){if(yO)return Os;yO=1,Object.defineProperty(Os,"__esModule",{value:!0}),Os.ActorFunctionFactoryTermIsBlank=void 0;const i=w(),o=S(),u=iI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.IS_BLANK],termFunction:!0})}async run(e){return new u.TermFunctionIsBlank}};return Os.ActorFunctionFactoryTermIsBlank=a,Os}var _O;function uI(){return _O||(_O=1,(function(i){var o=Hr&&Hr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Hr&&Hr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(oI(),i)})(Hr)),Hr}var Vr={},Ss={},Fs={},mO;function cI(){if(mO)return Fs;mO=1,Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.TermFunctionIsIri=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.IS_IRI,overloads:(0,o.declare)(o.SparqlOperator.IS_IRI).onTerm1(()=>t=>(0,o.bool)(t.termType==="namedNode")).collect()})}};return Fs.TermFunctionIsIri=u,Fs}var bO;function sI(){if(bO)return Ss;bO=1,Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.ActorFunctionFactoryTermIsIri=void 0;const i=w(),o=S(),u=cI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.IS_IRI,o.SparqlOperator.IS_URI],termFunction:!0})}async run(e){return new u.TermFunctionIsIri}};return Ss.ActorFunctionFactoryTermIsIri=a,Ss}var gO;function dI(){return gO||(gO=1,(function(i){var o=Vr&&Vr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Vr&&Vr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(sI(),i)})(Vr)),Vr}var zr={},ws={},Rs={},hO;function lI(){if(hO)return Rs;hO=1,Object.defineProperty(Rs,"__esModule",{value:!0}),Rs.TermFunctionIsLiteral=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.IS_LITERAL,overloads:(0,o.declare)(o.SparqlOperator.IS_LITERAL).onTerm1(()=>t=>(0,o.bool)(t.termType==="literal")).collect()})}};return Rs.TermFunctionIsLiteral=u,Rs}var vO;function fI(){if(vO)return ws;vO=1,Object.defineProperty(ws,"__esModule",{value:!0}),ws.ActorFunctionFactoryTermIsLiteral=void 0;const i=w(),o=S(),u=lI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.IS_LITERAL],termFunction:!0})}async run(e){return new u.TermFunctionIsLiteral}};return ws.ActorFunctionFactoryTermIsLiteral=a,ws}var TO;function pI(){return TO||(TO=1,(function(i){var o=zr&&zr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=zr&&zr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(fI(),i)})(zr)),zr}var Xr={},Ps={},qs={},OO;function yI(){if(OO)return qs;OO=1,Object.defineProperty(qs,"__esModule",{value:!0}),qs.TermFunctionIsNumeric=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.IS_NUMERIC,overloads:(0,o.declare)(o.SparqlOperator.IS_NUMERIC).onNumeric1(()=>()=>(0,o.bool)(!0)).onTerm1(()=>()=>(0,o.bool)(!1)).collect()})}};return qs.TermFunctionIsNumeric=u,qs}var AO;function _I(){if(AO)return Ps;AO=1,Object.defineProperty(Ps,"__esModule",{value:!0}),Ps.ActorFunctionFactoryTermIsNumeric=void 0;const i=w(),o=S(),u=yI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.IS_NUMERIC],termFunction:!0})}async run(e){return new u.TermFunctionIsNumeric}};return Ps.ActorFunctionFactoryTermIsNumeric=a,Ps}var SO;function mI(){return SO||(SO=1,(function(i){var o=Xr&&Xr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Xr&&Xr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(_I(),i)})(Xr)),Xr}var Gr={},js={},Ms={},FO;function bI(){if(FO)return Ms;FO=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.TermFunctionIsTriple=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.IS_TRIPLE,overloads:(0,o.declare)(o.SparqlOperator.IS_TRIPLE).onTerm1(()=>t=>(0,o.bool)(t.termType==="quad")).collect()})}};return Ms.TermFunctionIsTriple=u,Ms}var wO;function gI(){if(wO)return js;wO=1,Object.defineProperty(js,"__esModule",{value:!0}),js.ActorFunctionFactoryTermIsTriple=void 0;const i=w(),o=S(),u=bI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.IS_TRIPLE],termFunction:!0})}async run(e){return new u.TermFunctionIsTriple}};return js.ActorFunctionFactoryTermIsTriple=a,js}var RO;function hI(){return RO||(RO=1,(function(i){var o=Gr&&Gr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Gr&&Gr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(gI(),i)})(Gr)),Gr}var Jr={},xs={},Ds={},PO;function vI(){if(PO)return Ds;PO=1,Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.TermFunctionLang=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.LANG,overloads:(0,o.declare)(o.SparqlOperator.LANG).onLiteral1(()=>t=>(0,o.string)(t.language??"")).collect()})}};return Ds.TermFunctionLang=u,Ds}var qO;function TI(){if(qO)return xs;qO=1,Object.defineProperty(xs,"__esModule",{value:!0}),xs.ActorFunctionFactoryTermLang=void 0;const i=w(),o=S(),u=vI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.LANG],termFunction:!0})}async run(e){return new u.TermFunctionLang}};return xs.ActorFunctionFactoryTermLang=a,xs}var jO;function OI(){return jO||(jO=1,(function(i){var o=Jr&&Jr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Jr&&Jr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(TI(),i)})(Jr)),Jr}var Kr={},Es={},Ls={},MO;function AI(){if(MO)return Ls;MO=1,Object.defineProperty(Ls,"__esModule",{value:!0}),Ls.TermFunctionLangmatches=void 0;const i=w(),o=S();let u=class bo extends i.TermFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.LANG_MATCHES,overloads:(0,o.declare)(o.SparqlOperator.LANG_MATCHES).onBinaryTyped([o.TypeURL.XSD_STRING,o.TypeURL.XSD_STRING],()=>(t,e)=>(0,o.bool)(bo.langMatches(t,e))).collect()})}static langMatches(t,e){const r=t.split("-"),n=e.split("-");if(!bo.matchLangTag(n[0],r[0])&&!bo.isWildCard(r[0]))return!1;let c=1,s=1;for(;s<n.length;){if(bo.isWildCard(n[s])){s++;continue}if(c===r.length)return!1;if(bo.matchLangTag(n[s],r[c])){c++,s++;continue}if(r[c].length===1)return!1;c++}return!0}static isWildCard(t){return t==="*"}static matchLangTag(t,e){return new RegExp(`/${t}/`,"iu").test(`/${e}/`)}};return Ls.TermFunctionLangmatches=u,Ls}var xO;function SI(){if(xO)return Es;xO=1,Object.defineProperty(Es,"__esModule",{value:!0}),Es.ActorFunctionFactoryTermLangmatches=void 0;const i=w(),o=S(),u=AI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.LANG_MATCHES],termFunction:!0})}async run(e){return new u.TermFunctionLangmatches}};return Es.ActorFunctionFactoryTermLangmatches=a,Es}var DO;function FI(){return DO||(DO=1,(function(i){var o=Kr&&Kr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Kr&&Kr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(SI(),i)})(Kr)),Kr}var Yr={},Is={},$s={},EO;function wI(){if(EO)return $s;EO=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.TermFunctionLcase=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.LCASE,overloads:(0,o.declare)(o.SparqlOperator.LCASE).onString1Typed(()=>t=>(0,o.string)(t.toLowerCase())).onLangString1(()=>t=>(0,o.langString)(t.typedValue.toLowerCase(),t.language)).collect()})}};return $s.TermFunctionLcase=u,$s}var LO;function RI(){if(LO)return Is;LO=1,Object.defineProperty(Is,"__esModule",{value:!0}),Is.ActorFunctionFactoryTermLcase=void 0;const i=w(),o=S(),u=wI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.LCASE],termFunction:!0})}async run(e){return new u.TermFunctionLcase}};return Is.ActorFunctionFactoryTermLcase=a,Is}var IO;function PI(){return IO||(IO=1,(function(i){var o=Yr&&Yr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Yr&&Yr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(RI(),i)})(Yr)),Yr}var Wr={},Bs={},Qs={},$O;function qI(){if($O)return Qs;$O=1,Object.defineProperty(Qs,"__esModule",{value:!0}),Qs.TermFunctionMd5=void 0;const i=w(),o=S(),u=px();let a=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.MD5,overloads:(0,o.declare)(o.SparqlOperator.MD5).onString1Typed(()=>e=>(0,o.string)((0,u.hash)(e))).collect()})}};return Qs.TermFunctionMd5=a,Qs}var BO;function jI(){if(BO)return Bs;BO=1,Object.defineProperty(Bs,"__esModule",{value:!0}),Bs.ActorFunctionFactoryTermMd5=void 0;const i=w(),o=S(),u=qI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.MD5],termFunction:!0})}async run(e){return new u.TermFunctionMd5}};return Bs.ActorFunctionFactoryTermMd5=a,Bs}var QO;function MI(){return QO||(QO=1,(function(i){var o=Wr&&Wr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Wr&&Wr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(jI(),i)})(Wr)),Wr}var Zr={},Ns={},Cs={},NO;function xI(){if(NO)return Cs;NO=1,Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.TermFunctionMinutes=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.MINUTES,overloads:(0,o.declare)(o.SparqlOperator.MINUTES).onDateTime1(()=>t=>(0,o.integer)(t.typedValue.minutes)).set([o.TypeURL.XSD_TIME],()=>([t])=>(0,o.integer)(t.typedValue.minutes)).collect()})}};return Cs.TermFunctionMinutes=u,Cs}var CO;function DI(){if(CO)return Ns;CO=1,Object.defineProperty(Ns,"__esModule",{value:!0}),Ns.ActorFunctionFactoryTermMinutes=void 0;const i=w(),o=S(),u=xI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.MINUTES],termFunction:!0})}async run(e){return new u.TermFunctionMinutes}};return Ns.ActorFunctionFactoryTermMinutes=a,Ns}var UO;function EI(){return UO||(UO=1,(function(i){var o=Zr&&Zr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Zr&&Zr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(DI(),i)})(Zr)),Zr}var kr={},Us={},Hs={},HO;function LI(){if(HO)return Hs;HO=1,Object.defineProperty(Hs,"__esModule",{value:!0}),Hs.TermFunctionMonth=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.MONTH,overloads:(0,o.declare)(o.SparqlOperator.MONTH).onDateTime1(()=>t=>(0,o.integer)(t.typedValue.month)).set([o.TypeURL.XSD_DATE],()=>([t])=>(0,o.integer)(t.typedValue.month)).collect()})}};return Hs.TermFunctionMonth=u,Hs}var VO;function II(){if(VO)return Us;VO=1,Object.defineProperty(Us,"__esModule",{value:!0}),Us.ActorFunctionFactoryTermMonth=void 0;const i=w(),o=S(),u=LI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.MONTH],termFunction:!0})}async run(e){return new u.TermFunctionMonth}};return Us.ActorFunctionFactoryTermMonth=a,Us}var zO;function $I(){return zO||(zO=1,(function(i){var o=kr&&kr.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=kr&&kr.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(II(),i)})(kr)),kr}var en={},Vs={},zs={},XO;function BI(){if(XO)return zs;XO=1,Object.defineProperty(zs,"__esModule",{value:!0}),zs.TermFunctionMultiplication=void 0;const i=w(),o=S(),u=i_();let a=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.MULTIPLICATION,overloads:(0,o.declare)(o.SparqlOperator.MULTIPLICATION).arithmetic(()=>(e,r)=>new u.BigNumber(e).times(r).toNumber()).collect()})}};return zs.TermFunctionMultiplication=a,zs}var GO;function QI(){if(GO)return Vs;GO=1,Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.ActorFunctionFactoryTermMultiplication=void 0;const i=w(),o=S(),u=BI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.MULTIPLICATION],termFunction:!0})}async run(e){return new u.TermFunctionMultiplication}};return Vs.ActorFunctionFactoryTermMultiplication=a,Vs}var JO;function NI(){return JO||(JO=1,(function(i){var o=en&&en.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=en&&en.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(QI(),i)})(en)),en}var tn={},Xs={},Gs={},KO;function CI(){if(KO)return Gs;KO=1,Object.defineProperty(Gs,"__esModule",{value:!0}),Gs.TermFunctionNot=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.NOT,overloads:(0,o.declare)(o.SparqlOperator.NOT).onTerm1(()=>t=>(0,o.bool)(!t.coerceEBV())).collect()})}};return Gs.TermFunctionNot=u,Gs}var YO;function UI(){if(YO)return Xs;YO=1,Object.defineProperty(Xs,"__esModule",{value:!0}),Xs.ActorFunctionFactoryTermNot=void 0;const i=w(),o=S(),u=CI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.NOT],termFunction:!0})}async run(e){return new u.TermFunctionNot}};return Xs.ActorFunctionFactoryTermNot=a,Xs}var WO;function HI(){return WO||(WO=1,(function(i){var o=tn&&tn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=tn&&tn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(UI(),i)})(tn)),tn}var rn={},Js={},Ks={},ZO;function VI(){if(ZO)return Ks;ZO=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.TermFunctionNow=void 0;const i=w(),o=q(),u=S();let a=class extends i.TermFunctionBase{constructor(){super({arity:0,operator:u.SparqlOperator.NOW,overloads:(0,u.declare)(u.SparqlOperator.NOW).set([],e=>()=>new u.DateTimeLiteral((0,u.toDateTimeRepresentation)({date:e.context.getSafe(o.KeysInitQuery.queryTimestamp),timeZone:e.context.getSafe(o.KeysExpressionEvaluator.defaultTimeZone)}))).collect()})}};return Ks.TermFunctionNow=a,Ks}var kO;function zI(){if(kO)return Js;kO=1,Object.defineProperty(Js,"__esModule",{value:!0}),Js.ActorFunctionFactoryTermNow=void 0;const i=w(),o=S(),u=VI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.NOW],termFunction:!0})}async run(e){return new u.TermFunctionNow}};return Js.ActorFunctionFactoryTermNow=a,Js}var eA;function XI(){return eA||(eA=1,(function(i){var o=rn&&rn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=rn&&rn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(zI(),i)})(rn)),rn}var nn={},Ys={},Ws={},tA;function GI(){if(tA)return Ws;tA=1,Object.defineProperty(Ws,"__esModule",{value:!0}),Ws.TermFunctionObject=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.OBJECT,overloads:(0,o.declare)(o.SparqlOperator.OBJECT).onQuad1(()=>t=>t.object).collect()})}};return Ws.TermFunctionObject=u,Ws}var rA;function JI(){if(rA)return Ys;rA=1,Object.defineProperty(Ys,"__esModule",{value:!0}),Ys.ActorFunctionFactoryTermObject=void 0;const i=w(),o=S(),u=GI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.OBJECT],termFunction:!0})}async run(e){return new u.TermFunctionObject}};return Ys.ActorFunctionFactoryTermObject=a,Ys}var nA;function KI(){return nA||(nA=1,(function(i){var o=nn&&nn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=nn&&nn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(JI(),i)})(nn)),nn}var an={},Zs={},ks={},aA;function YI(){if(aA)return ks;aA=1,Object.defineProperty(ks,"__esModule",{value:!0}),ks.TermFunctionPredicate=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.PREDICATE,overloads:(0,o.declare)(o.SparqlOperator.PREDICATE).onQuad1(()=>t=>t.predicate).collect()})}};return ks.TermFunctionPredicate=u,ks}var iA;function WI(){if(iA)return Zs;iA=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.ActorFunctionFactoryTermPredicate=void 0;const i=w(),o=S(),u=YI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.PREDICATE],termFunction:!0})}async run(e){return new u.TermFunctionPredicate}};return Zs.ActorFunctionFactoryTermPredicate=a,Zs}var oA;function ZI(){return oA||(oA=1,(function(i){var o=an&&an.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=an&&an.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(WI(),i)})(an)),an}var on={},ed={},td={},uA;function kI(){if(uA)return td;uA=1,Object.defineProperty(td,"__esModule",{value:!0}),td.TermFunctionRand=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:0,operator:o.SparqlOperator.RAND,overloads:(0,o.declare)(o.SparqlOperator.RAND).set([],()=>()=>(0,o.double)(Math.random())).collect()})}};return td.TermFunctionRand=u,td}var cA;function e$(){if(cA)return ed;cA=1,Object.defineProperty(ed,"__esModule",{value:!0}),ed.ActorFunctionFactoryTermRand=void 0;const i=w(),o=S(),u=kI();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.RAND],termFunction:!0})}async run(e){return new u.TermFunctionRand}};return ed.ActorFunctionFactoryTermRand=a,ed}var sA;function t$(){return sA||(sA=1,(function(i){var o=on&&on.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=on&&on.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(e$(),i)})(on)),on}var un={},rd={},nd={},dA;function Lj(){if(dA)return nd;dA=1,Object.defineProperty(nd,"__esModule",{value:!0}),nd.TermFunctionRegex=void 0;const i=w(),o=S();let u=class xe extends i.TermFunctionBase{constructor(){super({arity:[2,3],operator:o.SparqlOperator.REGEX,overloads:(0,o.declare)(o.SparqlOperator.REGEX).onBinaryTyped([o.TypeAlias.SPARQL_STRINGLY,o.TypeURL.XSD_STRING],xe.regex2).onTernaryTyped([o.TypeAlias.SPARQL_STRINGLY,o.TypeURL.XSD_STRING,o.TypeURL.XSD_STRING],xe.regex3).collect()})}static regex2(){return(t,e)=>(0,o.bool)(xe.matches(t,e))}static regex3(){return(t,e,r)=>(0,o.bool)(xe.matches(t,e,r))}static matches(t,e,r=""){return r=xe.cleanFlags(r),r.includes("x")&&(e=xe.flagX(e)),r.includes("q")&&(e=xe.flagQ(e)),new RegExp(e,r.replaceAll(/[qx]/gu,"")).test(t)}static cleanFlags(t){if(!/^[imsxq]*$/u.test(t))throw new Error("Invalid flags");const e=[...t].find((r,n,c)=>c.indexOf(r)!==n);if(e)throw new Error(`Duplicate flag: ${e}`);return t!=null&&t.includes("q")&&(t=t.replaceAll(/[msx]/gu,"")),`${t}u`}static flagX(t){if(!t)return t;let e=t[0];for(;["	",`
`,"\r"," "].includes(e);)t=t.slice(1),e=t[0];let r=e==="[";for(let n=1;n<t.length;n++){const c=t[n];["	",`
`,"\r"," "].includes(c)&&!r?(t=t.slice(0,n)+t.slice(n+1),n--):c==="["&&e!=="\\"?r=!0:c==="]"&&e!=="\\"&&(r=!1),e=c}return t}static flagQ(t){return t.replaceAll(/([?+*.{}()[\]\\|])/gu,"\\$1").replaceAll(/^\^/gu,"\\^").replaceAll(/\$$/gu,"\\$")}};return nd.TermFunctionRegex=u,nd}var lA;function r$(){if(lA)return rd;lA=1,Object.defineProperty(rd,"__esModule",{value:!0}),rd.ActorFunctionFactoryTermRegex=void 0;const i=w(),o=S(),u=Lj();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.REGEX],termFunction:!0})}async run(e){return new u.TermFunctionRegex}};return rd.ActorFunctionFactoryTermRegex=a,rd}var fA;function Ij(){return fA||(fA=1,(function(i){var o=un&&un.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=un&&un.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(r$(),i),u(Lj(),i)})(un)),un}var cn={},ad={},id={},pA;function n$(){if(pA)return id;pA=1,Object.defineProperty(id,"__esModule",{value:!0}),id.TermFunctionReplace=void 0;const i=Ij(),o=w(),u=S();let a=class Ny extends o.TermFunctionBase{constructor(){super({arity:[3,4],operator:u.SparqlOperator.REPLACE,overloads:(0,u.declare)(u.SparqlOperator.REPLACE).onTernaryTyped([u.TypeURL.XSD_STRING,u.TypeURL.XSD_STRING,u.TypeURL.XSD_STRING],()=>(e,r,n)=>(0,u.string)(Ny.replace(e,r,n))).set([u.TypeURL.RDF_LANG_STRING,u.TypeURL.XSD_STRING,u.TypeURL.XSD_STRING],()=>([e,r,n])=>{const c=Ny.replace(e.typedValue,r.typedValue,n.typedValue);return(0,u.langString)(c,e.language)}).onQuaternaryTyped([u.TypeURL.XSD_STRING,u.TypeURL.XSD_STRING,u.TypeURL.XSD_STRING,u.TypeURL.XSD_STRING],()=>(e,r,n,c)=>(0,u.string)(Ny.replace(e,r,n,c))).set([u.TypeURL.RDF_LANG_STRING,u.TypeURL.XSD_STRING,u.TypeURL.XSD_STRING,u.TypeURL.XSD_STRING],()=>([e,r,n,c])=>{const s=Ny.replace(e.typedValue,r.typedValue,n.typedValue,c.typedValue);return(0,u.langString)(s,e.language)}).collect()})}static replace(e,r,n,c=""){return c=i.TermFunctionRegex.cleanFlags(c),c.includes("x")&&(r=i.TermFunctionRegex.flagX(r)),c.includes("q")?r=i.TermFunctionRegex.flagQ(r):n=n.replaceAll("$0",()=>"$&"),c=`${c.replaceAll(/[qx]/gu,"")}g`,e.replaceAll(new RegExp(r,c),n)}};return id.TermFunctionReplace=a,id}var yA;function a$(){if(yA)return ad;yA=1,Object.defineProperty(ad,"__esModule",{value:!0}),ad.ActorFunctionFactoryTermReplace=void 0;const i=w(),o=S(),u=n$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.REPLACE],termFunction:!0})}async run(e){return new u.TermFunctionReplace}};return ad.ActorFunctionFactoryTermReplace=a,ad}var _A;function i$(){return _A||(_A=1,(function(i){var o=cn&&cn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=cn&&cn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(a$(),i)})(cn)),cn}var sn={},od={},ud={},mA;function o$(){if(mA)return ud;mA=1,Object.defineProperty(ud,"__esModule",{value:!0}),ud.TermFunctionRound=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.ROUND,overloads:(0,o.declare)(o.SparqlOperator.ROUND).numericConverter(()=>t=>Math.round(t)).collect()})}};return ud.TermFunctionRound=u,ud}var bA;function u$(){if(bA)return od;bA=1,Object.defineProperty(od,"__esModule",{value:!0}),od.ActorFunctionFactoryTermRound=void 0;const i=w(),o=S(),u=o$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.ROUND],termFunction:!0})}async run(e){return new u.TermFunctionRound}};return od.ActorFunctionFactoryTermRound=a,od}var gA;function c$(){return gA||(gA=1,(function(i){var o=sn&&sn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=sn&&sn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(u$(),i)})(sn)),sn}var dn={},cd={},sd={},hA;function s$(){if(hA)return sd;hA=1,Object.defineProperty(sd,"__esModule",{value:!0}),sd.TermFunctionSeconds=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.SECONDS,overloads:(0,o.declare)(o.SparqlOperator.SECONDS).onDateTime1(()=>t=>(0,o.decimal)(t.typedValue.seconds)).set([o.TypeURL.XSD_TIME],()=>([t])=>(0,o.integer)(t.typedValue.seconds)).collect()})}};return sd.TermFunctionSeconds=u,sd}var vA;function d$(){if(vA)return cd;vA=1,Object.defineProperty(cd,"__esModule",{value:!0}),cd.ActorFunctionFactoryTermSeconds=void 0;const i=w(),o=S(),u=s$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.SECONDS],termFunction:!0})}async run(e){return new u.TermFunctionSeconds}};return cd.ActorFunctionFactoryTermSeconds=a,cd}var TA;function l$(){return TA||(TA=1,(function(i){var o=dn&&dn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=dn&&dn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(d$(),i)})(dn)),dn}var ln={},dd={},ld={},OA;function f$(){if(OA)return ld;OA=1,Object.defineProperty(ld,"__esModule",{value:!0}),ld.TermFunctionSha1=void 0;const i=w(),o=S(),u=o_();let a=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.SHA1,overloads:(0,o.declare)(o.SparqlOperator.SHA1).onString1Typed(()=>e=>(0,o.string)((0,u.sha1)().update(e).digest("hex"))).collect()})}};return ld.TermFunctionSha1=a,ld}var AA;function p$(){if(AA)return dd;AA=1,Object.defineProperty(dd,"__esModule",{value:!0}),dd.ActorFunctionFactoryTermSha1=void 0;const i=w(),o=S(),u=f$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.SHA1],termFunction:!0})}async run(e){return new u.TermFunctionSha1}};return dd.ActorFunctionFactoryTermSha1=a,dd}var SA;function y$(){return SA||(SA=1,(function(i){var o=ln&&ln.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ln&&ln.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(p$(),i)})(ln)),ln}var fn={},fd={},pd={},FA;function _$(){if(FA)return pd;FA=1,Object.defineProperty(pd,"__esModule",{value:!0}),pd.TermFunctionSha256=void 0;const i=w(),o=S(),u=o_();let a=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.SHA256,overloads:(0,o.declare)(o.SparqlOperator.SHA256).onString1Typed(()=>e=>(0,o.string)((0,u.sha256)().update(e).digest("hex"))).collect()})}};return pd.TermFunctionSha256=a,pd}var wA;function m$(){if(wA)return fd;wA=1,Object.defineProperty(fd,"__esModule",{value:!0}),fd.ActorFunctionFactoryTermSha256=void 0;const i=w(),o=S(),u=_$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.SHA256],termFunction:!0})}async run(e){return new u.TermFunctionSha256}};return fd.ActorFunctionFactoryTermSha256=a,fd}var RA;function b$(){return RA||(RA=1,(function(i){var o=fn&&fn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=fn&&fn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(m$(),i)})(fn)),fn}var pn={},yd={},_d={},PA;function g$(){if(PA)return _d;PA=1,Object.defineProperty(_d,"__esModule",{value:!0}),_d.TermFunctionSha384=void 0;const i=w(),o=S(),u=o_();let a=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.SHA384,overloads:(0,o.declare)(o.SparqlOperator.SHA384).onString1Typed(()=>e=>(0,o.string)((0,u.sha384)().update(e).digest("hex"))).collect()})}};return _d.TermFunctionSha384=a,_d}var qA;function h$(){if(qA)return yd;qA=1,Object.defineProperty(yd,"__esModule",{value:!0}),yd.ActorFunctionFactoryTermSha384=void 0;const i=w(),o=S(),u=g$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.SHA384],termFunction:!0})}async run(e){return new u.TermFunctionSha384}};return yd.ActorFunctionFactoryTermSha384=a,yd}var jA;function v$(){return jA||(jA=1,(function(i){var o=pn&&pn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=pn&&pn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(h$(),i)})(pn)),pn}var yn={},md={},bd={},MA;function T$(){if(MA)return bd;MA=1,Object.defineProperty(bd,"__esModule",{value:!0}),bd.TermFunctionSha512=void 0;const i=w(),o=S(),u=o_();let a=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.SHA512,overloads:(0,o.declare)(o.SparqlOperator.SHA512).onString1Typed(()=>e=>(0,o.string)((0,u.sha512)().update(e).digest("hex"))).collect()})}};return bd.TermFunctionSha512=a,bd}var xA;function O$(){if(xA)return md;xA=1,Object.defineProperty(md,"__esModule",{value:!0}),md.ActorFunctionFactoryTermSha512=void 0;const i=w(),o=S(),u=T$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.SHA512],termFunction:!0})}async run(e){return new u.TermFunctionSha512}};return md.ActorFunctionFactoryTermSha512=a,md}var DA;function A$(){return DA||(DA=1,(function(i){var o=yn&&yn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=yn&&yn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(O$(),i)})(yn)),yn}var _n={},gd={},hd={},EA;function S$(){if(EA)return hd;EA=1,Object.defineProperty(hd,"__esModule",{value:!0}),hd.TermFunctionStrAfter=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.STRAFTER,overloads:(0,o.declare)(o.SparqlOperator.STRAFTER).onBinaryTyped([o.TypeURL.XSD_STRING,o.TypeURL.XSD_STRING],()=>(t,e)=>(0,o.string)(t.slice(t.indexOf(e)).slice(e.length))).onBinary([o.TypeURL.RDF_LANG_STRING,o.TypeURL.XSD_STRING],()=>(t,e)=>{const[r,n]=[t.typedValue,e.typedValue],c=r.slice(r.indexOf(n)).slice(n.length);return c||!n?(0,o.langString)(c,t.language):(0,o.string)(c)}).onBinary([o.TypeURL.RDF_LANG_STRING,o.TypeURL.RDF_LANG_STRING],()=>(t,e)=>{if(t.language!==e.language)throw new o.IncompatibleLanguageOperation(t,e);const[r,n]=[t.typedValue,e.typedValue],c=r.slice(r.indexOf(n)).slice(n.length);return c||!n?(0,o.langString)(c,t.language):(0,o.string)(c)}).collect()})}};return hd.TermFunctionStrAfter=u,hd}var LA;function F$(){if(LA)return gd;LA=1,Object.defineProperty(gd,"__esModule",{value:!0}),gd.ActorFunctionFactoryTermStrAfter=void 0;const i=w(),o=S(),u=S$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.STRAFTER],termFunction:!0})}async run(e){return new u.TermFunctionStrAfter}};return gd.ActorFunctionFactoryTermStrAfter=a,gd}var IA;function w$(){return IA||(IA=1,(function(i){var o=_n&&_n.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=_n&&_n.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(F$(),i)})(_n)),_n}var mn={},vd={},Td={},$A;function R$(){if($A)return Td;$A=1,Object.defineProperty(Td,"__esModule",{value:!0}),Td.TermFunctionStrBefore=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.STRBEFORE,overloads:(0,o.declare)(o.SparqlOperator.STRBEFORE).onBinaryTyped([o.TypeURL.XSD_STRING,o.TypeURL.XSD_STRING],()=>(t,e)=>(0,o.string)(t.slice(0,Math.max(0,t.indexOf(e))))).onBinary([o.TypeURL.RDF_LANG_STRING,o.TypeURL.XSD_STRING],()=>(t,e)=>{const[r,n]=[t.typedValue,e.typedValue],c=t.typedValue.slice(0,Math.max(0,r.indexOf(n)));return c||!n?(0,o.langString)(c,t.language):(0,o.string)(c)}).onBinary([o.TypeURL.RDF_LANG_STRING,o.TypeURL.RDF_LANG_STRING],()=>(t,e)=>{if(t.language!==e.language)throw new o.IncompatibleLanguageOperation(t,e);const[r,n]=[t.typedValue,e.typedValue],c=t.typedValue.slice(0,Math.max(0,r.indexOf(n)));return c||!n?(0,o.langString)(c,t.language):(0,o.string)(c)}).collect()})}};return Td.TermFunctionStrBefore=u,Td}var BA;function P$(){if(BA)return vd;BA=1,Object.defineProperty(vd,"__esModule",{value:!0}),vd.ActorFunctionFactoryTermStrBefore=void 0;const i=w(),o=S(),u=R$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.STRBEFORE],termFunction:!0})}async run(e){return new u.TermFunctionStrBefore}};return vd.ActorFunctionFactoryTermStrBefore=a,vd}var QA;function q$(){return QA||(QA=1,(function(i){var o=mn&&mn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=mn&&mn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(P$(),i)})(mn)),mn}var bn={},Od={},Ad={},NA;function j$(){if(NA)return Ad;NA=1,Object.defineProperty(Ad,"__esModule",{value:!0}),Ad.TermFunctionStrDt=void 0;const i=w(),o=q(),u=S();let a=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:u.SparqlOperator.STRDT,overloads:(0,u.declare)(u.SparqlOperator.STRDT).set([u.TypeURL.XSD_STRING,"namedNode"],e=>([r,n])=>{const c=e.context.getSafe(o.KeysInitQuery.dataFactory),s=c.literal(r.typedValue,c.namedNode(n.value));return new u.TermTransformer(e.context.getSafe(o.KeysExpressionEvaluator.superTypeProvider)).transformLiteral(s)}).collect()})}};return Ad.TermFunctionStrDt=a,Ad}var CA;function M$(){if(CA)return Od;CA=1,Object.defineProperty(Od,"__esModule",{value:!0}),Od.ActorFunctionFactoryTermStrDt=void 0;const i=w(),o=S(),u=j$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.STRDT],termFunction:!0})}async run(e){return new u.TermFunctionStrDt}};return Od.ActorFunctionFactoryTermStrDt=a,Od}var UA;function x$(){return UA||(UA=1,(function(i){var o=bn&&bn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=bn&&bn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(M$(),i)})(bn)),bn}var gn={},Sd={},Fd={},HA;function D$(){if(HA)return Fd;HA=1,Object.defineProperty(Fd,"__esModule",{value:!0}),Fd.TermFunctionStrEnds=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.STRENDS,overloads:(0,o.declare)(o.SparqlOperator.STRENDS).onBinaryTyped([o.TypeAlias.SPARQL_STRINGLY,o.TypeURL.XSD_STRING],()=>(t,e)=>(0,o.bool)(t.endsWith(e))).onBinary([o.TypeURL.RDF_LANG_STRING,o.TypeURL.RDF_LANG_STRING],()=>(t,e)=>{if(t.language!==e.language)throw new o.IncompatibleLanguageOperation(t,e);return(0,o.bool)(t.typedValue.endsWith(e.typedValue))}).collect()})}};return Fd.TermFunctionStrEnds=u,Fd}var VA;function E$(){if(VA)return Sd;VA=1,Object.defineProperty(Sd,"__esModule",{value:!0}),Sd.ActorFunctionFactoryTermStrEnds=void 0;const i=w(),o=S(),u=D$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.STRENDS],termFunction:!0})}async run(e){return new u.TermFunctionStrEnds}};return Sd.ActorFunctionFactoryTermStrEnds=a,Sd}var zA;function L$(){return zA||(zA=1,(function(i){var o=gn&&gn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=gn&&gn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(E$(),i)})(gn)),gn}var hn={},wd={},Rd={},XA;function I$(){if(XA)return Rd;XA=1,Object.defineProperty(Rd,"__esModule",{value:!0}),Rd.TermFunctionStrLang=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.STRLANG,overloads:(0,o.declare)(o.SparqlOperator.STRLANG).onBinaryTyped([o.TypeURL.XSD_STRING,o.TypeURL.XSD_STRING],()=>(t,e)=>new o.LangStringLiteral(t,e.toLowerCase())).collect()})}};return Rd.TermFunctionStrLang=u,Rd}var GA;function $$(){if(GA)return wd;GA=1,Object.defineProperty(wd,"__esModule",{value:!0}),wd.ActorFunctionFactoryTermStrLang=void 0;const i=w(),o=S(),u=I$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.STRLANG],termFunction:!0})}async run(e){return new u.TermFunctionStrLang}};return wd.ActorFunctionFactoryTermStrLang=a,wd}var JA;function B$(){return JA||(JA=1,(function(i){var o=hn&&hn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=hn&&hn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u($$(),i)})(hn)),hn}var vn={},Pd={},qd={},KA;function Q$(){if(KA)return qd;KA=1,Object.defineProperty(qd,"__esModule",{value:!0}),qd.TermFunctionStrLen=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.STRLEN,overloads:(0,o.declare)(o.SparqlOperator.STRLEN).onStringly1(()=>t=>(0,o.integer)([...t.typedValue].length)).collect()})}};return qd.TermFunctionStrLen=u,qd}var YA;function N$(){if(YA)return Pd;YA=1,Object.defineProperty(Pd,"__esModule",{value:!0}),Pd.ActorFunctionFactoryTermStrLen=void 0;const i=w(),o=S(),u=Q$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.STRLEN],termFunction:!0})}async run(e){return new u.TermFunctionStrLen}};return Pd.ActorFunctionFactoryTermStrLen=a,Pd}var WA;function C$(){return WA||(WA=1,(function(i){var o=vn&&vn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=vn&&vn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(N$(),i)})(vn)),vn}var Tn={},jd={},Md={},ZA;function U$(){if(ZA)return Md;ZA=1,Object.defineProperty(Md,"__esModule",{value:!0}),Md.TermFunctionStrStarts=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:o.SparqlOperator.STRSTARTS,overloads:(0,o.declare)(o.SparqlOperator.STRSTARTS).onBinaryTyped([o.TypeAlias.SPARQL_STRINGLY,o.TypeURL.XSD_STRING],()=>(t,e)=>(0,o.bool)(t.startsWith(e))).onBinary([o.TypeURL.RDF_LANG_STRING,o.TypeURL.RDF_LANG_STRING],()=>(t,e)=>{if(t.language!==e.language)throw new o.IncompatibleLanguageOperation(t,e);return(0,o.bool)(t.typedValue.startsWith(e.typedValue))}).collect()})}};return Md.TermFunctionStrStarts=u,Md}var kA;function H$(){if(kA)return jd;kA=1,Object.defineProperty(jd,"__esModule",{value:!0}),jd.ActorFunctionFactoryTermStrStarts=void 0;const i=w(),o=S(),u=U$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.STRSTARTS],termFunction:!0})}async run(e){return new u.TermFunctionStrStarts}};return jd.ActorFunctionFactoryTermStrStarts=a,jd}var eS;function V$(){return eS||(eS=1,(function(i){var o=Tn&&Tn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Tn&&Tn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(H$(),i)})(Tn)),Tn}var On={},xd={},Dd={},tS;function z$(){if(tS)return Dd;tS=1,Object.defineProperty(Dd,"__esModule",{value:!0}),Dd.TermFunctionStrUuid=void 0;const i=w(),o=S(),u=ij();let a=class extends i.TermFunctionBase{constructor(){super({arity:0,operator:o.SparqlOperator.STRUUID,overloads:(0,o.declare)(o.SparqlOperator.STRUUID).set([],()=>()=>(0,o.string)(u.v4())).collect()})}};return Dd.TermFunctionStrUuid=a,Dd}var rS;function X$(){if(rS)return xd;rS=1,Object.defineProperty(xd,"__esModule",{value:!0}),xd.ActorFunctionFactoryTermStrUuid=void 0;const i=w(),o=S(),u=z$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.STRUUID],termFunction:!0})}async run(e){return new u.TermFunctionStrUuid}};return xd.ActorFunctionFactoryTermStrUuid=a,xd}var nS;function G$(){return nS||(nS=1,(function(i){var o=On&&On.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=On&&On.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(X$(),i)})(On)),On}var An={},Ed={},Ld={},aS;function J$(){if(aS)return Ld;aS=1,Object.defineProperty(Ld,"__esModule",{value:!0}),Ld.TermFunctionStr=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.STR,overloads:(0,o.declare)(o.SparqlOperator.STR).onTerm1(()=>t=>(0,o.string)(t.str())).collect()})}};return Ld.TermFunctionStr=u,Ld}var iS;function K$(){if(iS)return Ed;iS=1,Object.defineProperty(Ed,"__esModule",{value:!0}),Ed.ActorFunctionFactoryTermStr=void 0;const i=w(),o=S(),u=J$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.STR],termFunction:!0})}async run(e){return new u.TermFunctionStr}};return Ed.ActorFunctionFactoryTermStr=a,Ed}var oS;function Y$(){return oS||(oS=1,(function(i){var o=An&&An.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=An&&An.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(K$(),i)})(An)),An}var Sn={},Id={},$d={},uS;function W$(){if(uS)return $d;uS=1,Object.defineProperty($d,"__esModule",{value:!0}),$d.TermFunctionSubStr=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:[2,3],operator:o.SparqlOperator.SUBSTR,overloads:(0,o.declare)(o.SparqlOperator.SUBSTR).onBinaryTyped([o.TypeURL.XSD_STRING,o.TypeURL.XSD_INTEGER],()=>(t,e)=>(0,o.string)([...t].slice(e-1).join(""))).onBinary([o.TypeURL.RDF_LANG_STRING,o.TypeURL.XSD_INTEGER],()=>(t,e)=>{const r=[...t.typedValue].slice(e.typedValue-1).join("");return(0,o.langString)(r,t.language)}).onTernaryTyped([o.TypeURL.XSD_STRING,o.TypeURL.XSD_INTEGER,o.TypeURL.XSD_INTEGER],()=>(t,e,r)=>(0,o.string)([...t].slice(e-1,r+e-1).join(""))).onTernary([o.TypeURL.RDF_LANG_STRING,o.TypeURL.XSD_INTEGER,o.TypeURL.XSD_INTEGER],()=>(t,e,r)=>{const n=[...t.typedValue].slice(e.typedValue-1,r.typedValue+e.typedValue-1).join("");return(0,o.langString)(n,t.language)}).collect()})}};return $d.TermFunctionSubStr=u,$d}var cS;function Z$(){if(cS)return Id;cS=1,Object.defineProperty(Id,"__esModule",{value:!0}),Id.ActorFunctionFactoryTermSubStr=void 0;const i=w(),o=S(),u=W$();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.SUBSTR],termFunction:!0})}async run(e){return new u.TermFunctionSubStr}};return Id.ActorFunctionFactoryTermSubStr=a,Id}var sS;function k$(){return sS||(sS=1,(function(i){var o=Sn&&Sn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Sn&&Sn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(Z$(),i)})(Sn)),Sn}var Fn={},Bd={},Qd={},dS;function eB(){if(dS)return Qd;dS=1,Object.defineProperty(Qd,"__esModule",{value:!0}),Qd.TermFunctionSubject=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.SUBJECT,overloads:(0,o.declare)(o.SparqlOperator.SUBJECT).onQuad1(()=>t=>t.subject).collect()})}};return Qd.TermFunctionSubject=u,Qd}var lS;function tB(){if(lS)return Bd;lS=1,Object.defineProperty(Bd,"__esModule",{value:!0}),Bd.ActorFunctionFactoryTermSubject=void 0;const i=w(),o=S(),u=eB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.SUBJECT],termFunction:!0})}async run(e){return new u.TermFunctionSubject}};return Bd.ActorFunctionFactoryTermSubject=a,Bd}var fS;function rB(){return fS||(fS=1,(function(i){var o=Fn&&Fn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Fn&&Fn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(tB(),i)})(Fn)),Fn}var wn={},Nd={},Cd={},pS;function nB(){if(pS)return Cd;pS=1,Object.defineProperty(Cd,"__esModule",{value:!0}),Cd.TermFunctionSubtraction=void 0;const i=w(),o=q(),u=S(),a=i_();let t=class extends i.TermFunctionBase{constructor(){super({arity:2,operator:u.SparqlOperator.SUBTRACTION,overloads:(0,u.declare)(u.SparqlOperator.SUBTRACTION).arithmetic(()=>(r,n)=>new a.BigNumber(r).minus(n).toNumber()).set([u.TypeURL.XSD_DATE_TIME,u.TypeURL.XSD_DATE_TIME],r=>([n,c])=>new u.DayTimeDurationLiteral((0,u.elapsedDuration)(n.typedValue,c.typedValue,r.context.getSafe(o.KeysExpressionEvaluator.defaultTimeZone)))).copy({from:[u.TypeURL.XSD_DATE_TIME,u.TypeURL.XSD_DATE_TIME],to:[u.TypeURL.XSD_DATE,u.TypeURL.XSD_DATE]}).copy({from:[u.TypeURL.XSD_DATE_TIME,u.TypeURL.XSD_DATE_TIME],to:[u.TypeURL.XSD_TIME,u.TypeURL.XSD_TIME]}).set([u.TypeURL.XSD_DATE_TIME,u.TypeURL.XSD_DAY_TIME_DURATION],()=>([r,n])=>new u.DateTimeLiteral((0,u.addDurationToDateTime)(r.typedValue,(0,u.defaultedDurationRepresentation)((0,u.negateDuration)(n.typedValue))))).copy({from:[u.TypeURL.XSD_DATE_TIME,u.TypeURL.XSD_DAY_TIME_DURATION],to:[u.TypeURL.XSD_DATE_TIME,u.TypeURL.XSD_YEAR_MONTH_DURATION]}).set([u.TypeURL.XSD_DATE,u.TypeURL.XSD_DAY_TIME_DURATION],()=>([r,n])=>new u.DateLiteral((0,u.addDurationToDateTime)((0,u.defaultedDateTimeRepresentation)(r.typedValue),(0,u.defaultedDurationRepresentation)((0,u.negateDuration)(n.typedValue))))).copy({from:[u.TypeURL.XSD_DATE,u.TypeURL.XSD_DAY_TIME_DURATION],to:[u.TypeURL.XSD_DATE,u.TypeURL.XSD_YEAR_MONTH_DURATION]}).set([u.TypeURL.XSD_TIME,u.TypeURL.XSD_DAY_TIME_DURATION],()=>([r,n])=>new u.TimeLiteral((0,u.addDurationToDateTime)((0,u.defaultedDateTimeRepresentation)(r.typedValue),(0,u.defaultedDurationRepresentation)((0,u.negateDuration)(n.typedValue))))).collect()})}};return Cd.TermFunctionSubtraction=t,Cd}var yS;function aB(){if(yS)return Nd;yS=1,Object.defineProperty(Nd,"__esModule",{value:!0}),Nd.ActorFunctionFactoryTermSubtraction=void 0;const i=w(),o=S(),u=nB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.SUBTRACTION],termFunction:!0})}async run(e){return new u.TermFunctionSubtraction}};return Nd.ActorFunctionFactoryTermSubtraction=a,Nd}var _S;function iB(){return _S||(_S=1,(function(i){var o=wn&&wn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=wn&&wn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(aB(),i)})(wn)),wn}var Rn={},Ud={},Hd={},mS;function oB(){if(mS)return Hd;mS=1,Object.defineProperty(Hd,"__esModule",{value:!0}),Hd.TermFunctionTimezone=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.TIMEZONE,overloads:(0,o.declare)(o.SparqlOperator.TIMEZONE).onDateTime1(()=>t=>{const e={hours:t.typedValue.zoneHours,minutes:t.typedValue.zoneMinutes};if(e.hours===void 0&&e.minutes===void 0)throw new o.InvalidTimezoneCall(t.str());return new o.DayTimeDurationLiteral(e)}).copy({from:[o.TypeURL.XSD_DATE_TIME],to:[o.TypeURL.XSD_DATE]}).copy({from:[o.TypeURL.XSD_DATE_TIME],to:[o.TypeURL.XSD_TIME]}).collect()})}};return Hd.TermFunctionTimezone=u,Hd}var bS;function uB(){if(bS)return Ud;bS=1,Object.defineProperty(Ud,"__esModule",{value:!0}),Ud.ActorFunctionFactoryTermTimezone=void 0;const i=w(),o=S(),u=oB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.TIMEZONE],termFunction:!0})}async run(e){return new u.TermFunctionTimezone}};return Ud.ActorFunctionFactoryTermTimezone=a,Ud}var gS;function cB(){return gS||(gS=1,(function(i){var o=Rn&&Rn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Rn&&Rn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(uB(),i)})(Rn)),Rn}var Pn={},Vd={},zd={},hS;function sB(){if(hS)return zd;hS=1,Object.defineProperty(zd,"__esModule",{value:!0}),zd.TermFunctionTriple=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:3,operator:o.SparqlOperator.TRIPLE,overloads:(0,o.declare)(o.SparqlOperator.TRIPLE).onTerm3(t=>(...e)=>new o.Quad(e[0],e[1],e[2],new o.DefaultGraph)).collect()})}};return zd.TermFunctionTriple=u,zd}var vS;function dB(){if(vS)return Vd;vS=1,Object.defineProperty(Vd,"__esModule",{value:!0}),Vd.ActorFunctionFactoryTermTriple=void 0;const i=w(),o=S(),u=sB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.TRIPLE],termFunction:!0})}async run(e){return new u.TermFunctionTriple}};return Vd.ActorFunctionFactoryTermTriple=a,Vd}var TS;function lB(){return TS||(TS=1,(function(i){var o=Pn&&Pn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Pn&&Pn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(dB(),i)})(Pn)),Pn}var qn={},Xd={},Gd={},OS;function fB(){if(OS)return Gd;OS=1,Object.defineProperty(Gd,"__esModule",{value:!0}),Gd.TermFunctionTz=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.TZ,overloads:(0,o.declare)(o.SparqlOperator.TZ).onDateTime1(()=>t=>(0,o.string)((0,o.extractRawTimeZone)(t.str()))).copy({from:[o.TypeURL.XSD_DATE_TIME],to:[o.TypeURL.XSD_DATE]}).copy({from:[o.TypeURL.XSD_DATE_TIME],to:[o.TypeURL.XSD_TIME]}).collect()})}};return Gd.TermFunctionTz=u,Gd}var AS;function pB(){if(AS)return Xd;AS=1,Object.defineProperty(Xd,"__esModule",{value:!0}),Xd.ActorFunctionFactoryTermTz=void 0;const i=w(),o=S(),u=fB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.TZ],termFunction:!0})}async run(e){return new u.TermFunctionTz}};return Xd.ActorFunctionFactoryTermTz=a,Xd}var SS;function yB(){return SS||(SS=1,(function(i){var o=qn&&qn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=qn&&qn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(pB(),i)})(qn)),qn}var jn={},Jd={},Kd={},FS;function _B(){if(FS)return Kd;FS=1,Object.defineProperty(Kd,"__esModule",{value:!0}),Kd.TermFunctionUcase=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.UCASE,overloads:(0,o.declare)(o.SparqlOperator.UCASE).onString1Typed(()=>t=>(0,o.string)(t.toUpperCase())).onLangString1(()=>t=>(0,o.langString)(t.typedValue.toUpperCase(),t.language)).collect()})}};return Kd.TermFunctionUcase=u,Kd}var wS;function mB(){if(wS)return Jd;wS=1,Object.defineProperty(Jd,"__esModule",{value:!0}),Jd.ActorFunctionFactoryTermUcase=void 0;const i=w(),o=S(),u=_B();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.UCASE],termFunction:!0})}async run(e){return new u.TermFunctionUcase}};return Jd.ActorFunctionFactoryTermUcase=a,Jd}var RS;function bB(){return RS||(RS=1,(function(i){var o=jn&&jn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=jn&&jn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(mB(),i)})(jn)),jn}var Mn={},Yd={},Wd={},PS;function gB(){if(PS)return Wd;PS=1,Object.defineProperty(Wd,"__esModule",{value:!0}),Wd.TermFunctionUnaryMinus=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.UMINUS,overloads:(0,o.declare)(o.SparqlOperator.UMINUS).numericConverter(()=>t=>-t).collect()})}};return Wd.TermFunctionUnaryMinus=u,Wd}var qS;function hB(){if(qS)return Yd;qS=1,Object.defineProperty(Yd,"__esModule",{value:!0}),Yd.ActorFunctionFactoryTermUnaryMinus=void 0;const i=w(),o=S(),u=gB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.UMINUS],termFunction:!0})}async run(e){return new u.TermFunctionUnaryMinus}};return Yd.ActorFunctionFactoryTermUnaryMinus=a,Yd}var jS;function vB(){return jS||(jS=1,(function(i){var o=Mn&&Mn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Mn&&Mn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(hB(),i)})(Mn)),Mn}var xn={},Zd={},kd={},MS;function TB(){if(MS)return kd;MS=1,Object.defineProperty(kd,"__esModule",{value:!0}),kd.TermFunctionUnaryPlus=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.UPLUS,overloads:(0,o.declare)(o.SparqlOperator.UPLUS).numericConverter(()=>t=>t).collect()})}};return kd.TermFunctionUnaryPlus=u,kd}var xS;function OB(){if(xS)return Zd;xS=1,Object.defineProperty(Zd,"__esModule",{value:!0}),Zd.ActorFunctionFactoryTermUnaryPlus=void 0;const i=w(),o=S(),u=TB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.UPLUS],termFunction:!0})}async run(e){return new u.TermFunctionUnaryPlus}};return Zd.ActorFunctionFactoryTermUnaryPlus=a,Zd}var DS;function AB(){return DS||(DS=1,(function(i){var o=xn&&xn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=xn&&xn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(OB(),i)})(xn)),xn}var Dn={},el={},tl={},ES;function SB(){if(ES)return tl;ES=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.TermFunctionUuid=void 0;const i=w(),o=S(),u=ij();let a=class extends i.TermFunctionBase{constructor(){super({arity:0,operator:o.SparqlOperator.UUID,overloads:(0,o.declare)(o.SparqlOperator.UUID).set([],()=>()=>new o.NamedNode(`urn:uuid:${u.v4()}`)).collect()})}};return tl.TermFunctionUuid=a,tl}var LS;function FB(){if(LS)return el;LS=1,Object.defineProperty(el,"__esModule",{value:!0}),el.ActorFunctionFactoryTermUuid=void 0;const i=w(),o=S(),u=SB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.UUID],termFunction:!0})}async run(e){return new u.TermFunctionUuid}};return el.ActorFunctionFactoryTermUuid=a,el}var IS;function wB(){return IS||(IS=1,(function(i){var o=Dn&&Dn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Dn&&Dn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(FB(),i)})(Dn)),Dn}var En={},rl={},nl={},$S;function RB(){if($S)return nl;$S=1,Object.defineProperty(nl,"__esModule",{value:!0}),nl.TermFunctionXsdToBoolean=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_BOOLEAN,overloads:(0,o.declare)(o.TypeURL.XSD_BOOLEAN).onNumeric1(()=>t=>(0,o.bool)(t.coerceEBV()),!0).onUnary(o.TypeURL.XSD_BOOLEAN,()=>t=>(0,o.bool)(t.coerceEBV()),!0).onUnary(o.TypeURL.XSD_STRING,()=>t=>{switch(t.str()){case"true":return(0,o.bool)(!0);case"false":return(0,o.bool)(!1);case"1":return(0,o.bool)(!0);case"0":return(0,o.bool)(!1);default:throw new o.CastError(t,o.TypeURL.XSD_BOOLEAN)}},!1).collect()})}};return nl.TermFunctionXsdToBoolean=u,nl}var BS;function PB(){if(BS)return rl;BS=1,Object.defineProperty(rl,"__esModule",{value:!0}),rl.ActorFunctionFactoryTermXsdToBoolean=void 0;const i=w(),o=S(),u=RB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_BOOLEAN],termFunction:!0})}async run(e){return new u.TermFunctionXsdToBoolean}};return rl.ActorFunctionFactoryTermXsdToBoolean=a,rl}var QS;function qB(){return QS||(QS=1,(function(i){var o=En&&En.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=En&&En.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(PB(),i)})(En)),En}var Ln={},al={},il={},NS;function jB(){if(NS)return il;NS=1,Object.defineProperty(il,"__esModule",{value:!0}),il.TermFunctionXsdToDate=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_DATE,overloads:(0,o.declare)(o.TypeURL.XSD_DATE).onUnary(o.TypeURL.XSD_DATE,()=>t=>new o.DateLiteral(t.typedValue,t.strValue)).onUnary(o.TypeURL.XSD_DATE_TIME,()=>t=>new o.DateLiteral(t.typedValue)).onStringly1(()=>t=>new o.DateLiteral((0,o.parseDate)(t.str()))).collect()})}};return il.TermFunctionXsdToDate=u,il}var CS;function MB(){if(CS)return al;CS=1,Object.defineProperty(al,"__esModule",{value:!0}),al.ActorFunctionFactoryTermXsdToDate=void 0;const i=w(),o=S(),u=jB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_DATE],termFunction:!0})}async run(e){return new u.TermFunctionXsdToDate}};return al.ActorFunctionFactoryTermXsdToDate=a,al}var US;function xB(){return US||(US=1,(function(i){var o=Ln&&Ln.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ln&&Ln.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(MB(),i)})(Ln)),Ln}var In={},ol={},ul={},HS;function DB(){if(HS)return ul;HS=1,Object.defineProperty(ul,"__esModule",{value:!0}),ul.TermFunctionXsdToDatetime=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_DATE_TIME,overloads:(0,o.declare)(o.TypeURL.XSD_DATE_TIME).onUnary(o.TypeURL.XSD_DATE_TIME,()=>t=>t).onUnary(o.TypeURL.XSD_STRING,()=>t=>(0,o.dateTime)((0,o.parseDateTime)(t.str()),t.str()),!1).onUnary(o.TypeURL.XSD_DATE,()=>t=>new o.DateTimeLiteral({...t.typedValue,hours:0,minutes:0,seconds:0})).collect()})}};return ul.TermFunctionXsdToDatetime=u,ul}var VS;function EB(){if(VS)return ol;VS=1,Object.defineProperty(ol,"__esModule",{value:!0}),ol.ActorFunctionFactoryTermXsdToDatetime=void 0;const i=w(),o=S(),u=DB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_DATE_TIME],termFunction:!0})}async run(e){return new u.TermFunctionXsdToDatetime}};return ol.ActorFunctionFactoryTermXsdToDatetime=a,ol}var zS;function LB(){return zS||(zS=1,(function(i){var o=In&&In.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=In&&In.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(EB(),i)})(In)),In}var $n={},cl={},sl={},XS;function IB(){if(XS)return sl;XS=1,Object.defineProperty(sl,"__esModule",{value:!0}),sl.TermFunctionXsdToDayTimeDuration=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_DAY_TIME_DURATION,overloads:(0,o.declare)(o.TypeURL.XSD_DAY_TIME_DURATION).onUnary(o.TypeURL.XSD_DURATION,()=>t=>new o.DayTimeDurationLiteral((0,o.trimToDayTimeDuration)(t.typedValue))).onStringly1(()=>t=>new o.DayTimeDurationLiteral((0,o.parseDayTimeDuration)(t.str()))).collect()})}};return sl.TermFunctionXsdToDayTimeDuration=u,sl}var GS;function $B(){if(GS)return cl;GS=1,Object.defineProperty(cl,"__esModule",{value:!0}),cl.ActorFunctionFactoryTermXsdToDayTimeDuration=void 0;const i=w(),o=S(),u=IB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_DAY_TIME_DURATION],termFunction:!0})}async run(e){return new u.TermFunctionXsdToDayTimeDuration}};return cl.ActorFunctionFactoryTermXsdToDayTimeDuration=a,cl}var JS;function BB(){return JS||(JS=1,(function(i){var o=$n&&$n.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=$n&&$n.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u($B(),i)})($n)),$n}var Bn={},dl={},ll={},KS;function QB(){if(KS)return ll;KS=1,Object.defineProperty(ll,"__esModule",{value:!0}),ll.TermFunctionXsdToDecimal=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_DECIMAL,overloads:(0,o.declare)(o.TypeURL.XSD_DECIMAL).onNumeric1(()=>t=>{const e=(0,o.parseXSDDecimal)(t.str());if(e===void 0)throw new o.CastError(t,o.TypeURL.XSD_DECIMAL);return(0,o.decimal)(e)}).onString1(()=>t=>{const e=t.str(),r=/^([+-])?(\d+(\.\d+)?)$/u.test(e)?(0,o.parseXSDDecimal)(e):void 0;if(r===void 0)throw new o.CastError(t,o.TypeURL.XSD_DECIMAL);return(0,o.decimal)(r)},!1).onBoolean1Typed(()=>t=>(0,o.decimal)(t?1:0)).collect()})}};return ll.TermFunctionXsdToDecimal=u,ll}var YS;function NB(){if(YS)return dl;YS=1,Object.defineProperty(dl,"__esModule",{value:!0}),dl.ActorFunctionFactoryTermXsdToDecimal=void 0;const i=w(),o=S(),u=QB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_DECIMAL],termFunction:!0})}async run(e){return new u.TermFunctionXsdToDecimal}};return dl.ActorFunctionFactoryTermXsdToDecimal=a,dl}var WS;function CB(){return WS||(WS=1,(function(i){var o=Bn&&Bn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Bn&&Bn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(NB(),i)})(Bn)),Bn}var Qn={},fl={},pl={},ZS;function UB(){if(ZS)return pl;ZS=1,Object.defineProperty(pl,"__esModule",{value:!0}),pl.TermFunctionXsdToDouble=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_DOUBLE,overloads:(0,o.declare)(o.TypeURL.XSD_DOUBLE).onNumeric1(()=>t=>(0,o.double)(t.typedValue)).onBoolean1Typed(()=>t=>(0,o.double)(t?1:0)).onUnary(o.TypeURL.XSD_STRING,()=>t=>{const e=(0,o.parseXSDFloat)(t.str());if(e===void 0)throw new o.CastError(t,o.TypeURL.XSD_DOUBLE);return(0,o.double)(e)},!1).collect()})}};return pl.TermFunctionXsdToDouble=u,pl}var kS;function HB(){if(kS)return fl;kS=1,Object.defineProperty(fl,"__esModule",{value:!0}),fl.ActorFunctionFactoryTermXsdToDouble=void 0;const i=w(),o=S(),u=UB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_DOUBLE],termFunction:!0})}async run(e){return new u.TermFunctionXsdToDouble}};return fl.ActorFunctionFactoryTermXsdToDouble=a,fl}var eF;function VB(){return eF||(eF=1,(function(i){var o=Qn&&Qn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Qn&&Qn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(HB(),i)})(Qn)),Qn}var Nn={},yl={},_l={},tF;function zB(){if(tF)return _l;tF=1,Object.defineProperty(_l,"__esModule",{value:!0}),_l.TermFunctionXsdToDuration=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_DAY_TIME_DURATION,overloads:(0,o.declare)(o.TypeURL.XSD_DURATION).onUnary(o.TypeURL.XSD_DURATION,()=>t=>new o.DurationLiteral(t.typedValue,t.strValue)).onStringly1(()=>t=>new o.DurationLiteral((0,o.parseDuration)(t.str()))).collect()})}};return _l.TermFunctionXsdToDuration=u,_l}var rF;function XB(){if(rF)return yl;rF=1,Object.defineProperty(yl,"__esModule",{value:!0}),yl.ActorFunctionFactoryTermXsdToDuration=void 0;const i=w(),o=S(),u=zB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_DURATION],termFunction:!0})}async run(e){return new u.TermFunctionXsdToDuration}};return yl.ActorFunctionFactoryTermXsdToDuration=a,yl}var nF;function GB(){return nF||(nF=1,(function(i){var o=Nn&&Nn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Nn&&Nn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(XB(),i)})(Nn)),Nn}var Cn={},ml={},bl={},aF;function JB(){if(aF)return bl;aF=1,Object.defineProperty(bl,"__esModule",{value:!0}),bl.TermFunctionXsdToFloat=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_FLOAT,overloads:(0,o.declare)(o.TypeURL.XSD_FLOAT).onNumeric1(()=>t=>(0,o.float)(t.typedValue)).onBoolean1Typed(()=>t=>(0,o.float)(t?1:0)).onUnary(o.TypeURL.XSD_STRING,()=>t=>{const e=(0,o.parseXSDFloat)(t.str());if(e===void 0)throw new o.CastError(t,o.TypeURL.XSD_FLOAT);return(0,o.float)(e)},!1).collect()})}};return bl.TermFunctionXsdToFloat=u,bl}var iF;function KB(){if(iF)return ml;iF=1,Object.defineProperty(ml,"__esModule",{value:!0}),ml.ActorFunctionFactoryTermXsdToFloat=void 0;const i=w(),o=S(),u=JB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_FLOAT],termFunction:!0})}async run(e){return new u.TermFunctionXsdToFloat}};return ml.ActorFunctionFactoryTermXsdToFloat=a,ml}var oF;function YB(){return oF||(oF=1,(function(i){var o=Cn&&Cn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Cn&&Cn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(KB(),i)})(Cn)),Cn}var Un={},gl={},hl={},uF;function WB(){if(uF)return hl;uF=1,Object.defineProperty(hl,"__esModule",{value:!0}),hl.TermFunctionXsdToInteger=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_INTEGER,overloads:(0,o.declare)(o.TypeURL.XSD_INTEGER).onBoolean1Typed(()=>t=>(0,o.integer)(t?1:0)).onNumeric1(()=>t=>{if(!Number.isFinite(t.typedValue))throw new o.CastError(t,o.TypeURL.XSD_INTEGER);return(0,o.integer)(Math.trunc(t.typedValue))}).onString1(()=>t=>{const e=t.str(),r=/^\d+$/u.test(e)?Number.parseInt(e,10):void 0;if(r===void 0)throw new o.CastError(t,o.TypeURL.XSD_INTEGER);return(0,o.integer)(r)}).collect()})}};return hl.TermFunctionXsdToInteger=u,hl}var cF;function ZB(){if(cF)return gl;cF=1,Object.defineProperty(gl,"__esModule",{value:!0}),gl.ActorFunctionFactoryTermXsdToInteger=void 0;const i=w(),o=S(),u=WB();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_INTEGER],termFunction:!0})}async run(e){return new u.TermFunctionXsdToInteger}};return gl.ActorFunctionFactoryTermXsdToInteger=a,gl}var sF;function kB(){return sF||(sF=1,(function(i){var o=Un&&Un.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Un&&Un.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(ZB(),i)})(Un)),Un}var Hn={},vl={},Tl={},dF;function eQ(){if(dF)return Tl;dF=1,Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.TermFunctionXsdToString=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_STRING,overloads:(0,o.declare)(o.TypeURL.XSD_STRING).onNumeric1(()=>t=>(0,o.string)((0,o.float)(t.typedValue).str())).onBoolean1Typed(()=>t=>(0,o.string)((0,o.bool)(t).str())).onTerm1(()=>t=>(0,o.string)(t.str())).collect()})}};return Tl.TermFunctionXsdToString=u,Tl}var lF;function tQ(){if(lF)return vl;lF=1,Object.defineProperty(vl,"__esModule",{value:!0}),vl.ActorFunctionFactoryTermXsdToString=void 0;const i=w(),o=S(),u=eQ();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_STRING],termFunction:!0})}async run(e){return new u.TermFunctionXsdToString}};return vl.ActorFunctionFactoryTermXsdToString=a,vl}var fF;function rQ(){return fF||(fF=1,(function(i){var o=Hn&&Hn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Hn&&Hn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(tQ(),i)})(Hn)),Hn}var Vn={},Ol={},Al={},pF;function nQ(){if(pF)return Al;pF=1,Object.defineProperty(Al,"__esModule",{value:!0}),Al.TermFunctionXsdToTime=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_TIME,overloads:(0,o.declare)(o.TypeURL.XSD_TIME).onUnary(o.TypeURL.XSD_TIME,()=>t=>new o.TimeLiteral(t.typedValue,t.strValue)).onUnary(o.TypeURL.XSD_DATE_TIME,()=>t=>new o.TimeLiteral(t.typedValue)).onStringly1(()=>t=>new o.TimeLiteral((0,o.parseTime)(t.str()))).collect()})}};return Al.TermFunctionXsdToTime=u,Al}var yF;function aQ(){if(yF)return Ol;yF=1,Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.ActorFunctionFactoryTermXsdToTime=void 0;const i=w(),o=S(),u=nQ();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_TIME],termFunction:!0})}async run(e){return new u.TermFunctionXsdToTime}};return Ol.ActorFunctionFactoryTermXsdToTime=a,Ol}var _F;function iQ(){return _F||(_F=1,(function(i){var o=Vn&&Vn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Vn&&Vn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(aQ(),i)})(Vn)),Vn}var zn={},Sl={},Fl={},mF;function oQ(){if(mF)return Fl;mF=1,Object.defineProperty(Fl,"__esModule",{value:!0}),Fl.TermFunctionXsdToYearMonthDuration=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.TypeURL.XSD_YEAR_MONTH_DURATION,overloads:(0,o.declare)(o.TypeURL.XSD_YEAR_MONTH_DURATION).onUnary(o.TypeURL.XSD_DURATION,()=>t=>new o.YearMonthDurationLiteral((0,o.trimToYearMonthDuration)(t.typedValue))).onStringly1(()=>t=>new o.YearMonthDurationLiteral((0,o.parseYearMonthDuration)(t.str()))).collect()})}};return Fl.TermFunctionXsdToYearMonthDuration=u,Fl}var bF;function uQ(){if(bF)return Sl;bF=1,Object.defineProperty(Sl,"__esModule",{value:!0}),Sl.ActorFunctionFactoryTermXsdToYearMonthDuration=void 0;const i=w(),o=S(),u=oQ();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.TypeURL.XSD_YEAR_MONTH_DURATION],termFunction:!0})}async run(e){return new u.TermFunctionXsdToYearMonthDuration}};return Sl.ActorFunctionFactoryTermXsdToYearMonthDuration=a,Sl}var gF;function cQ(){return gF||(gF=1,(function(i){var o=zn&&zn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=zn&&zn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(uQ(),i)})(zn)),zn}var Xn={},wl={},Rl={},hF;function sQ(){if(hF)return Rl;hF=1,Object.defineProperty(Rl,"__esModule",{value:!0}),Rl.TermFunctionYear=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(){super({arity:1,operator:o.SparqlOperator.YEAR,overloads:(0,o.declare)(o.SparqlOperator.YEAR).onDateTime1(()=>t=>(0,o.integer)(t.typedValue.year)).set([o.TypeURL.XSD_DATE],()=>([t])=>(0,o.integer)(t.typedValue.year)).collect()})}};return Rl.TermFunctionYear=u,Rl}var vF;function dQ(){if(vF)return wl;vF=1,Object.defineProperty(wl,"__esModule",{value:!0}),wl.ActorFunctionFactoryTermYear=void 0;const i=w(),o=S(),u=sQ();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.YEAR],termFunction:!0})}async run(e){return new u.TermFunctionYear}};return wl.ActorFunctionFactoryTermYear=a,wl}var TF;function lQ(){return TF||(TF=1,(function(i){var o=Xn&&Xn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Xn&&Xn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(dQ(),i)})(Xn)),Xn}var Gn={},Pl={},Jn={},ql={},OF;function Bj(){if(OF)return ql;OF=1,Object.defineProperty(ql,"__esModule",{value:!0}),ql.ActorHttp=void 0;const i=O(),o=yx(),u=mx(),a=_x();let t=class $j extends i.Actor{constructor(r){super(r)}static toNodeReadable(r){return u(r)||r===null?r:(0,o.readableFromWeb)(r)}static toWebReadableStream(r){return a(r)}static headersToHash(r){const n={};return r.forEach((c,s)=>{n[s]=c}),n}static getInputUrl(r){return new URL(r instanceof Request?r.url:r)}static createUserAgent(r,n){if(!$j.isBrowser()){const c=[`Comunica/${n.split(".")[0]}.0`,`${r}/${n}`];return typeof globalThis.navigator=="object"&&typeof globalThis.navigator.userAgent=="string"?c.push(globalThis.navigator.userAgent):typeof globalThis.process=="object"&&typeof globalThis.process.versions=="object"&&typeof globalThis.process.versions.node=="string"&&c.push(`Node.js/${globalThis.process.versions.node.split(".")[0]}`),typeof globalThis.process=="object"&&typeof globalThis.process.platform=="string"&&typeof globalThis.process.arch=="string"&&c.splice(1,0,`(${globalThis.process.platform}; ${globalThis.process.arch})`),c.join(" ")}}static isBrowser(){return typeof globalThis.window=="object"&&typeof globalThis.window.document=="object"||typeof globalThis.importScripts=="function"}};return ql.ActorHttp=t,ql}var jl={},AF;function fQ(){if(AF)return jl;AF=1,Object.defineProperty(jl,"__esModule",{value:!0}),jl.validateAndCloseHttpResponse=void 0;const i=Oo(),o=Bj();async function u(a,t){var e;if(t.status>=400){let r="empty response";if(t.body){const n=o.ActorHttp.toNodeReadable(t.body);r=await(0,i.stringify)(n)}throw new Error(`Could not update ${a} (HTTP status ${t.status}):
${r}`)}await((e=t.body)==null?void 0:e.cancel())}return jl.validateAndCloseHttpResponse=u,jl}var SF;function qe(){return SF||(SF=1,(function(i){var o=Jn&&Jn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Jn&&Jn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(Bj(),i),u(fQ(),i)})(Jn)),Jn}const pQ="4.2.0",yQ={version:pQ};var Ml={},FF;function _Q(){if(FF)return Ml;FF=1,Object.defineProperty(Ml,"__esModule",{value:!0}),Ml.FetchInitPreprocessor=void 0;class i{async handle(u){if(u.body&&typeof u.body!="string"&&"getReader"in u.body){const a=u.body.getReader(),t=[];for(;;){const{done:e,value:r}=await a.read();if(e)break;t.push(r)}u.body=t.join("")}return{...u,keepalive:!u.body}}}return Ml.FetchInitPreprocessor=i,Ml}var wF;function mQ(){if(wF)return Pl;wF=1,Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.ActorHttpFetch=void 0;const i=qe(),o=q(),u=O(),a=yQ,t=_Q();let e=class am extends i.ActorHttp{constructor(n){super(n),this.fetchInitPreprocessor=new t.FetchInitPreprocessor(n.agentOptions)}async test(n){return(0,u.passTest)({time:Number.POSITIVE_INFINITY})}async run(n){const c=this.prepareRequestHeaders(n),s={method:"GET",...n.init,headers:c};this.logInfo(n.context,`Requesting ${i.ActorHttp.getInputUrl(n.input).href}`,()=>({headers:i.ActorHttp.headersToHash(c),method:s.method})),n.context.has(o.KeysHttp.fetch)&&(s.headers=i.ActorHttp.headersToHash(c)),n.context.get(o.KeysHttp.includeCredentials)&&(s.credentials="include");const l=n.context.get(o.KeysHttp.httpTimeout),d=n.context.get(o.KeysHttp.httpBodyTimeout),f=n.context.get(o.KeysHttp.fetch)??fetch,p=await this.fetchInitPreprocessor.handle(s);let _,y;if(l){const b=new AbortController;p.signal=b.signal,_=()=>b.abort(new Error(`Fetch timed out for ${i.ActorHttp.getInputUrl(n.input).href} after ${l} ms`)),y=setTimeout(()=>_(),l)}const m=await f(n.input,p);return l&&(!d||!m.body)&&clearTimeout(y),m}prepareRequestHeaders(n){var l;const c=new Headers((l=n.init)==null?void 0:l.headers);i.ActorHttp.isBrowser()?c.delete("user-agent"):c.has("user-agent")||c.set("user-agent",am.userAgent);const s=n.context.get(o.KeysHttp.auth);return s&&c.set("Authorization",`Basic ${am.stringToBase64(s)}`),c}static stringToBase64(n){const c=new TextEncoder().encode(n),s=Array.from(c,l=>String.fromCodePoint(l)).join("");return btoa(s)}};return Pl.ActorHttpFetch=e,e.userAgent=i.ActorHttp.createUserAgent("ActorHttpFetch",a.version),Pl}var RF;function bQ(){return RF||(RF=1,(function(i){var o=Gn&&Gn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Gn&&Gn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(mQ(),i)})(Gn)),Gn}var Kn={},xl={},PF;function gQ(){if(PF)return xl;PF=1,Object.defineProperty(xl,"__esModule",{value:!0}),xl.ActorQueryOperationSource=void 0;const i=X(),o=q(),u=O(),a=ae(),t=Q(),e=$();let r=class extends i.ActorQueryOperation{constructor(c){super(c)}async test(c){return(0,t.getOperationSource)(c.operation)?(0,u.passTest)({httpRequests:1}):(0,u.failTest)(`Actor ${this.name} requires an operation with source annotation.`)}async run(c){const s=c.context.get(o.KeysInitQuery.physicalQueryPlanLogger);s&&(s.logOperation(c.operation.type,void 0,c.operation,c.context.get(o.KeysInitQuery.physicalQueryPlanNode),this.name,{}),c.context=c.context.set(o.KeysInitQuery.physicalQueryPlanNode,c.operation));const l=(0,t.getOperationSource)(c.operation),d=l.context?c.context.merge(l.context):c.context;let f=!1;if(e.Util.recurseOperation(c.operation,{construct(){return f=!0,!1}}),f){const y=l.source.queryQuads(c.operation,d),m=(0,a.getMetadataQuads)(y);return{type:"quads",quadStream:y,metadata:m}}switch(c.operation.type){case e.Algebra.types.ASK:return{type:"boolean",execute:()=>l.source.queryBoolean(c.operation,d)};case e.Algebra.types.COMPOSITE_UPDATE:case e.Algebra.types.DELETE_INSERT:case e.Algebra.types.LOAD:case e.Algebra.types.CLEAR:case e.Algebra.types.CREATE:case e.Algebra.types.DROP:case e.Algebra.types.ADD:case e.Algebra.types.MOVE:case e.Algebra.types.COPY:return{type:"void",execute:()=>l.source.queryVoid(c.operation,d)}}const p=l.source.queryBindings(c.operation,d),_=(0,a.getMetadataBindings)(p);return{type:"bindings",bindingsStream:p,metadata:_}}};return xl.ActorQueryOperationSource=r,xl}var qF;function hQ(){return qF||(qF=1,(function(i){var o=Kn&&Kn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Kn&&Kn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(gQ(),i)})(Kn)),Kn}var Yn={},Dl={},jF;function vQ(){if(jF)return Dl;jF=1,Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.MediatorJoinCoefficientsFixed=void 0;const i=q(),o=O();let u=class extends o.Mediator{constructor(t){super(t)}async mediateWith(t,e){var y;const r=[],n=e.map(({reply:m})=>m),c=(await Promise.all(n)).map(m=>{if(m.isFailed()){r.push(m.getFailMessage());return}return{value:m.get(),sideData:m.getSideData()}});let s=c.map(m=>{if(m)return m.value.iterations*this.cpuWeight+m.value.persistedItems*this.memoryWeight+m.value.blockingItems*this.timeWeight+m.value.requestTime*this.ioWeight});const l=Math.max(...s.filter(m=>m!==void 0)),d=t.context.get(i.KeysQueryOperation.limitIndicator);d&&(s=s.map((m,b)=>{var h,g;return m!==void 0&&((h=c[b])==null?void 0:h.value).blockingItems>0&&((g=c[b])==null?void 0:g.value).iterations>d?m+l:m}));let f=-1,p=Number.POSITIVE_INFINITY;for(const[m,b]of s.entries())b!==void 0&&(f===-1||b<p)&&(f=m,p=b);if(f<0)return(0,o.failTest)(this.constructFailureMessage(t,r));const _=e[f].actor;return _.includeInLogs&&((y=o.Actor.getContextLogger(t.context))==null||y.debug(`Determined physical join operator '${_.logicalType}-${_.physicalName}'`,{entries:t.entries.length,variables:await Promise.all(t.entries.map(async m=>(await m.output.metadata()).variables.map(b=>b.variable.value))),costs:Object.fromEntries(s.map((m,b)=>[`${e[b].actor.logicalType}-${e[b].actor.physicalName}`,m]).filter(m=>m[1]!==void 0)),coefficients:Object.fromEntries(c.map((m,b)=>[`${e[b].actor.logicalType}-${e[b].actor.physicalName}`,m==null?void 0:m.value]).filter(m=>m[1]!==void 0))})),(0,o.passTestWithSideData)(_,c[f].sideData)}};return Dl.MediatorJoinCoefficientsFixed=u,Dl}var MF;function TQ(){return MF||(MF=1,(function(i){var o=Yn&&Yn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Yn&&Yn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(vQ(),i)})(Yn)),Yn}var Wn={},El={},xF;function Qj(){if(xF)return El;xF=1,Object.defineProperty(El,"__esModule",{value:!0}),El.ActorHttpInvalidate=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return El.ActorHttpInvalidate=o,El}var Ll={},DF;function OQ(){if(DF)return Ll;DF=1,Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.ActorHttpInvalidateListenable=void 0;const i=O(),o=Qj();let u=class extends o.ActorHttpInvalidate{constructor(t){super(t),this.invalidateListeners=[],this.invalidateListeners=[]}addInvalidateListener(t){this.invalidateListeners.push(t)}async test(t){return(0,i.passTestVoid)()}async run(t){for(const e of this.invalidateListeners)e(t);return{}}};return Ll.ActorHttpInvalidateListenable=u,Ll}var EF;function _o(){return EF||(EF=1,(function(i){var o=Wn&&Wn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Wn&&Wn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(Qj(),i),u(OQ(),i)})(Wn)),Wn}var Zn={},Il={},LF;function AQ(){if(LF)return Il;LF=1,Object.defineProperty(Il,"__esModule",{value:!0}),Il.MediatorAll=void 0;const i=O();let o=class extends i.Mediator{constructor(a){super(a)}async mediate(a){const t=[];let e;try{e=this.publish(a)}catch{e=[]}for(const n of e){const c=await n.reply;c.isPassed()&&t.push({actor:n.actor,sideData:c.getSideData()})}return(await Promise.all(t.map(n=>n.actor.runObservable(a,n.sideData))))[0]}async mediateWith(){throw new Error("Unsupported operation: MediatorAll#mediateWith")}};return Il.MediatorAll=o,Il}var IF;function SQ(){return IF||(IF=1,(function(i){var o=Zn&&Zn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Zn&&Zn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(AQ(),i)})(Zn)),Zn}var kn={},$l={},$F;function FQ(){if($F)return $l;$F=1,Object.defineProperty($l,"__esModule",{value:!0}),$l.ActorRdfJoinEntriesSortSelectivity=void 0;const i=jj(),o=O();let u=class extends i.ActorRdfJoinEntriesSort{constructor(t){super(t)}async test(t){return(0,o.passTest)({accuracy:.501})}async run(t){const e=[...t.entries],r=[];for(;e.length>0;){let n=Number.MAX_VALUE,c=-1;for(const[s,l]of e.entries()){const{selectivity:d}=await this.mediatorJoinSelectivity.mediate({entries:[l,...r],context:t.context});d<n&&(n=d,c=s)}r.push(e[c]),e.splice(c,1)}return{entries:r}}};return $l.ActorRdfJoinEntriesSortSelectivity=u,$l}var BF;function wQ(){return BF||(BF=1,(function(i){var o=kn&&kn.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=kn&&kn.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(FQ(),i)})(kn)),kn}var ea={},Bl={},ta={},Ql={},ra={},Nl={},QF;function RQ(){if(QF)return Nl;QF=1,Object.defineProperty(Nl,"__esModule",{value:!0}),Nl.ChunkedIterator=void 0;const i=N();let o=class extends i.TransformIterator{constructor(a,t,e){super(a,e),this.chunk=[],this.blockSize=t}consumeChunkAsIterator(){const a=new i.ArrayIterator(this.chunk,{autoStart:!1});return this.chunk=[],a}_transform(a,t,e){this.chunk.push(a),this.chunk.length>=this.blockSize&&e(this.consumeChunkAsIterator()),t()}_flush(a){this.chunk.length>0&&this._push(this.consumeChunkAsIterator()),super._flush(a)}};return Nl.ChunkedIterator=o,Nl}var Cl={},NF;function PQ(){if(NF)return Cl;NF=1,Object.defineProperty(Cl,"__esModule",{value:!0}),Cl.ClosableIterator=void 0;const i=N();let o=class extends i.AsyncIterator{constructor(r,n){super(),this.onClose=n.onClose,this._source=r,this._source[i.DESTINATION]=this,this._source.on("end",t),this._source.on("error",a),this._source.on("readable",u),this.readable=this._source.readable}read(){const r=this._source.read();return r||(this.readable=!1,this._source.done&&this.close()),r}_end(r){this.onClose(),this._source.removeListener("end",t),this._source.removeListener("error",a),this._source.removeListener("readable",u),delete this._source[i.DESTINATION],this._source.destroy(),super._end(r)}};Cl.ClosableIterator=o;function u(){this[i.DESTINATION].readable=!0}function a(e){this[i.DESTINATION].emit("error",e)}function t(){this[i.DESTINATION].close()}return Cl}var Ul={},CF;function qQ(){if(CF)return Ul;CF=1,Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.ClosableTransformIterator=void 0;const i=N();let o=class extends i.TransformIterator{constructor(a,t){super(a,t),this.onClose=t.onClose}_end(a){this.onClose(),super._end(a)}};return Ul.ClosableTransformIterator=o,Ul}var Hl={},UF;function jQ(){if(UF)return Hl;UF=1,Object.defineProperty(Hl,"__esModule",{value:!0}),Hl.instrumentIterator=void 0;function i(u){const a={count:0,timeSelf:0,timeLife:0};return o(u,a,!0),new Promise(t=>{u.on("end",()=>{t(a)})})}Hl.instrumentIterator=i;function o(u,a,t){if(!("_profileInstrumented"in u)){if(u._profileInstrumented=!0,"_read"in u){const e=u._read;u._read=(r,n)=>{const c=performance.now();e.call(u,r,()=>{a.timeSelf+=performance.now()-c,n()})}}if("read"in u){const e=u.read;u.read=()=>{const r=performance.now(),n=e.call(u);return t&&n&&a.count++,a.timeSelf+=performance.now()-r,n}}if(t){const e=performance.now();u.on("end",()=>{a.timeLife=performance.now()-e})}"_source"in u&&o(u._source,a,!1)}}return Hl}var HF;function Le(){return HF||(HF=1,(function(i){var o=ra&&ra.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ra&&ra.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(RQ(),i),u(PQ(),i),u(qQ(),i),u(jQ(),i)})(ra)),ra}var VF;function MQ(){if(VF)return Ql;VF=1,Object.defineProperty(Ql,"__esModule",{value:!0}),Ql.ActorRdfJoin=void 0;const i=q(),o=O(),u=Le(),a=ae();let t=class De extends o.Actor{constructor(r,n){super(r),this.includeInLogs=!0,this.logicalType=n.logicalType,this.physicalName=n.physicalName,this.limitEntries=n.limitEntries??Number.POSITIVE_INFINITY,this.limitEntriesMin=n.limitEntriesMin??!1,this.canHandleUndefs=n.canHandleUndefs??!1,this.isLeaf=n.isLeaf??!0,this.requiresVariableOverlap=n.requiresVariableOverlap??!1}static overlappingVariables(r){const n={};for(const c of r)for(const s of c.variables){n[s.variable.value]||(n[s.variable.value]={variable:s.variable,canBeUndef:s.canBeUndef,occurrences:0});const l=n[s.variable.value];l.canBeUndef=l.canBeUndef||s.canBeUndef,l.occurrences++}return Object.values(n).filter(c=>c.occurrences===r.length).map(c=>({variable:c.variable,canBeUndef:c.canBeUndef}))}static joinVariables(r,n,c=!1){const s={};let l=!0;for(const d of n){for(const f of d.variables)s[f.variable.value]=s[f.variable.value]||f.canBeUndef||!l&&c&&!(f.variable.value in s);l=!1}return Object.entries(s).map(([d,f])=>({variable:r.variable(d),canBeUndef:f}))}static joinBindings(...r){if(r.length===0)return null;if(r.length===1)return r[0];let n=r[0];for(const c of r.slice(1)){const s=n.merge(c);if(!s)return null;n=s}return n}static getCardinality(r){return r.cardinality}static async getMetadatas(r){return await Promise.all(r.map(n=>n.output.metadata()))}static async getEntriesWithMetadatas(r){const n=await De.getMetadatas(r);return r.map((c,s)=>({...c,metadata:n[s]}))}static getRequestInitialTimes(r){return r.map(n=>n.pageSize?0:n.requestTime??0)}static getRequestItemTimes(r){return r.map(n=>n.pageSize?(n.requestTime??0)/n.pageSize:0)}constructState(r){const n=new a.MetadataValidationState,c=()=>n.invalidate();for(const s of r)s.state.addInvalidateListener(c);return n}async constructResultMetadata(r,n,c,s={},l=!1){let d;if(s.cardinality)d=s.cardinality;else{let f=!1;d=n.reduce((p,_)=>{const y=De.getCardinality(_);return y.value===0&&(f=!0),{type:y.type==="estimate"?"estimate":p.type,value:p.value*(l?Math.max(1,y.value):y.value)}},{type:"exact",value:1}),(!f||l)&&(d.value*=(await this.mediatorJoinSelectivity.mediate({entries:r,context:c})).selectivity,d.value===0&&(d.value=Number.MIN_VALUE))}return{state:this.constructState(n),...s,cardinality:{type:d.type,value:d.value},variables:De.joinVariables(c.getSafe(i.KeysInitQuery.dataFactory),n,l)}}static async sortJoinEntries(r,n,c){if(n.some(f=>f.metadata.variables.some(p=>p.canBeUndef)))return(0,o.passTest)(n);const l={};for(const f of n)for(const p of f.metadata.variables){let _=l[p.variable.value];_||(_=0),l[p.variable.value]=++_}const d=[];for(const[f,p]of Object.entries(l))p>=2&&d.push(f);return d.length===0?(0,o.failTest)("Bind join can only join entries with at least one common variable"):(0,o.passTest)((await r.mediate({entries:n,context:c})).entries)}async test(r){if(r.type!==this.logicalType)return(0,o.failTest)(`${this.name} can only handle logical joins of type '${this.logicalType}', while '${r.type}' was given.`);if(r.entries.length<=1)return(0,o.failTest)(`${this.name} requires at least two join entries.`);if(this.limitEntriesMin?r.entries.length<this.limitEntries:r.entries.length>this.limitEntries)return(0,o.failTest)(`${this.name} requires ${this.limitEntries} join entries at ${this.limitEntriesMin?"least":"most"}. The input contained ${r.entries.length}.`);for(const s of r.entries)if(s.output.type!=="bindings")return(0,o.failTest)(`Invalid type of a join entry: Expected 'bindings' but got '${s.output.type}'`);const n=await De.getMetadatas(r.entries);let c;return!this.canHandleUndefs&&(c=De.overlappingVariables(n),c.some(s=>s.canBeUndef))?(0,o.failTest)(`Actor ${this.name} can not join streams containing undefs`):this.requiresVariableOverlap&&(c??De.overlappingVariables(n)).length===0?(0,o.failTest)(`Actor ${this.name} can only join entries with at least one common variable`):await this.getJoinCoefficients(r,{metadatas:n})}async run(r,n){let c;r.context.has(i.KeysInitQuery.physicalQueryPlanLogger)&&(c=r.context.get(i.KeysInitQuery.physicalQueryPlanNode),r.context=r.context.set(i.KeysInitQuery.physicalQueryPlanNode,r));const s=r.context.get(i.KeysInitQuery.physicalQueryPlanLogger);let l;this.includeInLogs&&s&&(l={},s.stashChildren(c,p=>p.logicalOperator.startsWith("join")),s.logOperation(`join-${this.logicalType}`,this.physicalName,r,c,this.name,l));const{result:d,physicalPlanMetadata:f}=await this.getOutput(r,n);if(l){(0,u.instrumentIterator)(d.bindingsStream).then(_=>{s.appendMetadata(r,{cardinalityReal:_.count,timeSelf:_.timeSelf,timeLife:_.timeLife})}),Object.assign(l,f);const p=n.metadatas.map(De.getCardinality);if(l.cardinalities=p,l.joinCoefficients=(await this.getJoinCoefficients(r,n)).getOrThrow(),this.isLeaf)for(let _=0;_<r.entries.length;_++){const y=r.entries[_];s.unstashChild(y.operation,r),s.appendMetadata(y.operation,{cardinality:p[_]})}}return d.metadata=(0,a.cachifyMetadata)(d.metadata),d}};return Ql.ActorRdfJoin=t,Ql}var zF;function le(){return zF||(zF=1,(function(i){var o=ta&&ta.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ta&&ta.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(MQ(),i)})(ta)),ta}var XF;function xQ(){if(XF)return Bl;XF=1,Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.ActorRdfJoinSingle=void 0;const i=le(),o=O();let u=class extends i.ActorRdfJoin{constructor(t){super(t,{logicalType:"inner",physicalName:"single",limitEntries:1}),this.includeInLogs=!1}async test(t){return t.entries.length!==1?(0,o.failTest)(`Actor ${this.name} can only join a single entry`):await this.getJoinCoefficients(t,void 0)}async getOutput(t){return{result:t.entries[0].output}}async getJoinCoefficients(t,e){return(0,o.passTestWithSideData)({iterations:0,persistedItems:0,blockingItems:0,requestTime:0},e)}};return Bl.ActorRdfJoinSingle=u,Bl}var GF;function DQ(){return GF||(GF=1,(function(i){var o=ea&&ea.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ea&&ea.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(xQ(),i)})(ea)),ea}var na={},Vl={},JF;function EQ(){if(JF)return Vl;JF=1,Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.ActorRdfJoinMultiEmpty=void 0;const i=le(),o=q(),u=O(),a=ae(),t=N();let e=class extends i.ActorRdfJoin{constructor(n){super(n,{logicalType:"inner",physicalName:"multi-empty",canHandleUndefs:!0})}async test(n){return(await i.ActorRdfJoin.getMetadatas(n.entries)).every(c=>i.ActorRdfJoin.getCardinality(c).value>0)?(0,u.failTest)(`Actor ${this.name} can only join entries where at least one is empty`):super.test(n)}async getOutput(n){for(const s of n.entries)s.output.bindingsStream.close();const c=n.context.getSafe(o.KeysInitQuery.dataFactory);return{result:{bindingsStream:new t.ArrayIterator([],{autoStart:!1}),metadata:async()=>({state:new a.MetadataValidationState,cardinality:{type:"exact",value:0},variables:i.ActorRdfJoin.joinVariables(c,await i.ActorRdfJoin.getMetadatas(n.entries))}),type:"bindings"}}}async getJoinCoefficients(n,c){return(0,u.passTestWithSideData)({iterations:0,persistedItems:0,blockingItems:0,requestTime:0},c)}};return Vl.ActorRdfJoinMultiEmpty=e,Vl}var KF;function LQ(){return KF||(KF=1,(function(i){var o=na&&na.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=na&&na.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(EQ(),i)})(na)),na}var aa={},zl={},ia={},Xl={},YF;function IQ(){if(YF)return Xl;YF=1,Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.BindingsIndexDef=void 0;let i=class{constructor(u,a){this.keys=u.map(t=>t.variable),this.hashFn=a,this.index={}}put(u,a){return this.index[this.hashFn(u,this.keys)]=a}get(u){const a=this.getFirst(u);return a?[a]:[]}getFirst(u){return this.index[this.hashFn(u,this.keys)]}values(){return Object.values(this.index)}};return Xl.BindingsIndexDef=i,Xl}var Gl={},WF;function $Q(){if(WF)return Gl;WF=1,Object.defineProperty(Gl,"__esModule",{value:!0}),Gl.BindingsIndexUndef=void 0;let i=class{constructor(u,a,t){this.data={},this.keys=u.map(e=>e.variable),this.hashFn=a,this.allowDisjointDomains=t&&this.keys.length>0}put(u,a){if(this.allowDisjointDomains||this.isBindingsValid(u)){let t=this.data;for(let e=0;e<this.keys.length;e++){const r=this.keys[e],n=this.hashFn(u.get(r));let c=t[n];c||(c=t[n]=e===this.keys.length-1?a:{}),t=c}}return a}isBindingsValid(u){let a=!1;for(const t of this.keys)if(u.has(t)){a=!0;break}return a}get(u){return this.allowDisjointDomains||this.isBindingsValid(u)?this.getRecursive(u,this.keys,[this.data]):[]}getRecursive(u,a,t){if(a.length===0)return t;let e;[e,...a]=a;const r=[];for(const n of t){const c=this.hashFn(u==null?void 0:u.get(e));if(c){const s=[n[c],n[""]].filter(Boolean);if(s.length===0)continue;r.push(this.getRecursive(u,a,s))}else{const s=Object.values(n);if(s.length===0)continue;r.push(this.getRecursive(u,a,s))}}return r.flat()}getFirst(u,a=!0){if(this.allowDisjointDomains||this.isBindingsValid(u))return this.getRecursiveFirst(u,this.keys,[this.data],a)}getRecursiveFirst(u,a,t,e){if(a.length===0)return t[0];let r;[r,...a]=a;for(const n of t){const c=this.hashFn(u.get(r));if(c||!e){const s=[n[c],n[""]].filter(Boolean);if(s.length===0)continue;const l=this.getRecursiveFirst(u,a,s,e);if(l)return l}else{const s=Object.values(n);if(s.length===0)continue;const l=this.getRecursiveFirst(u,a,s,e);if(l)return l}}}values(){return this.keys.length===0?[]:this.getRecursive(void 0,this.keys,[this.data])}};return Gl.BindingsIndexUndef=i,Gl}var G_={},ZF;function BQ(){return ZF||(ZF=1,Object.defineProperty(G_,"__esModule",{value:!0})),G_}var kF;function mm(){return kF||(kF=1,(function(i){var o=ia&&ia.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ia&&ia.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(IQ(),i),u($Q(),i),u(BQ(),i)})(ia)),ia}var ew;function QQ(){if(ew)return zl;ew=1,Object.defineProperty(zl,"__esModule",{value:!0}),zl.ActorRdfJoinHash=void 0;const i=le(),o=O(),u=mm(),a=Le(),t=N(),e=u_(),r=ne();let n=class extends i.ActorRdfJoin{constructor(s){super(s,{logicalType:"inner",physicalName:`hash-${s.canHandleUndefs?"undef":"def"}`,limitEntries:2,requiresVariableOverlap:!0,canHandleUndefs:s.canHandleUndefs})}async getOutput(s,l){const d=l.metadatas;let f;const p=i.ActorRdfJoin.overlappingVariables(d);if(this.canHandleUndefs){const _=l.entriesSorted[0].output,y=l.entriesSorted[1].output;f=new a.ClosableTransformIterator(async()=>{const m=new u.BindingsIndexUndef(p,b=>b&&b.termType!=="Variable"?(0,r.termToString)(b):"",!0);return await new Promise(b=>{_.bindingsStream.on("data",h=>{(m.getFirst(h,!1)??m.put(h,[])).push(h)}),_.bindingsStream.on("end",b),_.bindingsStream.on("error",h=>{f.emit("error",h)})}),new t.MultiTransformIterator(y.bindingsStream,{multiTransform:b=>new t.ArrayIterator(m.get(b).flat().map(h=>i.ActorRdfJoin.joinBindings(b,h)).filter(h=>h!==null),{autoStart:!1}),autoStart:!1})},{autoStart:!1,onClose(){_.bindingsStream.destroy(),y.bindingsStream.destroy()}})}else{const{hashFunction:_}=await this.mediatorHashBindings.mediate({context:s.context}),y=p.map(m=>m.variable);f=new e.HashJoin(l.entriesSorted[0].output.bindingsStream,l.entriesSorted[1].output.bindingsStream,m=>_(m,y),i.ActorRdfJoin.joinBindings)}return{result:{type:"bindings",bindingsStream:f,metadata:async()=>await this.constructResultMetadata(l.entriesSorted,d,s.context)}}}async getJoinCoefficients(s,l){let d=s.entries;l.metadatas[1].cardinality.value<l.metadatas[0].cardinality.value&&(l.metadatas=[l.metadatas[1],l.metadatas[0]],d=[s.entries[1],s.entries[0]]);const{metadatas:f}=l,p=i.ActorRdfJoin.getRequestInitialTimes(f),_=i.ActorRdfJoin.getRequestItemTimes(f);let y=f[0].cardinality.value+f[1].cardinality.value;return this.canHandleUndefs||(y*=.8),(0,o.passTestWithSideData)({iterations:y,persistedItems:f[0].cardinality.value,blockingItems:f[0].cardinality.value,requestTime:p[0]+f[0].cardinality.value*_[0]+p[1]+f[1].cardinality.value*_[1]},{...l,entriesSorted:d})}};return zl.ActorRdfJoinHash=n,zl}var tw;function rw(){return tw||(tw=1,(function(i){var o=aa&&aa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=aa&&aa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(QQ(),i)})(aa)),aa}var oa={},Jl={},nw;function NQ(){if(nw)return Jl;nw=1,Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.ActorRdfJoinSymmetricHash=void 0;const i=le(),o=O(),u=u_();let a=class extends i.ActorRdfJoin{constructor(e){super(e,{logicalType:"inner",physicalName:"symmetric-hash",limitEntries:2,requiresVariableOverlap:!0})}async getOutput(e){const r=await i.ActorRdfJoin.getMetadatas(e.entries),n=i.ActorRdfJoin.overlappingVariables(r),{hashFunction:c}=await this.mediatorHashBindings.mediate({context:e.context}),s=n.map(d=>d.variable);return{result:{type:"bindings",bindingsStream:new u.SymmetricHashJoin(e.entries[0].output.bindingsStream,e.entries[1].output.bindingsStream,d=>c(d,s),i.ActorRdfJoin.joinBindings),metadata:async()=>await this.constructResultMetadata(e.entries,r,e.context)}}}async getJoinCoefficients(e,r){const{metadatas:n}=r,c=i.ActorRdfJoin.getRequestInitialTimes(n),s=i.ActorRdfJoin.getRequestItemTimes(n);return(0,o.passTestWithSideData)({iterations:n[0].cardinality.value+n[1].cardinality.value,persistedItems:n[0].cardinality.value+n[1].cardinality.value,blockingItems:0,requestTime:c[0]+n[0].cardinality.value*s[0]+c[1]+n[1].cardinality.value*s[1]},r)}};return Jl.ActorRdfJoinSymmetricHash=a,Jl}var aw;function CQ(){return aw||(aw=1,(function(i){var o=oa&&oa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=oa&&oa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(NQ(),i)})(oa)),oa}var ua={},Kl={},iw;function UQ(){if(iw)return Kl;iw=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.ActorRdfJoinNestedLoop=void 0;const i=le(),o=O(),u=u_();let a=class extends i.ActorRdfJoin{constructor(e){super(e,{logicalType:"inner",physicalName:"nested-loop",limitEntries:2,canHandleUndefs:!0})}async getOutput(e){return{result:{type:"bindings",bindingsStream:new u.NestedLoopJoin(e.entries[0].output.bindingsStream,e.entries[1].output.bindingsStream,i.ActorRdfJoin.joinBindings,{autoStart:!1}),metadata:async()=>await this.constructResultMetadata(e.entries,await i.ActorRdfJoin.getMetadatas(e.entries),e.context)}}}async getJoinCoefficients(e,r){const{metadatas:n}=r,c=i.ActorRdfJoin.getRequestInitialTimes(n),s=i.ActorRdfJoin.getRequestItemTimes(n);return(0,o.passTestWithSideData)({iterations:n[0].cardinality.value*n[1].cardinality.value,persistedItems:0,blockingItems:0,requestTime:c[0]+n[0].cardinality.value*s[0]+c[1]+n[1].cardinality.value*s[1]},r)}};return Kl.ActorRdfJoinNestedLoop=a,Kl}var ow;function HQ(){return ow||(ow=1,(function(i){var o=ua&&ua.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ua&&ua.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(UQ(),i)})(ua)),ua}var ca={},Yl={},sa={},Wl={},da={},uw;function Nj(){if(uw)return da;uw=1,Object.defineProperty(da,"__esModule",{value:!0}),da.bindingsToCompactString=da.bindingsToString=void 0;const i=ne();function o(a){const t={};for(const e of a.keys())t[e.value]=(0,i.termToString)(a.get(e));return JSON.stringify(t,null,"  ")}da.bindingsToString=o;function u(a,t){return t.map(e=>{const r=a.get(e);return r?(0,i.termToString)(r):""}).join("")}return da.bindingsToCompactString=u,da}var cw;function Cj(){if(cw)return Wl;cw=1,Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.Bindings=void 0;const i=O(),o=um,u=Nj();let a=class oe{constructor(e,r,n){this.type="bindings",this.dataFactory=e,this.entries=r,this.contextHolder=n}has(e){return this.entries.has(typeof e=="string"?e:e.value)}get(e){return this.entries.get(typeof e=="string"?e:e.value)}set(e,r){return new oe(this.dataFactory,this.entries.set(typeof e=="string"?e:e.value,r),this.contextHolder)}delete(e){return new oe(this.dataFactory,this.entries.delete(typeof e=="string"?e:e.value),this.contextHolder)}keys(){return this.mapIterable(this.iteratorToIterable(this.entries.keys()),e=>this.dataFactory.variable(e))}values(){return this.iteratorToIterable(this.entries.values())}forEach(e){for(const[r,n]of this.entries.entries())e(n,this.dataFactory.variable(r))}get size(){return this.entries.size}[Symbol.iterator](){return this.mapIterable(this.iteratorToIterable(this.entries.entries()),([e,r])=>[this.dataFactory.variable(e),r])[Symbol.iterator]()}equals(e){var r;if(!e)return!1;if(this===e)return!0;if(this.size!==e.size)return!1;for(const n of this.keys())if(!((r=this.get(n))!=null&&r.equals(e.get(n))))return!1;return!0}filter(e){return new oe(this.dataFactory,(0,o.Map)(this.entries.filter((r,n)=>e(r,this.dataFactory.variable(n)))),this.contextHolder)}map(e){return new oe(this.dataFactory,(0,o.Map)(this.entries.map((r,n)=>e(r,this.dataFactory.variable(n)))),this.contextHolder)}merge(e){if(this.size<e.size&&e instanceof oe)return e.merge(this);let r=this.entries;if(e instanceof oe)for(const[n,c]of e.entries){const s=this.entries.get(n);if(s&&!s.equals(c))return;r=r.set(n,c)}else for(const[n,c]of e){const s=this.entries.get(n.value);if(s&&!s.equals(c))return;r=r.set(n.value,c)}return this.createBindingsWithContexts(r,e)}mergeWith(e,r){if(this.size<r.size&&r instanceof oe)return r.mergeWith(e,this);let n=this.entries;if(r instanceof oe)for(const[c,s]of r.entries){const l=this.entries.get(c);let d;l&&!l.equals(s)?d=e(l,s,this.dataFactory.variable(c)):d=s,n=n.set(c,d)}else for(const[c,s]of r){const l=this.entries.get(c.value);let d;l&&!l.equals(s)?d=e(l,s,c):d=s,n=n.set(c.value,d)}return this.createBindingsWithContexts(n,r)}createBindingsWithContexts(e,r){if(this.contextHolder&&this.contextHolder.context){let n=this.contextHolder.context;return"contextHolder"in r&&r.contextHolder&&r.contextHolder.context&&(n=oe.mergeContext(this.contextHolder.contextMergeHandlers,n,r.contextHolder.context)),new oe(this.dataFactory,e,{contextMergeHandlers:this.contextHolder.contextMergeHandlers,context:n})}return new oe(this.dataFactory,e,r.contextHolder)}static mergeContext(e,r,n){const c=[...r.keys(),...n.keys()],s={},l={},d=new Set(n.keys().map(p=>p.name)),f=r.keys().filter(p=>d.has(p.name));for(const p of c){if(l[p.name]===1)continue;l[p.name]=1;const _=f.some(y=>y.name===p.name);if(e[p.name]&&_){s[p.name]=e[p.name].run(r.get(p),n.get(p));continue}if(!(!e[p.name]&&_)){if(!r.get(p)){s[p.name]=n.get(p);continue}n.get(p)||(s[p.name]=r.get(p))}}return new i.ActionContext(s)}setContextEntry(e,r){return this.setContextEntryRaw(e,r)}setContextEntryRaw(e,r){var n;return this.contextHolder&&this.contextHolder.context?new oe(this.dataFactory,this.entries,{contextMergeHandlers:this.contextHolder.contextMergeHandlers,context:this.contextHolder.context.set(e,r)}):new oe(this.dataFactory,this.entries,{contextMergeHandlers:((n=this.contextHolder)==null?void 0:n.contextMergeHandlers)??{},context:new i.ActionContext().set(e,r)})}deleteContextEntry(e){return this.deleteContextEntryRaw(e)}deleteContextEntryRaw(e){var r;return this.contextHolder?new oe(this.dataFactory,this.entries,{contextMergeHandlers:this.contextHolder.contextMergeHandlers,context:(r=this.contextHolder.context)==null?void 0:r.delete(e)}):new oe(this.dataFactory,this.entries)}getContext(){var e;return(e=this.contextHolder)==null?void 0:e.context}getContextEntry(e){var r;return(r=this.getContext())==null?void 0:r.get(e)}toString(){return(0,u.bindingsToString)(this)}*mapIterable(e,r){for(const n of e)yield r(n)}iteratorToIterable(e){return{[Symbol.iterator]:()=>e}}};return Wl.Bindings=a,Wl}var Zl={},sw;function VQ(){if(sw)return Zl;sw=1,Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.BindingsFactory=void 0;const i=um,o=Cj();let u=class Uj{constructor(t,e){this.dataFactory=t,this.contextMergeHandlers=e}static async create(t,e,r){return new Uj(r,(await t.mediate({context:e})).mergeHandlers)}bindings(t=[]){return new o.Bindings(this.dataFactory,(0,i.Map)(t.map(([e,r])=>[e.value,r])),this.contextMergeHandlers?{contextMergeHandlers:this.contextMergeHandlers}:void 0)}fromBindings(t){return this.bindings([...t])}fromRecord(t){return this.bindings(Object.entries(t).map(([e,r])=>[this.dataFactory.variable(e),r]))}};return Zl.BindingsFactory=u,Zl}var dw;function G(){return dw||(dw=1,(function(i){var o=sa&&sa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=sa&&sa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(Cj(),i),u(VQ(),i),u(Nj(),i)})(sa)),sa}var lw;function zQ(){if(lw)return Yl;lw=1,Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.ActorRdfJoinOptionalHash=void 0;const i=le(),o=O(),u=G(),a=mm(),t=Le(),e=N(),r=ne();let n=class im extends i.ActorRdfJoin{constructor(s){super(s,{logicalType:"optional",physicalName:`hash-${s.canHandleUndefs?"undef":"def"}-${s.blocking?"blocking":"nonblocking"}`,limitEntries:2,canHandleUndefs:s.canHandleUndefs,requiresVariableOverlap:!0})}static constructIndex(s,l){return s?new a.BindingsIndexUndef(l,d=>d&&d.termType!=="Variable"?(0,r.termToString)(d):"",!0):new a.BindingsIndexDef(l,u.bindingsToCompactString)}async getOutput(s){const l=s.entries[1].output,d=s.entries[0].output,f=await i.ActorRdfJoin.getMetadatas(s.entries),p=i.ActorRdfJoin.overlappingVariables(f);let _;return this.blocking?_=new t.ClosableTransformIterator(async()=>{const y=im.constructIndex(this.canHandleUndefs,p);return await new Promise(m=>{l.bindingsStream.on("data",b=>{(y.getFirst(b,!0)??y.put(b,[])).push(b)}),l.bindingsStream.on("end",m),l.bindingsStream.on("error",b=>{_.emit("error",b)})}),new e.MultiTransformIterator(d.bindingsStream,{multiTransform:m=>new e.ArrayIterator(y.get(m).flat().map(b=>i.ActorRdfJoin.joinBindings(m,b)).filter(b=>b!==null),{autoStart:!1}),optional:!0,autoStart:!1})},{autoStart:!1,onClose(){l.bindingsStream.destroy(),d.bindingsStream.destroy()}}):_=new t.ClosableTransformIterator(async()=>{const y=im.constructIndex(this.canHandleUndefs,p);let m=!0;return l.bindingsStream.on("data",b=>{(y.getFirst(b,!0)??y.put(b,new e.BufferedIterator({autoStart:!1})))._push(b)}),l.bindingsStream.on("end",()=>{for(const b of y.values())b.close();m=!1}),l.bindingsStream.on("error",b=>{_.emit("error",b)}),new e.MultiTransformIterator(d.bindingsStream,{multiTransform:b=>{let h=y.get(b);return h.length===0&&(m?h=[y.put(b,new e.BufferedIterator({autoStart:!1}))]:h=[]),new e.UnionIterator(h.map(T=>T.clone()),{autoStart:!1}).map(T=>i.ActorRdfJoin.joinBindings(b,T))},optional:!0,autoStart:!1})},{autoStart:!1,onClose(){l.bindingsStream.destroy(),d.bindingsStream.destroy()}}),{result:{type:"bindings",bindingsStream:_,metadata:async()=>await this.constructResultMetadata(s.entries,f,s.context,{},!0)}}}async getJoinCoefficients(s,l){const{metadatas:d}=l,f=i.ActorRdfJoin.getRequestInitialTimes(d),p=i.ActorRdfJoin.getRequestItemTimes(d);let _=d[0].cardinality.value+d[1].cardinality.value;return this.canHandleUndefs||(_*=.8),this.blocking&&(_*=.9),(0,o.passTestWithSideData)({iterations:_,persistedItems:d[0].cardinality.value,blockingItems:this.blocking?d[0].cardinality.value:0,requestTime:f[0]+d[0].cardinality.value*p[0]+f[1]+d[1].cardinality.value*p[1]},l)}};return Yl.ActorRdfJoinOptionalHash=n,Yl}var fw;function Zy(){return fw||(fw=1,(function(i){var o=ca&&ca.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ca&&ca.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(zQ(),i)})(ca)),ca}var la={},kl={},pw;function XQ(){if(pw)return kl;pw=1,Object.defineProperty(kl,"__esModule",{value:!0}),kl.ActorRdfJoinOptionalNestedLoop=void 0;const i=le(),o=O(),u=u_();let a=class extends i.ActorRdfJoin{constructor(e){super(e,{logicalType:"optional",physicalName:"nested-loop",limitEntries:2,canHandleUndefs:!0})}async getOutput(e){return{result:{type:"bindings",bindingsStream:new u.NestedLoopJoin(e.entries[0].output.bindingsStream,e.entries[1].output.bindingsStream,i.ActorRdfJoin.joinBindings,{optional:!0,autoStart:!1}),metadata:async()=>await this.constructResultMetadata(e.entries,await i.ActorRdfJoin.getMetadatas(e.entries),e.context,{},!0)}}}async getJoinCoefficients(e,r){const{metadatas:n}=r,c=i.ActorRdfJoin.getRequestInitialTimes(n),s=i.ActorRdfJoin.getRequestItemTimes(n);return(0,o.passTestWithSideData)({iterations:n[0].cardinality.value*n[1].cardinality.value,persistedItems:0,blockingItems:0,requestTime:c[0]+n[0].cardinality.value*s[0]+c[1]+n[1].cardinality.value*s[1]},r)}};return kl.ActorRdfJoinOptionalNestedLoop=a,kl}var yw;function GQ(){return yw||(yw=1,(function(i){var o=la&&la.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=la&&la.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(XQ(),i)})(la)),la}var fa={},ef={},_w;function JQ(){if(_w)return ef;_w=1,Object.defineProperty(ef,"__esModule",{value:!0}),ef.ActorRdfJoinMinusHash=void 0;const i=le(),o=O(),u=G(),a=mm(),t=Le(),e=ne();let r=class Hj extends i.ActorRdfJoin{constructor(c){super(c,{logicalType:"minus",physicalName:`hash-${c.canHandleUndefs?"undef":"def"}`,limitEntries:2,canHandleUndefs:c.canHandleUndefs})}static constructIndex(c,s){return c?new a.BindingsIndexUndef(s,l=>l&&l.termType!=="Variable"?(0,e.termToString)(l):"",!1):new a.BindingsIndexDef(s,u.bindingsToCompactString)}async getOutput(c){const s=c.entries[1].output,l=c.entries[0].output,d=await i.ActorRdfJoin.getMetadatas(c.entries),f=i.ActorRdfJoin.overlappingVariables(d);if(f.length===0)return s.bindingsStream.destroy(),{result:l};const p=new t.ClosableTransformIterator(async()=>{const _=Hj.constructIndex(this.canHandleUndefs,f);return await new Promise(y=>{s.bindingsStream.on("data",m=>_.put(m,!0)),s.bindingsStream.on("end",y),s.bindingsStream.on("error",m=>p.emit("error",m))}),l.bindingsStream.filter(y=>!_.getFirst(y,!0))},{autoStart:!1,onClose(){s.bindingsStream.destroy(),l.bindingsStream.destroy()}});return{result:{type:"bindings",bindingsStream:p,metadata:l.metadata}}}async getJoinCoefficients(c,s){const{metadatas:l}=s,d=i.ActorRdfJoin.getRequestInitialTimes(l),f=i.ActorRdfJoin.getRequestItemTimes(l);let p=l[0].cardinality.value+l[1].cardinality.value;return this.canHandleUndefs||(p*=.8),(0,o.passTestWithSideData)({iterations:p,persistedItems:l[0].cardinality.value,blockingItems:l[0].cardinality.value,requestTime:d[0]+l[0].cardinality.value*f[0]+d[1]+l[1].cardinality.value*f[1]},s)}};return ef.ActorRdfJoinMinusHash=r,ef}var mw;function bw(){return mw||(mw=1,(function(i){var o=fa&&fa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=fa&&fa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(JQ(),i)})(fa)),fa}var pa={},tf={},ya={},rf={},gw;function KQ(){if(gw)return rf;gw=1,Object.defineProperty(rf,"__esModule",{value:!0}),rf.ActorDereferenceRdf=void 0;const i=lm();let o=class extends i.ActorDereferenceParse{constructor(a){super(a)}};return rf.ActorDereferenceRdf=o,rf}var hw;function YQ(){return hw||(hw=1,(function(i){var o=ya&&ya.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ya&&ya.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(KQ(),i)})(ya)),ya}var vw;function WQ(){if(vw)return tf;vw=1,Object.defineProperty(tf,"__esModule",{value:!0}),tf.ActorDereferenceRdfParse=void 0;const i=YQ();let o=class extends i.ActorDereferenceRdf{constructor(a){super(a)}async getMetadata(a){return{baseIRI:a.url}}};return tf.ActorDereferenceRdfParse=o,tf}var Tw;function ZQ(){return Tw||(Tw=1,(function(i){var o=pa&&pa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=pa&&pa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(WQ(),i)})(pa)),pa}var _a={},nf={},af={},Ow;function kQ(){if(Ow)return af;Ow=1,Object.defineProperty(af,"__esModule",{value:!0}),af.HtmlScriptListener=void 0;const i=q(),o=Z(),u=a_();let a=class Cy{constructor(e,r,n,c,s,l,d,f){this.textChunksJsonLd=[],this.endBarrier=1,this.passedScripts=0,this.isFinalJsonLdProcessing=!1,this.mediatorRdfParseHandle=e,this.cbQuad=r,this.cbError=n,this.cbEnd=c,this.supportedTypes=s,this.context=l.set(i.KeysRdfParseHtmlScript.processingHtmlScript,!0),this.baseIRI=d,this.headers=f,this.onlyFirstScript=l.get(i.KeysRdfParseHtmlScript.extractAllScripts)===!1;const p=this.baseIRI.indexOf("#");this.targetScriptId=p>0?this.baseIRI.slice(p+1,this.baseIRI.length):null}static newErrorCoded(e,r){const n=new Error(e);return n.code=r,n}onEnd(){--this.endBarrier===0&&(this.textChunksJsonLd.length>0?(this.handleMediaType="application/ld+json",this.textChunks=this.textChunksJsonLd,this.textChunks.push("]"),this.textChunksJsonLd=[],this.isFinalJsonLdProcessing=!0,this.endBarrier++,this.onTagClose()):(this.passedScripts===0&&this.targetScriptId&&this.cbError(Cy.newErrorCoded(`Failed to find targeted script id "${this.targetScriptId}"`,"loading document failed")),this.cbEnd()),this.isFinalJsonLdProcessing=!1)}onTagClose(){if(this.handleMediaType)if(this.requiresCustomJsonLdHandling(this.handleMediaType)&&!this.isFinalJsonLdProcessing)this.handleMediaType=void 0,this.textChunks=void 0,this.onEnd();else{const e=new o.Readable({objectMode:!0});e._read=()=>{};const r=this.textChunks,n={context:this.context,handle:{metadata:{baseIRI:this.baseIRI},data:e,headers:this.headers,context:this.context},handleMediaType:this.handleMediaType};this.mediatorRdfParseHandle.mediate(n).then(({handle:c})=>{c.data.on("error",s=>this.cbError(Cy.newErrorCoded(s.message,"invalid script element"))).on("data",this.cbQuad).on("end",()=>this.onEnd());for(const s of r)e.push(s);e.push(null)}).catch(c=>{this.targetScriptId?this.cbError(Cy.newErrorCoded(c.message,"loading document failed")):this.onEnd()}),this.handleMediaType=void 0,this.textChunks=void 0}}onTagOpen(e,r){e==="base"&&r.href&&(this.baseIRI=(0,u.resolve)(r.href,this.baseIRI)),e==="script"&&(!this.targetScriptId||r.id===this.targetScriptId)?this.supportedTypes[r.type]?this.onlyFirstScript&&this.passedScripts>0?this.handleMediaType=void 0:(this.passedScripts++,this.handleMediaType=r.type,this.endBarrier++,this.requiresCustomJsonLdHandling(this.handleMediaType)?(this.textChunks=this.textChunksJsonLd,this.textChunks.push(this.textChunks.length===0?"[":",")):this.textChunks=[]):this.targetScriptId&&this.cbError(Cy.newErrorCoded(`Targeted script "${this.targetScriptId}" does not have a supported type`,"loading document failed")):this.handleMediaType=void 0}onText(e){this.handleMediaType&&this.textChunks.push(e)}requiresCustomJsonLdHandling(e){return!this.onlyFirstScript&&!this.targetScriptId&&e==="application/ld+json"}};return af.HtmlScriptListener=a,af}var Aw;function eN(){if(Aw)return nf;Aw=1,Object.defineProperty(nf,"__esModule",{value:!0}),nf.ActorRdfParseHtmlScript=void 0;const i=pm(),o=O(),u=kQ();let a=class extends i.ActorRdfParseHtml{constructor(e){super(e)}async test(e){return(0,o.passTestVoid)()}async run(e){const r=(await this.mediatorRdfParseMediatypes.mediate({context:e.context,mediaTypes:!0})).mediaTypes;return{htmlParseListener:new u.HtmlScriptListener(this.mediatorRdfParseHandle,e.emit,e.error,e.end,r,e.context,e.baseIRI,e.headers)}}};return nf.ActorRdfParseHtmlScript=a,nf}var Sw;function tN(){return Sw||(Sw=1,(function(i){var o=_a&&_a.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=_a&&_a.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(eN(),i)})(_a)),_a}var ma={},of={},Fw;function rN(){if(Fw)return of;Fw=1,Object.defineProperty(of,"__esModule",{value:!0}),of.ActorQueryResultSerializeRdf=void 0;const i=Ae(),o=O();let u=class extends i.ActorQueryResultSerialize{constructor(t){super(t)}async testHandle(t,e,r){if(t.type!=="quads")return(0,o.failTest)(`Actor ${this.name} can only handle quad streams`);const{mediaTypes:n}=await this.mediatorMediaTypeCombiner.mediate({context:r,mediaTypes:!0});return e in n?(0,o.passTestVoid)():(0,o.failTest)(`Actor ${this.name} can not handle media type ${e}. All available types: ${Object.keys(n)}`)}async runHandle(t,e,r){return(await this.mediatorRdfSerialize.mediate({context:r,handle:{context:r,quadStream:t.quadStream},handleMediaType:e})).handle}async testMediaType(t){return(0,o.passTestVoid)()}async getMediaTypes(t){return(await this.mediatorMediaTypeCombiner.mediate({context:t,mediaTypes:!0})).mediaTypes}async testMediaTypeFormats(t){return(0,o.passTestVoid)()}async getMediaTypeFormats(t){return(await this.mediatorMediaTypeFormatCombiner.mediate({context:t,mediaTypeFormats:!0})).mediaTypeFormats}};return of.ActorQueryResultSerializeRdf=u,of}var ww;function nN(){return ww||(ww=1,(function(i){var o=ma&&ma.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ma&&ma.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(rN(),i)})(ma)),ma}var ba={},uf={},ga={},cf={},Rw;function aN(){if(Rw)return cf;Rw=1,Object.defineProperty(cf,"__esModule",{value:!0}),cf.ActorBindingsAggregatorFactory=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a),this.mediatorExpressionEvaluatorFactory=a.mediatorExpressionEvaluatorFactory}};return cf.ActorBindingsAggregatorFactory=o,cf}var sf={},Pw;function iN(){if(Pw)return sf;Pw=1,Object.defineProperty(sf,"__esModule",{value:!0}),sf.AggregateEvaluator=void 0;const i=q(),o=S(),u=ne();let a=class{constructor(e,r,n=!1){this.evaluator=e,this.distinct=r,this.throwError=n,this.errorOccurred=!1,this.errorOccurred=!1,this.superTypeProvider=e.context.getSafe(i.KeysExpressionEvaluator.superTypeProvider),this.termTransformer=new o.TermTransformer(this.superTypeProvider),this.variableValues=new Set}emptyValueTerm(){}emptyValue(){const e=this.emptyValueTerm();if(e===void 0&&this.throwError)throw new o.EmptyAggregateError;return e}async putBindings(e){if(!this.errorOccurred)try{const r=await this.evaluator.evaluate(e);if(!r||this.errorOccurred)return;(!this.distinct||!this.variableValues.has(u.termToString(r)))&&(this.putTerm(r),this.distinct&&this.variableValues.add(u.termToString(r)))}catch(r){this.safeThrow(r)}}async result(){if(!this.errorOccurred)return this.termResult()}safeThrow(e){if(this.throwError)throw e;this.errorOccurred=!0}termToNumericOrError(e){if(e.termType!=="Literal")throw new Error(`Term with value ${e.value} has type ${e.termType} and is not a numeric literal`);if(!o.isSubTypeOf(e.datatype.value,o.TypeAlias.SPARQL_NUMERIC,this.superTypeProvider))throw new Error(`Term datatype ${e.datatype.value} with value ${e.value} has type ${e.termType} and is not a numeric literal`);return this.termTransformer.transformLiteral(e)}};return sf.AggregateEvaluator=a,sf}var qw;function ue(){return qw||(qw=1,(function(i){var o=ga&&ga.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ga&&ga.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(aN(),i),u(iN(),i)})(ga)),ga}var df={},jw;function Vj(){if(jw)return df;jw=1,Object.defineProperty(df,"__esModule",{value:!0}),df.GroupConcatAggregator=void 0;const i=ue(),o=S();let u=class extends i.AggregateEvaluator{constructor(t,e,r,n,c){super(t,e,c),this.dataFactory=r,this.state=void 0,this.lastLanguageValid=!0,this.lastLanguage=void 0,this.separator=n??" "}emptyValueTerm(){return o.typedLiteral("",o.TypeURL.XSD_STRING)}putTerm(t){this.state===void 0?(this.state=t.value,t.termType==="Literal"&&(this.lastLanguage=t.language)):(this.state+=this.separator+t.value,this.lastLanguageValid&&t.termType==="Literal"&&this.lastLanguage!==t.language&&(this.lastLanguageValid=!1,this.lastLanguage=void 0))}termResult(){return this.state===void 0?this.emptyValue():this.lastLanguageValid&&this.lastLanguage?o.langString(this.state,this.lastLanguage).toRDF(this.dataFactory):o.typedLiteral(this.state,o.TypeURL.XSD_STRING)}};return df.GroupConcatAggregator=u,df}var Mw;function oN(){if(Mw)return uf;Mw=1,Object.defineProperty(uf,"__esModule",{value:!0}),uf.ActorBindingsAggregatorFactoryGroupConcat=void 0;const i=ue(),o=q(),u=O(),a=Vj();let t=class extends i.ActorBindingsAggregatorFactory{constructor(r){super(r)}async test(r){return r.expr.aggregator!=="group_concat"?(0,u.failTest)("This actor only supports the 'group_concat' aggregator."):(0,u.passTestVoid)()}async run({context:r,expr:n}){return new a.GroupConcatAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:n.expression,context:r}),n.distinct,r.getSafe(o.KeysInitQuery.dataFactory),n.separator)}};return uf.ActorBindingsAggregatorFactoryGroupConcat=t,uf}var xw;function uN(){return xw||(xw=1,(function(i){var o=ba&&ba.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ba&&ba.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(oN(),i),u(Vj(),i)})(ba)),ba}var ha={},lf={},ff={},Dw;function zj(){if(Dw)return ff;Dw=1,Object.defineProperty(ff,"__esModule",{value:!0}),ff.CountAggregator=void 0;const i=ue(),o=S();let u=class extends i.AggregateEvaluator{constructor(t,e,r){super(t,e,r),this.state=void 0}emptyValueTerm(){return(0,o.typedLiteral)("0",o.TypeURL.XSD_INTEGER)}putTerm(t){this.state===void 0&&(this.state=0),this.state++}termResult(){return this.state===void 0?this.emptyValue():(0,o.typedLiteral)(String(this.state),o.TypeURL.XSD_INTEGER)}};return ff.CountAggregator=u,ff}var Ew;function cN(){if(Ew)return lf;Ew=1,Object.defineProperty(lf,"__esModule",{value:!0}),lf.ActorBindingsAggregatorFactoryCount=void 0;const i=ue(),o=O(),u=$(),a=zj();let t=class extends i.ActorBindingsAggregatorFactory{constructor(r){super(r)}async test(r){return r.expr.aggregator!=="count"||r.expr.expression.expressionType===u.Algebra.expressionTypes.WILDCARD?(0,o.failTest)("This actor only supports the 'count' aggregator without wildcard."):(0,o.passTestVoid)()}async run({context:r,expr:n}){return new a.CountAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:n.expression,context:r}),n.distinct)}};return lf.ActorBindingsAggregatorFactoryCount=t,lf}var Lw;function sN(){return Lw||(Lw=1,(function(i){var o=ha&&ha.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ha&&ha.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(cN(),i),u(zj(),i)})(ha)),ha}var va={},pf={},yf={},Iw;function Xj(){if(Iw)return yf;Iw=1,Object.defineProperty(yf,"__esModule",{value:!0}),yf.SampleAggregator=void 0;const i=ue();let o=class extends i.AggregateEvaluator{constructor(a,t,e){super(a,t,e),this.state=void 0}putTerm(a){this.state===void 0&&(this.state=a)}termResult(){return this.state===void 0?this.emptyValue():this.state}};return yf.SampleAggregator=o,yf}var $w;function dN(){if($w)return pf;$w=1,Object.defineProperty(pf,"__esModule",{value:!0}),pf.ActorBindingsAggregatorFactorySample=void 0;const i=ue(),o=O(),u=Xj();let a=class extends i.ActorBindingsAggregatorFactory{constructor(e){super(e)}async test(e){return e.expr.aggregator!=="sample"?(0,o.failTest)("This actor only supports the 'sample' aggregator."):(0,o.passTestVoid)()}async run({context:e,expr:r}){return new u.SampleAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:r.expression,context:e}),r.distinct)}};return pf.ActorBindingsAggregatorFactorySample=a,pf}var Bw;function lN(){return Bw||(Bw=1,(function(i){var o=va&&va.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=va&&va.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(dN(),i),u(Xj(),i)})(va)),va}var Ta={},_f={},mf={},Qw;function Gj(){if(Qw)return mf;Qw=1,Object.defineProperty(mf,"__esModule",{value:!0}),mf.WildcardCountAggregator=void 0;const i=ue(),o=S(),u=ne();let a=class extends i.AggregateEvaluator{constructor(e,r,n){super(e,r,n),this.bindingValues=new Map,this.state=void 0}putTerm(e){}async putBindings(e){this.handleDistinct(e)||(this.state===void 0&&(this.state=0),this.state+=1)}emptyValueTerm(){return(0,o.typedLiteral)("0",o.TypeURL.XSD_INTEGER)}termResult(){return this.state===void 0?this.emptyValue():(0,o.typedLiteral)(String(this.state),o.TypeURL.XSD_INTEGER)}handleDistinct(e){if(this.distinct){const r=[...e];r.sort((d,f)=>d[0].value.localeCompare(f[0].value));const n=r.map(([d])=>d.value).join(","),c=r.map(([,d])=>u.termToString(d)).join(","),s=this.bindingValues.get(n),l=s!==void 0&&s.has(c);return s||this.bindingValues.set(n,new Set),this.bindingValues.get(n).add(c),l}return!1}};return mf.WildcardCountAggregator=a,mf}var Nw;function fN(){if(Nw)return _f;Nw=1,Object.defineProperty(_f,"__esModule",{value:!0}),_f.ActorBindingsAggregatorFactoryWildcardCount=void 0;const i=ue(),o=O(),u=Gj();let a=class extends i.ActorBindingsAggregatorFactory{constructor(e){super(e)}async test(e){return e.expr.aggregator!=="count"||e.expr.expression.expressionType!=="wildcard"?(0,o.failTest)("This actor only supports the 'count' aggregator with wildcard."):(0,o.passTestVoid)()}async run({context:e,expr:r}){return new u.WildcardCountAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:r.expression,context:e}),r.distinct)}};return _f.ActorBindingsAggregatorFactoryWildcardCount=a,_f}var Cw;function pN(){return Cw||(Cw=1,(function(i){var o=Ta&&Ta.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ta&&Ta.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(fN(),i),u(Gj(),i)})(Ta)),Ta}var Oa={},bf={},gf={},Uw;function Jj(){if(Uw)return gf;Uw=1,Object.defineProperty(gf,"__esModule",{value:!0}),gf.AverageAggregator=void 0;const i=ue(),o=S();let u=class extends i.AggregateEvaluator{constructor(t,e,r,n,c,s){super(t,e,s),this.dataFactory=r,this.additionFunction=n,this.divisionFunction=c,this.state=void 0}emptyValueTerm(){return o.typedLiteral("0",o.TypeURL.XSD_INTEGER)}putTerm(t){if(this.state===void 0){const e=this.termToNumericOrError(t);this.state={sum:e,count:1}}else{const e=this.termToNumericOrError(t);this.state.sum=this.additionFunction.applyOnTerms([this.state.sum,e],this.evaluator),this.state.count++}}termResult(){if(this.state===void 0)return this.emptyValue();const t=new o.IntegerLiteral(this.state.count);return this.divisionFunction.applyOnTerms([this.state.sum,t],this.evaluator).toRDF(this.dataFactory)}};return gf.AverageAggregator=u,gf}var Hw;function yN(){if(Hw)return bf;Hw=1,Object.defineProperty(bf,"__esModule",{value:!0}),bf.ActorBindingsAggregatorFactoryAverage=void 0;const i=ue(),o=q(),u=O(),a=S(),t=Jj();let e=class extends i.ActorBindingsAggregatorFactory{constructor(n){super(n),this.mediatorFunctionFactory=n.mediatorFunctionFactory}async test(n){return n.expr.aggregator!=="avg"?(0,u.failTest)("This actor only supports the 'avg' aggregator."):(0,u.passTestVoid)()}async run({context:n,expr:c}){return new t.AverageAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:c.expression,context:n}),c.distinct,n.getSafe(o.KeysInitQuery.dataFactory),await this.mediatorFunctionFactory.mediate({functionName:a.SparqlOperator.ADDITION,context:n,requireTermExpression:!0}),await this.mediatorFunctionFactory.mediate({functionName:a.SparqlOperator.DIVISION,context:n,requireTermExpression:!0}))}};return bf.ActorBindingsAggregatorFactoryAverage=e,bf}var Vw;function _N(){return Vw||(Vw=1,(function(i){var o=Oa&&Oa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Oa&&Oa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(yN(),i),u(Jj(),i)})(Oa)),Oa}var Aa={},hf={},vf={},zw;function Kj(){if(zw)return vf;zw=1,Object.defineProperty(vf,"__esModule",{value:!0}),vf.SumAggregator=void 0;const i=ue(),o=S();let u=class extends i.AggregateEvaluator{constructor(t,e,r,n,c){super(t,e,c),this.dataFactory=r,this.additionFunction=n,this.state=void 0}emptyValueTerm(){return(0,o.typedLiteral)("0",o.TypeURL.XSD_INTEGER)}putTerm(t){if(this.state===void 0)this.state=this.termToNumericOrError(t);else{const e=this.termToNumericOrError(t);this.state=this.additionFunction.applyOnTerms([this.state,e],this.evaluator)}}termResult(){return this.state===void 0?this.emptyValue():this.state.toRDF(this.dataFactory)}};return vf.SumAggregator=u,vf}var Xw;function mN(){if(Xw)return hf;Xw=1,Object.defineProperty(hf,"__esModule",{value:!0}),hf.ActorBindingsAggregatorFactorySum=void 0;const i=ue(),o=q(),u=O(),a=S(),t=Kj();let e=class extends i.ActorBindingsAggregatorFactory{constructor(n){super(n),this.mediatorFunctionFactory=n.mediatorFunctionFactory}async test(n){return n.expr.aggregator!=="sum"?(0,u.failTest)("This actor only supports the 'sum' aggregator."):(0,u.passTestVoid)()}async run({expr:n,context:c}){return new t.SumAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:n.expression,context:c}),n.distinct,c.getSafe(o.KeysInitQuery.dataFactory),await this.mediatorFunctionFactory.mediate({functionName:a.SparqlOperator.ADDITION,context:c,requireTermExpression:!0}))}};return hf.ActorBindingsAggregatorFactorySum=e,hf}var Gw;function bN(){return Gw||(Gw=1,(function(i){var o=Aa&&Aa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Aa&&Aa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(mN(),i),u(Kj(),i)})(Aa)),Aa}var Sa={},Tf={},Of={},Jw;function gN(){if(Jw)return Of;Jw=1,Object.defineProperty(Of,"__esModule",{value:!0}),Of.ExpressionFunctionIn=void 0;const i=w(),o=S();let u=class extends i.ExpressionFunctionBase{constructor(t){super({arity:Number.POSITIVE_INFINITY,operator:o.SparqlOperator.IN,apply:async e=>{const{args:r,mapping:n,exprEval:c}=e,[s,...l]=r,d=await c.evaluatorExpressionEvaluation(s,n);return await this.inRecursive(d,{...e,args:l},[])}}),this.equalityFunction=t}checkArity(t){return t.length>0}async inRecursive(t,e,r){const{args:n,mapping:c,exprEval:s}=e;if(n.length===0)return r.every(d=>!d)?(0,o.bool)(!1):Promise.reject(new o.InError(r));try{const l=n.shift(),d=await s.evaluatorExpressionEvaluation(l,c);return this.equalityFunction.applyOnTerms([t,d],s).typedValue?(0,o.bool)(!0):this.inRecursive(t,e,[...r,!1])}catch(l){return this.inRecursive(t,e,[...r,l])}}};return Of.ExpressionFunctionIn=u,Of}var Kw;function hN(){if(Kw)return Tf;Kw=1,Object.defineProperty(Tf,"__esModule",{value:!0}),Tf.ActorFunctionFactoryExpressionIn=void 0;const i=w(),o=S(),u=gN();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.IN],termFunction:!1}),this.mediatorFunctionFactory=e.mediatorFunctionFactory}async run(e){const r=await this.mediatorFunctionFactory.mediate({functionName:o.SparqlOperator.EQUAL,requireTermExpression:!0,context:e.context,arguments:e.arguments});return new u.ExpressionFunctionIn(r)}};return Tf.ActorFunctionFactoryExpressionIn=a,Tf}var Yw;function vN(){return Yw||(Yw=1,(function(i){var o=Sa&&Sa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Sa&&Sa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(hN(),i)})(Sa)),Sa}var Fa={},Af={},Sf={},Ww;function TN(){if(Ww)return Sf;Ww=1,Object.defineProperty(Sf,"__esModule",{value:!0}),Sf.ExpressionFunctionNotIn=void 0;const i=w(),o=S();let u=class extends i.ExpressionFunctionBase{constructor(t){super({arity:Number.POSITIVE_INFINITY,operator:o.SparqlOperator.NOT_IN,apply:async e=>{const r=await this.inFunction.apply(e);return(0,o.bool)(!r.typedValue)}}),this.inFunction=t}checkArity(t){return t.length>0}};return Sf.ExpressionFunctionNotIn=u,Sf}var Zw;function ON(){if(Zw)return Af;Zw=1,Object.defineProperty(Af,"__esModule",{value:!0}),Af.ActorFunctionFactoryExpressionNotIn=void 0;const i=w(),o=S(),u=TN();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.NOT_IN],termFunction:!1}),this.mediatorFunctionFactory=e.mediatorFunctionFactory}async run(e){const r=await this.mediatorFunctionFactory.mediate({functionName:o.SparqlOperator.IN,context:e.context,arguments:e.arguments});return new u.ExpressionFunctionNotIn(r)}};return Af.ActorFunctionFactoryExpressionNotIn=a,Af}var kw;function AN(){return kw||(kw=1,(function(i){var o=Fa&&Fa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Fa&&Fa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(ON(),i)})(Fa)),Fa}var wa={},Ff={},wf={},eR;function SN(){if(eR)return wf;eR=1,Object.defineProperty(wf,"__esModule",{value:!0}),wf.TermFunctionGreaterThanEqual=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(t){super({arity:2,operator:o.SparqlOperator.GTE,overloads:(0,o.declare)(o.SparqlOperator.GTE).set(["term","term"],e=>([r,n])=>this.lessThanEqualFunction.applyOnTerms([n,r],e)).collect()}),this.lessThanEqualFunction=t}};return wf.TermFunctionGreaterThanEqual=u,wf}var tR;function FN(){if(tR)return Ff;tR=1,Object.defineProperty(Ff,"__esModule",{value:!0}),Ff.ActorFunctionFactoryTermGreaterThanEqual=void 0;const i=w(),o=S(),u=SN();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.GTE],termFunction:!0}),this.mediatorFunctionFactory=e.mediatorFunctionFactory}async run(e){const r=await this.mediatorFunctionFactory.mediate({functionName:o.SparqlOperator.LTE,requireTermExpression:!0,context:e.context,arguments:e.arguments});return new u.TermFunctionGreaterThanEqual(r)}};return Ff.ActorFunctionFactoryTermGreaterThanEqual=a,Ff}var rR;function wN(){return rR||(rR=1,(function(i){var o=wa&&wa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=wa&&wa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(FN(),i)})(wa)),wa}var Ra={},Rf={},Pf={},nR;function RN(){if(nR)return Pf;nR=1,Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.TermFunctionGreaterThan=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(t){super({arity:2,operator:o.SparqlOperator.GT,overloads:(0,o.declare)(o.SparqlOperator.GT).set(["term","term"],e=>([r,n])=>this.lessThanFunction.applyOnTerms([n,r],e)).collect()}),this.lessThanFunction=t}};return Pf.TermFunctionGreaterThan=u,Pf}var aR;function PN(){if(aR)return Rf;aR=1,Object.defineProperty(Rf,"__esModule",{value:!0}),Rf.ActorFunctionFactoryTermGreaterThan=void 0;const i=w(),o=S(),u=RN();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.GT],termFunction:!0}),this.mediatorFunctionFactory=e.mediatorFunctionFactory}async run(e){const r=await this.mediatorFunctionFactory.mediate({functionName:o.SparqlOperator.LT,requireTermExpression:!0,context:e.context,arguments:e.arguments});return new u.TermFunctionGreaterThan(r)}};return Rf.ActorFunctionFactoryTermGreaterThan=a,Rf}var iR;function qN(){return iR||(iR=1,(function(i){var o=Ra&&Ra.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ra&&Ra.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(PN(),i)})(Ra)),Ra}var Pa={},qf={},jf={},oR;function jN(){if(oR)return jf;oR=1,Object.defineProperty(jf,"__esModule",{value:!0}),jf.TermFunctionInequality=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(t){super({arity:2,operator:o.SparqlOperator.NOT_EQUAL,overloads:(0,o.declare)(o.SparqlOperator.NOT_EQUAL).set(["term","term"],e=>([r,n])=>(0,o.bool)(!this.equalityFunction.applyOnTerms([r,n],e).typedValue)).collect()}),this.equalityFunction=t}};return jf.TermFunctionInequality=u,jf}var uR;function MN(){if(uR)return qf;uR=1,Object.defineProperty(qf,"__esModule",{value:!0}),qf.ActorFunctionFactoryTermInequality=void 0;const i=w(),o=S(),u=jN();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.NOT_EQUAL],termFunction:!0}),this.mediatorFunctionFactory=e.mediatorFunctionFactory}async run(e){const r=await this.mediatorFunctionFactory.mediate({functionName:o.SparqlOperator.EQUAL,requireTermExpression:!0,context:e.context,arguments:e.arguments});return new u.TermFunctionInequality(r)}};return qf.ActorFunctionFactoryTermInequality=a,qf}var cR;function xN(){return cR||(cR=1,(function(i){var o=Pa&&Pa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Pa&&Pa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(MN(),i)})(Pa)),Pa}var qa={},Mf={},xf={},sR;function DN(){if(sR)return xf;sR=1,Object.defineProperty(xf,"__esModule",{value:!0}),xf.TermFunctionLesserThanEqual=void 0;const i=w(),o=S();let u=class extends i.TermFunctionBase{constructor(t,e){super({arity:2,operator:o.SparqlOperator.LTE,overloads:(0,o.declare)(o.SparqlOperator.LTE).set(["term","term"],r=>([n,c])=>(0,o.bool)(this.lessThanFunction.applyOnTerms([n,c],r).typedValue||this.equalityFunction.applyOnTerms([n,c],r).typedValue)).collect()}),this.equalityFunction=t,this.lessThanFunction=e}};return xf.TermFunctionLesserThanEqual=u,xf}var dR;function EN(){if(dR)return Mf;dR=1,Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.ActorFunctionFactoryTermLesserThanEqual=void 0;const i=w(),o=S(),u=DN();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.LTE],termFunction:!0}),this.mediatorFunctionFactory=e.mediatorFunctionFactory}async run(e){const r=await this.mediatorFunctionFactory.mediate({functionName:o.SparqlOperator.EQUAL,requireTermExpression:!0,context:e.context,arguments:e.arguments}),n=await this.mediatorFunctionFactory.mediate({functionName:o.SparqlOperator.LT,requireTermExpression:!0,context:e.context,arguments:e.arguments});return new u.TermFunctionLesserThanEqual(r,n)}};return Mf.ActorFunctionFactoryTermLesserThanEqual=a,Mf}var lR;function LN(){return lR||(lR=1,(function(i){var o=qa&&qa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=qa&&qa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(EN(),i)})(qa)),qa}var ja={},Df={},Ef={},fR;function IN(){if(fR)return Ef;fR=1,Object.defineProperty(Ef,"__esModule",{value:!0}),Ef.TermFunctionLesserThan=void 0;const i=w(),o=q(),u=S();let a=class extends i.TermFunctionBase{constructor(e){super({arity:2,operator:u.SparqlOperator.LT,overloads:(0,u.declare)(u.SparqlOperator.LT).numberTest(()=>(r,n)=>r<n).stringTest(()=>(r,n)=>r.localeCompare(n)===-1).booleanTest(()=>(r,n)=>r<n).dateTimeTest(r=>(n,c)=>(0,u.toUTCDate)(n,r.context.getSafe(o.KeysExpressionEvaluator.defaultTimeZone)).getTime()<(0,u.toUTCDate)(c,r.context.getSafe(o.KeysExpressionEvaluator.defaultTimeZone)).getTime()).copy({from:[u.TypeURL.XSD_DATE_TIME,u.TypeURL.XSD_DATE_TIME],to:[u.TypeURL.XSD_DATE,u.TypeURL.XSD_DATE]}).set([u.TypeURL.XSD_YEAR_MONTH_DURATION,u.TypeURL.XSD_YEAR_MONTH_DURATION],()=>([r,n])=>(0,u.bool)((0,u.yearMonthDurationsToMonths)((0,u.defaultedYearMonthDurationRepresentation)(r.typedValue))<(0,u.yearMonthDurationsToMonths)((0,u.defaultedYearMonthDurationRepresentation)(n.typedValue)))).set([u.TypeURL.XSD_DAY_TIME_DURATION,u.TypeURL.XSD_DAY_TIME_DURATION],()=>([r,n])=>(0,u.bool)((0,u.dayTimeDurationsToSeconds)((0,u.defaultedDayTimeDurationRepresentation)(r.typedValue))<(0,u.dayTimeDurationsToSeconds)((0,u.defaultedDayTimeDurationRepresentation)(n.typedValue)))).set([u.TypeURL.XSD_TIME,u.TypeURL.XSD_TIME],r=>([n,c])=>(0,u.bool)((0,u.toUTCDate)((0,u.defaultedDateTimeRepresentation)(n.typedValue),r.context.getSafe(o.KeysExpressionEvaluator.defaultTimeZone)).getTime()<(0,u.toUTCDate)((0,u.defaultedDateTimeRepresentation)(c.typedValue),r.context.getSafe(o.KeysExpressionEvaluator.defaultTimeZone)).getTime())).set(["quad","quad"],r=>([n,c])=>{const s=this.quadComponentTest(n.subject,c.subject,r);if(s!==void 0)return(0,u.bool)(s);const l=this.quadComponentTest(n.predicate,c.predicate,r);if(l!==void 0)return(0,u.bool)(l);const d=this.quadComponentTest(n.object,c.object,r);return d!==void 0?(0,u.bool)(d):(0,u.bool)(this.quadComponentTest(n.graph,c.graph,r)??!1)},!1).collect()}),this.equalityFunction=e}quadComponentTest(e,r,n){return this.equalityFunction.applyOnTerms([e,r],n).typedValue?void 0:this.applyOnTerms([e,r],n).typedValue}};return Ef.TermFunctionLesserThan=a,Ef}var pR;function $N(){if(pR)return Df;pR=1,Object.defineProperty(Df,"__esModule",{value:!0}),Df.ActorFunctionFactoryTermLesserThan=void 0;const i=w(),o=S(),u=IN();let a=class extends i.ActorFunctionFactoryDedicated{constructor(e){super({...e,functionNames:[o.SparqlOperator.LT],termFunction:!0}),this.mediatorFunctionFactory=e.mediatorFunctionFactory}async run(e){const r=await this.mediatorFunctionFactory.mediate({functionName:o.SparqlOperator.EQUAL,requireTermExpression:!0,context:e.context,arguments:e.arguments});return new u.TermFunctionLesserThan(r)}};return Df.ActorFunctionFactoryTermLesserThan=a,Df}var yR;function BN(){return yR||(yR=1,(function(i){var o=ja&&ja.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ja&&ja.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u($N(),i)})(ja)),ja}var Ma={},Lf={},_R;function QN(){if(_R)return Lf;_R=1,Object.defineProperty(Lf,"__esModule",{value:!0}),Lf.ActorHttpWayback=void 0;const i=qe(),o=q(),u=O(),a=Oo(),t="http://wayback.archive-it.org/";function e(c){const s=new Request(c.input,c.init);return{input:new Request(new URL(`/${s.url}`,t),s)}}function r(c){const s=c.get(o.KeysHttpProxy.httpProxyHandler);return s?l=>s.getProxy(e(l)):l=>Promise.resolve(e(l))}let n=class extends i.ActorHttp{constructor(s){super(s)}async test(s){return(0,u.passTestVoid)()}async run(s){let l=await this.mediatorHttp.mediate(s);if(l.status===404&&s.context.get(o.KeysHttpWayback.recoverBrokenLinks)){let d=await this.mediatorHttp.mediate({...s,context:s.context.set(o.KeysHttpWayback.recoverBrokenLinks,!1).set(o.KeysHttpProxy.httpProxyHandler,{getProxy:r(s.context)})});d.status===200&&([l,d]=[d,l]);const{body:f}=d;f&&("cancel"in f&&typeof f.cancel=="function"?await f.cancel():"destroy"in f&&typeof f.destroy=="function"?f.destroy():await(0,a.stringify)(i.ActorHttp.toNodeReadable(f)))}return l}};return Lf.ActorHttpWayback=n,Lf}var mR;function NN(){return mR||(mR=1,(function(i){var o=Ma&&Ma.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ma&&Ma.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(QN(),i)})(Ma)),Ma}var xa={},If={},$f={},bR;function Wj(){if(bR)return $f;bR=1,Object.defineProperty($f,"__esModule",{value:!0}),$f.DocumentLoaderMediated=void 0;const i=qe(),o=Oo(),u=bx();let a=class Yj extends u.FetchDocumentLoader{constructor(e,r){super(Yj.createFetcher(e,r)),this.mediatorHttp=e,this.context=r}static createFetcher(e,r){return async(n,c)=>{const s=await e.mediate({input:n,init:c,context:r});return s.json=async()=>JSON.parse(await(0,o.stringify)(i.ActorHttp.toNodeReadable(s.body))),s}}};return $f.DocumentLoaderMediated=a,$f}var gR;function CN(){if(gR)return If;gR=1,Object.defineProperty(If,"__esModule",{value:!0}),If.ActorRdfParseJsonLd=void 0;const i=So(),o=q(),u=O(),a=gx(),t=Wj();let e=class extends i.ActorRdfParseFixedMediaTypes{constructor(n){super(n)}async testHandle(n,c,s){return s.has(o.KeysRdfParseHtmlScript.processingHtmlScript)&&c!=="application/ld+json"?(0,u.failTest)("JSON-LD in script tags can only have media type 'application/ld+json'"):!c||!(c in this.mediaTypePriorities||c.endsWith("+json"))?(0,u.failTest)(`Unrecognized media type: ${c}`):await this.testHandleChecked(n)}async runHandle(n,c,s){var p;const l=n.context.getSafe(o.KeysInitQuery.dataFactory);return{data:a.JsonLdParser.fromHttpResponse(((p=n.metadata)==null?void 0:p.baseIRI)??"",c,n.headers,{dataFactory:l,documentLoader:s.get(o.KeysRdfParseJsonLd.documentLoader)??new t.DocumentLoaderMediated(this.mediatorHttp,s),strictValues:s.get(o.KeysRdfParseJsonLd.strictValues),...s.get(o.KeysRdfParseJsonLd.parserOptions)}).import(n.data)}}};return If.ActorRdfParseJsonLd=e,If}var hR;function UN(){return hR||(hR=1,(function(i){var o=xa&&xa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=xa&&xa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(CN(),i),u(Wj(),i)})(xa)),xa}var Da={},Bf={},Ea={},Qf={},vR;function HN(){if(vR)return Qf;vR=1,Object.defineProperty(Qf,"__esModule",{value:!0}),Qf.ActorRdfUpdateHypermedia=void 0;const i=O();let o=class extends i.Actor{constructor(a,t){super(a),this.destinationType=t}async test(a){return a.forceDestinationType&&this.destinationType!==a.forceDestinationType?(0,i.failTest)(`Actor ${this.name} is not able to handle destination type ${a.forceDestinationType}.`):this.testMetadata(a)}};return Qf.ActorRdfUpdateHypermedia=o,Qf}var TR;function bm(){return TR||(TR=1,(function(i){var o=Ea&&Ea.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ea&&Ea.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(HN(),i)})(Ea)),Ea}var Nf={},OR;function Zj(){if(OR)return Nf;OR=1,Object.defineProperty(Nf,"__esModule",{value:!0}),Nf.QuadDestinationPatchSparqlUpdate=void 0;const i=qe(),o=N(),u=n_(),a=Z();let t=class{constructor(r,n,c){this.url=r,this.context=n,this.mediatorHttp=c}async update(r){const n=this.createCombinedQuadsQuery(r.insert,r.delete);await this.wrapSparqlUpdateRequest(n)}createCombinedQuadsQuery(r,n){return new o.ArrayIterator([],{autoStart:!1}).append(this.createQuadsQuery("DELETE",n)).append(n&&r?[` ;
`]:[]).append(this.createQuadsQuery("INSERT",r))}createQuadsQuery(r,n){return n?n.map(c=>{let s=`${(0,u.termToString)(c.subject)} ${(0,u.termToString)(c.predicate)} ${(0,u.termToString)(c.object)} .`;return c.graph.termType==="DefaultGraph"?s=`  ${s}
`:s=`  GRAPH ${(0,u.termToString)(c.graph)} { ${s} }
`,s}).prepend([`${r} DATA {
`]).append(["}"]):new o.ArrayIterator([],{autoStart:!1})}async wrapSparqlUpdateRequest(r){const n=new a.Readable;n.wrap(r);const c=new Headers({"content-type":"application/sparql-update"}),s=await this.mediatorHttp.mediate({context:this.context,init:{headers:c,method:"PATCH",body:i.ActorHttp.toWebReadableStream(n)},input:this.url});await(0,i.validateAndCloseHttpResponse)(this.url,s)}async deleteGraphs(r,n,c){throw new Error("Patch-based SPARQL Update destinations don't support named graphs")}async createGraphs(r,n){throw new Error("Patch-based SPARQL Update destinations don't support named graphs")}};return Nf.QuadDestinationPatchSparqlUpdate=t,Nf}var AR;function VN(){if(AR)return Bf;AR=1,Object.defineProperty(Bf,"__esModule",{value:!0}),Bf.ActorRdfUpdateHypermediaPatchSparqlUpdate=void 0;const i=bm(),o=O(),u=Zj();let a=class extends i.ActorRdfUpdateHypermedia{constructor(e){super(e,"patchSparqlUpdate")}async testMetadata(e){return!e.forceDestinationType&&!e.metadata.patchSparqlUpdate?(0,o.failTest)(`Actor ${this.name} could not detect a destination with 'application/sparql-update' as 'Accept-Patch' header.`):!e.forceDestinationType&&!e.exists?(0,o.failTest)(`Actor ${this.name} can only patch a destination that already exists.`):(0,o.passTestVoid)()}async run(e){return this.logInfo(e.context,`Identified as patchSparqlUpdate destination: ${e.url}`),{destination:new u.QuadDestinationPatchSparqlUpdate(e.url,e.context,this.mediatorHttp)}}};return Bf.ActorRdfUpdateHypermediaPatchSparqlUpdate=a,Bf}var SR;function zN(){return SR||(SR=1,(function(i){var o=Da&&Da.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Da&&Da.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(VN(),i),u(Zj(),i)})(Da)),Da}var La={},Cf={},Uf={},FR;function kj(){if(FR)return Uf;FR=1,Object.defineProperty(Uf,"__esModule",{value:!0}),Uf.QuadDestinationPutLdp=void 0;const i=qe();let o=class{constructor(a,t,e,r,n,c){this.url=a,this.context=t,this.mediaTypes=e,this.mediatorHttp=r,this.mediatorRdfSerializeMediatypes=n,this.mediatorRdfSerialize=c}async update(a){if(a.delete)throw new Error("Put-based LDP destinations don't support deletions");a.insert&&await this.wrapRdfUpdateRequest("INSERT",a.insert)}async wrapRdfUpdateRequest(a,t){const{mediaTypes:e}=await this.mediatorRdfSerializeMediatypes.mediate({context:this.context,mediaTypes:!0}),r=this.mediaTypes.filter(d=>d in e),n=r.length>0?r[0]:Object.keys(e).sort((d,f)=>e[f]-e[d])[0],{handle:{data:c}}=await this.mediatorRdfSerialize.mediate({context:this.context,handle:{quadStream:t,context:this.context},handleMediaType:n}),s=new Headers({"content-type":n}),l=await this.mediatorHttp.mediate({context:this.context,init:{headers:s,method:"PUT",body:i.ActorHttp.toWebReadableStream(c)},input:this.url});await(0,i.validateAndCloseHttpResponse)(this.url,l)}async deleteGraphs(a,t,e){throw new Error("Put-based LDP destinations don't support named graphs")}async createGraphs(a,t){throw new Error("Put-based LDP destinations don't support named graphs")}};return Uf.QuadDestinationPutLdp=o,Uf}var wR;function XN(){if(wR)return Cf;wR=1,Object.defineProperty(Cf,"__esModule",{value:!0}),Cf.ActorRdfUpdateHypermediaPutLdp=void 0;const i=bm(),o=O(),u=kj();let a=class extends i.ActorRdfUpdateHypermedia{constructor(e){super(e,"putLdp")}async testMetadata(e){if(!e.forceDestinationType){if(!e.metadata.allowHttpMethods||!e.metadata.allowHttpMethods.includes("PUT"))return(0,o.failTest)(`Actor ${this.name} could not detect a destination with 'Allow: PUT' header.`);if(e.exists)return(0,o.failTest)(`Actor ${this.name} can only put on a destination that does not already exists.`)}return(0,o.passTestVoid)()}async run(e){return this.logInfo(e.context,`Identified as putLdp destination: ${e.url}`),{destination:new u.QuadDestinationPutLdp(e.url,e.context,e.metadata.putAccepted||[],this.mediatorHttp,this.mediatorRdfSerializeMediatypes,this.mediatorRdfSerialize)}}};return Cf.ActorRdfUpdateHypermediaPutLdp=a,Cf}var RR;function GN(){return RR||(RR=1,(function(i){var o=La&&La.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=La&&La.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(XN(),i),u(kj(),i)})(La)),La}var Ia={},Hf={},Vf={},PR;function eM(){if(PR)return Vf;PR=1,Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.QuadDestinationSparql=void 0;const i=Oo(),o=N(),u=oj(),a=n_();let t=class{constructor(r,n,c,s){this.url=r,this.context=n,this.mediatorHttp=c,this.endpointFetcher=new u.SparqlEndpointFetcher({fetch:(l,d)=>this.mediatorHttp.mediate({input:l,init:d,context:this.context}),prefixVariableQuestionMark:!0,dataFactory:s})}async update(r){const n=this.createCombinedQuadsQuery(r.insert,r.delete);await this.wrapSparqlUpdateRequest(n)}createCombinedQuadsQuery(r,n){return new o.ArrayIterator([],{autoStart:!1}).append(this.createQuadsQuery("DELETE",n)).append(n&&r?[` ;
`]:[]).append(this.createQuadsQuery("INSERT",r))}createQuadsQuery(r,n){return n?n.map(c=>{let s=`${(0,a.termToString)(c.subject)} ${(0,a.termToString)(c.predicate)} ${(0,a.termToString)(c.object)} .`;return c.graph.termType==="DefaultGraph"?s=`  ${s}
`:s=`  GRAPH ${(0,a.termToString)(c.graph)} { ${s} }
`,s}).prepend([`${r} DATA {
`]).append(["}"]):new o.ArrayIterator([],{autoStart:!1})}async wrapSparqlUpdateRequest(r){const n=await(0,i.stringify)(r);await this.endpointFetcher.fetchUpdate(this.url,n)}async deleteGraphs(r,n,c){const s=Array.isArray(r)?r:[r],l=[];for(const d of s){let f;typeof d=="string"?f=d:d.termType==="DefaultGraph"?f="DEFAULT":f=`GRAPH <${d.value}>`,l.push(`${c?"DROP":"CLEAR"} ${n?"":"SILENT "}${f}`)}await this.endpointFetcher.fetchUpdate(this.url,l.join("; "))}async createGraphs(r,n){const c=[];for(const s of r)c.push(`CREATE${n?"":" SILENT"} GRAPH <${s.value}>`);await this.endpointFetcher.fetchUpdate(this.url,c.join("; "))}};return Vf.QuadDestinationSparql=t,Vf}var qR;function JN(){if(qR)return Hf;qR=1,Object.defineProperty(Hf,"__esModule",{value:!0}),Hf.ActorRdfUpdateHypermediaSparql=void 0;const i=bm(),o=q(),u=O(),a=eM();let t=class extends i.ActorRdfUpdateHypermedia{constructor(r){super(r,"sparql")}async testMetadata(r){return!r.forceDestinationType&&!r.metadata.sparqlService&&!(this.checkUrlSuffixSparql&&(r.url.endsWith("/sparql")||r.url.endsWith("/sparql/")))&&!(this.checkUrlSuffixUpdate&&(r.url.endsWith("/update")||r.url.endsWith("/update/")))?(0,u.failTest)(`Actor ${this.name} could not detect a SPARQL service description or URL ending on /sparql or /update.`):(0,u.passTestVoid)()}async run(r){this.logInfo(r.context,`Identified as sparql destination: ${r.url}`);const n=r.context.getSafe(o.KeysInitQuery.dataFactory);return{destination:new a.QuadDestinationSparql(r.metadata.sparqlService||r.url,r.context,this.mediatorHttp,n)}}};return Hf.ActorRdfUpdateHypermediaSparql=t,Hf}var jR;function KN(){return jR||(jR=1,(function(i){var o=Ia&&Ia.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ia&&Ia.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(JN(),i),u(eM(),i)})(Ia)),Ia}var $a={},zf={},MR;function YN(){if(MR)return zf;MR=1,Object.defineProperty(zf,"__esModule",{value:!0}),zf.ActorQueryOperationAsk=void 0;const i=X(),o=O(),u=Q();let a=class extends i.ActorQueryOperationTypedMediated{constructor(e){super(e,"ask")}async testOperation(e,r){return(0,o.passTestVoid)()}async runOperation(e,r){const n=await this.mediatorQueryOperation.mediate({operation:e.input,context:r}),{bindingsStream:c}=(0,u.getSafeBindings)(n);return{type:"boolean",execute:async()=>(await c.take(1).toArray()).length===1}}};return zf.ActorQueryOperationAsk=a,zf}var xR;function WN(){return xR||(xR=1,(function(i){var o=$a&&$a.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=$a&&$a.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(YN(),i)})($a)),$a}var Ba={},Xf={},DR;function ZN(){if(DR)return Xf;DR=1,Object.defineProperty(Xf,"__esModule",{value:!0}),Xf.ActorQueryOperationBgpJoin=void 0;const i=X(),o=q(),u=O(),a=$();let t=class extends i.ActorQueryOperationTypedMediated{constructor(r){super(r,"bgp")}async testOperation(r,n){return(0,u.passTestVoid)()}async runOperation(r,n){const c=n.getSafe(o.KeysInitQuery.dataFactory),s=new a.Factory(c);return this.mediatorQueryOperation.mediate({operation:s.createJoin(r.patterns),context:n})}};return Xf.ActorQueryOperationBgpJoin=t,Xf}var ER;function kN(){return ER||(ER=1,(function(i){var o=Ba&&Ba.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ba&&Ba.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(ZN(),i)})(Ba)),Ba}var Qa={},Gf={},Jf={},LR;function tM(){if(LR)return Jf;LR=1,Object.defineProperty(Jf,"__esModule",{value:!0}),Jf.BindingsToQuadsIterator=void 0;const i=N(),o=Oe();let u=class Uy extends i.MultiTransformIterator{constructor(t,e,r){super(r,{autoStart:!1}),this.dataFactory=t,this.template=e,this.blankNodeCounter=0}static bindTerm(t,e){return e.termType==="Variable"?t.get(e):e}static bindQuad(t,e){try{return(0,o.mapTermsNested)(e,r=>{const n=Uy.bindTerm(t,r);if(!n)throw new Error("Unbound term");return n})}catch{}}static localizeBlankNode(t,e,r){return r.termType==="BlankNode"?t.blankNode(`${r.value}${e}`):r}static localizeQuad(t,e,r){return(0,o.mapTermsNested)(r,n=>Uy.localizeBlankNode(t,e,n))}bindTemplate(t,e,r){return e.map(Uy.localizeQuad.bind(null,this.dataFactory,r)).map(c=>Uy.bindQuad.bind(null,t)(c)).filter(Boolean)}_createTransformer(t){return new i.ArrayIterator(this.bindTemplate(t,this.template,this.blankNodeCounter++),{autoStart:!1})}};return Jf.BindingsToQuadsIterator=u,Jf}var IR;function eC(){if(IR)return Gf;IR=1,Object.defineProperty(Gf,"__esModule",{value:!0}),Gf.ActorQueryOperationConstruct=void 0;const i=X(),o=q(),u=O(),a=Q(),t=Oe(),e=$(),r=tM();let n=class rM extends i.ActorQueryOperationTypedMediated{constructor(s){super(s,"construct")}static getVariables(s){return(0,t.uniqTerms)([].concat.apply([],s.map(l=>(0,t.getVariables)((0,t.getTermsNested)(l)))))}async testOperation(s,l){return(0,u.passTestVoid)()}async runOperation(s,l){const d=l.getSafe(o.KeysInitQuery.dataFactory),f=rM.getVariables(s.template),p={type:e.Algebra.types.PROJECT,input:s.input,variables:f},_=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:p,context:l})),y=new r.BindingsToQuadsIterator(d,s.template,_.bindingsStream);return{metadata:()=>_.metadata().then(b=>({...b,order:void 0,cardinality:{type:b.cardinality.type,value:b.cardinality.value*s.template.length},availableOrders:void 0})),quadStream:y,type:"quads"}}};return Gf.ActorQueryOperationConstruct=n,Gf}var $R;function nM(){return $R||($R=1,(function(i){var o=Qa&&Qa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Qa&&Qa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(eC(),i),u(tM(),i)})(Qa)),Qa}var Na={},Kf={},J_={},Te={},Ca={},Yf={},BR;function aM(){if(BR)return Yf;BR=1,Object.defineProperty(Yf,"__esModule",{value:!0}),Yf.BlankNode=void 0;let i=class{constructor(u){this.termType="BlankNode",this.value=u}equals(u){return!!u&&u.termType==="BlankNode"&&u.value===this.value}};return Yf.BlankNode=i,Yf}var Wf={},Zf={},QR;function iM(){if(QR)return Zf;QR=1,Object.defineProperty(Zf,"__esModule",{value:!0}),Zf.DefaultGraph=void 0;let i=class{constructor(){this.termType="DefaultGraph",this.value=""}equals(u){return!!u&&u.termType==="DefaultGraph"}};return Zf.DefaultGraph=i,i.INSTANCE=new i,Zf}var kf={},ep={},NR;function gm(){if(NR)return ep;NR=1,Object.defineProperty(ep,"__esModule",{value:!0}),ep.NamedNode=void 0;let i=class{constructor(u){this.termType="NamedNode",this.value=u}equals(u){return!!u&&u.termType==="NamedNode"&&u.value===this.value}};return ep.NamedNode=i,ep}var CR;function oM(){if(CR)return kf;CR=1,Object.defineProperty(kf,"__esModule",{value:!0}),kf.Literal=void 0;const i=gm();let o=class Hy{constructor(a,t){this.termType="Literal",this.value=a,typeof t=="string"?(this.language=t,this.datatype=Hy.RDF_LANGUAGE_STRING,this.direction=""):t?"termType"in t?(this.language="",this.datatype=t,this.direction=""):(this.language=t.language,this.datatype=t.direction?Hy.RDF_DIRECTIONAL_LANGUAGE_STRING:Hy.RDF_LANGUAGE_STRING,this.direction=t.direction||""):(this.language="",this.datatype=Hy.XSD_STRING,this.direction="")}equals(a){return!!a&&a.termType==="Literal"&&a.value===this.value&&a.language===this.language&&(a.direction===this.direction||!a.direction&&this.direction==="")&&this.datatype.equals(a.datatype)}};return kf.Literal=o,o.RDF_LANGUAGE_STRING=new i.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),o.RDF_DIRECTIONAL_LANGUAGE_STRING=new i.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#dirLangString"),o.XSD_STRING=new i.NamedNode("http://www.w3.org/2001/XMLSchema#string"),kf}var tp={},UR;function uM(){if(UR)return tp;UR=1,Object.defineProperty(tp,"__esModule",{value:!0}),tp.Quad=void 0;let i=class{constructor(u,a,t,e){this.termType="Quad",this.value="",this.subject=u,this.predicate=a,this.object=t,this.graph=e}equals(u){return!!u&&(u.termType==="Quad"||!u.termType)&&this.subject.equals(u.subject)&&this.predicate.equals(u.predicate)&&this.object.equals(u.object)&&this.graph.equals(u.graph)}};return tp.Quad=i,tp}var rp={},HR;function cM(){if(HR)return rp;HR=1,Object.defineProperty(rp,"__esModule",{value:!0}),rp.Variable=void 0;let i=class{constructor(u){this.termType="Variable",this.value=u}equals(u){return!!u&&u.termType==="Variable"&&u.value===this.value}};return rp.Variable=i,rp}var VR;function tC(){if(VR)return Wf;VR=1,Object.defineProperty(Wf,"__esModule",{value:!0}),Wf.DataFactory=void 0;const i=aM(),o=iM(),u=oM(),a=gm(),t=uM(),e=cM();let r=0,n=class{constructor(s){this.blankNodeCounter=0,s=s||{},this.blankNodePrefix=s.blankNodePrefix||`df_${r++}_`}namedNode(s){return new a.NamedNode(s)}blankNode(s){return new i.BlankNode(s||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(s,l){return new u.Literal(s,l)}variable(s){return new e.Variable(s)}defaultGraph(){return o.DefaultGraph.INSTANCE}quad(s,l,d,f){return new t.Quad(s,l,d,f||this.defaultGraph())}fromTerm(s){switch(s.termType){case"NamedNode":return this.namedNode(s.value);case"BlankNode":return this.blankNode(s.value);case"Literal":return s.language?this.literal(s.value,s.language):s.datatype.equals(u.Literal.XSD_STRING)?this.literal(s.value):this.literal(s.value,this.fromTerm(s.datatype));case"Variable":return this.variable(s.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(s.subject),this.fromTerm(s.predicate),this.fromTerm(s.object),this.fromTerm(s.graph))}}fromQuad(s){return this.fromTerm(s)}resetBlankNodeCounter(){this.blankNodeCounter=0}};return Wf.DataFactory=n,Wf}var zR;function rC(){return zR||(zR=1,(function(i){var o=Ca&&Ca.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ca&&Ca.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(aM(),i),u(tC(),i),u(iM(),i),u(oM(),i),u(gm(),i),u(uM(),i),u(cM(),i)})(Ca)),Ca}var XR;function nC(){if(XR)return Te;XR=1,Object.defineProperty(Te,"__esModule",{value:!0}),Te.termToString=u,Te.getLiteralValue=a,Te.getLiteralType=t,Te.getLiteralLanguage=e,Te.getLiteralDirection=r,Te.stringToTerm=n,Te.quadToStringQuad=c,Te.stringQuadToQuad=s;const i=rC(),o=new i.DataFactory;function u(l){if(l)switch(l.termType){case"NamedNode":return l.value;case"BlankNode":return"_:"+l.value;case"Literal":const d=l;return'"'+d.value+'"'+(d.datatype&&d.datatype.value!=="http://www.w3.org/2001/XMLSchema#string"&&d.datatype.value!=="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"&&d.datatype.value!=="http://www.w3.org/1999/02/22-rdf-syntax-ns#dirLangString"?"^^"+d.datatype.value:"")+(d.language?"@"+d.language:"")+(d.direction?"--"+d.direction:"");case"Quad":return`<<${u(l.subject)} ${u(l.predicate)} ${u(l.object)}${l.graph.termType==="DefaultGraph"?"":" "+u(l.graph)}>>`;case"Variable":return"?"+l.value;case"DefaultGraph":return l.value}}function a(l){const d=/^"([^]*)"/.exec(l);if(!d)throw new Error(l+" is not a literal");return d[1]}function t(l){const d=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(l);if(!d)throw new Error(l+" is not a literal");return d[1]||(d[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")}function e(l){const d=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(l);if(!d)throw new Error(l+" is not a literal");if(d[1]){let f=d[1].toLowerCase();const p=f.indexOf("--");return p>=0&&(f=f.slice(0,p)),f}return""}function r(l){const d=l.indexOf("--",l.lastIndexOf('"'));if(d>=0){const f=l.slice(d+2,l.length);if(f==="ltr"||f==="rtl")return f;throw new Error(l+" is not a literal with a valid direction")}return""}function n(l,d){if(d=d||o,!l||!l.length)return d.defaultGraph();switch(l[0]){case"_":return d.blankNode(l.substr(2));case"?":if(!d.variable)throw new Error("Missing 'variable()' method on the given DataFactory");return d.variable(l.substr(1));case'"':const f=e(l),p=r(l),_=d.namedNode(t(l));return d.literal(a(l),f?{language:f,direction:p}:_);case"<":default:if(l[0]==="<"&&l.length>4&&l[1]==="<"&&l[l.length-1]===">"&&l[l.length-2]===">"){const y=l.slice(2,-2).trim();let m=[],b=0,h=0,g=!1;for(let T=0;T<y.length;T++){const v=y[T];if(v==="<"&&b++,v===">"){if(b===0)throw new Error("Found closing tag without opening tag in "+l);b--}if(v==='"'){let F=!1,P=T;for(;P-- >0&&y[P]==="\\";)F=!F;F||(g=!g)}if(v===" "&&!g&&b===0){for(m.push(y.slice(h,T));y[T+1]===" ";)T+=1;h=T+1}}if(b!==0)throw new Error("Found opening tag without closing tag in "+l);if(m.push(y.slice(h,y.length)),m.length!==3&&m.length!==4)throw new Error("Nested quad syntax error "+l);return m=m.map(T=>T.startsWith("<")&&!T.includes(" ")?T.slice(1,-1):T),d.quad(n(m[0]),n(m[1]),n(m[2]),m[3]?n(m[3]):void 0)}return d.namedNode(l)}}function c(l){return{subject:u(l.subject),predicate:u(l.predicate),object:u(l.object),graph:u(l.graph)}}function s(l,d){return d=d||o,d.quad(n(l.subject,d),n(l.predicate,d),n(l.object,d),n(l.graph,d))}return Te}var GR;function aC(){return GR||(GR=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.termToString=i.stringToTerm=i.stringQuadToQuad=i.quadToStringQuad=i.getLiteralValue=i.getLiteralType=i.getLiteralDirection=i.getLiteralLanguage=void 0;const o=nC();Object.defineProperty(i,"getLiteralLanguage",{enumerable:!0,get:function(){return o.getLiteralLanguage}}),Object.defineProperty(i,"getLiteralDirection",{enumerable:!0,get:function(){return o.getLiteralDirection}}),Object.defineProperty(i,"getLiteralType",{enumerable:!0,get:function(){return o.getLiteralType}}),Object.defineProperty(i,"getLiteralValue",{enumerable:!0,get:function(){return o.getLiteralValue}}),Object.defineProperty(i,"quadToStringQuad",{enumerable:!0,get:function(){return o.quadToStringQuad}}),Object.defineProperty(i,"stringQuadToQuad",{enumerable:!0,get:function(){return o.stringQuadToQuad}}),Object.defineProperty(i,"stringToTerm",{enumerable:!0,get:function(){return o.stringToTerm}}),Object.defineProperty(i,"termToString",{enumerable:!0,get:function(){return o.termToString}})})(J_)),J_}var JR;function iC(){if(JR)return Kf;JR=1,Object.defineProperty(Kf,"__esModule",{value:!0}),Kf.ActorQueryOperationDistinctIdentity=void 0;const i=X(),o=O(),u=Q(),a=aC();let t=class extends i.ActorQueryOperationTypedMediated{constructor(r){super(r,"distinct")}async testOperation(r,n){return(0,o.passTestVoid)()}async runOperation(r,n){const c=await this.mediatorQueryOperation.mediate({operation:r.input,context:n});if(c.type==="quads"){const f=(0,u.getSafeQuads)(c);return{type:"quads",quadStream:f.quadStream.filter(await this.newIdentityFilterQuads()),metadata:f.metadata}}const s=(0,u.getSafeBindings)(c),l=(await s.metadata()).variables.map(f=>f.variable);return{type:"bindings",bindingsStream:s.bindingsStream.filter(await this.newIdentityFilter(l)),metadata:s.metadata}}async newIdentityFilter(r){const n={};return c=>{const s=r.map(l=>a.termToString(c.get(l))).join("-");return!(s in n)&&(n[s]=!0)}}async newIdentityFilterQuads(){const r={};return n=>{const c=Object.values(a.quadToStringQuad(n)).join(" ");return!(c in r)&&(r[c]=!0)}}};return Kf.ActorQueryOperationDistinctIdentity=t,Kf}var KR;function oC(){return KR||(KR=1,(function(i){var o=Na&&Na.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Na&&Na.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(iC(),i)})(Na)),Na}var Ua={},np={},YR;function uC(){if(YR)return np;YR=1,Object.defineProperty(np,"__esModule",{value:!0}),np.ActorQueryOperationExtend=void 0;const i=X(),o=O(),u=G(),a=S(),t=Q();let e=class extends i.ActorQueryOperationTypedMediated{constructor(n){super(n,"extend"),this.mediatorExpressionEvaluatorFactory=n.mediatorExpressionEvaluatorFactory}async testOperation(){return(0,o.passTestVoid)()}async runOperation(n,c){const{expression:s,input:l,variable:d}=n,f=(0,t.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:l,context:c}));if((await f.metadata()).variables.some(m=>m.variable.equals(d)))throw new Error(`Illegal binding to variable '${d.value}' that has already been bound`);const p=await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:s,context:c}),_=async(m,b,h)=>{try{const g=await p.evaluate(m),T=m.set(d,g);h(T)}catch(g){(0,a.isExpressionError)(g)?(h(m),this.logWarn(c,`Expression error for extend operation (${g.message})with bindings '${(0,u.bindingsToString)(m)}'`)):y.emit("error",g)}b()},y=f.bindingsStream.transform({autoStart:!1,transform:_});return{type:"bindings",bindingsStream:y,async metadata(){const m=await f.metadata();return{...m,variables:[...m.variables,{variable:d,canBeUndef:!1}]}}}}};return np.ActorQueryOperationExtend=e,np}var WR;function cC(){return WR||(WR=1,(function(i){var o=Ua&&Ua.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ua&&Ua.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(uC(),i)})(Ua)),Ua}var Ha={},ap={},ZR;function sC(){if(ZR)return ap;ZR=1,Object.defineProperty(ap,"__esModule",{value:!0}),ap.ActorQueryOperationFilter=void 0;const i=X(),o=O(),u=G(),a=S(),t=Q();let e=class extends i.ActorQueryOperationTypedMediated{constructor(n){super(n,"filter"),this.mediatorExpressionEvaluatorFactory=n.mediatorExpressionEvaluatorFactory}async testOperation(){return(0,o.passTestVoid)()}async runOperation(n,c){const s=await this.mediatorQueryOperation.mediate({operation:n.input,context:c}),l=(0,t.getSafeBindings)(s);(0,t.validateQueryOutput)(l,"bindings");const d=await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:n.expression,context:c}),f=async(_,y,m)=>{try{await d.evaluateAsEBV(_)&&m(_)}catch(b){(0,a.isExpressionError)(b)?this.logWarn(c,"Error occurred while filtering.",()=>({error:b,bindings:(0,u.bindingsToString)(_)})):p.emit("error",b)}y()},p=l.bindingsStream.transform({transform:f,autoStart:!1});return{type:"bindings",bindingsStream:p,metadata:l.metadata}}};return ap.ActorQueryOperationFilter=e,ap}var kR;function dC(){return kR||(kR=1,(function(i){var o=Ha&&Ha.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ha&&Ha.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(sC(),i)})(Ha)),Ha}var Va={},ip={},e1;function lC(){if(e1)return ip;e1=1,Object.defineProperty(ip,"__esModule",{value:!0}),ip.ActorQueryOperationFromQuad=void 0;const i=X(),o=q(),u=O(),a=$();let t=class _e extends i.ActorQueryOperationTypedMediated{constructor(r){super(r,"from")}static copyOperation(r,n){const c={};for(const s of Object.keys(r))Array.isArray(r[s])&&s!=="template"?s==="variables"?c[s]=r[s]:c[s]=r[s].map(n):_e.ALGEBRA_TYPES.includes(r[s].type)?c[s]=n(r[s]):c[s]=r[s];return c}static applyOperationDefaultGraph(r,n,c){if(n.type==="bgp"&&n.patterns.length>0||n.type==="path"||n.type==="pattern"){if(n.type==="bgp")return _e.joinOperations(r,n.patterns.map(l=>{if(l.graph.termType!=="DefaultGraph")return r.createBgp([l]);const d=c.map(f=>r.createBgp([Object.assign(r.createPattern(l.subject,l.predicate,l.object,f),{metadata:l.metadata})]));return _e.unionOperations(r,d)}));if(n.graph.termType!=="DefaultGraph")return n;const s=c.map(l=>n.type==="path"?r.createPath(n.subject,n.predicate,n.object,l):Object.assign(r.createPattern(n.subject,n.predicate,n.object,l),{metadata:n.metadata}));return _e.unionOperations(r,s)}return _e.copyOperation(n,s=>this.applyOperationDefaultGraph(r,s,c))}static applyOperationNamedGraph(r,n,c,s){if(n.type==="bgp"&&n.patterns.length>0||n.type==="path"||n.type==="pattern"){const l=n.type==="bgp"?n.patterns[0].graph:n.graph;if(l.termType==="DefaultGraph")return{type:a.Algebra.types.BGP,patterns:[]};if(l.termType==="Variable"){if(c.length===1){const f=c[0],p={};p[`?${l.value}`]=f;const _=r.createValues([l],[p]);let y;return n.type==="bgp"?y=r.createBgp(n.patterns.map(m=>r.createPattern(m.subject,m.predicate,m.object,f))):n.type==="path"?y=r.createPath(n.subject,n.predicate,n.object,f):y=r.createPattern(n.subject,n.predicate,n.object,f),r.createJoin([_,y])}return _e.unionOperations(r,c.map(f=>_e.applyOperationNamedGraph(r,n,[f],s)))}return[...c,...s].some(f=>f.equals(l))?n:{type:a.Algebra.types.BGP,patterns:[]}}return _e.copyOperation(n,l=>this.applyOperationNamedGraph(r,l,c,s))}static joinOperations(r,n){if(n.length===1)return n[0];if(n.length>1)return r.createJoin(n);throw new Error("A join can only be applied on at least one operation")}static unionOperations(r,n){if(n.length===1)return n[0];if(n.length>1)return r.createUnion(n);throw new Error("A union can only be applied on at least one operation")}static createOperation(r,n){let c=n.input;return n.default.length>0&&(c=_e.applyOperationDefaultGraph(r,c,n.default)),(n.named.length>0||n.default.length>0)&&(c=_e.applyOperationNamedGraph(r,c,n.named,n.default)),c}async testOperation(r,n){return(0,u.passTestVoid)()}async runOperation(r,n){const c=n.getSafe(o.KeysInitQuery.dataFactory),s=new a.Factory(c),l=_e.createOperation(s,r);return this.mediatorQueryOperation.mediate({operation:l,context:n})}};return ip.ActorQueryOperationFromQuad=t,t.ALGEBRA_TYPES=Object.keys(a.Algebra.types).map(e=>a.Algebra.types[e]),ip}var t1;function fC(){return t1||(t1=1,(function(i){var o=Va&&Va.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Va&&Va.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(lC(),i)})(Va)),Va}var za={},op={},r1;function pC(){if(r1)return op;r1=1,Object.defineProperty(op,"__esModule",{value:!0}),op.ActorQueryOperationProject=void 0;const i=X(),o=q(),u=O(),a=cm(),t=Q();let e=class extends i.ActorQueryOperationTypedMediated{constructor(n){super(n,"project")}async testOperation(n,c){return(0,u.passTestVoid)()}async runOperation(n,c){const s=c.getSafe(o.KeysInitQuery.dataFactory),l=(0,t.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:n.input,context:c})),d=await l.metadata(),f=Object.fromEntries(d.variables.map(g=>[g.variable.value,g])),p=n.variables.map(g=>({variable:g,canBeUndef:!1})),_=Object.fromEntries(p.map(g=>[g.variable.value,g])),y=d.variables.filter(g=>!(g.variable.value in _)),m=p.map(g=>({variable:g.variable,canBeUndef:!(g.variable.value in f)||f[g.variable.value].canBeUndef}));let b=y.length===0?l.bindingsStream:l.bindingsStream.map(g=>{for(const T of y)g=g.delete(T.variable);return g}),h=0;return b=b.map(g=>{h++;const T=new Map;return g.map(v=>{if(v instanceof a.BlankNodeBindingsScoped){let F=T.get(v.value);return F||(F=s.blankNode(`${v.value}${h}`),T.set(v.value,F)),F}return v})}),{type:"bindings",bindingsStream:b,metadata:async()=>({...d,variables:m})}}};return op.ActorQueryOperationProject=e,op}var n1;function yC(){return n1||(n1=1,(function(i){var o=za&&za.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=za&&za.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(pC(),i)})(za)),za}var Xa={},up={},a1;function _C(){if(a1)return up;a1=1,Object.defineProperty(up,"__esModule",{value:!0}),up.ActorQueryOperationReducedHash=void 0;const i=X(),o=O(),u=Q(),a=To();let t=class extends i.ActorQueryOperationTypedMediated{constructor(r){super(r,"reduced")}async testOperation(r,n){return(0,o.passTestVoid)()}async runOperation(r,n){const c=(0,u.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:r.input,context:n})),s=(await c.metadata()).variables.map(d=>d.variable);return{type:"bindings",bindingsStream:c.bindingsStream.filter(await this.newHashFilter(n,s)),metadata:c.metadata}}async newHashFilter(r,n){const{hashFunction:c}=await this.mediatorHashBindings.mediate({context:r}),s=new a.LRUCache({max:this.cacheSize});return l=>{const d=c(l,n);return s.has(d)?!1:(s.set(d,!0),!0)}}};return up.ActorQueryOperationReducedHash=t,up}var i1;function mC(){return i1||(i1=1,(function(i){var o=Xa&&Xa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Xa&&Xa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(_C(),i)})(Xa)),Xa}var Ga={},cp={},o1;function bC(){if(o1)return cp;o1=1,Object.defineProperty(cp,"__esModule",{value:!0}),cp.ActorQueryOperationSlice=void 0;const i=X(),o=q(),u=O();let a=class extends i.ActorQueryOperationTypedMediated{constructor(e){super(e,"slice")}async testOperation(e,r){return(0,u.passTestVoid)()}async runOperation(e,r){e.length&&(r=r.set(o.KeysQueryOperation.limitIndicator,e.length));const n=await this.mediatorQueryOperation.mediate({operation:e.input,context:r});return n.type==="bindings"?{type:"bindings",bindingsStream:this.sliceStream(n.bindingsStream,e),metadata:this.sliceMetadata(n,e)}:n.type==="quads"?{type:"quads",quadStream:this.sliceStream(n.quadStream,e),metadata:this.sliceMetadata(n,e)}:n}sliceStream(e,r){const n=!!r.length||r.length===0,{start:c}=r,s=n?r.start+r.length-1:Number.POSITIVE_INFINITY;return e.transform({offset:c,limit:Math.max(s-c+1,0),autoStart:!1})}sliceMetadata(e,r){const n=!!r.length||r.length===0;return()=>e.metadata().then(c=>{const s={...c.cardinality};return Number.isFinite(s.value)&&(s.value=Math.max(0,s.value-r.start),n&&(s.value=Math.min(s.value,r.length))),{...c,cardinality:s}})}};return cp.ActorQueryOperationSlice=a,cp}var u1;function gC(){return u1||(u1=1,(function(i){var o=Ga&&Ga.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ga&&Ga.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(bC(),i)})(Ga)),Ga}var Ja={},sp={},c1;function hC(){if(c1)return sp;c1=1,Object.defineProperty(sp,"__esModule",{value:!0}),sp.ActorQueryOperationUnion=void 0;const i=X(),o=O(),u=ae(),a=Q(),t=N();let e=class e_ extends i.ActorQueryOperationTypedMediated{constructor(n){super(n,"union")}static unionVariables(n){const c={};for(const s of n)for(const l of s){c[l.variable.value]||(c[l.variable.value]={variable:l.variable,canBeUndef:l.canBeUndef,occurrences:0});const d=c[l.variable.value];d.canBeUndef=d.canBeUndef||l.canBeUndef,d.occurrences++}return Object.values(c).map(s=>s.occurrences===n.length?{variable:s.variable,canBeUndef:s.canBeUndef}:{variable:s.variable,canBeUndef:!0})}static async unionMetadata(n,c,s,l){let d=(await l.mediate({mode:"initialize",context:s})).metadata;for(const p of n)d={...p,...(await l.mediate({mode:"append",accumulatedMetadata:d,appendingMetadata:p,context:s})).metadata};d.state=new u.MetadataValidationState;const f=()=>d.state.invalidate();for(const p of n)p.state.addInvalidateListener(f);if(c){const p=n.map(_=>_.variables);d.variables=e_.unionVariables(p)}return d}async testOperation(n,c){return(0,o.passTestVoid)()}async runOperation(n,c){const s=await Promise.all(n.input.map(d=>this.mediatorQueryOperation.mediate({operation:d,context:c})));let l;for(const d of s)if(l===void 0)l=d.type;else if(l!==d.type)throw new Error(`Unable to union ${l} and ${d.type}`);if(l==="bindings"||n.input.length===0){const d=s.map(a.getSafeBindings);return{type:"bindings",bindingsStream:new t.UnionIterator(d.map(_=>_.bindingsStream),{autoStart:!1}),metadata:()=>Promise.all(d.map(_=>_.metadata())).then(_=>e_.unionMetadata(_,!0,c,this.mediatorRdfMetadataAccumulate))}}if(l==="quads"){const d=s.map(a.getSafeQuads);return{type:"quads",quadStream:new t.UnionIterator(d.map(_=>_.quadStream),{autoStart:!1}),metadata:()=>Promise.all(d.map(_=>_.metadata())).then(_=>e_.unionMetadata(_,!1,c,this.mediatorRdfMetadataAccumulate))}}throw new Error(`Unable to union ${l}`)}};return sp.ActorQueryOperationUnion=e,sp}var s1;function sM(){return s1||(s1=1,(function(i){var o=Ja&&Ja.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ja&&Ja.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(hC(),i)})(Ja)),Ja}var Ka={},dp={},Ya={},lp={},fp={},d1;function dM(){if(d1)return fp;d1=1,Object.defineProperty(fp,"__esModule",{value:!0}),fp.PathVariableObjectIterator=void 0;const i=Q(),o=N(),u=ne();let a=class extends o.BufferedIterator{constructor(e,r,n,c,s,l,d,f=16){super({autoStart:!1}),this.algebraFactory=e,this.subject=r,this.predicate=n,this.graph=c,this.context=s,this.mediatorQueryOperation=l,this.maxRunningOperations=f,this.termHashes=new Map,this.runningOperations=[],this.pendingOperations=[],this.started=!1,this._push(this.subject,d)}getProperty(e,r){return!this.started&&e==="metadata"&&this.startNextOperation(!1).catch(n=>this.emit("error",n)),super.getProperty(e,r)}_end(e){for(const r of this.runningOperations)r.destroy();super._end(e)}_push(e,r=!0){let n;if(r&&(n=(0,u.termToString)(e),this.termHashes.has(n)))return!1;const c=this.algebraFactory.dataFactory.variable("b");return this.pendingOperations.push({variable:c,operation:this.algebraFactory.createPath(e,this.predicate,c,this.graph)}),n&&(this.termHashes.set(n,e),super._push(e)),!0}async startNextOperation(e){this.started=!0;const r=this.pendingOperations.pop(),n=(0,i.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:r.operation,context:this.context})),c=n.bindingsStream.map(s=>s.get(r.variable));c.done||(this.runningOperations.push(c),c.on("error",s=>this.destroy(s)),c.on("readable",()=>{e&&this._fillBufferAsync(),this.readable=!0}),c.on("end",()=>{this.runningOperations.splice(this.runningOperations.indexOf(c),1),e&&this._fillBufferAsync(),this.readable=!0})),this.getProperty("metadata")||this.setProperty("metadata",n.metadata)}_read(e,r){const n=this;(async function(){for(;n.runningOperations.length<n.maxRunningOperations&&n.pendingOperations.length!==0;)await n.startNextOperation(!0);let c=0,s,l=!0;for(;!l||c!==(c=e);){l=!0;for(let d=0;d<n.runningOperations.length&&e>0;d++)(s=n.runningOperations[d].read())!==null&&(n._push(s)?e--:l=!1)}n.closeIfNeeded()})().then(()=>{r()},c=>this.destroy(c))}closeIfNeeded(){this.runningOperations.length===0&&this.pendingOperations.length===0&&this.close()}};return fp.PathVariableObjectIterator=a,fp}var l1;function vC(){if(l1)return lp;l1=1,Object.defineProperty(lp,"__esModule",{value:!0}),lp.ActorAbstractPath=void 0;const i=X(),o=q(),u=O(),a=Q(),t=N(),e=ne(),r=$(),n=dM();let c=class extends i.ActorQueryOperationTypedMediated{constructor(l,d){super(l,"path"),this.predicateType=d}async testOperation(l,d){return l.predicate.type!==this.predicateType?(0,u.failTest)(`This Actor only supports ${this.predicateType} Path operations.`):(0,u.passTestVoid)()}generateVariable(l,d,f){return f?d&&(d.subject.value===f||d.object.value===f)?this.generateVariable(l,d,`${f}b`):l.variable(f):this.generateVariable(l,d,"b")}async isPathArbitraryLengthDistinct(l,d,f){return d.get(o.KeysQueryOperation.isPathArbitraryLengthDistinctKey)?(d=d.set(o.KeysQueryOperation.isPathArbitraryLengthDistinctKey,!1),{context:d,operation:void 0}):(d=d.set(o.KeysQueryOperation.isPathArbitraryLengthDistinctKey,!0),{context:d,operation:(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:l.createDistinct(f),context:d}))})}async predicateStarGraphVariable(l,d,f,p,_,y,m){const b=this.getPathSources(f),h=this.generateVariable(y.dataFactory,y.createPath(l,f,d,p)),g=y.createUnion([this.assignPatternSources(y,y.createPattern(l,h,d,p),b),this.assignPatternSources(y,y.createPattern(d,h,l,p),b)]),T=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:_,operation:g})),v=new Set;return{bindingsStream:new t.MultiTransformIterator(T.bindingsStream,{multiTransform:P=>{const j=P.get(p);return v.has(j.value)?new t.EmptyIterator:(v.add(j.value),new t.TransformIterator(async()=>{const x=new t.BufferedIterator;return await this.getObjectsPredicateStar(y,l,f,j,_,{},x,{count:0}),x.map(A=>m.bindings([[d,A],[p,j]]))},{maxBufferSize:128}))},autoStart:!1}),metadata:T.metadata}}async getObjectsPredicateStarEval(l,d,f,p,_,y,m,b){if(p.termType==="Variable")return this.predicateStarGraphVariable(l,f,d,p,_,m,b);const h=new n.PathVariableObjectIterator(m,l,d,p,_,this.mediatorQueryOperation,y);return{bindingsStream:h.map(T=>b.bindings([[f,T]])),async metadata(){const T=await new Promise(v=>{h.getProperty("metadata",F=>v(F()))});return T.cardinality.value++,T}}}async getObjectsPredicateStar(l,d,f,p,_,y,m,b){const h=(0,e.termToString)(d);if(y[h])return;m._push(d),y[h]=d,b.count++;const g=this.generateVariable(l.dataFactory),T=l.createPath(d,f,g,p),v=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:T,context:_}));return v.bindingsStream.on("data",async F=>{const P=F.get(g);await this.getObjectsPredicateStar(l,P,f,p,_,y,m,b)}),v.bindingsStream.on("end",()=>{--b.count===0&&m.close()}),v.metadata}async getSubjectAndObjectBindingsPredicateStar(l,d,f,p,_,y,m,b,h,g,T,v,F){const P=(0,e.termToString)(p)+(0,e.termToString)(y);if(h[P])return;if(T.count++,h[P]=!0,g._push(F.bindings([[l,f],[d,p]])),P in b){const x=await b[P];for(const A of x)await this.getSubjectAndObjectBindingsPredicateStar(l,d,f,A,_,y,m,b,h,g,T,v,F);--T.count===0&&g.close();return}const j=new Promise(async(x,A)=>{const L=[],z=this.generateVariable(v.dataFactory),M=v.createPath(p,_,z,y),R=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:M,context:m}));R.bindingsStream.on("data",async E=>{const D=E.get(z);L.push(D),await this.getSubjectAndObjectBindingsPredicateStar(l,d,f,D,_,y,m,b,h,g,T,v,F)}),R.bindingsStream.on("error",A),R.bindingsStream.on("end",()=>{--T.count===0&&g.close(),x(L)})});b[P]=j}getPathSources(l){switch(l.type){case r.Algebra.types.ALT:case r.Algebra.types.SEQ:return l.input.flatMap(d=>this.getPathSources(d));case r.Algebra.types.INV:case r.Algebra.types.ONE_OR_MORE_PATH:case r.Algebra.types.ZERO_OR_MORE_PATH:case r.Algebra.types.ZERO_OR_ONE_PATH:return this.getPathSources(l.path);case r.Algebra.types.LINK:case r.Algebra.types.NPS:{const d=(0,a.getOperationSource)(l);if(!d)throw new Error("Could not find a required source on a link path operation");return[d]}}}assignPatternSources(l,d,f){if(f.length===0)throw new Error("Attempted to assign zero sources to a pattern during property path handling");return f.length===1?(0,a.assignOperationSource)(d,f[0]):l.createUnion(f.map(p=>(0,a.assignOperationSource)(d,p)),!0)}};return lp.ActorAbstractPath=c,lp}var f1;function Ie(){return f1||(f1=1,(function(i){var o=Ya&&Ya.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ya&&Ya.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(vC(),i),u(dM(),i)})(Ya)),Ya}var p1;function TC(){if(p1)return dp;p1=1,Object.defineProperty(dp,"__esModule",{value:!0}),dp.ActorQueryOperationPathAlt=void 0;const i=Ie(),o=sM(),u=q(),a=Q(),t=N(),e=$();let r=class extends i.ActorAbstractPath{constructor(c){super(c,e.Algebra.types.ALT)}async runOperation(c,s){const l=s.getSafe(u.KeysInitQuery.dataFactory),d=new e.Factory(l),f=c.predicate,p=(await Promise.all(f.input.map(m=>this.mediatorQueryOperation.mediate({context:s,operation:d.createPath(c.subject,m,c.object,c.graph)})))).map(a.getSafeBindings);return{type:"bindings",bindingsStream:new t.UnionIterator(p.map(m=>m.bindingsStream),{autoStart:!1}),metadata:()=>Promise.all(p.map(m=>m.metadata())).then(m=>o.ActorQueryOperationUnion.unionMetadata(m,!0,s,this.mediatorRdfMetadataAccumulate))}}};return dp.ActorQueryOperationPathAlt=r,dp}var y1;function OC(){return y1||(y1=1,(function(i){var o=Ka&&Ka.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ka&&Ka.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(TC(),i)})(Ka)),Ka}var Wa={},pp={},_1;function AC(){if(_1)return pp;_1=1,Object.defineProperty(pp,"__esModule",{value:!0}),pp.ActorQueryOperationPathInv=void 0;const i=Ie(),o=q(),u=$();let a=class extends i.ActorAbstractPath{constructor(e){super(e,u.Algebra.types.INV)}async runOperation(e,r){const n=r.getSafe(o.KeysInitQuery.dataFactory),c=new u.Factory(n),s=e.predicate,l=c.createPath(e.object,s.path,e.subject,e.graph);return this.mediatorQueryOperation.mediate({operation:l,context:r})}};return pp.ActorQueryOperationPathInv=a,pp}var m1;function SC(){return m1||(m1=1,(function(i){var o=Wa&&Wa.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Wa&&Wa.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(AC(),i)})(Wa)),Wa}var Za={},yp={},b1;function FC(){if(b1)return yp;b1=1,Object.defineProperty(yp,"__esModule",{value:!0}),yp.ActorQueryOperationPathLink=void 0;const i=Ie(),o=q(),u=$();let a=class extends i.ActorAbstractPath{constructor(e){super(e,u.Algebra.types.LINK)}async runOperation(e,r){const n=r.getSafe(o.KeysInitQuery.dataFactory),c=new u.Factory(n),s=e.predicate,l=Object.assign(c.createPattern(e.subject,s.iri,e.object,e.graph),{metadata:s.metadata});return this.mediatorQueryOperation.mediate({operation:l,context:r})}};return yp.ActorQueryOperationPathLink=a,yp}var g1;function wC(){return g1||(g1=1,(function(i){var o=Za&&Za.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Za&&Za.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(FC(),i)})(Za)),Za}var ka={},_p={},h1;function RC(){if(h1)return _p;h1=1,Object.defineProperty(_p,"__esModule",{value:!0}),_p.ActorQueryOperationPathNps=void 0;const i=Ie(),o=q(),u=Q(),a=$();let t=class extends i.ActorAbstractPath{constructor(r){super(r,a.Algebra.types.NPS)}async runOperation(r,n){const c=n.getSafe(o.KeysInitQuery.dataFactory),s=new a.Factory(c),l=r.predicate,d=this.generateVariable(c,r),f=Object.assign(s.createPattern(r.subject,d,r.object,r.graph),{metadata:l.metadata}),p=(0,u.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:f,context:n}));return{type:"bindings",bindingsStream:p.bindingsStream.map(y=>l.iris.some(m=>m.equals(y.get(d)))?null:y.delete(d)),metadata:p.metadata}}};return _p.ActorQueryOperationPathNps=t,_p}var v1;function PC(){return v1||(v1=1,(function(i){var o=ka&&ka.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ka&&ka.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(RC(),i)})(ka)),ka}var ei={},mp={},T1;function qC(){if(T1)return mp;T1=1,Object.defineProperty(mp,"__esModule",{value:!0}),mp.ActorQueryOperationClear=void 0;const i=X(),o=q(),u=Q();let a=class extends i.ActorQueryOperationTypedMediated{constructor(e){super(e,"clear")}async testOperation(e,r){return(0,u.testReadOnly)(r)}async runOperation(e,r){const n=r.getSafe(o.KeysInitQuery.dataFactory);let c;e.source==="DEFAULT"?c=n.defaultGraph():typeof e.source=="string"?c=e.source:c=[e.source];const{execute:s}=await this.mediatorUpdateQuads.mediate({deleteGraphs:{graphs:c,requireExistence:!e.silent,dropGraphs:!1},context:r});return{type:"void",execute:s}}};return mp.ActorQueryOperationClear=a,mp}var O1;function jC(){return O1||(O1=1,(function(i){var o=ei&&ei.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ei&&ei.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(qC(),i)})(ei)),ei}var ti={},bp={},A1;function MC(){if(A1)return bp;A1=1,Object.defineProperty(bp,"__esModule",{value:!0}),bp.ActorQueryOperationUpdateCompositeUpdate=void 0;const i=X(),o=Q();let u=class extends i.ActorQueryOperationTypedMediated{constructor(t){super(t,"compositeupdate")}async testOperation(t,e){return(0,o.testReadOnly)(e)}async runOperation(t,e){return{type:"void",execute:()=>(async()=>{for(const n of t.updates)await(0,o.getSafeVoid)(await this.mediatorQueryOperation.mediate({operation:n,context:e})).execute()})()}}};return bp.ActorQueryOperationUpdateCompositeUpdate=u,bp}var S1;function xC(){return S1||(S1=1,(function(i){var o=ti&&ti.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ti&&ti.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(MC(),i)})(ti)),ti}var ri={},gp={},F1;function DC(){if(F1)return gp;F1=1,Object.defineProperty(gp,"__esModule",{value:!0}),gp.ActorQueryOperationCreate=void 0;const i=X(),o=Q();let u=class extends i.ActorQueryOperationTypedMediated{constructor(t){super(t,"create")}async testOperation(t,e){return(0,o.testReadOnly)(e)}async runOperation(t,e){const{execute:r}=await this.mediatorUpdateQuads.mediate({createGraphs:{graphs:[t.source],requireNonExistence:!t.silent},context:e});return{type:"void",execute:r}}};return gp.ActorQueryOperationCreate=u,gp}var w1;function EC(){return w1||(w1=1,(function(i){var o=ri&&ri.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ri&&ri.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(DC(),i)})(ri)),ri}var ni={},hp={},R1;function LC(){if(R1)return hp;R1=1,Object.defineProperty(hp,"__esModule",{value:!0}),hp.ActorQueryOperationDrop=void 0;const i=X(),o=q(),u=Q();let a=class extends i.ActorQueryOperationTypedMediated{constructor(e){super(e,"drop")}async testOperation(e,r){return(0,u.testReadOnly)(r)}async runOperation(e,r){const n=r.getSafe(o.KeysInitQuery.dataFactory);let c;e.source==="DEFAULT"?c=n.defaultGraph():typeof e.source=="string"?c=e.source:c=[e.source];const{execute:s}=await this.mediatorUpdateQuads.mediate({deleteGraphs:{graphs:c,requireExistence:!e.silent,dropGraphs:!0},context:r});return{type:"void",execute:s}}};return hp.ActorQueryOperationDrop=a,hp}var P1;function IC(){return P1||(P1=1,(function(i){var o=ni&&ni.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ni&&ni.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(LC(),i)})(ni)),ni}var ai={},vp={},q1;function $C(){if(q1)return vp;q1=1,Object.defineProperty(vp,"__esModule",{value:!0}),vp.ActorQueryOperationLoad=void 0;const i=X(),o=q(),u=Q(),a=$();let t=class extends i.ActorQueryOperationTypedMediated{constructor(r){super(r,"load")}async testOperation(r,n){return(0,u.testReadOnly)(n)}async runOperation(r,n){const c=n.getSafe(o.KeysInitQuery.dataFactory),s=new a.Factory(c);let l=n;r.silent&&(l=l.set(o.KeysInitQuery.lenient,!0));const{querySource:d}=await this.mediatorQuerySourceIdentify.mediate({querySourceUnidentified:{value:r.source.value},context:l});let p=(0,u.getSafeQuads)(await this.mediatorQueryOperation.mediate({operation:s.createConstruct((0,u.assignOperationSource)(s.createPattern(c.variable("s"),c.variable("p"),c.variable("o")),d),[s.createPattern(c.variable("s"),c.variable("p"),c.variable("o"))]),context:l})).quadStream;r.destination&&(p=p.map(y=>c.quad(y.subject,y.predicate,y.object,r.destination)));const{execute:_}=await this.mediatorUpdateQuads.mediate({quadStreamInsert:p,context:n});return{type:"void",execute:_}}};return vp.ActorQueryOperationLoad=t,vp}var j1;function BC(){return j1||(j1=1,(function(i){var o=ai&&ai.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ai&&ai.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u($C(),i)})(ai)),ai}var ii={},Tp={},M1;function QC(){if(M1)return Tp;M1=1,Object.defineProperty(Tp,"__esModule",{value:!0}),Tp.ActorQueryOperationJoin=void 0;const i=X(),o=le(),u=O(),a=ae(),t=Q(),e=N(),r=vo();let n=class extends i.ActorQueryOperationTypedMediated{constructor(s){super(s,"join")}async testOperation(s,l){return(0,u.passTestVoid)()}async runOperation(s,l){const d=(await Promise.all(s.input.map(async f=>({output:await this.mediatorQueryOperation.mediate({operation:f,context:l}),operation:f})))).map(({output:f,operation:p})=>({output:(0,t.getSafeBindings)(f),operation:p}));if((await Promise.all(d.map(f=>f.output.metadata()))).some(f=>f.cardinality.value===0&&f.cardinality.type==="exact")){for(const f of d)f.output.bindingsStream.close();return{bindingsStream:new e.ArrayIterator([],{autoStart:!1}),metadata:async()=>({state:new a.MetadataValidationState,cardinality:{type:"exact",value:0},variables:o.ActorRdfJoin.joinVariables(new r.DataFactory,await o.ActorRdfJoin.getMetadatas(d))}),type:"bindings"}}return this.mediatorJoin.mediate({type:"inner",entries:d,context:l})}};return Tp.ActorQueryOperationJoin=n,Tp}var x1;function NC(){return x1||(x1=1,(function(i){var o=ii&&ii.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ii&&ii.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(QC(),i)})(ii)),ii}var oi={},Op={},D1;function CC(){if(D1)return Op;D1=1,Object.defineProperty(Op,"__esModule",{value:!0}),Op.ActorQueryOperationLeftJoin=void 0;const i=X(),o=O(),u=G(),a=S(),t=Q();let e=class extends i.ActorQueryOperationTypedMediated{constructor(n){super(n,"leftjoin"),this.mediatorExpressionEvaluatorFactory=n.mediatorExpressionEvaluatorFactory}async testOperation(n,c){return(0,o.passTestVoid)()}async runOperation(n,c){const s=(await Promise.all(n.input.map(async d=>({output:await this.mediatorQueryOperation.mediate({operation:d,context:c}),operation:d})))).map(({output:d,operation:f})=>({output:(0,t.getSafeBindings)(d),operation:f})),l=await this.mediatorJoin.mediate({type:"optional",entries:s,context:c});if(n.expression){const f=(await s[1].output.metadata()).variables,p=await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:n.expression,context:c}),_=l.bindingsStream.transform({autoStart:!1,transform:async(y,m,b)=>{if(!f.every(h=>y.has(h.variable.value)))return b(y),m();try{await p.evaluateAsEBV(y)&&b(y)}catch(h){(0,a.isExpressionError)(h)?this.logWarn(c,"Error occurred while filtering.",()=>({error:h,bindings:(0,u.bindingsToString)(y)})):_.emit("error",h)}m()}});l.bindingsStream=_}return l}};return Op.ActorQueryOperationLeftJoin=e,Op}var E1;function UC(){return E1||(E1=1,(function(i){var o=oi&&oi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=oi&&oi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(CC(),i)})(oi)),oi}var ui={},Ap={},L1;function HC(){if(L1)return Ap;L1=1,Object.defineProperty(Ap,"__esModule",{value:!0}),Ap.ActorQueryOperationMinus=void 0;const i=X(),o=O(),u=Q();let a=class extends i.ActorQueryOperationTypedMediated{constructor(e){super(e,"minus")}async testOperation(e,r){return(0,o.passTestVoid)()}async runOperation(e,r){const n=(await Promise.all(e.input.map(async c=>({output:await this.mediatorQueryOperation.mediate({operation:c,context:r}),operation:c})))).map(({output:c,operation:s})=>({output:(0,u.getSafeBindings)(c),operation:s}));return this.mediatorJoin.mediate({type:"minus",entries:n,context:r})}};return Ap.ActorQueryOperationMinus=a,Ap}var I1;function VC(){return I1||(I1=1,(function(i){var o=ui&&ui.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ui&&ui.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(HC(),i)})(ui)),ui}var ci={},Sp={},$1;function zC(){if($1)return Sp;$1=1,Object.defineProperty(Sp,"__esModule",{value:!0}),Sp.ActorQueryOperationPathSeq=void 0;const i=Ie(),o=q(),u=Q(),a=$();let t=class extends i.ActorAbstractPath{constructor(r){super(r,a.Algebra.types.SEQ)}async runOperation(r,n){const c=n.getSafe(o.KeysInitQuery.dataFactory),s=new a.Factory(c),l=r.predicate;let d=r.subject;const f=[],p=await Promise.all(l.input.map((m,b)=>{const h=b===l.input.length-1?r.object:this.generateVariable(c,r,`b${b}`),g=s.createPath(d,m,h,r.graph),T=this.mediatorQueryOperation.mediate({context:n,operation:g});return d=h,b<l.input.length-1&&f.push(h),{output:T,operation:g}}).map(async({output:m,operation:b})=>({output:(0,u.getSafeBindings)(await m),operation:b}))),_=(0,u.getSafeBindings)(await this.mediatorJoin.mediate({type:"inner",entries:p,context:n}));return{type:"bindings",bindingsStream:_.bindingsStream.transform({transform(m,b,h){for(const g of f)m=m.delete(g);h(m),b()}}),async metadata(){const m=await _.metadata(),b=m.variables.filter(h=>!f.some(g=>g.value===h.variable.value));return{...m,variables:b}}}}};return Sp.ActorQueryOperationPathSeq=t,Sp}var B1;function XC(){return B1||(B1=1,(function(i){var o=ci&&ci.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ci&&ci.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(zC(),i)})(ci)),ci}var si={},Fp={},Q1;function GC(){if(Q1)return Fp;Q1=1,Object.defineProperty(Fp,"__esModule",{value:!0}),Fp.ActorRdfJoinMultiSmallest=void 0;const i=le(),o=q(),u=O(),a=Q(),t=$();let e=class extends i.ActorRdfJoin{constructor(n){super(n,{logicalType:"inner",physicalName:"multi-smallest",limitEntries:3,limitEntriesMin:!0,canHandleUndefs:!0,isLeaf:!1})}async sortJoinEntries(n,c){return(await this.mediatorJoinEntriesSort.mediate({entries:n,context:c})).entries}async getOutput(n,c){const s=n.context.getSafe(o.KeysInitQuery.dataFactory),l=new t.Factory(s),d=c.sortedEntries,f=d[0],p=d[1];d.splice(0,2);const _={output:(0,a.getSafeBindings)(await this.mediatorJoin.mediate({type:n.type,entries:[f,p],context:n.context})),operation:l.createJoin([f.operation,p.operation],!1)};return d.push(_),{result:await this.mediatorJoin.mediate({type:n.type,entries:d,context:n.context})}}async getJoinCoefficients(n,c){let{metadatas:s}=c;s=[...s];const l=await this.sortJoinEntries(n.entries.map((p,_)=>({...p,metadata:s[_]})),n.context);s=l.map(p=>p.metadata);const d=i.ActorRdfJoin.getRequestInitialTimes(s),f=i.ActorRdfJoin.getRequestItemTimes(s);return(0,u.passTestWithSideData)({iterations:s[0].cardinality.value*s[1].cardinality.value*s.slice(2).reduce((p,_)=>p*_.cardinality.value,1),persistedItems:0,blockingItems:0,requestTime:d[0]+s[0].cardinality.value*f[0]+d[1]+s[1].cardinality.value*f[1]+s.slice(2).reduce((p,_,y)=>p+d.slice(2)[y]+_.cardinality.value*f.slice(2)[y],0)},{...c,sortedEntries:l})}};return Fp.ActorRdfJoinMultiSmallest=e,Fp}var N1;function JC(){return N1||(N1=1,(function(i){var o=si&&si.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=si&&si.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(GC(),i)})(si)),si}var di={},wp={},Rp={},C1;function lM(){if(C1)return Rp;C1=1,Object.defineProperty(Rp,"__esModule",{value:!0}),Rp.MaxAggregator=void 0;const i=ue();let o=class extends i.AggregateEvaluator{constructor(a,t,e,r){super(a,t,r),this.orderByEvaluator=e,this.state=void 0}putTerm(a){if(a.termType!=="Literal")throw new Error(`Term with value ${a.value} has type ${a.termType} and is not a literal`);this.state===void 0?this.state=a:this.orderByEvaluator.orderTypes(this.state,a)===-1&&(this.state=a)}termResult(){return this.state===void 0?this.emptyValue():this.state}};return Rp.MaxAggregator=o,Rp}var U1;function KC(){if(U1)return wp;U1=1,Object.defineProperty(wp,"__esModule",{value:!0}),wp.ActorBindingsAggregatorFactoryMax=void 0;const i=ue(),o=O(),u=lM();let a=class extends i.ActorBindingsAggregatorFactory{constructor(e){super(e),this.mediatorTermComparatorFactory=e.mediatorTermComparatorFactory}async test(e){return e.expr.aggregator!=="max"?(0,o.failTest)("This actor only supports the 'max' aggregator."):(0,o.passTestVoid)()}async run({expr:e,context:r}){return new u.MaxAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:e.expression,context:r}),e.distinct,await this.mediatorTermComparatorFactory.mediate({context:r}))}};return wp.ActorBindingsAggregatorFactoryMax=a,wp}var H1;function YC(){return H1||(H1=1,(function(i){var o=di&&di.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=di&&di.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(KC(),i),u(lM(),i)})(di)),di}var li={},Pp={},qp={},V1;function fM(){if(V1)return qp;V1=1,Object.defineProperty(qp,"__esModule",{value:!0}),qp.MinAggregator=void 0;const i=ue();let o=class extends i.AggregateEvaluator{constructor(a,t,e,r){super(a,t,r),this.orderByEvaluator=e,this.state=void 0}putTerm(a){if(a.termType!=="Literal")throw new Error(`Term with value ${a.value} has type ${a.termType} and is not a literal`);this.state===void 0?this.state=a:this.orderByEvaluator.orderTypes(this.state,a)===1&&(this.state=a)}termResult(){return this.state===void 0?this.emptyValue():this.state}};return qp.MinAggregator=o,qp}var z1;function WC(){if(z1)return Pp;z1=1,Object.defineProperty(Pp,"__esModule",{value:!0}),Pp.ActorBindingsAggregatorFactoryMin=void 0;const i=ue(),o=O(),u=fM();let a=class extends i.ActorBindingsAggregatorFactory{constructor(e){super(e),this.mediatorTermComparatorFactory=e.mediatorTermComparatorFactory}async test(e){return e.expr.aggregator!=="min"?(0,o.failTest)("This actor only supports the 'min' aggregator."):(0,o.passTestVoid)()}async run({context:e,expr:r}){return new u.MinAggregator(await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:r.expression,context:e}),r.distinct,await this.mediatorTermComparatorFactory.mediate({context:e}))}};return Pp.ActorBindingsAggregatorFactoryMin=a,Pp}var X1;function ZC(){return X1||(X1=1,(function(i){var o=li&&li.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=li&&li.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(WC(),i),u(fM(),i)})(li)),li}var fi={},jp={},Mp={},G1;function kC(){if(G1)return Mp;G1=1,Object.defineProperty(Mp,"__esModule",{value:!0}),Mp.SortIterator=void 0;const i=N();let o=class extends i.TransformIterator{constructor(a,t,e){super(a,e);const r=e&&e.window;this.windowLength=Number.isFinite(r)&&r>0?r:Number.POSITIVE_INFINITY,this.sort=t,this.sorted=[]}_read(a,t){let e,{length:r}=this.sorted;for(;r!==this.windowLength&&(e=this.source.read(),e!==null);){let n=0,c=r-1,s,l;for(;n<=c;)s=Math.trunc((n+c)/2),l=this.sort(e,this.sorted[s]),l<0?n=s+1:l>0?c=s-1:(n=s,c=-1);this.sorted.splice(n,0,e),r++}r===this.windowLength&&this._push(this.sorted.pop()),t()}_flush(a){let{length:t}=this.sorted;for(;t--;)this._push(this.sorted.pop());a()}};return Mp.SortIterator=o,Mp}var J1;function eU(){if(J1)return jp;J1=1,Object.defineProperty(jp,"__esModule",{value:!0}),jp.ActorQueryOperationOrderBy=void 0;const i=X(),o=O(),u=S(),a=Q(),t=$(),e=kC();let r=class extends i.ActorQueryOperationTypedMediated{constructor(c){super(c,"orderby"),this.window=c.window??Number.POSITIVE_INFINITY,this.mediatorExpressionEvaluatorFactory=c.mediatorExpressionEvaluatorFactory,this.mediatorTermComparatorFactory=c.mediatorTermComparatorFactory}async testOperation(){return(0,o.passTestVoid)()}async runOperation(c,s){const l=await this.mediatorQueryOperation.mediate({operation:c.input,context:s}),d=(0,a.getSafeBindings)(l),f={window:this.window};let{bindingsStream:p}=d;const _=await this.mediatorTermComparatorFactory.mediate({context:s});for(let y=c.expressions.length-1;y>=0;y--){let m=c.expressions[y];const b=this.isAscending(m);m=this.extractSortExpression(m);const h=await this.mediatorExpressionEvaluatorFactory.mediate({algExpr:m,context:s}),g=async(F,P,j)=>{try{const x=await h.evaluate(F);j({bindings:F,result:x})}catch(x){(0,u.isExpressionError)(x)||p.emit("error",x),j({bindings:F,result:void 0})}P()},T=p.transform({transform:g});p=new e.SortIterator(T,(F,P)=>{let j=_.orderTypes(F.result,P.result);return b||(j*=-1),j},f).map(({bindings:F})=>F)}return{type:"bindings",bindingsStream:p,metadata:d.metadata}}extractSortExpression(c){const{expressionType:s,operator:l}=c;return s!==t.Algebra.expressionTypes.OPERATOR?c:l==="desc"?c.args[0]:c}isAscending(c){const{expressionType:s,operator:l}=c;return s!==t.Algebra.expressionTypes.OPERATOR?!0:l!=="desc"}};return jp.ActorQueryOperationOrderBy=r,jp}var K1;function tU(){return K1||(K1=1,(function(i){var o=fi&&fi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=fi&&fi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(eU(),i)})(fi)),fi}var pi={},xp={},Y1;function rU(){if(Y1)return xp;Y1=1,Object.defineProperty(xp,"__esModule",{value:!0}),xp.ActorOptimizeQueryOperationFilterPushdown=void 0;const i=be(),o=q(),u=O(),a=Q(),t=Oe(),e=$();let r=class extends i.ActorOptimizeQueryOperation{constructor(c){super(c)}async test(c){return(0,u.passTestVoid)()}async run(c){const s=c.context.getSafe(o.KeysInitQuery.dataFactory),l=new e.Factory(s);let d=c.operation;const f=this;this.splitConjunctive&&(d=e.Util.mapOperation(d,{filter(b,h){return b.expression.expressionType===e.Algebra.expressionTypes.OPERATOR&&b.expression.operator==="&&"?(f.logDebug(c.context,`Split conjunctive filter into ${b.expression.args.length} nested filters`),{recurse:!0,result:b.expression.args.reduce((g,T)=>h.createFilter(g,T),b.input)}):{recurse:!0,result:b}}},l));const p=this.getSources(d),_=new Map(await Promise.all(p.map(async b=>[b,await b.source.getSelectorShape(c.context)])));let y=!0,m=0;for(;y&&m<this.maxIterations;)y=!1,d=e.Util.mapOperation(d,{filter(b,h){if(!f.shouldAttemptPushDown(b,p,_))return{recurse:!0,result:b};const g=f.getExpressionVariables(b.expression),[T,v]=f.filterPushdown(b.expression,g,b.input,h,c.context);return T&&(y=!0),{recurse:!0,result:v}}}),m++;return m>1&&f.logDebug(c.context,`Pushed down filters in ${m} iterations`),this.mergeConjunctive&&(d=e.Util.mapOperation(d,{filter(b,h){if(b.input.type===e.Algebra.types.FILTER){const{nestedExpressions:g,input:T}=f.getNestedFilterExpressions(b);return f.logDebug(c.context,`Merge ${g.length} nested filters into conjunctive filter`),{recurse:!0,result:h.createFilter(T,g.slice(1).reduce((v,F)=>h.createOperatorExpression("&&",[v,F]),g[0]))}}return{recurse:!0,result:b}}})),{operation:d,context:c.context}}shouldAttemptPushDown(c,s,l){if(this.aggressivePushdown)return!0;const d=c.expression;return!!(d.expressionType===e.Algebra.expressionTypes.OPERATOR&&d.operator==="="&&(d.args[0].expressionType==="term"&&d.args[0].term.termType!=="Variable"&&d.args[1].expressionType==="term"&&d.args[1].term.termType==="Variable"||d.args[0].expressionType==="term"&&d.args[0].term.termType==="Variable"&&d.args[1].expressionType==="term"&&d.args[1].term.termType!=="Variable")||s.some(f=>(0,a.doesShapeAcceptOperation)(l.get(f),c)))}getSources(c){const s=new Set,l=d=>{const f=(0,a.getOperationSource)(d);return f&&s.add(f),!1};return e.Util.recurseOperation(c,{[e.Algebra.types.PATTERN]:l,[e.Algebra.types.LINK]:l,[e.Algebra.types.NPS]:l,[e.Algebra.types.SERVICE]:l}),[...s]}getExpressionVariables(c){switch(c.expressionType){case e.Algebra.expressionTypes.AGGREGATE:case e.Algebra.expressionTypes.WILDCARD:throw new Error(`Getting expression variables is not supported for ${c.expressionType}`);case e.Algebra.expressionTypes.EXISTENCE:return e.Util.inScopeVariables(c.input);case e.Algebra.expressionTypes.NAMED:return[];case e.Algebra.expressionTypes.OPERATOR:return(0,t.uniqTerms)(c.args.flatMap(s=>this.getExpressionVariables(s)));case e.Algebra.expressionTypes.TERM:return c.term.termType==="Variable"?[c.term]:[]}}getOverlappingOperations(c,s){const l=[],d=[],f=[];for(const p of c.input){const _=e.Util.inScopeVariables(p);this.variablesSubSetOf(s,_)?l.push(p):this.variablesIntersect(s,_)?d.push(p):f.push(p)}return{fullyOverlapping:l,partiallyOverlapping:d,notOverlapping:f}}filterPushdown(c,s,l,d,f){if(this.isExpressionFalse(c))return[!0,d.createUnion([])];if(c.type===e.Algebra.types.EXPRESSION&&c.expressionType===e.Algebra.expressionTypes.EXISTENCE)return[!1,d.createFilter(l,c)];switch(l.type){case e.Algebra.types.EXTEND:return this.variablesIntersect([l.variable],s)?[!1,d.createFilter(l,c)]:[!0,d.createExtend(this.filterPushdown(c,s,l.input,d,f)[1],l.variable,l.expression)];case e.Algebra.types.FILTER:{const[p,_]=this.filterPushdown(c,s,l.input,d,f);return[p,d.createFilter(_,l.expression)]}case e.Algebra.types.JOIN:{if(l.input.length===0)return[!1,d.createFilter(l,c)];const{fullyOverlapping:p,partiallyOverlapping:_,notOverlapping:y}=this.getOverlappingOperations(l,s),m=[];let b=!1;return p.length>0&&(b=!0,m.push(d.createJoin(p.map(h=>this.filterPushdown(c,s,h,d,f)[1])))),_.length>0&&m.push(d.createFilter(d.createJoin(_,!1),c)),y.length>0&&m.push(...y),m.length>1&&(b=!0),b&&this.logDebug(f,`Push down filter across join entries with ${p.length} fully overlapping, ${_.length} partially overlapping, and ${y.length} not overlapping`),[b,m.length===1?m[0]:d.createJoin(m)]}case e.Algebra.types.NOP:return[!0,l];case e.Algebra.types.PROJECT:return this.variablesIntersect(l.variables,s)?[!0,d.createProject(this.filterPushdown(c,s,l.input,d,f)[1],l.variables)]:[!0,l];case e.Algebra.types.UNION:{const{fullyOverlapping:p,partiallyOverlapping:_,notOverlapping:y}=this.getOverlappingOperations(l,s),m=[];let b=!1;return p.length>0&&(b=!0,m.push(d.createUnion(p.map(h=>this.filterPushdown(c,s,h,d,f)[1])))),_.length>0&&m.push(d.createFilter(d.createUnion(_,!1),c)),y.length>0&&m.push(...y),m.length>1&&(b=!0),b&&this.logDebug(f,`Push down filter across union entries with ${p.length} fully overlapping, ${_.length} partially overlapping, and ${y.length} not overlapping`),[b,m.length===1?m[0]:d.createUnion(m)]}case e.Algebra.types.VALUES:return this.variablesIntersect(l.variables,s)?[!1,d.createFilter(l,c)]:[!0,l];case e.Algebra.types.LEFT_JOIN:{if(this.pushIntoLeftJoins){const p=e.Util.inScopeVariables(l.input[1]);if(!this.variablesIntersect(s,p))return this.logDebug(f,"Push down filter into left join"),[!0,d.createLeftJoin(this.filterPushdown(c,s,l.input[0],d,f)[1],l.input[1],l.expression)]}return[!1,d.createFilter(l,c)]}case e.Algebra.types.PATTERN:{if(this.pushEqualityIntoPatterns){const p=this.getEqualityExpressionPushableIntoPattern(c);if(p){let _=!1;const y=l.metadata;if(l=(0,t.mapTermsNested)(l,m=>m.equals(p.variable)?(_=!0,p.term):m),l.type=e.Algebra.types.PATTERN,l.metadata=y,_)return this.logDebug(f,`Push down filter into pattern for ?${p.variable.value}`),[!0,d.createJoin([l,d.createValues([p.variable],[{[`?${p.variable.value}`]:p.term}])])]}}return[!1,d.createFilter(l,c)]}case e.Algebra.types.PATH:{if(this.pushEqualityIntoPatterns){const p=this.getEqualityExpressionPushableIntoPattern(c);if(p&&(l.subject.equals(p.variable)||l.object.equals(p.variable))){this.logDebug(f,`Push down filter into path for ?${p.variable.value}`);const _=l.metadata;return l=d.createPath(l.subject.equals(p.variable)?p.term:l.subject,l.predicate,l.object.equals(p.variable)?p.term:l.object),l.metadata=_,[!0,d.createJoin([l,d.createValues([p.variable],[{[`?${p.variable.value}`]:p.term}])])]}}return[!1,d.createFilter(l,c)]}case e.Algebra.types.MINUS:case e.Algebra.types.ALT:case e.Algebra.types.ASK:case e.Algebra.types.BGP:case e.Algebra.types.CONSTRUCT:case e.Algebra.types.DESCRIBE:case e.Algebra.types.DISTINCT:case e.Algebra.types.EXPRESSION:case e.Algebra.types.FROM:case e.Algebra.types.GRAPH:case e.Algebra.types.GROUP:case e.Algebra.types.INV:case e.Algebra.types.LINK:case e.Algebra.types.NPS:case e.Algebra.types.ONE_OR_MORE_PATH:case e.Algebra.types.ORDER_BY:case e.Algebra.types.REDUCED:case e.Algebra.types.SEQ:case e.Algebra.types.SERVICE:case e.Algebra.types.SLICE:case e.Algebra.types.ZERO_OR_MORE_PATH:case e.Algebra.types.ZERO_OR_ONE_PATH:case e.Algebra.types.COMPOSITE_UPDATE:case e.Algebra.types.DELETE_INSERT:case e.Algebra.types.LOAD:case e.Algebra.types.CLEAR:case e.Algebra.types.CREATE:case e.Algebra.types.DROP:case e.Algebra.types.ADD:case e.Algebra.types.MOVE:case e.Algebra.types.COPY:return[!1,d.createFilter(l,c)]}}getEqualityExpressionPushableIntoPattern(c){if(c.expressionType===e.Algebra.expressionTypes.OPERATOR&&c.operator==="="){if(c.args[0].expressionType==="term"&&c.args[0].term.termType!=="Variable"&&(c.args[0].term.termType!=="Literal"||this.isLiteralWithCanonicalLexicalForm(c.args[0].term))&&c.args[1].expressionType==="term"&&c.args[1].term.termType==="Variable")return{variable:c.args[1].term,term:c.args[0].term};if(c.args[0].expressionType==="term"&&c.args[0].term.termType==="Variable"&&c.args[1].expressionType==="term"&&c.args[1].term.termType!=="Variable"&&(c.args[1].term.termType!=="Literal"||this.isLiteralWithCanonicalLexicalForm(c.args[1].term)))return{variable:c.args[0].term,term:c.args[1].term}}}isLiteralWithCanonicalLexicalForm(c){if(c.termType==="Literal")switch(c.datatype.value){case"http://www.w3.org/2001/XMLSchema#string":case"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":case"http://www.w3.org/2001/XMLSchema#normalizedString":case"http://www.w3.org/2001/XMLSchema#anyURI":case"http://www.w3.org/2001/XMLSchema#base64Binary":case"http://www.w3.org/2001/XMLSchema#language":case"http://www.w3.org/2001/XMLSchema#Name":case"http://www.w3.org/2001/XMLSchema#NCName":case"http://www.w3.org/2001/XMLSchema#NMTOKEN":case"http://www.w3.org/2001/XMLSchema#token":case"http://www.w3.org/2001/XMLSchema#hexBinary":return!0}return!1}variablesIntersect(c,s){return c.some(l=>s.some(d=>l.equals(d)))}variablesSubSetOf(c,s){return c.length<=s.length&&c.every(l=>s.some(d=>l.equals(d)))}isExpressionFalse(c){return c.term&&c.term.termType==="Literal"&&c.term.value==="false"}getNestedFilterExpressions(c){if(c.input.type===e.Algebra.types.FILTER){const s=this.getNestedFilterExpressions(c.input);return{nestedExpressions:[c.expression,...s.nestedExpressions],input:s.input}}return{nestedExpressions:[c.expression],input:c.input}}};return xp.ActorOptimizeQueryOperationFilterPushdown=r,xp}var W1;function nU(){return W1||(W1=1,(function(i){var o=pi&&pi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=pi&&pi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(rU(),i)})(pi)),pi}var yi={},Dp={},_i={},Z1;function pM(){if(Z1)return _i;Z1=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.ActorDereferenceHttpBase=_i.mediaTypesToAcceptString=void 0;const i=lm(),o=qe(),u=O(),a=Oo(),t=a_(),e=/^[^ ;]*/u;function r(c,s){const l="*/*;q=0.1",d=[],f=Object.entries(c).map(([_,y])=>({mediaType:_,priority:y})).sort((_,y)=>y.priority===_.priority?_.mediaType.localeCompare(y.mediaType):y.priority-_.priority);let p=f.length-1;for(const{mediaType:_,priority:y}of f){const m=_+(y===1?"":`;q=${y.toFixed(3).replace(/0*$/u,"")}`);if(p+m.length>s){for(;p+l.length>s;){const b=d.pop()??"";p-=b.length+1}d.push(l);break}d.push(m),p+=m.length}return d.length===0?"*/*":d.join(",")}_i.mediaTypesToAcceptString=r;let n=class extends i.ActorDereference{constructor(s){super(s)}async test({url:s}){return/^https?:/u.test(s)?(0,u.passTestVoid)():(0,u.failTest)(`Cannot retrieve ${s} because it is not an HTTP(S) URL.`)}async run(s){var b,h;let l=!0;const d=new Headers(s.headers);d.append("Accept",r(await((b=s.mediaTypes)==null?void 0:b.call(s))??{},this.getMaxAcceptHeaderLength()));let f;const p=Date.now();try{f=await this.mediatorHttp.mediate({context:s.context,init:{headers:d,method:s.method},input:s.url})}catch(g){return this.handleDereferenceErrors(s,g)}const _=(0,t.resolve)(f.url,s.url),y=Date.now()-p;if(f.status!==200){l=!1;const g=f.body?await(0,a.stringify)(o.ActorHttp.toNodeReadable(f.body)):"empty response";if(!s.acceptErrors){const T=new Error(`Could not retrieve ${s.url} (HTTP status ${f.status}):
${g}`);return this.handleDereferenceErrors(s,T,f.headers,y)}}const m=(h=e.exec(f.headers.get("content-type")??""))==null?void 0:h[0];return{url:_,data:l?o.ActorHttp.toNodeReadable(f.body):(0,i.emptyReadable)(),exists:l,requestTime:y,headers:f.headers,mediaType:m==="text/plain"?void 0:m}}};return _i.ActorDereferenceHttpBase=n,_i}var k1;function aU(){if(k1)return Dp;k1=1,Object.defineProperty(Dp,"__esModule",{value:!0}),Dp.ActorDereferenceHttp=void 0;const i=pM();class o extends i.ActorDereferenceHttpBase{getMaxAcceptHeaderLength(){return this.maxAcceptHeaderLengthBrowser}}return Dp.ActorDereferenceHttp=o,Dp}var eP;function iU(){return eP||(eP=1,(function(i){var o=yi&&yi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=yi&&yi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(aU(),i),u(pM(),i)})(yi)),yi}var mi={},Ep={},tP;function oU(){if(tP)return Ep;tP=1,Object.defineProperty(Ep,"__esModule",{value:!0}),Ep.ActorHttpProxy=void 0;const i=qe(),o=q(),u=O();let a=class extends i.ActorHttp{constructor(e){super(e)}async test(e){const r=e.context.get(o.KeysHttpProxy.httpProxyHandler);return r?await r.getProxy(e)?(0,u.passTest)({time:Number.POSITIVE_INFINITY}):(0,u.failTest)(`Actor ${this.name} could not determine a proxy for the given request.`):(0,u.failTest)(`Actor ${this.name} could not find a proxy handler in the context.`)}async run(e){const r=typeof e.input=="string"?e.input:e.input.url,n=e.context.get(o.KeysHttpProxy.httpProxyHandler),c=await this.mediatorHttp.mediate({...await n.getProxy(e),context:e.context.delete(o.KeysHttpProxy.httpProxyHandler)});return Object.defineProperty(c,"url",{configurable:!0,enumerable:!0,get:()=>c.headers.get("x-final-url")??r}),c}};return Ep.ActorHttpProxy=a,Ep}var Lp={},rP;function uU(){if(rP)return Lp;rP=1,Object.defineProperty(Lp,"__esModule",{value:!0}),Lp.ProxyHandlerStatic=void 0;let i=class{constructor(u){this.prefixUrl=u}async getProxy(u){return{init:u.init,input:this.modifyInput(u.input)}}modifyInput(u){return typeof u=="string"?this.prefixUrl+u:new Request(this.prefixUrl+u.url,u)}};return Lp.ProxyHandlerStatic=i,Lp}var nP;function cU(){return nP||(nP=1,(function(i){var o=mi&&mi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=mi&&mi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(oU(),i),u(uU(),i)})(mi)),mi}var bi={},Ip={},aP;function sU(){if(aP)return Ip;aP=1,Object.defineProperty(Ip,"__esModule",{value:!0}),Ip.ActorContextPreprocessQuerySourceIdentify=void 0;const i=Gy(),o=q(),u=O(),a=To();let t=class extends i.ActorContextPreprocess{constructor(r){super(r),this.cache=this.cacheSize?new a.LRUCache({max:this.cacheSize}):void 0;const n=this.cache;n&&this.httpInvalidator.addInvalidateListener(({url:c})=>c?n.delete(c):n.clear())}async test(r){return(0,u.passTestVoid)()}async run(r){let n=r.context;if(n.has(o.KeysInitQuery.querySourcesUnidentified)){const c=r.context.get(o.KeysInitQuery.querySourcesUnidentified),s=await Promise.all(c.map(f=>this.expandSource(f))),l=await Promise.all(s.map(async f=>this.identifySource(f,r.context))),d=r.context.get(o.KeysStatistics.dereferencedLinks);if(d)for(const f of l)d.updateStatistic({url:f.source.referenceValue,metadata:{seed:!0}},f.source);n=r.context.delete(o.KeysInitQuery.querySourcesUnidentified).set(o.KeysQueryOperation.querySources,l)}return{context:n}}async expandSource(r){return typeof r=="string"||"match"in r?{value:r}:{...r,context:(await this.mediatorContextPreprocess.mediate({context:u.ActionContext.ensureActionContext(r.context??{})})).context}}identifySource(r,n){let c;return typeof r.value=="string"&&this.cache&&(c=this.cache.get(r.value)),c||(c=this.mediatorQuerySourceIdentify.mediate({querySourceUnidentified:r,context:n}).then(({querySource:s})=>s),typeof r.value=="string"&&this.cache&&this.cache.set(r.value,c)),c}};return Ip.ActorContextPreprocessQuerySourceIdentify=t,Ip}var iP;function dU(){return iP||(iP=1,(function(i){var o=bi&&bi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=bi&&bi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(sU(),i)})(bi)),bi}var gi={},$p={},oP;function lU(){if(oP)return $p;oP=1,Object.defineProperty($p,"__esModule",{value:!0}),$p.ActorRdfUpdateQuadsHypermedia=void 0;const i=_m(),o=O(),u=To();let a=class extends i.ActorRdfUpdateQuadsDestination{constructor(e){super(e),this.cache=this.cacheSize?new u.LRUCache({max:this.cacheSize}):void 0;const r=this.cache;r&&this.httpInvalidator.addInvalidateListener(({url:n})=>n?r.delete(n):r.clear())}async test(e){return(0,i.getContextDestinationUrl)((0,i.getContextDestination)(e.context))?(0,o.passTestVoid)():(0,o.failTest)(`Actor ${this.name} can only update quads against a single destination URL.`)}getDestination(e){const r=(0,i.getContextDestination)(e);let n=(0,i.getContextDestinationUrl)(r);if(this.cache&&this.cache.has(n))return this.cache.get(n);const c=(async()=>{var f;let s,l;try{const p=await this.mediatorDereferenceRdf.mediate({context:e,url:n,acceptErrors:!0});l=p.exists,n=p.url;const _=await this.mediatorMetadata.mediate({context:e,url:n,quads:p.data,triples:(f=p.metadata)==null?void 0:f.triples});s=(await this.mediatorMetadataExtract.mediate({context:e,url:n,metadata:_.metadata,headers:p.headers,requestTime:p.requestTime})).metadata}catch{s={},l=!1}const{destination:d}=await this.mediatorRdfUpdateHypermedia.mediate({context:e,url:n,metadata:s,exists:l,forceDestinationType:(0,i.getDataDestinationType)(r)});return d})();return this.cache&&this.cache.set(n,c),c}};return $p.ActorRdfUpdateQuadsHypermedia=a,$p}var uP;function fU(){return uP||(uP=1,(function(i){var o=gi&&gi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=gi&&gi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(lU(),i)})(gi)),gi}var hi={},Bp={},cP;function pU(){if(cP)return Bp;cP=1,Object.defineProperty(Bp,"__esModule",{value:!0}),Bp.ActionObserverHttp=void 0;const i=O();class o extends i.ActionObserver{constructor(a){super(a),this.requests=0,this.bus.subscribeObserver(this),this.httpInvalidator.addInvalidateListener(()=>{this.requests=0})}onRun(a,t,e){this.observedActors.includes(a.name)&&this.requests++}}return Bp.ActionObserverHttp=o,Bp}var Qp={},sP;function yU(){if(sP)return Qp;sP=1,Object.defineProperty(Qp,"__esModule",{value:!0}),Qp.ActorQueryResultSerializeSparqlJson=void 0;const i=Ae(),o=O(),u=N(),a=Z();let t=class Vy extends i.ActorQueryResultSerializeFixedMediaTypes{constructor(r){super(r)}static bindingToJsonBindings(r){if(r.termType==="Literal"){const n=r,c={value:n.value,type:"literal"},{language:s,datatype:l}=n;return s?c["xml:lang"]=s:l&&l.value!=="http://www.w3.org/2001/XMLSchema#string"&&(c.datatype=l.value),c}return r.termType==="BlankNode"?{value:r.value,type:"bnode"}:r.termType==="Quad"?{value:{subject:Vy.bindingToJsonBindings(r.subject),predicate:Vy.bindingToJsonBindings(r.predicate),object:Vy.bindingToJsonBindings(r.object)},type:"triple"}:{value:r.value,type:"uri"}}async testHandleChecked(r,n){return["bindings","boolean"].includes(r.type)?(0,o.passTestVoid)():(0,o.failTest)("This actor can only handle bindings streams or booleans.")}async runHandle(r,n,c){const s=new a.Readable,l={};if(r.type==="bindings"){const d=await r.metadata();d.variables.length>0&&(l.vars=d.variables.map(f=>f.variable.value))}if(s.push(`{"head": ${JSON.stringify(l)},
`),r.type==="bindings"){const d=r.bindingsStream;s.push(`"results": { "bindings": [
`);let f=!0;function*p(_){yield _()}s.wrap((0,u.wrap)(d).map(_=>{const y=`${f?"":`,
`}${JSON.stringify(Object.fromEntries([..._].map(([m,b])=>[m.value,Vy.bindingToJsonBindings(b)])))}`;return f=!1,y}).append((0,u.wrap)(p(()=>`
]}${this.emitMetadata?`,
"metadata": { "httpRequests": ${this.httpObserver.requests} }`:""}}
`))))}else s.wrap((0,u.wrap)(r.execute().then(d=>[`"boolean":${d}
}
`])));return{data:s}}};return Qp.ActorQueryResultSerializeSparqlJson=t,Qp}var dP;function lP(){return dP||(dP=1,(function(i){var o=hi&&hi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=hi&&hi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(pU(),i),u(yU(),i)})(hi)),hi}var vi={},Np={},fP;function _U(){if(fP)return Np;fP=1,Object.defineProperty(Np,"__esModule",{value:!0}),Np.ActionObserverHttp=void 0;const i=O();let o=class extends i.ActionObserver{constructor(a){super(a),this.requests=0,this.bus.subscribeObserver(this),this.httpInvalidator.addInvalidateListener(()=>{this.requests=0})}onRun(a,t,e){this.observedActors.includes(a.name)&&this.requests++}};return Np.ActionObserverHttp=o,Np}var Cp={},pP;function mU(){if(pP)return Cp;pP=1,Object.defineProperty(Cp,"__esModule",{value:!0}),Cp.ActorQueryResultSerializeStats=void 0;const i=Ae(),o=q(),u=O(),a=N(),t=Z();let e=class extends i.ActorQueryResultSerializeFixedMediaTypes{constructor(n){super(n)}async testHandleChecked(n,c){return["bindings","quads"].includes(n.type)?(0,u.passTestVoid)():(0,u.failTest)("This actor can only handle bindings streams or quad streams.")}pushHeader(n){const c=["Result","Delay (ms)","HTTP requests"].join(",");n.push(`${c}
`)}createStat(n,c){return`${[c,this.delay(n),this.httpObserver.requests].join(",")}
`}createSpecialLine(n,c){return`${[n,this.delay(c),this.httpObserver.requests].join(",")}
`}async runHandle(n,c,s){const l=new t.Readable,d=n.type==="bindings"?n.bindingsStream:n.quadStream,f=n.context.getSafe(o.KeysInitQuery.queryTimestampHighResolution);let p=1;function*_(m){yield m()}const y=(0,a.wrap)(d).map(()=>this.createStat(f,p++)).prepend([this.createSpecialLine("PLANNING",f)]).append((0,a.wrap)(_(()=>this.createSpecialLine("TOTAL",f))));return this.pushHeader(l),l.wrap(y),{data:l}}now(){return performance.now()}delay(n){return this.now()-n}};return Cp.ActorQueryResultSerializeStats=e,Cp}var yP;function _P(){return yP||(yP=1,(function(i){var o=vi&&vi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=vi&&vi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(_U(),i),u(mU(),i)})(vi)),vi}var Ti={},Up={},Oi={},Hp={},mP;function bU(){if(mP)return Hp;mP=1,Object.defineProperty(Hp,"__esModule",{value:!0}),Hp.ActorQuerySourceIdentifyHypermedia=void 0;const i=O();class o extends i.Actor{constructor(a,t){super(a),this.sourceType=t}async test(a){return a.forceSourceType&&this.sourceType!==a.forceSourceType?(0,i.failTest)(`Actor ${this.name} is not able to handle source type ${a.forceSourceType}.`):this.testMetadata(a)}}return Hp.ActorQuerySourceIdentifyHypermedia=o,Hp}var bP;function hm(){return bP||(bP=1,(function(i){var o=Oi&&Oi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Oi&&Oi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(bU(),i)})(Oi)),Oi}var Vp={},Ai={},zp={},gP;function gU(){if(gP)return zp;gP=1,Object.defineProperty(zp,"__esModule",{value:!0}),zp.ActorQuerySourceIdentify=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return zp.ActorQuerySourceIdentify=o,zp}var te={},hP;function hU(){if(hP)return te;hP=1,Object.defineProperty(te,"__esModule",{value:!0}),te.filterMatchingQuotedQuads=te.quadsOrderToBindingsOrder=te.quadsMetadataToBindingsMetadata=te.setMetadata=te.getDuplicateElementLinks=te.getVariables=te.isTermVariable=te.quadsToBindings=void 0;const i=Le(),o=ae(),u=ne(),a=Oe(),t=hx();function e(p,_,y,m,b){const h=n(_),g=_.graph.termType==="Variable"&&!b,T=c(_),v=(0,a.reduceTermsNested)(_,(j,x,A)=>(x.termType==="Variable"&&(j[A.join("_")]=x.value),j),{});let F=p;g&&(F=F.filter(j=>j.graph.termType!=="DefaultGraph")),T&&(F=F.filter(j=>{for(const x in T){const A=x.split("_"),L=(0,a.getValueNestedPath)(j,A);for(const z of T[x])if(!L.equals((0,a.getValueNestedPath)(j,z)))return!1}return!0}));const P=new i.ClosableIterator(F.map(j=>m.bindings(Object.keys(v).map(x=>{const A=x.split("_"),L=v[x],z=(0,a.getValueNestedPath)(j,A);return[y.variable(L),z]}))),{onClose:()=>p.destroy()});return s(y,P,p,v,h,g||!!T),P}te.quadsToBindings=e;function r(p){return p.termType==="Variable"}te.isTermVariable=r;function n(p){return(0,a.uniqTerms)((0,a.getTermsNested)(p).filter(r))}te.getVariables=n;function c(p){const _={};let y=!1;if((0,a.forEachTermsNested)(p,(b,h)=>{if(b.termType==="Variable"){const g=(0,u.termToString)(b),T=(_[g]||(_[g]=[])).push(h);y=y||T>1}}),!y)return;const m={};for(const b in _){const h=_[b],g=h.slice(1);g.length>0&&(m[h[0].join("_")]=g)}return m}te.getDuplicateElementLinks=c;function s(p,_,y,m,b,h){const g=v=>{h&&(v.cardinality.type="estimate"),_.setProperty("metadata",l(p,(0,o.validateMetadataQuads)(v),m,b)),v.state&&v.state.addInvalidateListener(()=>{s(p,_,y,m,b,h)})},T=y.getProperty("metadata");T?g(T):y.getProperty("metadata",g)}te.setMetadata=s;function l(p,_,y,m){return{..._,order:_.order?d(p,_.order,y):void 0,availableOrders:_.availableOrders?_.availableOrders.map(b=>({cost:b.cost,terms:d(p,b.terms,y)})):void 0,variables:m.map(b=>({variable:b,canBeUndef:!1}))}}te.quadsMetadataToBindingsMetadata=l;function d(p,_,y){const m={};return _.map(b=>{const h=y[b.term];if(h&&!m[h])return m[h]=!0,{term:p.variable(h),direction:b.direction}}).filter(Boolean)}te.quadsOrderToBindingsOrder=d;function f(p,_){return(0,a.someTerms)(p,y=>y.termType==="Quad")&&(_=_.filter(y=>(0,t.matchPatternMappings)(y,p))),_}return te.filterMatchingQuotedQuads=f,te}var vP;function Jy(){return vP||(vP=1,(function(i){var o=Ai&&Ai.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ai&&Ai.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(gU(),i),u(hU(),i)})(Ai)),Ai}var TP;function yM(){if(TP)return Vp;TP=1,Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.QuerySourceQpf=void 0;const i=Jy(),o=q(),u=ae(),a=N(),t=ne(),e=n_(),r=Oe();let n=class{constructor(l,d,f,p,_,y,m,b,h,g,T,v,F,P){if(this.referenceValue=T,this.mediatorMetadata=l,this.mediatorMetadataExtract=d,this.mediatorDereferenceRdf=f,this.dataFactory=p,this.algebraFactory=_,this.bindingsFactory=y,this.subjectUri=m,this.predicateUri=b,this.objectUri=h,this.graphUri=g,this.url=T,this.bindingsRestricted=F,this.cachedQuads={},this.searchForm=this.getSearchForm(v),this.defaultGraph=v.defaultGraph?this.dataFactory.namedNode(v.defaultGraph):void 0,P){let j=(0,a.wrap)(P);this.defaultGraph&&(j=this.reverseMapQuadsToDefaultGraph(j)),v={...v,state:new u.MetadataValidationState},j.setProperty("metadata",v),this.cacheQuads(j,this.dataFactory.variable(""),this.dataFactory.variable(""),this.dataFactory.variable(""),this.dataFactory.variable(""))}this.selectorShape=this.bindingsRestricted?{type:"operation",operation:{operationType:"pattern",pattern:this.algebraFactory.createPattern(this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"),this.dataFactory.variable("g"))},variablesOptional:[this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"),this.dataFactory.variable("g")],filterBindings:!0}:{type:"operation",operation:{operationType:"pattern",pattern:this.algebraFactory.createPattern(this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"),this.dataFactory.variable("g"))},variablesOptional:[this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"),this.dataFactory.variable("g")]}}async getSelectorShape(){return this.selectorShape}queryBindings(l,d,f){if(l.type!=="pattern")throw new Error(`Attempted to pass non-pattern operation '${l.type}' to QuerySourceQpf`);const p=!!d.get(o.KeysQueryOperation.unionDefaultGraph);let _=this.match(l.subject,l.predicate,l.object,l.graph,p,d,f);return _=(0,i.filterMatchingQuotedQuads)(l,_),(0,i.quadsToBindings)(_,l,this.dataFactory,this.bindingsFactory,p)}getSearchForm(l){if(!l.searchForms||!l.searchForms.values)return;const{searchForms:d}=l;for(const f of d.values)if(this.graphUri&&this.subjectUri in f.mappings&&this.predicateUri in f.mappings&&this.objectUri in f.mappings&&this.graphUri in f.mappings&&Object.keys(f.mappings).length===4||this.subjectUri in f.mappings&&this.predicateUri in f.mappings&&this.objectUri in f.mappings&&Object.keys(f.mappings).length===3)return f}createFragmentUri(l,d,f,p,_){const y={},m=[{uri:this.subjectUri,term:d},{uri:this.predicateUri,term:f},{uri:this.objectUri,term:p},{uri:this.graphUri,term:_}];for(const b of m)b.uri&&(this.bindingsRestricted||b.term.termType!=="Variable"&&(b.term.termType!=="Quad"||(0,r.everyTermsNested)(b.term,h=>h.termType!=="Variable")))&&(y[b.uri]=(0,t.termToString)(b.term));return l.getUri(y)}match(l,d,f,p,_,y,m){let b=!1;if(p.termType==="DefaultGraph")if(this.defaultGraph)b=!0,p=this.defaultGraph;else if(Object.keys(this.searchForm.mappings).length===4&&!this.defaultGraph)if(_)p=this.dataFactory.variable("g");else{const v=new a.ArrayIterator([],{autoStart:!1});return v.setProperty("metadata",{state:new u.MetadataValidationState,requestTime:0,cardinality:{type:"exact",value:0},first:null,next:null,last:null}),v}else Object.keys(this.searchForm.mappings).length===3&&(p=this.dataFactory.variable("g"));if(!(m!=null&&m.filterBindings)){const v=this.getCachedQuads(l,d,f,p);if(v)return v}const h=this;let g;const T=(async function(){var x;let v=h.createFragmentUri(h.searchForm,l,d,f,p);m!=null&&m.filterBindings&&(v=await h.getBindingsRestrictedLink(l,d,f,p,v,m.filterBindings));const F=await h.mediatorDereferenceRdf.mediate({context:y,url:v});v=F.url;const P=await h.mediatorMetadata.mediate({context:y,url:v,quads:F.data,triples:(x=F.metadata)==null?void 0:x.triples}),{metadata:j}=await h.mediatorMetadataExtract.mediate({context:y,url:v,metadata:P.metadata,requestTime:F.requestTime});return g.setProperty("metadata",{...j,state:new u.MetadataValidationState,subsetOf:h.url}),P.data})();return g=new a.TransformIterator(async()=>{const v=await T,F=this.dataFactory.defaultGraph();let P=(0,a.wrap)(v).transform({filter(j){return(0,r.matchPattern)(j,l,d,f,p)?!0:b&&(0,r.matchPattern)(j,l,d,f,F)}});return(b||p.termType==="Variable")&&(P=this.reverseMapQuadsToDefaultGraph(P)),P},{autoStart:!1}),m!=null&&m.filterBindings?g:(this.cacheQuads(g,l,d,f,p),this.getCachedQuads(l,d,f,p))}async getBindingsRestrictedLink(l,d,f,p,_,y){const m=[];for(const h of await y.bindings.toArray()){const g=["("];for(const T of y.metadata.variables){const v=h.get(T.variable);g.push(v?(0,e.termToString)(v):"UNDEF"),g.push(" ")}g.push(")"),m.push(g.join(""))}m.length===0&&m.push("(<ex:comunica:unknown>)");const b=encodeURIComponent(`(${y.metadata.variables.map(h=>`?${h.variable.value}`).join(" ")}) { ${m.join(" ")} }`);return`${_}&values=${b}`}reverseMapQuadsToDefaultGraph(l){const d=this.dataFactory.defaultGraph();return l.map(f=>(0,r.mapTerms)(f,(p,_)=>_==="graph"&&p.equals(this.defaultGraph)?d:p))}getPatternId(l,d,f,p){return JSON.stringify({s:l.termType==="Variable"?"":c(l),p:d.termType==="Variable"?"":c(d),o:f.termType==="Variable"?"":c(f),g:p.termType==="Variable"?"":c(p)})}cacheQuads(l,d,f,p,_){const y=this.getPatternId(d,f,p,_);this.cachedQuads[y]=l.clone()}getCachedQuads(l,d,f,p){const _=this.getPatternId(l,d,f,p),y=this.cachedQuads[_];if(y)return y.clone()}queryQuads(l,d){throw new Error("queryQuads is not implemented in QuerySourceQpf")}queryBoolean(l,d){throw new Error("queryBoolean is not implemented in QuerySourceQpf")}queryVoid(l,d){throw new Error("queryVoid is not implemented in QuerySourceQpf")}};Vp.QuerySourceQpf=n;function c(s){return s.termType==="DefaultGraph"?"|":(0,t.termToString)(s)}return Vp}var OP;function vU(){if(OP)return Up;OP=1,Object.defineProperty(Up,"__esModule",{value:!0}),Up.ActorQuerySourceIdentifyHypermediaQpf=void 0;const i=hm(),o=q(),u=O(),a=G(),t=$(),e=yM();let r=class extends i.ActorQuerySourceIdentifyHypermedia{constructor(c){super(c,"qpf")}async test(c){return c.forceSourceType&&c.forceSourceType!=="qpf"&&c.forceSourceType!=="brtpf"?(0,u.failTest)(`Actor ${this.name} is not able to handle source type ${c.forceSourceType}.`):this.testMetadata(c)}async testMetadata(c){const{searchForm:s}=await this.createSource(c.url,c.metadata,c.context,c.forceSourceType==="brtpf");return s?c.handledDatasets&&c.handledDatasets[s.dataset]?(0,u.failTest)(`Actor ${this.name} can only be applied for the first page of a QPF dataset.`):(0,u.passTest)({filterFactor:1}):(0,u.failTest)("Illegal state: found no TPF/QPF search form anymore in metadata.")}async run(c){this.logInfo(c.context,`Identified as qpf source: ${c.url}`);const s=await this.createSource(c.url,c.metadata,c.context,c.forceSourceType==="brtpf",c.quads);return{source:s,dataset:s.searchForm.dataset}}async createSource(c,s,l,d,f){const p=l.getSafe(o.KeysInitQuery.dataFactory),_=new t.Factory(p);return new e.QuerySourceQpf(this.mediatorMetadata,this.mediatorMetadataExtract,this.mediatorDereferenceRdf,p,_,await a.BindingsFactory.create(this.mediatorMergeBindingsContext,l,p),this.subjectUri,this.predicateUri,this.objectUri,this.graphUri,c,s,d,f)}};return Up.ActorQuerySourceIdentifyHypermediaQpf=r,Up}var AP;function TU(){return AP||(AP=1,(function(i){var o=Ti&&Ti.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ti&&Ti.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(vU(),i),u(yM(),i)})(Ti)),Ti}var Si={},Xp={},Gp={},SP;function _M(){if(SP)return Gp;SP=1,Object.defineProperty(Gp,"__esModule",{value:!0}),Gp.QuerySourceSparql=void 0;const i=q(),o=O(),u=ae(),a=Q(),t=N(),e=oj(),r=To(),n=Oe(),c=$();let s=class me{constructor(d,f,p,_,y,m,b,h,g,T,v,F,P,j,x){this.referenceValue=d,this.url=d,this.context=f,this.mediatorHttp=p,this.bindMethod=_,this.dataFactory=y,this.algebraFactory=m,this.bindingsFactory=b,this.endpointFetcher=new e.SparqlEndpointFetcher({method:h?"GET":"POST",fetch:(A,L)=>this.mediatorHttp.mediate({input:A,init:L,context:this.lastSourceContext}),prefixVariableQuestionMark:!0,dataFactory:y}),this.cache=g>0?new r.LRUCache({max:g}):void 0,this.countTimeout=T,this.cardinalityCountQueries=v,this.cardinalityEstimateConstruction=F,this.defaultGraph=P,this.unionDefaultGraph=j??!1,this.datasets=x}async getSelectorShape(){return me.SELECTOR_SHAPE}queryBindings(d,f,p){let _;p!=null&&p.joinBindings?_=me.addBindingsToOperation(this.algebraFactory,this.bindMethod,d,p.joinBindings):_=Promise.resolve(d);const y=new t.TransformIterator(async()=>{const m=await _,b=c.Util.inScopeVariables(m),h=f.get(i.KeysInitQuery.queryString),g=f.getSafe(i.KeysInitQuery.queryFormat),T=!(p!=null&&p.joinBindings)&&h&&g.language==="sparql"?h:me.operationToSelectQuery(this.algebraFactory,m,b),v=me.getOperationUndefs(m);return this.queryBindingsRemote(this.url,T,b,f,v)},{autoStart:!1});return this.attachMetadata(y,f,_),y}queryQuads(d,f){this.lastSourceContext=this.context.merge(f);const p=this.endpointFetcher.fetchTriples(this.url,f.get(i.KeysInitQuery.queryString)??me.operationToQuery(d));this.lastSourceContext=void 0;const _=(0,t.wrap)(p,{autoStart:!1,maxBufferSize:Number.POSITIVE_INFINITY});return this.attachMetadata(_,f,Promise.resolve(d.input)),_}queryBoolean(d,f){this.lastSourceContext=this.context.merge(f);const p=this.endpointFetcher.fetchAsk(this.url,f.get(i.KeysInitQuery.queryString)??me.operationToQuery(d));return this.lastSourceContext=void 0,p}queryVoid(d,f){this.lastSourceContext=this.context.merge(f);const p=this.endpointFetcher.fetchUpdate(this.url,f.get(i.KeysInitQuery.queryString)??me.operationToQuery(d));return this.lastSourceContext=void 0,p}attachMetadata(d,f,p){let _=[];new Promise(async(y,m)=>{var b,h;try{const g=await p,T=c.Util.inScopeVariables(g),v=this.operationToNormalizedCountQuery(g),F=me.getOperationUndefs(g);_=T.map(L=>({variable:L,canBeUndef:F.some(z=>z.equals(L))}));const P=(b=this.cache)==null?void 0:b.get(v);if(P)return y(P);if(this.cardinalityEstimateConstruction){const L=await this.estimateOperationCardinality(g);if(Number.isFinite(L.value))return(h=this.cache)==null||h.set(v,L),y(L)}if(!this.cardinalityCountQueries)return y({type:"estimate",value:Number.POSITIVE_INFINITY,dataset:this.url});const j=setTimeout(()=>y({type:"estimate",value:Number.POSITIVE_INFINITY,dataset:this.url}),this.countTimeout),x=this.dataFactory.variable("count"),A=await this.queryBindingsRemote(this.url,v,[x],f,[]);A.on("data",L=>{var R;clearTimeout(j);const z=L.get(x),M={type:"estimate",value:Number.POSITIVE_INFINITY,dataset:this.url};if(z){const E=Number.parseInt(z.value,10);Number.isNaN(E)||(M.type="exact",M.value=E,(R=this.cache)==null||R.set(v,M))}return y(M)}),A.on("error",()=>{clearTimeout(j),y({type:"estimate",value:Number.POSITIVE_INFINITY,dataset:this.url})}),A.on("end",()=>{clearTimeout(j),y({type:"estimate",value:Number.POSITIVE_INFINITY,dataset:this.url})})}catch(g){return m(g)}}).then(y=>{d.setProperty("metadata",{state:new u.MetadataValidationState,cardinality:y,variables:_})}).catch(()=>d.setProperty("metadata",{state:new u.MetadataValidationState,cardinality:{type:"estimate",value:Number.POSITIVE_INFINITY,dataset:this.url},variables:_}))}operationToNormalizedCountQuery(d){const f=d.type===c.Algebra.types.PATTERN?this.algebraFactory.createPattern(d.subject.termType==="Variable"?this.dataFactory.variable("s"):d.subject,d.predicate.termType==="Variable"?this.dataFactory.variable("p"):d.predicate,d.object.termType==="Variable"?this.dataFactory.variable("o"):d.object):d;return me.operationToCountQuery(this.dataFactory,this.algebraFactory,f)}async estimateOperationCardinality(d){const f={getCardinality:p=>{var m;const _=this.operationToNormalizedCountQuery(p),y=(m=this.cache)==null?void 0:m.get(_);if(y)return y;if(this.datasets){const b=this.datasets.filter(g=>this.unionDefaultGraph||this.defaultGraph&&g.uri.endsWith(this.defaultGraph)).map(g=>(0,a.estimateCardinality)(p,g));return{type:b.some(g=>g.type==="estimate")?"estimate":"exact",value:b.length>0?b.reduce((g,T)=>g+T.value,0):0,dataset:this.url}}},source:this.url,uri:this.url};return(0,a.estimateCardinality)(d,f)}static async addBindingsToOperation(d,f,p,_){const y=await _.bindings.toArray();switch(f){case"values":return d.createJoin([d.createValues(_.metadata.variables.map(m=>m.variable),y.map(m=>Object.fromEntries([...m].map(([b,h])=>[`?${b.value}`,h])))),p],!1);case"union":throw new Error('Not implemented yet: "union" case');case"filter":throw new Error('Not implemented yet: "filter" case')}}static operationToSelectQuery(d,f,p){return me.operationToQuery(d.createProject(f,p))}static operationToCountQuery(d,f,p){return me.operationToQuery(f.createProject(f.createExtend(f.createGroup(p,[],[f.createBoundAggregate(d.variable("var0"),"count",f.createWildcardExpression(),!1)]),d.variable("count"),f.createTermExpression(d.variable("var0"))),[d.variable("count")]))}static operationToQuery(d){return(0,c.toSparql)(d,{sparqlStar:!0})}static getOperationUndefs(d){const f=[];return c.Util.recurseOperation(d,{leftjoin(p){const _=c.Util.inScopeVariables(p.input[0]),y=c.Util.inScopeVariables(p.input[1]);for(const m of y)_.some(b=>b.equals(m))||f.push(m);return!1},values(p){for(const _ of p.variables)p.bindings.some(y=>!(`?${_.value}`in y))&&f.push(_);return!1},union(p){const _=p.input.map(c.Util.inScopeVariables);for(const y of(0,n.uniqTerms)(_.flat()))_.every(m=>m.some(b=>b.equals(y)))||f.push(y);return!0}}),(0,n.uniqTerms)(f)}async queryBindingsRemote(d,f,p,_,y){const m=new Set;for(const h of y)m.add(h.value);this.lastSourceContext=this.context.merge(_);const b=await this.endpointFetcher.fetchBindings(d,f);return this.lastSourceContext=void 0,(0,t.wrap)(b,{autoStart:!1,maxBufferSize:Number.POSITIVE_INFINITY}).map(h=>this.bindingsFactory.bindings(p.map(g=>{var v;const T=h[`?${g.value}`];return!m.has(g.value)&&!T&&((v=o.Actor.getContextLogger(this.context))==null||v.warn(`The endpoint ${d} failed to provide a binding for ${g.value}.`)),[g,T]}).filter(([g,T])=>!!T)))}toString(){return`QuerySourceSparql(${this.url})`}};return Gp.QuerySourceSparql=s,s.SELECTOR_SHAPE={type:"disjunction",children:[{type:"operation",operation:{operationType:"wildcard"},joinBindings:!0}]},Gp}var FP;function OU(){if(FP)return Xp;FP=1,Object.defineProperty(Xp,"__esModule",{value:!0}),Xp.ActorQuerySourceIdentifyHypermediaSparql=void 0;const i=hm(),o=q(),u=O(),a=G(),t=$(),e=_M();let r=class extends i.ActorQuerySourceIdentifyHypermedia{constructor(c){super(c,"sparql")}async testMetadata(c){return!c.forceSourceType&&!this.forceSourceType&&!c.metadata.sparqlService&&!(this.checkUrlSuffix&&(c.url.endsWith("/sparql")||c.url.endsWith("/sparql/")))?(0,u.failTest)(`Actor ${this.name} could not detect a SPARQL service description or URL ending on /sparql.`):(0,u.passTest)({filterFactor:1})}async run(c){var p;this.logInfo(c.context,`Identified ${c.url} as sparql source with service URL: ${c.metadata.sparqlService||c.url}`);const s=c.context.getSafe(o.KeysInitQuery.dataFactory),l=new t.Factory(s),d=((p=c.context.get(o.KeysQueryOperation.querySources))==null?void 0:p.length)===1;return{source:new e.QuerySourceSparql(c.forceSourceType??this.forceSourceType?c.url:c.metadata.sparqlService||c.url,c.context,this.mediatorHttp,this.bindMethod,s,l,await a.BindingsFactory.create(this.mediatorMergeBindingsContext,c.context,s),this.forceHttpGet,this.cacheSize,this.countTimeout,this.cardinalityCountQueries&&!d,this.cardinalityEstimateConstruction,c.metadata.defaultGraph,c.metadata.unionDefaultGraph,c.metadata.datasets)}}};return Xp.ActorQuerySourceIdentifyHypermediaSparql=r,Xp}var wP;function AU(){return wP||(wP=1,(function(i){var o=Si&&Si.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Si&&Si.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(OU(),i),u(_M(),i)})(Si)),Si}var Fi={},Jp={},wi={},Kp={},Yp={},RP;function mM(){if(RP)return Yp;RP=1,Object.defineProperty(Yp,"__esModule",{value:!0}),Yp.QuerySourceRdfJs=void 0;const i=Jy(),o=q(),u=ae(),a=N(),t=Oe(),e=$();let r=class fe{constructor(c,s,l){this.source=c,this.referenceValue=c,this.dataFactory=s,this.bindingsFactory=l;const d=new e.Factory(this.dataFactory);this.selectorShape={type:"operation",operation:{operationType:"pattern",pattern:d.createPattern(this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"))},variablesOptional:[this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o")]},this.dummyDefaultGraph=this.dataFactory.variable("__comunica:defaultGraph")}static nullifyVariables(c,s){return!c||c.termType==="Variable"||!s&&c.termType==="Quad"&&(0,t.someTermsNested)(c,l=>l.termType==="Variable")?void 0:c}static hasDuplicateVariables(c){const s=(0,t.filterTermsNested)(c,l=>l.termType==="Variable");return s.length>1&&(0,t.uniqTerms)(s).length<s.length}async getSelectorShape(){return this.selectorShape}queryBindings(c,s){var _;if(c.type!=="pattern")throw new Error(`Attempted to pass non-pattern operation '${c.type}' to QuerySourceRdfJs`);const l=!!s.get(o.KeysQueryOperation.unionDefaultGraph);if(c.graph.termType==="DefaultGraph"&&l&&(c.graph=this.dummyDefaultGraph),this.source.matchBindings){const y=this.source.matchBindings(this.bindingsFactory,c.subject,c.predicate,c.object,c.graph);let m=y instanceof a.AsyncIterator?y:(0,a.wrap)(y,{autoStart:!1}),b=!1;if(c.graph.termType==="Variable"&&!l){b=!0;const h=c.graph;m=m.filter(g=>g.get(h).termType!=="DefaultGraph")}if(c.graph.equals(this.dummyDefaultGraph)&&(m=m.map(h=>h.delete(this.dummyDefaultGraph)),c.graph=this.dataFactory.defaultGraph()),!m.getProperty("metadata")){const h=(0,i.getVariables)(c).map(g=>({variable:g,canBeUndef:!1}));this.setMetadata(m,c,s,b,{variables:h}).catch(g=>m.destroy(g))}return m}const d=!!((_=this.source.features)!=null&&_.quotedTripleFiltering),f=this.source.match(fe.nullifyVariables(c.subject,d),fe.nullifyVariables(c.predicate,d),fe.nullifyVariables(c.object,d),fe.nullifyVariables(c.graph,d));let p=f instanceof a.AsyncIterator?f:(0,a.wrap)(f,{autoStart:!1});return d||(p=(0,i.filterMatchingQuotedQuads)(c,p)),p.getProperty("metadata")||this.setMetadata(p,c,s).catch(y=>p.destroy(y)),c.graph.equals(this.dummyDefaultGraph)&&(c.graph=this.dataFactory.defaultGraph()),(0,i.quadsToBindings)(p,c,this.dataFactory,this.bindingsFactory,!!s.get(o.KeysQueryOperation.unionDefaultGraph))}async setMetadata(c,s,l,d=!1,f={}){var b;const p=!!((b=this.source.features)!=null&&b.quotedTripleFiltering),_=!!l.get(o.KeysQueryOperation.unionDefaultGraph);s.graph.termType==="DefaultGraph"&&_&&(s.graph=this.dummyDefaultGraph);let y;if(this.source.countQuads)y=await this.source.countQuads(fe.nullifyVariables(s.subject,p),fe.nullifyVariables(s.predicate,p),fe.nullifyVariables(s.object,p),fe.nullifyVariables(s.graph,p));else{let h=0;y=await new Promise((g,T)=>{const v=this.source.match(fe.nullifyVariables(s.subject,p),fe.nullifyVariables(s.predicate,p),fe.nullifyVariables(s.object,p),fe.nullifyVariables(s.graph,p));v.on("error",T),v.on("end",()=>g(h)),v.on("data",()=>h++)})}const m=!p&&(0,t.someTerms)(s,h=>h.termType==="Quad")||fe.hasDuplicateVariables(s);c.setProperty("metadata",{state:new u.MetadataValidationState,cardinality:{type:m||d?"estimate":"exact",value:y},requestTime:0,...f})}queryQuads(c,s){throw new Error("queryQuads is not implemented in QuerySourceRdfJs")}queryBoolean(c,s){throw new Error("queryBoolean is not implemented in QuerySourceRdfJs")}queryVoid(c,s){throw new Error("queryVoid is not implemented in QuerySourceRdfJs")}toString(){return`QuerySourceRdfJs(${this.source.constructor.name})`}};return Yp.QuerySourceRdfJs=r,Yp}var PP;function SU(){if(PP)return Kp;PP=1,Object.defineProperty(Kp,"__esModule",{value:!0}),Kp.ActorQuerySourceIdentifyRdfJs=void 0;const i=Jy(),o=q(),u=O(),a=G(),t=mM();let e=class extends i.ActorQuerySourceIdentify{constructor(n){super(n)}async test(n){const c=n.querySourceUnidentified;return c.type!==void 0&&c.type!=="rdfjs"?(0,u.failTest)(`${this.name} requires a single query source with rdfjs type to be present in the context.`):typeof c.value=="string"||!("match"in c.value)?(0,u.failTest)(`${this.name} received an invalid rdfjs query source.`):(0,u.passTestVoid)()}async run(n){const c=n.context.getSafe(o.KeysInitQuery.dataFactory);return{querySource:{source:new t.QuerySourceRdfJs(n.querySourceUnidentified.value,c,await a.BindingsFactory.create(this.mediatorMergeBindingsContext,n.context,c)),context:n.querySourceUnidentified.context??new u.ActionContext}}}};return Kp.ActorQuerySourceIdentifyRdfJs=e,Kp}var K_={},qP;function FU(){return qP||(qP=1,Object.defineProperty(K_,"__esModule",{value:!0})),K_}var jP;function vm(){return jP||(jP=1,(function(i){var o=wi&&wi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=wi&&wi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(SU(),i),u(FU(),i),u(mM(),i)})(wi)),wi}var MP;function wU(){if(MP)return Jp;MP=1,Object.defineProperty(Jp,"__esModule",{value:!0}),Jp.ActorQuerySourceIdentifyHypermediaNone=void 0;const i=vm(),o=hm(),u=q(),a=O(),t=G(),e=uj();let r=class extends o.ActorQuerySourceIdentifyHypermedia{constructor(c){super(c,"file")}async testMetadata(c){return(0,a.passTest)({filterFactor:0})}async run(c){this.logInfo(c.context,`Identified as file source: ${c.url}`);const s=c.context.getSafe(u.KeysInitQuery.dataFactory),l=new i.QuerySourceRdfJs(await(0,e.storeStream)(c.quads),s,await t.BindingsFactory.create(this.mediatorMergeBindingsContext,c.context,s));return l.toString=()=>`QuerySourceRdfJs(${c.url})`,l.referenceValue=c.url,{source:l}}};return Jp.ActorQuerySourceIdentifyHypermediaNone=r,Jp}var xP;function RU(){return xP||(xP=1,(function(i){var o=Fi&&Fi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Fi&&Fi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(wU(),i)})(Fi)),Fi}var Ri={},Wp={},Pi={},Zp={},DP;function PU(){if(DP)return Zp;DP=1,Object.defineProperty(Zp,"__esModule",{value:!0}),Zp.ActorExpressionEvaluatorFactory=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a),this.mediatorQueryOperation=a.mediatorQueryOperation,this.mediatorFunctionFactory=a.mediatorFunctionFactory,this.mediatorMergeBindingsContext=a.mediatorMergeBindingsContext}};return Zp.ActorExpressionEvaluatorFactory=o,Zp}var EP;function qU(){return EP||(EP=1,(function(i){var o=Pi&&Pi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Pi&&Pi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(PU(),i)})(Pi)),Pi}var kp={},LP;function bM(){if(LP)return kp;LP=1,Object.defineProperty(kp,"__esModule",{value:!0}),kp.AlgebraTransformer=void 0;const i=q(),o=S(),u=$();let a=class t_ extends o.TermTransformer{constructor(e,r){super(e.getSafe(i.KeysExpressionEvaluator.superTypeProvider)),this.context=e,this.mediatorFunctionFactory=r}async transformAlgebra(e){const r=u.Algebra.expressionTypes;switch(e.expressionType){case r.TERM:return this.transformTerm(e);case r.OPERATOR:return await this.transformOperator(e);case r.NAMED:return await this.transformNamed(e);case r.EXISTENCE:return t_.transformExistence(e);case r.AGGREGATE:return t_.transformAggregate(e);case r.WILDCARD:return t_.transformWildcard(e)}}static transformWildcard(e){return new o.NamedNode(e.wildcard.value)}async getOperator(e,r){const n=await this.mediatorFunctionFactory.mediate({functionName:e,arguments:r.args,context:this.context}),c=await Promise.all(r.args.map(s=>this.transformAlgebra(s)));if(!n.checkArity(c))throw new o.InvalidArity(c,e);return new o.Operator(e,c,n.apply)}async transformOperator(e){return this.getOperator(e.operator.toLowerCase(),e)}async transformNamed(e){return this.getOperator(e.name.value,e)}static transformAggregate(e){const r=e.aggregator;return new o.Aggregate(r,e)}static transformExistence(e){return new o.Existence(e)}};return kp.AlgebraTransformer=a,kp}var ey={},ty={},IP;function gM(){if(IP)return ty;IP=1,Object.defineProperty(ty,"__esModule",{value:!0}),ty.InternalEvaluator=void 0;const i=q(),o=Ee(),u=S(),a=Q(),t=$(),e=bM();let r=class{constructor(c,s,l,d){this.context=c,this.mediatorQueryOperation=l,this.bindingsFactory=d,this.subEvaluators={[o.ExpressionType.Term]:(f,p)=>this.term(f),[o.ExpressionType.Variable]:(f,p)=>this.variable(f,p),[o.ExpressionType.Operator]:(f,p)=>this.evalFunction(f,p),[o.ExpressionType.Existence]:(f,p)=>this.evalExistence(f,p),[o.ExpressionType.Aggregate]:(f,p)=>this.evalAggregate()},this.transformer=new e.AlgebraTransformer(c,s)}async evaluatorExpressionEvaluation(c,s){return this.subEvaluators[c.expressionType].bind(this)(c,s)}term(c){return c}variable(c,s){const l=s.get(u.expressionToVar(this.context.getSafe(i.KeysInitQuery.dataFactory),c));if(!l)throw new u.UnboundVariableError(c.name,s);return this.transformer.transformRDFTermUnsafe(l)}async evalFunction(c,s){return c.apply({args:c.args,mapping:s,exprEval:this})}async evalExistence(c,s){const l=this.context.getSafe(i.KeysInitQuery.dataFactory),d=new t.Factory(l),f=(0,a.materializeOperation)(c.expression.input,s,d,this.bindingsFactory),p=await this.mediatorQueryOperation.mediate({operation:f,context:this.context}),_=(0,a.getSafeBindings)(p);return await new Promise((y,m)=>{_.bindingsStream.on("end",()=>{y(!1)}),_.bindingsStream.on("error",m),_.bindingsStream.on("data",()=>{_.bindingsStream.close(),y(!0)})}).then(y=>c.expression.not?!y:y).then(y=>new u.BooleanLiteral(y))}evalAggregate(){throw new u.NoAggregator}};return ty.InternalEvaluator=r,ty}var $P;function jU(){if($P)return ey;$P=1,Object.defineProperty(ey,"__esModule",{value:!0}),ey.ExpressionEvaluator=void 0;const i=q(),o=gM();let u=class{constructor(t,e,r,n,c){this.context=t,this.expr=e,this.mediatorFunctionFactory=r,this.mediatorQueryOperation=n,this.bindingsFactory=c,this.internalEvaluator=new o.InternalEvaluator(t,r,n,c)}async evaluate(t){return(await this.internalEvaluator.evaluatorExpressionEvaluation(this.expr,t)).toRDF(this.context.getSafe(i.KeysInitQuery.dataFactory))}async evaluateAsEBV(t){return(await this.internalEvaluator.evaluatorExpressionEvaluation(this.expr,t)).coerceEBV()}evaluateAsEvaluatorExpression(t){return this.evaluatorExpressionEvaluation(this.expr,t)}evaluatorExpressionEvaluation(t,e){return this.internalEvaluator.evaluatorExpressionEvaluation(t,e)}};return ey.ExpressionEvaluator=u,ey}var BP;function MU(){if(BP)return Wp;BP=1,Object.defineProperty(Wp,"__esModule",{value:!0}),Wp.ActorExpressionEvaluatorFactoryDefault=void 0;const i=qU(),o=q(),u=O(),a=G(),t=S(),e=bM(),r=jU();let n=class extends i.ActorExpressionEvaluatorFactory{constructor(s){super(s)}async test(s){return(0,u.passTestVoid)()}async run(s){const l=(0,t.prepareEvaluatorActionContext)(s.context);return new r.ExpressionEvaluator(l,await new e.AlgebraTransformer(l,this.mediatorFunctionFactory).transformAlgebra(s.algExpr),this.mediatorFunctionFactory,this.mediatorQueryOperation,await a.BindingsFactory.create(this.mediatorMergeBindingsContext,s.context,s.context.getSafe(o.KeysInitQuery.dataFactory)))}};return Wp.ActorExpressionEvaluatorFactoryDefault=n,Wp}var QP;function xU(){return QP||(QP=1,(function(i){var o=Ri&&Ri.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ri&&Ri.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(MU(),i)})(Ri)),Ri}var qi={},ry={},ny={},NP;function DU(){if(NP)return ny;NP=1,Object.defineProperty(ny,"__esModule",{value:!0}),ny.GroupsState=void 0;const i=q(),o=G();let u=class{constructor(t,e,r,n,c){this.pattern=t,this.mediatorBindingsAggregatorFactory=e,this.context=r,this.bindingsFactory=n,this.variables=c,this.groups=new Map,this.groupsInitializer=new Map,this.groupVariables=new Set(this.pattern.variables.map(s=>s.value)),this.waitCounter=1,this.resultHasBeenCalled=!1}consumeBindings(t){const e=this.resultCheck();if(e)return e;this.waitCounter++;const r=t.filter((l,d)=>this.groupVariables.has(d.value)),n=this.hashBindings(r);let c=this.groupsInitializer.get(n),s;if(c){const l=c;s=(async()=>{const d=await l;await Promise.all(this.pattern.aggregates.map(async f=>{const p=f.variable.value;await d.aggregators[p].putBindings(t)}))})().then(async()=>{await this.subtractWaitCounterAndCollect()})}else c=(async()=>{const l={};await Promise.all(this.pattern.aggregates.map(async f=>{const p=f.variable.value;l[p]=await this.mediatorBindingsAggregatorFactory.mediate({expr:f,context:this.context}),await l[p].putBindings(t)}));const d={aggregators:l,bindings:r};return this.groups.set(n,d),await this.subtractWaitCounterAndCollect(),d})(),this.groupsInitializer.set(n,c),s=c;return s}async subtractWaitCounterAndCollect(){--this.waitCounter===0&&await this.handleResultCollection()}async handleResultCollection(){const t=this.context.getSafe(i.KeysInitQuery.dataFactory);let e=await Promise.all([...this.groups].map(async([r,n])=>{const{bindings:c,aggregators:s}=n;let l=c;for(const d in s){const f=await s[d].result();f&&(l=l.set(t.variable(d),f))}return l}));if(e.length===0&&this.groupVariables.size===0){const r=[];await Promise.all(this.pattern.aggregates.map(async n=>{const c=n.variable,l=await(await this.mediatorBindingsAggregatorFactory.mediate({expr:n,context:this.context})).result();l!==void 0&&r.push([c,l])})),e=[this.bindingsFactory.bindings(r)]}this.waitResolver(e)}resultCheck(){if(this.resultHasBeenCalled)return Promise.reject(new Error("Calling any function after calling collectResult is invalid."))}async collectResults(){const t=this.resultCheck();if(t)return t;this.resultHasBeenCalled=!0;const e=new Promise(r=>{this.waitResolver=r});return await this.subtractWaitCounterAndCollect(),e}hashBindings(t){return(0,o.bindingsToCompactString)(t,this.variables)}};return ny.GroupsState=u,ny}var CP;function EU(){if(CP)return ry;CP=1,Object.defineProperty(ry,"__esModule",{value:!0}),ry.ActorQueryOperationGroup=void 0;const i=X(),o=q(),u=O(),a=G(),t=Q(),e=N(),r=DU();let n=class extends i.ActorQueryOperationTypedMediated{constructor(s){super(s,"group"),this.mediatorBindingsAggregatorFactory=s.mediatorBindingsAggregatorFactory}async testOperation(){return(0,u.passTestVoid)()}async runOperation(s,l){const d=l.getSafe(o.KeysInitQuery.dataFactory),f=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,l,d),{input:p,aggregates:_}=s,y=await this.mediatorQueryOperation.mediate({operation:p,context:l}),m=(0,t.getSafeBindings)(y),b=[...s.variables,..._.map(T=>T.variable)].map(T=>({variable:T,canBeUndef:!1})),h=(await m.metadata()).variables.map(T=>T.variable);return{type:"bindings",bindingsStream:new e.TransformIterator(()=>new Promise((T,v)=>{const F=new r.GroupsState(s,this.mediatorBindingsAggregatorFactory,l,f,h);m.bindingsStream.on("end",async()=>{try{const P=new e.ArrayIterator(await F.collectResults(),{autoStart:!1});T(P)}catch(P){v(P)}}),m.bindingsStream.on("error",v),m.bindingsStream.on("data",P=>{F.consumeBindings(P).catch(v)})}),{autoStart:!1}),metadata:async()=>({...await m.metadata(),variables:b})}}};return ry.ActorQueryOperationGroup=n,ry}var UP;function LU(){return UP||(UP=1,(function(i){var o=qi&&qi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=qi&&qi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(EU(),i)})(qi)),qi}var ji={},ay={},HP;function IU(){if(HP)return ay;HP=1,Object.defineProperty(ay,"__esModule",{value:!0}),ay.ActorQueryOperationNop=void 0;const i=X(),o=q(),u=O(),a=G(),t=ae(),e=N();let r=class extends i.ActorQueryOperationTypedMediated{constructor(c){super(c,"nop")}async testOperation(c,s){return(0,u.passTestVoid)()}async runOperation(c,s){const l=s.getSafe(o.KeysInitQuery.dataFactory),d=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,s,l);return{bindingsStream:new e.SingletonIterator(d.bindings()),metadata:()=>Promise.resolve({state:new t.MetadataValidationState,cardinality:{type:"exact",value:1},variables:[]}),type:"bindings"}}};return ay.ActorQueryOperationNop=r,ay}var VP;function $U(){return VP||(VP=1,(function(i){var o=ji&&ji.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ji&&ji.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(IU(),i)})(ji)),ji}var Mi={},iy={},zP;function BU(){if(zP)return iy;zP=1,Object.defineProperty(iy,"__esModule",{value:!0}),iy.ActorQueryOperationService=void 0;const i=X(),o=q(),u=O(),a=G(),t=ae(),e=Q(),r=N();let n=class extends i.ActorQueryOperationTypedMediated{constructor(s){super(s,"service")}async testOperation(s,l){return s.name.termType!=="NamedNode"?(0,u.failTest)(`${this.name} can only query services by IRI, while a ${s.name.termType} was given.`):(0,u.passTestVoid)()}async runOperation(s,l){const{querySource:d}=await this.mediatorQuerySourceIdentify.mediate({querySourceUnidentified:{value:s.name.value,type:this.forceSparqlEndpoint?"sparql":void 0},context:l});let f;try{f=(0,e.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:(0,e.assignOperationSource)(s.input,d),context:l}))}catch(p){if(s.silent){const _=l.getSafe(o.KeysInitQuery.dataFactory),y=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,l,_);f={bindingsStream:new r.SingletonIterator(y.bindings()),type:"bindings",metadata:async()=>({state:new t.MetadataValidationState,cardinality:{type:"exact",value:1},variables:[]})},this.logWarn(l,`An error occurred when executing a SERVICE clause: ${p.message}`)}else throw p}return f}};return iy.ActorQueryOperationService=n,iy}var XP;function QU(){return XP||(XP=1,(function(i){var o=Mi&&Mi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Mi&&Mi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(BU(),i)})(Mi)),Mi}var xi={},oy={},GP;function NU(){if(GP)return oy;GP=1,Object.defineProperty(oy,"__esModule",{value:!0}),oy.ActorQueryOperationValues=void 0;const i=X(),o=q(),u=O(),a=G(),t=ae(),e=N();let r=class extends i.ActorQueryOperationTyped{constructor(c){super(c,"values")}async testOperation(c,s){return(0,u.passTestVoid)()}async runOperation(c,s){const l=s.getSafe(o.KeysInitQuery.dataFactory),d=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,s,l);return{type:"bindings",bindingsStream:new e.ArrayIterator(c.bindings.map(_=>d.bindings(Object.entries(_).map(([y,m])=>[l.variable(y.slice(1)),m])))),metadata:()=>Promise.resolve({state:new t.MetadataValidationState,cardinality:{type:"exact",value:c.bindings.length},variables:c.variables.map(_=>({variable:_,canBeUndef:c.bindings.some(y=>!(`?${_.value}`in y))}))})}}};return oy.ActorQueryOperationValues=r,oy}var JP;function CU(){return JP||(JP=1,(function(i){var o=xi&&xi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=xi&&xi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(NU(),i)})(xi)),xi}var Di={},uy={},KP;function UU(){if(KP)return uy;KP=1,Object.defineProperty(uy,"__esModule",{value:!0}),uy.ActorQueryOperationPathOneOrMore=void 0;const i=Ie(),o=q(),u=G(),a=Q(),t=N(),e=$();let r=class extends i.ActorAbstractPath{constructor(c){super(c,e.Algebra.types.ONE_OR_MORE_PATH)}async runOperation(c,s){const l=s.getSafe(o.KeysInitQuery.dataFactory),d=new e.Factory(l),f=await u.BindingsFactory.create(this.mediatorMergeBindingsContext,s,l),p=await this.isPathArbitraryLengthDistinct(d,s,c);if(p.operation)return p.operation;s=p.context;const _=c.predicate;if(c.subject.termType!=="Variable"&&c.object.termType==="Variable"){const h=c.object,g=await this.getObjectsPredicateStarEval(c.subject,_.path,h,c.graph,s,!1,d,f),T=(c.graph.termType==="Variable"?[h,c.graph]:[h]).map(v=>({variable:v,canBeUndef:!1}));return{type:"bindings",bindingsStream:g.bindingsStream,metadata:async()=>({...await g.metadata(),variables:T})}}if(c.subject.termType==="Variable"&&c.object.termType==="Variable"){const h=d.createDistinct(d.createPath(c.subject,c.predicate.path,c.object,c.graph)),g=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:s,operation:h})),T=c.subject,v=c.object,F={},P=new t.MultiTransformIterator(g.bindingsStream,{multiTransform:x=>{const A=x.get(T),L=x.get(v),z=c.graph.termType==="Variable"?x.get(c.graph):c.graph;return new t.TransformIterator(async()=>{const M=new t.BufferedIterator;return await this.getSubjectAndObjectBindingsPredicateStar(T,v,A,L,_.path,z,s,F,{},M,{count:0},d,f),M.map(R=>(c.graph.termType==="Variable"&&(R=R.set(c.graph,z)),R))},{autoStart:!1,maxBufferSize:128})},autoStart:!1}),j=(c.graph.termType==="Variable"?[T,v,c.graph]:[T,v]).map(x=>({variable:x,canBeUndef:!1}));return{type:"bindings",bindingsStream:P,metadata:async()=>({...await g.metadata(),variables:j})}}if(c.subject.termType==="Variable"&&c.object.termType!=="Variable")return this.mediatorQueryOperation.mediate({context:s,operation:d.createPath(c.object,d.createOneOrMorePath(d.createInv(_.path)),c.subject,c.graph)});const y=this.generateVariable(l),m=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:s,operation:d.createPath(c.subject,_,y,c.graph)}));return{type:"bindings",bindingsStream:m.bindingsStream.map(h=>c.object.equals(h.get(y))?c.graph.termType==="Variable"?f.bindings([[c.graph,h.get(c.graph)]]):f.bindings():null),metadata:async()=>({...await m.metadata(),variables:(c.graph.termType==="Variable"?[c.graph]:[]).map(h=>({variable:h,canBeUndef:!1}))})}}};return uy.ActorQueryOperationPathOneOrMore=r,uy}var YP;function HU(){return YP||(YP=1,(function(i){var o=Di&&Di.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Di&&Di.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(UU(),i)})(Di)),Di}var Ei={},cy={},WP;function VU(){if(WP)return cy;WP=1,Object.defineProperty(cy,"__esModule",{value:!0}),cy.ActorQueryOperationPathZeroOrMore=void 0;const i=Ie(),o=q(),u=G(),a=Q(),t=N(),e=ne(),r=$();let n=class extends i.ActorAbstractPath{constructor(s){super(s,r.Algebra.types.ZERO_OR_MORE_PATH)}async runOperation(s,l){const d=l.getSafe(o.KeysInitQuery.dataFactory),f=new r.Factory(d),p=await u.BindingsFactory.create(this.mediatorMergeBindingsContext,l,d),_=await this.isPathArbitraryLengthDistinct(f,l,s);if(_.operation)return _.operation;l=_.context;const y=s.predicate,m=this.getPathSources(y),b=s.subject.termType==="Variable",h=s.object.termType==="Variable";if(s.subject.termType==="Variable"&&s.object.termType==="Variable"){const j=this.generateVariable(d,s),x=this.assignPatternSources(f,f.createPattern(s.subject,j,s.object,s.graph),m),A=(0,a.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:l,operation:x})),L=s.subject,z=s.object,M=new Set,R={},E=new t.MultiTransformIterator(A.bindingsStream,{multiTransform:C=>{const ce=C.get(L),lo=C.get(z),$e=s.graph.termType==="Variable"?C.get(s.graph):s.graph,fo=(0,e.termToString)(ce)+(0,e.termToString)($e),je=(0,e.termToString)(lo)+(0,e.termToString)($e);return new t.TransformIterator(async()=>{if(M.has(fo)&&M.has(je))return new t.EmptyIterator;const Fo=new t.BufferedIterator,Ky={count:0};return M.has(fo)||(M.add(fo),await this.getSubjectAndObjectBindingsPredicateStar(L,z,ce,ce,y.path,$e,l,R,{},Fo,Ky,f,p)),M.has(je)||(M.add(je),await this.getSubjectAndObjectBindingsPredicateStar(L,z,lo,lo,y.path,$e,l,R,{},Fo,Ky,f,p)),Fo.map(wo=>(s.graph.termType==="Variable"&&(wo=wo.set(s.graph,$e)),wo))},{autoStart:!1,maxBufferSize:128})},autoStart:!1}),D=(s.graph.termType==="Variable"?[L,s.object,s.graph]:[L,s.object]).map(C=>({variable:C,canBeUndef:!1}));return{type:"bindings",bindingsStream:E,metadata:async()=>({...await A.metadata(),variables:D})}}if(!b&&!h){const j=this.generateVariable(d),x=await this.getObjectsPredicateStarEval(s.subject,y.path,j,s.graph,l,!0,f,p);return{type:"bindings",bindingsStream:x.bindingsStream.map(L=>s.object.equals(L.get(j))?s.graph.termType==="Variable"?p.bindings([[s.graph,L.get(s.graph)]]):p.bindings():null),metadata:async()=>({...await x.metadata(),variables:(s.graph.termType==="Variable"?[s.graph]:[]).map(L=>({variable:L,canBeUndef:!1}))})}}const g=b?s.object:s.subject,T=b?s.subject:s.object,v=b?f.createInv(y.path):y.path,F=await this.getObjectsPredicateStarEval(g,v,T,s.graph,l,!0,f,p),P=(s.graph.termType==="Variable"?[T,s.graph]:[T]).map(j=>({variable:j,canBeUndef:!1}));return{type:"bindings",bindingsStream:F.bindingsStream,metadata:async()=>({...await F.metadata(),variables:P})}}};return cy.ActorQueryOperationPathZeroOrMore=n,cy}var ZP;function zU(){return ZP||(ZP=1,(function(i){var o=Ei&&Ei.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ei&&Ei.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(VU(),i)})(Ei)),Ei}var Li={},sy={},kP;function XU(){if(kP)return sy;kP=1,Object.defineProperty(sy,"__esModule",{value:!0}),sy.ActorQueryOperationPathZeroOrOne=void 0;const i=Ie(),o=q(),u=G(),a=ae(),t=Q(),e=N(),r=$();let n=class extends i.ActorAbstractPath{constructor(s){super(s,r.Algebra.types.ZERO_OR_ONE_PATH)}async runOperation(s,l){const d=l.getSafe(o.KeysInitQuery.dataFactory),f=new r.Factory(d),p=await u.BindingsFactory.create(this.mediatorMergeBindingsContext,l,d),_=s.predicate,y=this.getPathSources(_),m=[];if(s.subject.termType!=="Variable"&&s.object.termType!=="Variable"&&s.subject.equals(s.object))return{type:"bindings",bindingsStream:new e.SingletonIterator(p.bindings()),metadata:()=>Promise.resolve({state:new a.MetadataValidationState,cardinality:{type:"exact",value:1},variables:[]})};const b=await this.isPathArbitraryLengthDistinct(f,l,s);if(b.operation)return b.operation;l=b.context;const h=(0,t.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:l,operation:f.createPath(s.subject,_.path,s.object,s.graph)}));let g;if(s.subject.termType==="Variable"&&s.object.termType==="Variable"){const v=this.generateVariable(d,s),F=(0,t.getSafeBindings)(await this.mediatorQueryOperation.mediate({context:l,operation:f.createFilter(this.assignPatternSources(f,f.createPattern(s.subject,v,s.object,s.graph),y),f.createOperatorExpression("=",[f.createTermExpression(s.subject),f.createTermExpression(s.object)]))})).bindingsStream.map(P=>P.delete(v));g=new e.UnionIterator([F,h.bindingsStream],{autoStart:!1})}else s.subject.termType==="Variable"&&m.push(p.bindings([[s.subject,s.object]])),s.object.termType==="Variable"&&m.push(p.bindings([[s.object,s.subject]])),g=h.bindingsStream.prepend(m);return{type:"bindings",bindingsStream:g,metadata:async()=>{const v=await h.metadata();return{...v,cardinality:{...v.cardinality,value:v.cardinality.value+1}}}}}};return sy.ActorQueryOperationPathZeroOrOne=n,sy}var eq;function GU(){return eq||(eq=1,(function(i){var o=Li&&Li.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Li&&Li.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(XU(),i)})(Li)),Li}var Ii={},dy={},tq;function JU(){if(tq)return dy;tq=1,Object.defineProperty(dy,"__esModule",{value:!0}),dy.ActorQueryOperationUpdateDeleteInsert=void 0;const i=nM(),o=X(),u=q(),a=G(),t=Q(),e=N();let r=class extends o.ActorQueryOperationTypedMediated{constructor(c){super(c,"deleteinsert"),this.blankNodeCounter=0}async testOperation(c,s){return(0,t.testReadOnly)(s)}async runOperation(c,s){const l=s.getSafe(u.KeysInitQuery.dataFactory),d=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,s,l),f=c.where?(0,t.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:c.where,context:s})).bindingsStream:new e.ArrayIterator([d.bindings()],{autoStart:!1});let p,_;c.insert&&(p=new i.BindingsToQuadsIterator(l,c.insert.map(i.BindingsToQuadsIterator.localizeQuad.bind(null,l,this.blankNodeCounter)),f.clone()),this.blankNodeCounter++),c.delete&&(_=new i.BindingsToQuadsIterator(l,c.delete.map(i.BindingsToQuadsIterator.localizeQuad.bind(null,l,this.blankNodeCounter)),f.clone()),this.blankNodeCounter++);const{execute:y}=await this.mediatorUpdateQuads.mediate({quadStreamInsert:p,quadStreamDelete:_,context:s});return{type:"void",execute:y}}};return dy.ActorQueryOperationUpdateDeleteInsert=r,dy}var rq;function KU(){return rq||(rq=1,(function(i){var o=Ii&&Ii.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ii&&Ii.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(JU(),i)})(Ii)),Ii}var $i={},ly={},Bi={},fy={},nq;function YU(){if(nq)return fy;nq=1,Object.defineProperty(fy,"__esModule",{value:!0}),fy.ActorQueryProcess=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a)}};return fy.ActorQueryProcess=o,fy}var aq;function s_(){return aq||(aq=1,(function(i){var o=Bi&&Bi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Bi&&Bi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(YU(),i)})(Bi)),Bi}var iq;function WU(){if(iq)return ly;iq=1,Object.defineProperty(ly,"__esModule",{value:!0}),ly.ActorQueryProcessSequential=void 0;const i=s_(),o=q(),u=O(),a=G(),t=Q(),e=$();let r=class extends i.ActorQueryProcess{constructor(c){super(c)}async test(c){return c.context.get(o.KeysInitQuery.explain)??c.context.get(new u.ActionContextKey("explain"))?(0,u.failTest)(`${this.name} is not able to explain queries.`):(0,u.passTestVoid)()}async run(c){let{operation:s,context:l}=await this.parse(c.query,c.context);return{operation:s,context:l}=await this.optimize(s,l),{result:await this.evaluate(s,l)}}async parse(c,s){s=(await this.mediatorContextPreprocess.mediate({context:s,initialize:!0})).context;let l;if(typeof c=="string"){s=s.set(o.KeysInitQuery.queryString,c);const d=s.get(o.KeysInitQuery.baseIRI),f=s.get(o.KeysInitQuery.queryFormat),p=await this.mediatorQueryParse.mediate({context:s,query:c,queryFormat:f,baseIRI:d});l=p.operation,p.baseIRI&&(s=s.set(o.KeysInitQuery.baseIRI,p.baseIRI))}else l=c;if(s.has(o.KeysInitQuery.initialBindings)){const d=s.getSafe(o.KeysInitQuery.dataFactory),f=new e.Factory(d),p=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,s,d);l=(0,t.materializeOperation)(l,s.get(o.KeysInitQuery.initialBindings),f,p,{strictTargetVariables:!0}),s=s.delete(o.KeysInitQuery.queryString)}return{operation:l,context:s}}async optimize(c,s){return s=s.set(o.KeysInitQuery.query,c),{operation:c,context:s}=await this.mediatorOptimizeQueryOperation.mediate({context:s,operation:c}),s=s.set(o.KeysInitQuery.query,c),{operation:c,context:s}}async evaluate(c,s){const l=await this.mediatorQueryOperation.mediate({context:s,operation:c});return l.context=s,l}};return ly.ActorQueryProcessSequential=r,ly}var oq;function ZU(){return oq||(oq=1,(function(i){var o=$i&&$i.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=$i&&$i.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(WU(),i)})($i)),$i}var Qi={},py={},yy={},_y={},my={},uq;function kU(){if(uq)return my;uq=1,Object.defineProperty(my,"__esModule",{value:!0}),my.LinkedRdfSourcesAsyncRdfIterator=void 0;const i=q(),o=ae(),u=N();let a=class extends u.BufferedIterator{constructor(e,r,n,c,s,l,d,f){if(super({autoStart:!1,...f}),this.started=!1,this.currentIterators=[],this.iteratorsPendingCreation=0,this.iteratorsPendingTermination=0,this.accumulatedMetadata=Promise.resolve(void 0),this._reading=!1,this.cacheSize=e,this.operation=r,this.queryBindingsOptions=n,this.context=c,this.firstUrl=s,this.maxIterators=l,this.sourceStateGetter=d,this.maxIterators<=0)throw new Error(`LinkedRdfSourcesAsyncRdfIterator.maxIterators must be larger than zero, but got ${this.maxIterators}`)}kickstart(){this.started||this._fillBufferAsync()}getProperty(e,r){return e==="metadata"&&!this.started&&(this.preflightMetadata||(this.preflightMetadata=new Promise((n,c)=>{this.sourceStateGetter({url:this.firstUrl},{}).then(s=>{const l=s.source.queryBindings(this.operation,this.context);l.getProperty("metadata",d=>{d.state=new o.MetadataValidationState,l.destroy(),this.accumulateMetadata(s.metadata,d).then(f=>{const p={...s.metadata,...d,...f};n(p)}).catch(()=>{n({...s.metadata,state:new o.MetadataValidationState})})})}).catch(c)})),this.preflightMetadata.then(n=>this.setProperty("metadata",n)).catch(n=>this.emit("error",n))),super.getProperty(e,r)}_end(e){for(const r of this.currentIterators)r.destroy();super._end(e)}_read(e,r){if(this.started){for(const n of this.currentIterators){for(;e>0;){const c=n.read();if(c===null)break;e--,this._push(c)}if(e<=0)break}e>=0&&this.canStartNewIterator()?this.sourceStateGetter({url:this.firstUrl},{}).then(n=>{this.startIteratorsForNextUrls(n.handledDatasets,!1),r()}):r()}else this.started=!0,this.sourceStateGetter({url:this.firstUrl},{}).then(n=>{this.startIterator(n),r()}).catch(n=>setTimeout(()=>this.destroy(n)))}canStartNewIterator(){return this.currentIterators.length+this.iteratorsPendingCreation+this.iteratorsPendingTermination<this.maxIterators&&(!this.canStartNewIteratorConsiderReadable()||!this.readable)}canStartNewIteratorConsiderReadable(){return!0}areIteratorsRunning(){return this.currentIterators.length+this.iteratorsPendingCreation+this.iteratorsPendingTermination>0}startIterator(e){try{const r=e.source.queryBindings(this.operation,this.context,this.queryBindingsOptions);this.currentIterators.push(r);let n=!1,c=!1;r._destination=this,r.on("error",s=>this.destroy(s)),r.on("readable",()=>this._fillBuffer()),r.on("end",()=>{this.currentIterators.splice(this.currentIterators.indexOf(r),1),n=!0,c||this.iteratorsPendingTermination++,c&&this.startIteratorsForNextUrls(e.handledDatasets,!0)}),r.getProperty("metadata",s=>{this.accumulatedMetadata=this.accumulatedMetadata.then(l=>(async()=>(l||(l=e.metadata),this.accumulateMetadata(l,s)))().then(d=>{const f={...e.metadata,...s,...d};return f.state=new o.MetadataValidationState,this.updateMetadata(f),this.preflightMetadata&&this.preflightMetadata.then(p=>p.state.invalidate()).catch(()=>{}),this.getSourceLinks(f,e).then(p=>Promise.all(p)).then(async p=>{const _=await this.getLinkQueue();for(const y of p)_.push(y,e.link);c=!0,n&&this.iteratorsPendingTermination--,this.startIteratorsForNextUrls(e.handledDatasets,!0)}).catch(p=>this.destroy(p)),f})).catch(l=>(this.destroy(l),{}))})}catch(r){this.destroy(r)}}updateMetadata(e){const r=this.getProperty("metadata");this.setProperty("metadata",e),r==null||r.state.invalidate()}isRunning(){return!this.done}startIteratorsForNextUrls(e,r){this.getLinkQueue().then(n=>{for(;this.canStartNewIterator()&&this.isRunning();){const c=n.pop();if(c)this.iteratorsPendingCreation++,this.sourceStateGetter(c,e).then(s=>{const l=this.context.get(i.KeysStatistics.dereferencedLinks);l&&l.updateStatistic({url:s.link.url,metadata:{...s.metadata,...s.link.metadata}},s.source),this.iteratorsPendingCreation--,this.startIterator(s)}).catch(s=>this.emit("error",s));else break}r&&this.isCloseable(n,!0)&&this.close()}).catch(n=>this.destroy(n))}isCloseable(e,r){return e.isEmpty()&&!this.areIteratorsRunning()}};return my.LinkedRdfSourcesAsyncRdfIterator=a,my}var cq;function eH(){if(cq)return _y;cq=1,Object.defineProperty(_y,"__esModule",{value:!0}),_y.MediatedLinkedRdfSourcesAsyncRdfIterator=void 0;const i=q(),o=kU();let u=class extends o.LinkedRdfSourcesAsyncRdfIterator{constructor(t,e,r,n,c,s,l,d,f,p,_,y,m,b){super(t,e,r,n,s,l,d,f?{maxBufferSize:Number.POSITIVE_INFINITY}:void 0),this.wasForcefullyClosed=!1,this.forceSourceType=c,this.mediatorMetadataAccumulate=p,this.mediatorRdfResolveHypermediaLinks=_,this.mediatorRdfResolveHypermediaLinksQueue=y,this.handledUrls={[s]:!0},this.aggregatedStore=f,this.dataFactory=m,this.algebraFactory=b}close(){if(!this.aggregatedStore){super.close();return}this.getLinkQueue().then(t=>{this.isCloseable(t,!1)?(this.aggregatedStore&&setTimeout(()=>this.aggregatedStore.end()),super.close()):this.wasForcefullyClosed=!0}).catch(t=>super.destroy(t))}destroy(t){if(!this.aggregatedStore){super.destroy(t);return}this.getLinkQueue().then(e=>{t??this.isCloseable(e,!1)?(this.aggregatedStore&&setTimeout(()=>this.aggregatedStore.end()),super.destroy(t)):this.wasForcefullyClosed=!0}).catch(e=>super.destroy(e))}isCloseable(t,e){return(e?t.isEmpty():this.wasForcefullyClosed||t.isEmpty())&&!this.areIteratorsRunning()}canStartNewIterator(){return!this.wasForcefullyClosed&&this.aggregatedStore&&this.aggregatedStore.hasRunningIterators()||super.canStartNewIterator()}canStartNewIteratorConsiderReadable(){return!this.aggregatedStore}isRunning(){return this.aggregatedStore&&this.aggregatedStore.hasRunningIterators()||!this.done}getLinkQueue(){return this.linkQueue||(this.linkQueue=this.mediatorRdfResolveHypermediaLinksQueue.mediate({firstUrl:this.firstUrl,context:this.context}).then(t=>t.linkQueue)),this.linkQueue}async getSourceLinks(t,e){try{const{links:r}=await this.mediatorRdfResolveHypermediaLinks.mediate({context:this.context,metadata:t}),n=this.context.get(i.KeysStatistics.discoveredLinks);if(n)for(const c of r)n.updateStatistic({url:c.url,metadata:{...c.metadata}},e.link);return r.filter(c=>this.handledUrls[c.url]?!1:(this.handledUrls[c.url]=!0,!0))}catch{return[]}}startIterator(t){var e;if(this.aggregatedStore&&!this.aggregatedStore.containedSources.has(t.link.url)){(e=this.aggregatedStore)==null||e.containedSources.add(t.link.url);const r=t.source.queryBindings(this.algebraFactory.createPattern(this.dataFactory.variable("s"),this.dataFactory.variable("p"),this.dataFactory.variable("o"),this.dataFactory.variable("g")),this.context.set(i.KeysQueryOperation.unionDefaultGraph,!0)).map(n=>this.dataFactory.quad(n.get("s"),n.get("p"),n.get("o"),n.get("g")));this.aggregatedStore.import(r).on("end",()=>{super.startIterator(t)})}else super.startIterator(t)}async accumulateMetadata(t,e){return(await this.mediatorMetadataAccumulate.mediate({mode:"append",accumulatedMetadata:t,appendingMetadata:e,context:this.context})).metadata}updateMetadata(t){var e;super.updateMetadata(t),(e=this.aggregatedStore)==null||e.setBaseMetadata(t,!0)}};return _y.MediatedLinkedRdfSourcesAsyncRdfIterator=u,_y}var by={},sq;function tH(){if(sq)return by;sq=1,Object.defineProperty(by,"__esModule",{value:!0}),by.StreamingStoreMetadata=void 0;const i=Le(),o=ae(),u=vx();let a=class extends u.StreamingStore{constructor(e,r){super(e),this.started=!1,this.containedSources=new Set,this.runningIterators=new Set,this.iteratorCreatedListeners=new Set,this.baseMetadata={state:new o.MetadataValidationState,cardinality:{type:"exact",value:0},variables:[]},this.metadataAccumulator=r}import(e){return this.ended||super.import(e),e}hasRunningIterators(){return this.runningIterators.size>0}match(e,r,n,c){const s=super.match(e,r,n,c),l=new i.ClosableTransformIterator(s,{autoStart:!1,onClose:()=>{this.runningIterators.delete(l)}});let d=this.getStore().countQuads(e,r,n,c);const f={state:new o.MetadataValidationState,cardinality:{type:"estimate",value:d}};l.setProperty("metadata",f),l.setProperty("lastCount",d),s.on("quad",()=>{l.setProperty("lastCount",++d),this.updateMetadataState(l,d)}),this.runningIterators.add(l);for(const p of this.iteratorCreatedListeners)p();return l}setBaseMetadata(e,r){if(this.baseMetadata={...e},this.baseMetadata.cardinality={type:"exact",value:0},r)for(const n of this.runningIterators){const c=n.getProperty("lastCount");this.updateMetadataState(n,c)}}updateMetadataState(e,r){const n={state:new o.MetadataValidationState,cardinality:{type:"estimate",value:r},variables:[]};this.metadataAccumulator(this.baseMetadata,n).then(c=>{c.state=new o.MetadataValidationState;const s=e.getProperty("metadata");e.setProperty("metadata",c),s==null||s.state.invalidate()}).catch(()=>{})}addIteratorCreatedListener(e){this.iteratorCreatedListeners.add(e)}removeIteratorCreatedListener(e){this.iteratorCreatedListeners.delete(e)}};return by.StreamingStoreMetadata=a,by}var dq;function hM(){if(dq)return yy;dq=1,Object.defineProperty(yy,"__esModule",{value:!0}),yy.QuerySourceHypermedia=void 0;const i=vm(),o=q(),u=N(),a=To(),t=Z(),e=$(),r=eH(),n=tH();let c=class{constructor(l,d,f,p,_,y,m,b,h){this.referenceValue=d,this.cacheSize=l,this.firstUrl=d,this.forceSourceType=f,this.maxIterators=p,this.mediators=y,this.aggregateStore=_,this.logWarning=m,this.dataFactory=b,this.bindingsFactory=h,this.sourcesState=new a.LRUCache({max:this.cacheSize})}async getSelectorShape(l){return(await this.getSourceCached({url:this.firstUrl},{},l,this.getAggregateStore(l))).source.getSelectorShape(l)}queryBindings(l,d,f){const p=this.getAggregateStore(d);if(p&&l.type==="pattern"&&p.started)return new i.QuerySourceRdfJs(p,d.getSafe(o.KeysInitQuery.dataFactory),this.bindingsFactory).queryBindings(l,d);this.sourcesState.size===0&&this.getSourceCached({url:this.firstUrl},{},d,p).catch(b=>m.destroy(b));const _=d.getSafe(o.KeysInitQuery.dataFactory),y=new e.Factory(_),m=new r.MediatedLinkedRdfSourcesAsyncRdfIterator(this.cacheSize,l,f,d,this.forceSourceType,this.firstUrl,this.maxIterators,(b,h)=>this.getSourceCached(b,h,d,p),p,this.mediators.mediatorMetadataAccumulate,this.mediators.mediatorRdfResolveHypermediaLinks,this.mediators.mediatorRdfResolveHypermediaLinksQueue,_,y);if(p){p.started=!0;const b=()=>m.kickstart();p.addIteratorCreatedListener(b),m.on("end",()=>p.removeIteratorCreatedListener(b))}return m}queryQuads(l,d){return new u.TransformIterator(async()=>(await this.getSourceCached({url:this.firstUrl},{},d,this.getAggregateStore(d))).source.queryQuads(l,d))}async queryBoolean(l,d){return await(await this.getSourceCached({url:this.firstUrl},{},d,this.getAggregateStore(d))).source.queryBoolean(l,d)}async queryVoid(l,d){return await(await this.getSourceCached({url:this.firstUrl},{},d,this.getAggregateStore(d))).source.queryVoid(l,d)}async getSource(l,d,f,p){var g,T;l.context&&(f=f.merge(l.context));let _=l.url,y,m;if(this.forceSourceType==="sparql"&&((g=f.get(o.KeysQueryOperation.querySources))==null?void 0:g.length)===1)y=new t.Readable,y.read=()=>null,{metadata:m}=await this.mediators.mediatorMetadataAccumulate.mediate({context:f,mode:"initialize"});else try{const v=await this.mediators.mediatorDereferenceRdf.mediate({context:f,url:_});_=v.url;const F=await this.mediators.mediatorMetadata.mediate({context:f,url:_,quads:v.data,triples:(T=v.metadata)==null?void 0:T.triples});F.data.on("error",()=>{}),m=(await this.mediators.mediatorMetadataExtract.mediate({context:f,url:_,metadata:F.metadata,headers:v.headers,requestTime:v.requestTime})).metadata,y=F.data,l.transform&&(y=await l.transform(y))}catch(v){y=new t.Readable,y.read=()=>(setTimeout(()=>y.emit("error",v)),null),{metadata:m}=await this.mediators.mediatorMetadataAccumulate.mediate({context:f,mode:"initialize"}),this.logWarning(`Metadata extraction for ${_} failed: ${v.message}`)}p==null||p.setBaseMetadata(m,!1),p==null||p.containedSources.add(l.url),p==null||p.import(y);const{source:b,dataset:h}=await this.mediators.mediatorQuerySourceIdentifyHypermedia.mediate({context:f,forceSourceType:l.url===this.firstUrl?this.forceSourceType:void 0,handledDatasets:d,metadata:m,quads:y,url:_});return h&&(d[h]=!0),{link:l,source:b,metadata:m,handledDatasets:d}}getSourceCached(l,d,f,p){let _=this.sourcesState.get(l.url);return _||(_=this.getSource(l,d,f,p),(l.url===this.firstUrl||p===void 0)&&this.sourcesState.set(l.url,_),_)}getAggregateStore(l){let d;if(this.aggregateStore){const f=l.get(o.KeysQuerySourceIdentify.hypermediaSourcesAggregatedStores);if(f)return d=f.get(this.firstUrl),d||(d=new n.StreamingStoreMetadata(void 0,async(p,_)=>(await this.mediators.mediatorMetadataAccumulate.mediate({mode:"append",accumulatedMetadata:p,appendingMetadata:_,context:l})).metadata),f.set(this.firstUrl,d)),d}}toString(){return`QuerySourceHypermedia(${this.firstUrl})`}};return yy.QuerySourceHypermedia=c,yy}var lq;function rH(){if(lq)return py;lq=1,Object.defineProperty(py,"__esModule",{value:!0}),py.ActorQuerySourceIdentifyHypermedia=void 0;const i=Jy(),o=q(),u=O(),a=G(),t=hM();let e=class extends i.ActorQuerySourceIdentify{constructor(n){super(n)}async test(n){return typeof n.querySourceUnidentified.value!="string"?(0,u.failTest)(`${this.name} requires a single query source with a URL value to be present in the context.`):(0,u.passTestVoid)()}async run(n){var s;const c=n.context.getSafe(o.KeysInitQuery.dataFactory);return{querySource:{source:new t.QuerySourceHypermedia(this.cacheSize,n.querySourceUnidentified.value,n.querySourceUnidentified.type,this.maxIterators,this.aggregateTraversalStore&&!!((s=n.querySourceUnidentified.context)!=null&&s.get(o.KeysQuerySourceIdentify.traverse)),{mediatorMetadata:this.mediatorMetadata,mediatorMetadataExtract:this.mediatorMetadataExtract,mediatorMetadataAccumulate:this.mediatorMetadataAccumulate,mediatorDereferenceRdf:this.mediatorDereferenceRdf,mediatorQuerySourceIdentifyHypermedia:this.mediatorQuerySourceIdentifyHypermedia,mediatorRdfResolveHypermediaLinks:this.mediatorRdfResolveHypermediaLinks,mediatorRdfResolveHypermediaLinksQueue:this.mediatorRdfResolveHypermediaLinksQueue},l=>this.logWarn(n.context,l),c,await a.BindingsFactory.create(this.mediatorMergeBindingsContext,n.context,c)),context:n.querySourceUnidentified.context??new u.ActionContext}}}};return py.ActorQuerySourceIdentifyHypermedia=e,py}var fq;function nH(){return fq||(fq=1,(function(i){var o=Qi&&Qi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Qi&&Qi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(rH(),i),u(hM(),i)})(Qi)),Qi}var Ni={},gy={},pq;function aH(){if(pq)return gy;pq=1,Object.defineProperty(gy,"__esModule",{value:!0}),gy.ActorRdfJoinNone=void 0;const i=le(),o=q(),u=O(),a=G(),t=ae(),e=N();let r=class extends i.ActorRdfJoin{constructor(c){super(c,{logicalType:"inner",physicalName:"none",limitEntries:0})}async test(c){return c.entries.length>0?(0,u.failTest)(`Actor ${this.name} can only join zero entries`):await this.getJoinCoefficients(c,void 0)}async getOutput(c){const s=c.context.getSafe(o.KeysInitQuery.dataFactory),l=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,c.context,s);return{result:{bindingsStream:new e.ArrayIterator([l.bindings()],{autoStart:!1}),metadata:()=>Promise.resolve({state:new t.MetadataValidationState,cardinality:{type:"exact",value:1},variables:[]}),type:"bindings"}}}async getJoinCoefficients(c,s){return(0,u.passTestWithSideData)({iterations:0,persistedItems:0,blockingItems:0,requestTime:0},s)}};return gy.ActorRdfJoinNone=r,gy}var yq;function iH(){return yq||(yq=1,(function(i){var o=Ni&&Ni.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ni&&Ni.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(aH(),i)})(Ni)),Ni}var Ci={},hy={},Ui={},vy={},_q;function oH(){if(_q)return vy;_q=1,Object.defineProperty(vy,"__esModule",{value:!0}),vy.ActorRdfJoinMultiBind=void 0;const i=le(),o=q(),u=O(),a=G(),t=Q(),e=N(),r=$();let n=class vM extends i.ActorRdfJoin{constructor(s){super(s,{logicalType:"inner",physicalName:"bind",canHandleUndefs:!0,isLeaf:!1})}static createBindStream(s,l,d,f,p,_,y){const m=s==="depth-first",b=h=>{const g=d.map(v=>(0,t.materializeOperation)(v,h,_,y,{bindFilter:!0})),T=v=>v.merge(h);return new e.TransformIterator(async()=>(await f(g,h)).transform({map:T}),{maxBufferSize:128,autoStart:m})};switch(s){case"depth-first":return new e.MultiTransformIterator(l,{autoStart:!1,multiTransform:b,optional:p});case"breadth-first":return new e.UnionIterator(l.transform({map:b,optional:p}),{autoStart:!1});default:throw new Error(`Received request for unknown bind order: ${s}`)}}async getOutput(s,l){const d=s.context.getSafe(o.KeysInitQuery.dataFactory),f=new r.Factory(d),p=await a.BindingsFactory.create(this.mediatorMergeBindingsContext,s.context,d),_=l.entriesSorted;this.logDebug(s.context,"First entry for Bind Join: ",()=>({entry:_[0].operation,cardinality:_[0].metadata.cardinality,order:_[0].metadata.order,availableOrders:_[0].metadata.availableOrders}));for(const[g,T]of _.entries())g!==0&&T.output.bindingsStream.close();const y=_[0].output,m=[..._];m.splice(0,1);const b=s.context.set(o.KeysQueryOperation.joinLeftMetadata,_[0].metadata).set(o.KeysQueryOperation.joinRightMetadatas,m.map(g=>g.metadata));return{result:{type:"bindings",bindingsStream:vM.createBindStream(this.bindOrder,y.bindingsStream,m.map(g=>g.operation),async(g,T)=>{const v=g.length===1?g[0]:f.createJoin(g,g.every(P=>!P.metadata));return(0,t.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:v,context:b==null?void 0:b.set(o.KeysQueryOperation.joinBindings,T)})).bindingsStream},!1,f,p),metadata:()=>this.constructResultMetadata(_,_.map(g=>g.metadata),s.context)},physicalPlanMetadata:{bindIndex:l.entriesUnsorted.indexOf(_[0]),bindOperation:_[0].operation,bindOperationCardinality:_[0].metadata.cardinality,bindOrder:this.bindOrder}}}canBindWithOperation(s){let l=!0;return r.Util.recurseOperation(s,{[r.Algebra.types.EXTEND](){return l=!1,!1},[r.Algebra.types.GROUP](){return l=!1,!1}}),l}async getJoinCoefficients(s,l){let{metadatas:d}=l;const f=s.entries.map((x,A)=>({...x,metadata:d[A]})),p=await i.ActorRdfJoin.sortJoinEntries(this.mediatorJoinEntriesSort,f,s.context);if(p.isFailed())return p;const _=p.get();d=_.map(x=>x.metadata);const y=i.ActorRdfJoin.getRequestInitialTimes(d),m=i.ActorRdfJoin.getRequestItemTimes(d),b=[..._],h=[...y],g=[...m];if(b.splice(0,1),h.splice(0,1),g.splice(0,1),b.some(x=>!this.canBindWithOperation(x.operation)))return(0,u.failTest)(`Actor ${this.name} can not bind on Extend and Group operations`);if(b.some(x=>x.operationModified))return(0,u.failTest)(`Actor ${this.name} can not be used over remaining entries with modified operations`);const T=m.some(x=>x>0);if(d[0].cardinality.value*this.minMaxCardinalityRatio/(T?1:3)>Math.max(...d.map(x=>x.cardinality.value)))return(0,u.failTest)(`Actor ${this.name} can only run if the smallest stream is much smaller than largest stream`);const v=await Promise.all(b.map(async x=>(await this.mediatorJoinSelectivity.mediate({entries:[_[0],x],context:s.context})).selectivity*this.selectivityModifier)),F=b.map((x,A)=>x.metadata.cardinality.value*v[A]).reduce((x,A)=>x+A,0),P=h.reduce((x,A)=>x+A,0),j=g.reduce((x,A)=>x+A,0);return(0,u.passTestWithSideData)({iterations:d[0].cardinality.value*F,persistedItems:0,blockingItems:0,requestTime:y[0]+d[0].cardinality.value*(m[0]+P+F*j)},{...l,entriesUnsorted:f,entriesSorted:_})}};return vy.ActorRdfJoinMultiBind=n,vy}var mq;function TM(){return mq||(mq=1,(function(i){var o=Ui&&Ui.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ui&&Ui.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(oH(),i)})(Ui)),Ui}var bq;function uH(){if(bq)return hy;bq=1,Object.defineProperty(hy,"__esModule",{value:!0}),hy.ActorRdfJoinOptionalBind=void 0;const i=TM(),o=le(),u=q(),a=O(),t=G(),e=Q(),r=$();let n=class extends o.ActorRdfJoin{constructor(s){super(s,{logicalType:"optional",physicalName:"bind",limitEntries:2,canHandleUndefs:!0,isLeaf:!1,requiresVariableOverlap:!0})}async getOutput(s){const l=s.context.getSafe(u.KeysInitQuery.dataFactory),d=new r.Factory(l),f=await t.BindingsFactory.create(this.mediatorMergeBindingsContext,s.context,l);s.entries[1].output.bindingsStream.close();const p=s.context.set(u.KeysQueryOperation.joinLeftMetadata,await s.entries[0].output.metadata()).set(u.KeysQueryOperation.joinRightMetadatas,[await s.entries[1].output.metadata()]);return{result:{type:"bindings",bindingsStream:i.ActorRdfJoinMultiBind.createBindStream(this.bindOrder,s.entries[0].output.bindingsStream,[s.entries[1].operation],async(y,m)=>{const b=y[0];return(0,e.getSafeBindings)(await this.mediatorQueryOperation.mediate({operation:b,context:p==null?void 0:p.set(u.KeysQueryOperation.joinBindings,m)})).bindingsStream},!0,d,f),metadata:async()=>await this.constructResultMetadata(s.entries,await o.ActorRdfJoin.getMetadatas(s.entries),s.context,{},!0)}}}async getJoinCoefficients(s,l){const{metadatas:d}=l,f=o.ActorRdfJoin.getRequestInitialTimes(d),p=o.ActorRdfJoin.getRequestItemTimes(d);if(s.entries[1].operation.type===r.Algebra.types.EXTEND||s.entries[1].operation.type===r.Algebra.types.GROUP)return(0,a.failTest)(`Actor ${this.name} can not bind on Extend and Group operations`);const _=(await this.mediatorJoinSelectivity.mediate({entries:s.entries,context:s.context})).selectivity*this.selectivityModifier;return(0,a.passTestWithSideData)({iterations:d[0].cardinality.value*d[1].cardinality.value*_,persistedItems:0,blockingItems:0,requestTime:f[0]+d[0].cardinality.value*(p[0]+f[1]+_*d[1].cardinality.value*p[1])},l)}};return hy.ActorRdfJoinOptionalBind=n,hy}var gq;function cH(){return gq||(gq=1,(function(i){var o=Ci&&Ci.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ci&&Ci.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(uH(),i)})(Ci)),Ci}var Hi={},Ty={},Vi={},Oy={},hq;function sH(){if(hq)return Oy;hq=1,Object.defineProperty(Oy,"__esModule",{value:!0}),Oy.ActorTermComparatorFactory=void 0;const i=O();let o=class extends i.Actor{constructor(a){super(a),this.mediatorQueryOperation=a.mediatorQueryOperation,this.mediatorFunctionFactory=a.mediatorFunctionFactory,this.mediatorMergeBindingsContext=a.mediatorMergeBindingsContext}};return Oy.ActorTermComparatorFactory=o,Oy}var vq;function dH(){return vq||(vq=1,(function(i){var o=Vi&&Vi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Vi&&Vi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(sH(),i)})(Vi)),Vi}var Ay={},Tq;function lH(){if(Tq)return Ay;Tq=1,Object.defineProperty(Ay,"__esModule",{value:!0}),Ay.TermComparatorExpressionEvaluator=void 0;let i=class{constructor(u,a,t){this.internalEvaluator=u,this.equalityFunction=a,this.lessThanFunction=t,this._TERM_ORDERING_PRIORITY={Variable:0,BlankNode:1,NamedNode:2,Literal:3,Quad:4,DefaultGraph:5}}orderTypes(u,a){if(u===a)return 0;if(u===void 0)return-1;if(a===void 0)return 1;if(u.termType!==a.termType)return this._TERM_ORDERING_PRIORITY[u.termType]<this._TERM_ORDERING_PRIORITY[a.termType]?-1:1;if(u.equals(a))return 0;if(u.termType==="Quad"&&a.termType==="Quad"){const t=this.orderTypes(u.subject,a.subject);if(t!==0)return t;const e=this.orderTypes(u.predicate,a.predicate);if(e!==0)return e;const r=this.orderTypes(u.object,a.object);return r!==0?r:this.orderTypes(u.graph,a.graph)}return u.termType==="Literal"?this.orderLiteralTypes(u,a):this.comparePrimitives(u.value,a.value)}orderLiteralTypes(u,a){const t=this.internalEvaluator.transformer.transformLiteral(u),e=this.internalEvaluator.transformer.transformLiteral(a);try{return this.equalityFunction.applyOnTerms([t,e],this.internalEvaluator).typedValue?0:this.lessThanFunction.applyOnTerms([t,e],this.internalEvaluator).typedValue?-1:1}catch{const r=this.comparePrimitives(t.dataType,e.dataType);return r!==0?r:this.comparePrimitives(t.str(),e.str())}}comparePrimitives(u,a){return u===a?0:u<a?-1:1}};return Ay.TermComparatorExpressionEvaluator=i,Ay}var Oq;function fH(){if(Oq)return Ty;Oq=1,Object.defineProperty(Ty,"__esModule",{value:!0}),Ty.ActorTermComparatorFactoryExpressionEvaluator=void 0;const i=gM(),o=dH(),u=q(),a=O(),t=G(),e=S(),r=lH();let n=class extends o.ActorTermComparatorFactory{async test(s){return(0,a.passTestVoid)()}async run({context:s}){return s=e.prepareEvaluatorActionContext(s),new r.TermComparatorExpressionEvaluator(new i.InternalEvaluator(s,this.mediatorFunctionFactory,this.mediatorQueryOperation,await t.BindingsFactory.create(this.mediatorMergeBindingsContext,s,s.getSafe(u.KeysInitQuery.dataFactory))),await this.mediatorFunctionFactory.mediate({functionName:e.SparqlOperator.EQUAL,context:s,requireTermExpression:!0}),await this.mediatorFunctionFactory.mediate({functionName:e.SparqlOperator.LT,context:s,requireTermExpression:!0}))}};return Ty.ActorTermComparatorFactoryExpressionEvaluator=n,Ty}var Aq;function pH(){return Aq||(Aq=1,(function(i){var o=Hi&&Hi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Hi&&Hi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(fH(),i)})(Hi)),Hi}var zi={},Sy={},Sq;function yH(){if(Sq)return Sy;Sq=1,Object.defineProperty(Sy,"__esModule",{value:!0}),Sy.ActorRdfJoinMultiSmallestFilterBindings=void 0;const i=le(),o=q(),u=O(),a=G(),t=Le(),e=Q(),r=N(),n=$();let c=class extends i.ActorRdfJoin{constructor(l){super(l,{logicalType:"inner",physicalName:"multi-smallest-filter-bindings",limitEntries:2,limitEntriesMin:!0,isLeaf:!1})}async sortJoinEntries(l,d){let{entries:f}=await this.mediatorJoinEntriesSort.mediate({entries:l,context:d});f=f.sort((h,g)=>h.operationModified&&!g.operationModified?-1:0);const p=f.splice(0,1)[0];let _,y=-1,m=0;for(const[h,g]of f.entries()){const T=p.metadata.variables.filter(v=>g.metadata.variables.some(F=>v.variable.equals(F.variable))).length;(!_||T>m||T===m&&(g.metadata.variables.length<_.metadata.variables.length||g.metadata.variables.length===_.metadata.variables.length&&g.metadata.cardinality.value<_.metadata.cardinality.value))&&(_=g,y=h,m=T)}if(m===0)return(0,u.failTest)(`Actor ${this.name} can only join with common variables`);const b=f;return b.splice(y,1),(0,u.passTest)({first:p,second:_,remaining:b})}async getOutput(l){const d=l.context.getSafe(o.KeysInitQuery.dataFactory),f=new n.Factory(d),p=await i.ActorRdfJoin.getEntriesWithMetadatas([...l.entries]),{first:_,second:y,remaining:m}=(await this.sortJoinEntries(p,l.context)).getOrThrow(),b=_.output.bindingsStream;_.output.bindingsStream=b.clone();const h=_.metadata.variables.filter(L=>y.metadata.variables.some(z=>L.variable.equals(z.variable))),g={},T=b.clone().map(L=>L.filter((z,M)=>h.some(R=>R.variable.equals(M)))).filter(L=>{const z=(0,a.bindingsToString)(L);return!(z in g)&&(g[z]=!0)}),v=new t.ChunkedIterator(T,this.blockSize,{autoStart:!1}),F=(0,e.getOperationSource)(y.operation),j={output:{type:"bindings",bindingsStream:new r.UnionIterator(v.map(L=>F.source.queryBindings(y.operation,F.context?l.context.merge(F.context):l.context,{filterBindings:{bindings:L,metadata:_.metadata}}))),metadata:y.output.metadata},operation:y.operation,operationModified:!0};y.output.bindingsStream.destroy();const x={output:(0,e.getSafeBindings)(await this.mediatorJoin.mediate({type:l.type,entries:[_,j],context:l.context.set(o.KeysRdfJoin.lastPhysicalJoin,this.physicalName)})),operation:f.createJoin([_.operation,j.operation],!1),operationModified:!0},A=m;return A.unshift(x),{result:await this.mediatorJoin.mediate({type:l.type,entries:A,context:l.context}),physicalPlanMetadata:{firstIndex:p.indexOf(_),secondIndex:p.indexOf(y)}}}async getJoinCoefficients(l,d){let{metadatas:f}=d;if(l.context.get(o.KeysRdfJoin.lastPhysicalJoin)===this.physicalName)return(0,u.failTest)(`Actor ${this.name} can not be called recursively`);f=[...f];const p=await this.sortJoinEntries(l.entries.map((j,x)=>({...j,metadata:f[x]})),l.context);if(p.isFailed())return p;const{first:_,second:y,remaining:m}=p.get(),b=(0,e.getOperationSource)(y.operation);if(!b)return(0,u.failTest)(`Actor ${this.name} can only process if entries[1] has a source`);const h=y.operation,g=await b.source.getSelectorShape(l.context);if(!(0,e.doesShapeAcceptOperation)(g,h,{filterBindings:!0}))return(0,u.failTest)(`Actor ${this.name} can only process if entries[1] accept filterBindings`);f=[_.metadata,y.metadata,...m.map(j=>j.metadata)];const T=i.ActorRdfJoin.getRequestInitialTimes(f),v=i.ActorRdfJoin.getRequestItemTimes(f),{selectivity:F}=await this.mediatorJoinSelectivity.mediate({entries:[_,y],context:l.context}),P=m.reduce((j,x)=>j*x.metadata.cardinality.value*this.selectivityModifier,1);return(0,u.passTestWithSideData)({iterations:F*this.selectivityModifier*y.metadata.cardinality.value*P,persistedItems:_.metadata.cardinality.value,blockingItems:_.metadata.cardinality.value,requestTime:T[0]+f[0].cardinality.value*v[0]+T[1]+P*v[1]},d)}};return Sy.ActorRdfJoinMultiSmallestFilterBindings=c,Sy}var Fq;function _H(){return Fq||(Fq=1,(function(i){var o=zi&&zi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=zi&&zi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(yH(),i)})(zi)),zi}var Xi={},Fy={},wq;function mH(){if(wq)return Fy;wq=1,Object.defineProperty(Fy,"__esModule",{value:!0}),Fy.ActorQueryProcessExplainLogical=void 0;const i=s_(),o=q(),u=O();let a=class extends i.ActorQueryProcess{constructor(e){super(e)}async test(e){return(e.context.get(o.KeysInitQuery.explain)??e.context.get(new u.ActionContextKey("explain")))!=="logical"?(0,u.failTest)(`${this.name} can only explain in 'logical' mode.`):(0,u.passTestVoid)()}async run(e){let{operation:r,context:n}=await this.queryProcessor.parse(e.query,e.context);return{operation:r,context:n}=await this.queryProcessor.optimize(r,n),{result:{explain:!0,type:"logical",data:r}}}};return Fy.ActorQueryProcessExplainLogical=a,Fy}var Rq;function bH(){return Rq||(Rq=1,(function(i){var o=Xi&&Xi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Xi&&Xi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(mH(),i)})(Xi)),Xi}var Gi={},wy={},Pq;function gH(){if(Pq)return wy;Pq=1,Object.defineProperty(wy,"__esModule",{value:!0}),wy.ActorQueryProcessExplainParsed=void 0;const i=s_(),o=q(),u=O();let a=class extends i.ActorQueryProcess{constructor(e){super(e)}async test(e){return(e.context.get(o.KeysInitQuery.explain)??e.context.get(new u.ActionContextKey("explain")))!=="parsed"?(0,u.failTest)(`${this.name} can only explain in 'parsed' mode.`):(0,u.passTestVoid)()}async run(e){const{operation:r}=await this.queryProcessor.parse(e.query,e.context);return{result:{explain:!0,type:"parsed",data:r}}}};return wy.ActorQueryProcessExplainParsed=a,wy}var qq;function hH(){return qq||(qq=1,(function(i){var o=Gi&&Gi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Gi&&Gi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(gH(),i)})(Gi)),Gi}var Ji={},Ry={},Ki={},jq;function OM(){if(jq)return Ki;jq=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.numberToString=Ki.MemoryPhysicalQueryPlanLogger=void 0;const i=ne();let o=class{constructor(){this.planNodes=new Map}logOperation(t,e,r,n,c,s){const l={actor:c,logicalOperator:t,physicalOperator:e,rawNode:r,children:[],metadata:s};if(this.planNodes.set(r,l),this.rootNode){if(!n)throw new Error("Detected more than one parent-less node");const d=this.planNodes.get(n);if(!d)throw new Error("Could not find parent node");d.children.push(l)}else{if(n)throw new Error("No root node has been set yet, while a parent is being referenced");this.rootNode=l}}stashChildren(t,e){const r=this.planNodes.get(t);if(!r)throw new Error("Could not find plan node");r.children=e?r.children.filter(e):[]}unstashChild(t,e){const r=this.planNodes.get(t);if(r){const n=this.planNodes.get(e);if(!n)throw new Error("Could not find plan parent node");n.children.push(r)}}appendMetadata(t,e){const r=this.planNodes.get(t);r&&(r.metadata={...r.metadata,...e})}toJson(){return this.rootNode?this.planNodeToJson(this.rootNode):{}}planNodeToJson(t){var r;const e={logical:t.logicalOperator,physical:t.physicalOperator,...this.getLogicalMetadata(t.rawNode),...this.compactMetadata(t.metadata)};if(t.children.length>0&&(e.children=t.children.map(n=>this.planNodeToJson(n))),e.physical==="bind"&&e.children){const n={};for(const s of e.children){const l=((r=s.children)==null?void 0:r.at(-1))??s,d=this.getPlanHash(l).join(",");n[d]||(n[d]=[]),n[d].push(s)}const c=[];for(const s of Object.values(n))c.push({occurrences:s.length,firstOccurrence:s[0]});e.childrenCompact=c,delete e.children}return e}getPlanHash(t){let e=[`${t.logical}-${t.physical}`];return t.children?e=[...e,...t.children.flatMap(r=>this.getPlanHash(r))]:t.childrenCompact&&(e=[...e,...t.childrenCompact.flatMap(r=>this.getPlanHash(r.firstOccurrence))]),e}compactMetadata(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e,this.compactMetadataValue(r)]))}compactMetadataValue(t){return t&&typeof t=="object"&&"termType"in t?this.getLogicalMetadata(t):t}getLogicalMetadata(t){var r;const e={};if("type"in t){const n=t;switch((r=n.metadata)!=null&&r.scopedSource&&(e.source=n.metadata.scopedSource.source.toString()),n.type){case"pattern":e.pattern=this.quadToString(n);break;case"project":e.variables=n.variables.map(c=>c.value);break}}return e}quadToString(t){return`${(0,i.termToString)(t.subject)} ${(0,i.termToString)(t.predicate)} ${(0,i.termToString)(t.object)}${t.graph.termType==="DefaultGraph"?"":` ${(0,i.termToString)(t.graph)}`}`}toCompactString(){const t=this.toJson(),e=[],r=new Map;if("logical"in t?this.nodeToCompactString(e,r,"",t):e.push("Empty"),r.size>0){e.push(""),e.push("sources:");for(const[n,c]of r.entries())e.push(`  ${c}: ${n}`)}return e.join(`
`)}nodeToCompactString(t,e,r,n,c){let s;n.source&&(s=e.get(n.source),s===void 0&&(s=e.size,e.set(n.source,s))),t.push(`${r}${n.logical}${n.physical?`(${n.physical})`:""}${n.pattern?` (${n.pattern})`:""}${n.variables?` (${n.variables.join(",")})`:""}${n.bindOperation?` bindOperation:(${n.bindOperation.pattern}) bindCardEst:${n.bindOperationCardinality.type==="estimate"?"~":""}${u(n.bindOperationCardinality.value)}`:""}${n.cardinality?` cardEst:${n.cardinality.type==="estimate"?"~":""}${u(n.cardinality.value)}`:""}${n.source?` src:${s}`:""}${n.cardinalityReal?` cardReal:${n.cardinalityReal}`:""}${n.timeSelf?` timeSelf:${u(n.timeSelf)}ms`:""}${n.timeLife?` timeLife:${u(n.timeLife)}ms`:""}${c?` ${c}`:""}`);for(const l of n.children??[])this.nodeToCompactString(t,e,`${r}  `,l);for(const l of n.childrenCompact??[])this.nodeToCompactString(t,e,`${r}  `,l.firstOccurrence,`compacted-occurrences:${l.occurrences}`)}};Ki.MemoryPhysicalQueryPlanLogger=o;function u(a){return a.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:3})}return Ki.numberToString=u,Ki}var Mq;function vH(){if(Mq)return Ry;Mq=1,Object.defineProperty(Ry,"__esModule",{value:!0}),Ry.ActorQueryProcessExplainPhysical=void 0;const i=s_(),o=q(),u=O(),a=OM();let t=class extends i.ActorQueryProcess{constructor(r){super(r)}async test(r){const n=r.context.get(o.KeysInitQuery.explain)??r.context.get(new u.ActionContextKey("explain"));return n!=="physical"&&n!=="physical-json"?(0,u.failTest)(`${this.name} can only explain in 'physical' or 'physical-json' mode.`):(0,u.passTestVoid)()}async run(r){let{operation:n,context:c}=await this.queryProcessor.parse(r.query,r.context);({operation:n,context:c}=await this.queryProcessor.optimize(n,c));const s=new a.MemoryPhysicalQueryPlanLogger;c=c.set(o.KeysInitQuery.physicalQueryPlanLogger,s);const l=await this.queryProcessor.evaluate(n,c);switch(l.type){case"bindings":await l.bindingsStream.toArray();break;case"quads":await l.quadStream.toArray();break;case"boolean":await l.execute();break;case"void":await l.execute();break}const d=r.context.get(o.KeysInitQuery.explain)??r.context.getSafe(new u.ActionContextKey("explain"));return{result:{explain:!0,type:d,data:d==="physical"?s.toCompactString():s.toJson()}}}};return Ry.ActorQueryProcessExplainPhysical=t,Ry}var xq;function TH(){return xq||(xq=1,(function(i){var o=Ji&&Ji.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Ji&&Ji.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(vH(),i),u(OM(),i)})(Ji)),Ji}var Yi={},Py={},Dq;function OH(){if(Dq)return Py;Dq=1,Object.defineProperty(Py,"__esModule",{value:!0}),Py.ActorOptimizeQueryOperationPruneEmptySourceOperations=void 0;const i=be(),o=q(),u=O(),a=Q(),t=$();let e=class zy extends i.ActorOptimizeQueryOperation{constructor(n){super(n)}async test(n){return(0,a.getOperationSource)(n.operation)?(0,u.failTest)(`Actor ${this.name} does not work with top-level operation sources.`):(0,u.passTestVoid)()}async run(n){const c=n.context.getSafe(o.KeysInitQuery.dataFactory),s=new t.Factory(c);let l=n.operation;const d=[],f=this;t.Util.recurseOperation(l,{[t.Algebra.types.UNION](_){return f.collectMultiOperationInputs(_.input,d,t.Algebra.types.PATTERN),!0},[t.Algebra.types.ALT](_){return f.collectMultiOperationInputs(_.input,d,t.Algebra.types.LINK),!1},[t.Algebra.types.SERVICE](){return!1}});const p=new Set;return await Promise.all(d.map(async _=>{const y=_.type==="link"?s.createPattern(c.variable("s"),_.iri,c.variable("o")):_;await this.hasSourceResults(s,(0,a.getOperationSource)(_),y,n.context)||p.add(_)})),p.size>0&&(this.logDebug(n.context,`Pruning ${p.size} source-specific operations`),l=t.Util.mapOperation(l,{[t.Algebra.types.UNION](_,y){return f.mapMultiOperation(_,p,m=>y.createUnion(m))},[t.Algebra.types.ALT](_,y){return f.mapMultiOperation(_,p,m=>y.createAlt(m))}},s),l=t.Util.mapOperation(l,{[t.Algebra.types.PROJECT](_,y){return zy.hasEmptyOperation(_)?{recurse:!1,result:y.createUnion([])}:{recurse:!0,result:_}},[t.Algebra.types.LEFT_JOIN](_){return zy.hasEmptyOperation(_.input[1])?{recurse:!0,result:_.input[0]}:{recurse:!0,result:_}}},s)),{operation:l,context:n.context}}static hasEmptyOperation(n){let c=!1;return t.Util.recurseOperation(n,{[t.Algebra.types.UNION](s){return s.input.every(l=>zy.hasEmptyOperation(l))&&(c=!0),!1},[t.Algebra.types.ALT](s){return s.input.length===0&&(c=!0),!1},[t.Algebra.types.LEFT_JOIN](s){return zy.hasEmptyOperation(s.input[0])&&(c=!0),!1}}),c}collectMultiOperationInputs(n,c,s){for(const l of n)(0,a.getOperationSource)(l)&&l.type===s&&c.push(l)}mapMultiOperation(n,c,s){const l=n.input.filter(d=>!c.has(d));return l.length===n.input.length?{result:n,recurse:!0}:l.length===0?{result:s([]),recurse:!1}:l.length===1?{result:l[0],recurse:!0}:{result:s(l),recurse:!0}}async hasSourceResults(n,c,s,l){var f;if(((f=c.context)==null?void 0:f.get(o.KeysQuerySourceIdentify.traverse))??l.get(o.KeysQuerySourceIdentify.traverse))return!0;if(this.useAskIfSupported){const p=n.createAsk(s);if((0,a.doesShapeAcceptOperation)(await c.source.getSelectorShape(l),p))return c.source.queryBoolean(p,l)}const d=c.source.queryBindings(s,l);return new Promise((p,_)=>{d.on("error",_),d.getProperty("metadata",y=>{d.destroy(),p(y.cardinality.value>0)})})}};return Py.ActorOptimizeQueryOperationPruneEmptySourceOperations=e,Py}var Eq;function AH(){return Eq||(Eq=1,(function(i){var o=Yi&&Yi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Yi&&Yi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(OH(),i)})(Yi)),Yi}var Wi={},qy={},Lq;function SH(){if(Lq)return qy;Lq=1,Object.defineProperty(qy,"__esModule",{value:!0}),qy.ActorHttpRetry=void 0;const i=qe(),o=q(),u=O();let a=class co extends i.ActorHttp{constructor(e){super(e),this.activeDelays={},this.httpInvalidator=e.httpInvalidator,this.httpInvalidator.addInvalidateListener(r=>this.handleHttpInvalidateEvent(r)),this.mediatorHttp=e.mediatorHttp}async test(e){if(e.context.has(co.keyWrapped))return(0,u.failTest)(`${this.name} can only wrap a request once`);const r=e.context.get(o.KeysHttp.httpRetryCount);return!r||r<1?(0,u.failTest)(`${this.name} requires a retry count greater than zero to function`):(0,u.passTest)({time:0})}async run(e){const r=i.ActorHttp.getInputUrl(e.input),n=e.context.getSafe(o.KeysHttp.httpRetryCount)+1,c=e.context.get(o.KeysHttp.httpRetryDelayFallback)??0,s=e.context.get(o.KeysHttp.httpRetryDelayLimit),l=e.context.get(o.KeysHttp.httpRetryStatusCodes);for(let d=1;d<=n;d++){const f=r.host in this.activeDelays?this.activeDelays[r.host].date.getTime()-Date.now():c;if(s&&f>s){this.logWarn(e.context,"Requested delay exceeds the limit",()=>({url:r.href,delay:f,delayDate:this.activeDelays[r.host].date.toISOString(),delayLimit:s,currentAttempt:`${d} / ${n}`}));break}else f>0&&d>1&&(this.logDebug(e.context,"Delaying request",()=>({url:r.href,delay:f,currentAttempt:`${d} / ${n}`})),await co.sleep(f));const p=await this.mediatorHttp.mediate({...e,context:e.context.set(co.keyWrapped,!0)});if(p.ok)return p;if(l&&l.includes(p.status)){this.logDebug(e.context,"Status code in force retry list, forcing retry",()=>({url:r.href,status:p.status,statusText:p.statusText,currentAttempt:`${d} / ${n}`}));continue}if(p.status===504){this.logDebug(e.context,"Received proxy timeout",()=>({url:r.href,status:p.status,statusText:p.statusText,currentAttempt:`${d} / ${n}`}));continue}if(p.status===429||p.status===503||p.status===405&&p.headers.has("retry-after")){const _=p.headers.get("retry-after");if(_){const y=co.parseRetryAfterHeader(_);y?(r.host in this.activeDelays&&clearTimeout(this.activeDelays[r.host].timeout),this.activeDelays[r.host]={date:y,timeout:setTimeout(()=>delete this.activeDelays[r.host],y.getTime()-Date.now())}):this.logDebug(e.context,"Invalid Retry-After header value from server",()=>({url:r.href,status:p.status,statusText:p.statusText,retryAfterHeader:_,currentAttempt:`${d} / ${n}`}))}this.logDebug(e.context,"Server temporarily unavailable",()=>({url:r.href,status:p.status,statusText:p.statusText,currentAttempt:`${d} / ${n}`}));continue}if(p.status>=400&&p.status<500){this.logDebug(e.context,"Server reported client-side error",()=>({url:r.href,status:p.status,statusText:p.statusText,currentAttempt:`${d} / ${n}`}));break}if(p.status>=500&&p.status<600){this.logDebug(e.context,"Server-side error encountered, terminating",()=>({url:r.href,status:p.status,statusText:p.statusText,currentAttempt:`${d} / ${n}`}));break}this.logDebug(e.context,"Request failed",()=>({url:r.href,status:p.status,statusText:p.statusText,currentAttempt:`${d} / ${n}`}))}throw new Error(`Request failed: ${r.href}`)}static async sleep(e){e>0&&await new Promise(r=>setTimeout(r,e))}static parseRetryAfterHeader(e){if(co.numberRegex.test(e))return new Date(Date.now()+Number.parseInt(e,10)*1e3);if(co.dateRegex.test(e))return new Date(e)}handleHttpInvalidateEvent(e){const r=e.url?new URL(e.url).host:void 0;for(const n of Object.keys(this.activeDelays))(!r||n===r)&&(clearTimeout(this.activeDelays[n].timeout),delete this.activeDelays[n])}};return qy.ActorHttpRetry=a,a.dateRegex=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), [0-9]{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) [0-9]{4} [0-9]{2}:[0-9]{2}:[0-9]{2} GMT$/u,a.numberRegex=/^[0-9]+$/u,a.keyWrapped=new u.ActionContextKey("urn:comunica:actor-http-retry#wrapped"),qy}var Iq;function FH(){return Iq||(Iq=1,(function(i){var o=Wi&&Wi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Wi&&Wi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(SH(),i)})(Wi)),Wi}var Zi={},jy={},$q;function wH(){if($q)return jy;$q=1,Object.defineProperty(jy,"__esModule",{value:!0}),jy.ActorHttpLimitRate=void 0;const i=qe(),o=O();let u=class om extends i.ActorHttp{constructor(t){super(t),this.mediatorHttp=t.mediatorHttp,this.httpInvalidator=t.httpInvalidator,this.httpInvalidator.addInvalidateListener(e=>this.handleHttpInvalidateEvent(e)),this.correctionMultiplier=t.correctionMultiplier,this.failureMultiplier=t.failureMultiplier,this.limitByDefault=t.limitByDefault,this.allowOverlap=t.allowOverlap,this.hostData=new Map}async test(t){return t.context.has(om.keyWrapped)?(0,o.failTest)(`${this.name} can only wrap a request once`):(0,o.passTest)({time:0})}async run(t){const e=i.ActorHttp.getInputUrl(t.input);let r=this.hostData.get(e.host);r||(r={latestRequestTimestamp:0,rateLimited:this.limitByDefault,requestInterval:Number.NEGATIVE_INFINITY},this.hostData.set(e.host,r));const n=Date.now();let c=0;r.rateLimited&&(c=Math.max(0,r.latestRequestTimestamp+r.requestInterval-n)),r.latestRequestTimestamp=n+(this.allowOverlap?0:1)*c,c>0&&(this.logDebug(t.context,"Delaying request",()=>({url:e.href,requestInterval:r.requestInterval,currentDelay:c})),await new Promise(l=>setTimeout(l,c)));const s=l=>{const d=(l?1:this.failureMultiplier)*(Date.now()-n-c);r.requestInterval<0?r.requestInterval=Math.round(d*this.correctionMultiplier):r.requestInterval+=Math.round(this.correctionMultiplier*(d-r.requestInterval)),!l&&!r.rateLimited&&(this.logDebug(t.context,"Marking host as rate-limited",()=>({host:e.host})),r.rateLimited=!0)};try{const l=await this.mediatorHttp.mediate({...t,context:t.context.set(om.keyWrapped,!0)});return s(l.ok),l}catch(l){throw s(!1),l}}handleHttpInvalidateEvent(t){if(t.url){const e=new URL(t.url).host;this.hostData.delete(e)}else this.hostData.clear()}};return jy.ActorHttpLimitRate=u,u.keyWrapped=new o.ActionContextKey("urn:comunica:actor-http-limit-rate#wrapped"),jy}var Bq;function RH(){return Bq||(Bq=1,(function(i){var o=Zi&&Zi.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Zi&&Zi.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(wH(),i)})(Zi)),Zi}var ki={},My={},Qq;function PH(){if(Qq)return My;Qq=1,Object.defineProperty(My,"__esModule",{value:!0}),My.ActorQuerySourceIdentifySerialized=void 0;const i=Jy(),o=O(),u=uj(),a=Z();let t=class extends i.ActorQuerySourceIdentify{constructor(r){super(r)}async test(r){return this.isStringSource(r.querySourceUnidentified)?(0,o.passTestVoid)():(0,o.failTest)(`${this.name} requires a single query source with serialized type to be present in the context.`)}async run(r){return await this.mediatorQuerySourceIdentify.mediate({querySourceUnidentified:{type:"rdfjs",value:await this.getRdfSource(r.context,r.querySourceUnidentified),context:r.querySourceUnidentified.context},context:r.context})}async getRdfSource(r,n){const c=new a.Readable({objectMode:!0});c._read=()=>{},c.push(n.value),c.push(null);const s={context:r,handle:{metadata:{baseIRI:n.baseIRI},data:c,context:r},handleMediaType:n.mediaType},l=await this.mediatorRdfParse.mediate(s);return await(0,u.storeStream)(l.handle.data)}isStringSource(r){return"type"in r?r.type==="serialized":typeof r.value!="string"?!1:"mediaType"in r}};return My.ActorQuerySourceIdentifySerialized=t,My}var Nq;function qH(){return Nq||(Nq=1,(function(i){var o=ki&&ki.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ki&&ki.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(PH(),i)})(ki)),ki}var eo={},xy={},Cq;function jH(){if(Cq)return xy;Cq=1,Object.defineProperty(xy,"__esModule",{value:!0}),xy.ActorRdfJoinMultiBindSource=void 0;const i=le(),o=q(),u=O(),a=Le(),t=Q(),e=N(),r=$();let n=class extends i.ActorRdfJoin{constructor(s){super(s,{logicalType:"inner",physicalName:"bind-source",canHandleUndefs:!0})}async getOutput(s,l){const d=s.context.getSafe(o.KeysInitQuery.dataFactory),f=new r.Factory(d),p=l.entriesSorted;this.logDebug(s.context,"First entry for Bind Join Source: ",()=>({entry:p[0].operation,cardinality:p[0].metadata.cardinality,order:p[0].metadata.order,availableOrders:p[0].metadata.availableOrders}));for(const[v,F]of p.entries())v!==0&&F.output.bindingsStream.close();const _=p[0].output,y=p[0].metadata,m=[...p];m.splice(0,1);const b=(0,t.getOperationSource)(m[0].operation),h=this.createOperationFromEntries(f,m),g=new a.ChunkedIterator(_.bindingsStream,this.blockSize,{autoStart:!1});return{result:{type:"bindings",bindingsStream:new e.UnionIterator(g.map(v=>b.source.queryBindings(h,b.context?s.context.merge(b.context):s.context,{joinBindings:{bindings:v,metadata:y}}))),metadata:()=>this.constructResultMetadata(p,p.map(v=>v.metadata),s.context)},physicalPlanMetadata:{bindIndex:l.entriesUnsorted.indexOf(p[0])}}}async sortJoinEntries(s,l){const d=await i.ActorRdfJoin.sortJoinEntries(this.mediatorJoinEntriesSort,s,l);return d.isFailed()?d:(s=d.get(),s=s.sort((f,p)=>f.operationModified&&!p.operationModified?-1:0),(0,u.passTest)(s))}async getJoinCoefficients(s,l){let{metadatas:d}=l;const f=s.context.getSafe(o.KeysInitQuery.dataFactory),p=new r.Factory(f),_=s.entries.map((A,L)=>({...A,metadata:d[L]})),y=await this.sortJoinEntries(_,s.context);if(y.isFailed())return y;const m=y.get();d=m.map(A=>A.metadata);const b=i.ActorRdfJoin.getRequestInitialTimes(d),h=i.ActorRdfJoin.getRequestItemTimes(d),g=[...m];[...b],[...h],g.splice(0,1);const T=g.map(A=>(0,t.getOperationSource)(A.operation));if(T.some(A=>!A))return(0,u.failTest)(`Actor ${this.name} can not bind on remaining operations without source annotation`);if(T.some(A=>A!==T[0]))return(0,u.failTest)(`Actor ${this.name} can not bind on remaining operations with non-equal source annotation`);const v=T[0],F=this.createOperationFromEntries(p,g),P=await v.source.getSelectorShape(s.context);if(!(0,t.doesShapeAcceptOperation)(P,F,{joinBindings:!0}))return(0,u.failTest)(`Actor ${this.name} detected a source that can not handle passing down join bindings`);const j=await Promise.all(g.map(async A=>(await this.mediatorJoinSelectivity.mediate({entries:[m[0],A],context:s.context})).selectivity*this.selectivityModifier)),x=g.map((A,L)=>A.metadata.cardinality.value*j[L]).reduce((A,L)=>A+L,0);return(0,u.passTestWithSideData)({iterations:1,persistedItems:d[0].cardinality.value,blockingItems:d[0].cardinality.value,requestTime:b[0]+d[0].cardinality.value*h[0]+b[1]+x*h[1]},{...l,entriesUnsorted:_,entriesSorted:m})}createOperationFromEntries(s,l){return l.length===1?l[0].operation:s.createJoin(l.map(d=>d.operation),!0)}};return xy.ActorRdfJoinMultiBindSource=n,xy}var Uq;function MH(){return Uq||(Uq=1,(function(i){var o=eo&&eo.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=eo&&eo.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(jH(),i)})(eo)),eo}var to={},Dy={},Hq;function xH(){if(Hq)return Dy;Hq=1,Object.defineProperty(Dy,"__esModule",{value:!0}),Dy.ActorOptimizeQueryOperationJoinConnected=void 0;const i=be(),o=q(),u=O(),a=$();let t=class r_ extends i.ActorOptimizeQueryOperation{async test(r){return(0,u.passTestVoid)()}async run(r){const n=r.context.getSafe(o.KeysInitQuery.dataFactory),c=new a.Factory(n);return{operation:a.Util.mapOperation(r.operation,{join(l,d){return{recurse:!1,result:r_.cluster(l,d)}}},c),context:r.context}}static cluster(r,n){const c=r.input.map(f=>({inScopeVariables:Object.fromEntries(a.Util.inScopeVariables(f).map(p=>[p.value,!0])),entries:[f]}));let s,l=c;do s=l,l=r_.clusterIteration(s);while(s.length!==l.length);const d=l.map(f=>f.entries.length===1?f.entries[0]:n.createJoin(f.entries));return d.length===1?d[0]:n.createJoin(d,!1)}static clusterIteration(r){const n=[];for(const c of r){let s=!1;for(const l of n)if(r_.haveOverlappingVariables(c.inScopeVariables,l.inScopeVariables)){l.entries=[...l.entries,...c.entries],l.inScopeVariables={...l.inScopeVariables,...c.inScopeVariables},s=!0;break}s||n.push({inScopeVariables:c.inScopeVariables,entries:c.entries})}return n}static haveOverlappingVariables(r,n){for(const c of Object.keys(r))if(n[c])return!0;return!1}};return Dy.ActorOptimizeQueryOperationJoinConnected=t,Dy}var Vq;function DH(){return Vq||(Vq=1,(function(i){var o=to&&to.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=to&&to.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(xH(),i)})(to)),to}var ro={},Ey={},zq;function EH(){if(zq)return Ey;zq=1,Object.defineProperty(Ey,"__esModule",{value:!0}),Ey.ActorOptimizeQueryOperationBgpToJoin=void 0;const i=be(),o=q(),u=O(),a=$();let t=class extends i.ActorOptimizeQueryOperation{async test(r){return(0,u.passTestVoid)()}async run(r){const n=r.context.getSafe(o.KeysInitQuery.dataFactory),c=new a.Factory(n);return{operation:a.Util.mapOperation(r.operation,{bgp(l,d){return{recurse:!1,result:d.createJoin(l.patterns)}}},c),context:r.context}}};return Ey.ActorOptimizeQueryOperationBgpToJoin=t,Ey}var Xq;function LH(){return Xq||(Xq=1,(function(i){var o=ro&&ro.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ro&&ro.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(EH(),i)})(ro)),ro}var no={},Ly={},Gq;function IH(){if(Gq)return Ly;Gq=1,Object.defineProperty(Ly,"__esModule",{value:!0}),Ly.ActorOptimizeQueryOperationJoinBgp=void 0;const i=be(),o=q(),u=O(),a=$();let t=class extends i.ActorOptimizeQueryOperation{async test(r){return(0,u.passTestVoid)()}async run(r){const n=r.context.getSafe(o.KeysInitQuery.dataFactory),c=new a.Factory(n);return{operation:a.Util.mapOperation(r.operation,{join(l,d){return l.input.every(f=>f.type==="bgp")?{recurse:!1,result:d.createBgp(l.input.flatMap(f=>f.patterns))}:{recurse:!1,result:l}}},c),context:r.context}}};return Ly.ActorOptimizeQueryOperationJoinBgp=t,Ly}var Jq;function $H(){return Jq||(Jq=1,(function(i){var o=no&&no.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=no&&no.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(IH(),i)})(no)),no}var ao={},Iy={},Kq;function BH(){if(Kq)return Iy;Kq=1,Object.defineProperty(Iy,"__esModule",{value:!0}),Iy.ActorOptimizeQueryOperationAssignSourcesExhaustive=void 0;const i=be(),o=_m(),u=q(),a=O(),t=Q(),e=$();let r=class extends i.ActorOptimizeQueryOperation{constructor(c){super(c)}async test(c){return(0,a.passTestVoid)()}async run(c){const s=c.context.getSafe(u.KeysInitQuery.dataFactory),l=new e.Factory(s),d=c.context.get(u.KeysQueryOperation.querySources)??[];if(d.length===0)return{operation:c.operation,context:c.context};if(d.length===1){const f=d[0],p=c.context.get(u.KeysRdfUpdateQuads.destination);if(!p||f.source.referenceValue===(0,o.getDataDestinationValue)(p))try{const _=await f.source.getSelectorShape(c.context);if((0,t.doesShapeAcceptOperation)(_,c.operation))return{operation:(0,t.assignOperationSource)(c.operation,f),context:c.context}}catch{}}return{operation:this.assignExhaustive(l,c.operation,d),context:c.context.delete(u.KeysInitQuery.queryString)}}assignExhaustive(c,s,l){const d=this;return e.Util.mapOperation(s,{[e.Algebra.types.PATTERN](f,p){return l.length===1?{result:(0,t.assignOperationSource)(f,l[0]),recurse:!1}:{result:p.createUnion(l.map(_=>(0,t.assignOperationSource)(f,_))),recurse:!1}},[e.Algebra.types.LINK](f,p){return l.length===1?{result:(0,t.assignOperationSource)(f,l[0]),recurse:!1}:{result:p.createAlt(l.map(_=>(0,t.assignOperationSource)(f,_))),recurse:!1}},[e.Algebra.types.NPS](f,p){return l.length===1?{result:(0,t.assignOperationSource)(f,l[0]),recurse:!1}:{result:p.createAlt(l.map(_=>(0,t.assignOperationSource)(f,_))),recurse:!1}},[e.Algebra.types.SERVICE](f){return{result:f,recurse:!1}},[e.Algebra.types.CONSTRUCT](f,p){return{result:p.createConstruct(d.assignExhaustive(c,f.input,l),f.template),recurse:!1}},[e.Algebra.types.DELETE_INSERT](f,p){return{result:p.createDeleteInsert(f.delete,f.insert,f.where?d.assignExhaustive(c,f.where,l):void 0),recurse:!1}}},c)}};return Iy.ActorOptimizeQueryOperationAssignSourcesExhaustive=r,Iy}var Yq;function QH(){return Yq||(Yq=1,(function(i){var o=ao&&ao.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=ao&&ao.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(BH(),i)})(ao)),ao}var io={},$y={},Wq;function NH(){if(Wq)return $y;Wq=1,Object.defineProperty($y,"__esModule",{value:!0}),$y.ActorOptimizeQueryOperationDescribeToConstructsSubject=void 0;const i=be(),o=q(),u=O(),a=$();let t=class extends i.ActorOptimizeQueryOperation{constructor(r){super(r)}async test(r){return r.operation.type!==a.Algebra.types.DESCRIBE?(0,u.failTest)(`Actor ${this.name} only supports describe operations, but got ${r.operation.type}`):(0,u.passTest)(!0)}async run(r){const n=r.context.getSafe(o.KeysInitQuery.dataFactory),c=new a.Factory(n),s=r.operation,l=s.terms.filter(f=>f.termType!=="Variable").map(f=>{const p=[n.quad(f,n.variable("__predicate"),n.variable("__object"))];return p.forEach(y=>y.type="pattern"),{input:{type:a.Algebra.types.BGP,patterns:p},template:p,type:"construct"}});if(l.length!==s.terms.length){let f=[];s.terms.filter(p=>p.termType==="Variable").forEach((p,_)=>{const y=[n.quad(p,n.variable(`__predicate${_}`),n.variable(`__object${_}`))];y.forEach(m=>m.type="pattern"),f=[...f,...y]}),l.push({input:{type:a.Algebra.types.JOIN,input:[s.input,{type:a.Algebra.types.BGP,patterns:f}]},template:f,type:a.Algebra.types.CONSTRUCT})}return{operation:c.createUnion(l,!1),context:r.context}}};return $y.ActorOptimizeQueryOperationDescribeToConstructsSubject=t,$y}var Zq;function CH(){return Zq||(Zq=1,(function(i){var o=io&&io.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=io&&io.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(NH(),i)})(io)),io}var Y_,kq;function UH(){return kq||(kq=1,Y_=function(i){const o=new(Zx()).LoggerVoid,u=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-init/^4.0.0/components/ActorInit.jsonld#ActorInit_default_bus"}),a=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-context-preprocess/^4.0.0/components/ActorContextPreprocess.jsonld#ActorContextPreprocess_default_bus"}),t=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-hash-bindings/^4.0.0/components/ActorHashBindings.jsonld#ActorHashBindings_default_bus"}),e=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-hash-quads/^4.0.0/components/ActorHashQuads.jsonld#ActorHashQuads_default_bus"}),r=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-optimize-query-operation/^4.0.0/components/ActorOptimizeQueryOperation.jsonld#ActorOptimizeQueryOperation_default_bus"}),n=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-parse/^4.0.0/components/ActorQueryParse.jsonld#ActorQueryParse_default_bus"}),c=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-result-serialize/^4.0.0/components/ActorQueryResultSerialize.jsonld#ActorQueryResultSerialize_default_bus"}),s=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-source-identify-hypermedia/^4.0.0/components/ActorQuerySourceIdentifyHypermedia.jsonld#ActorQuerySourceIdentifyHypermedia_default_bus"}),l=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-dereference/^4.0.0/components/ActorDereference.jsonld#ActorDereference_default_bus"}),d=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-dereference-rdf/^4.0.0/components/ActorDereferenceRdf.jsonld#ActorDereferenceRdf_default_bus"}),f=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-join-entries-sort/^4.0.0/components/ActorRdfJoinEntriesSort.jsonld#ActorRdfJoinEntriesSort_default_bus"}),p=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-join-selectivity/^4.0.0/components/ActorRdfJoinSelectivity.jsonld#ActorRdfJoinSelectivity_default_bus"}),_=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-metadata/^4.0.0/components/ActorRdfMetadata.jsonld#ActorRdfMetadata_default_bus"}),y=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-metadata-accumulate/^4.0.0/components/ActorRdfMetadataAccumulate.jsonld#ActorRdfMetadataAccumulate_default_bus"}),m=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-metadata-extract/^4.0.0/components/ActorRdfMetadataExtract.jsonld#ActorRdfMetadataExtract_default_bus"}),b=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-parse/^4.0.0/components/ActorRdfParse.jsonld#ActorRdfParse_default_bus"}),h=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-parse-html/^4.0.0/components/ActorRdfParseHtml.jsonld#ActorRdfParseHtml_default_bus"}),g=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-resolve-hypermedia-links/^4.0.0/components/ActorRdfResolveHypermediaLinks.jsonld#ActorRdfResolveHypermediaLinks_default_bus"}),T=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-resolve-hypermedia-links-queue/^4.0.0/components/ActorRdfResolveHypermediaLinksQueue.jsonld#ActorRdfResolveHypermediaLinksQueue_default_bus"}),v=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-serialize/^4.0.0/components/ActorRdfSerialize.jsonld#ActorRdfSerialize_default_bus"}),F=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-update-hypermedia/^4.0.0/components/ActorRdfUpdateHypermedia.jsonld#ActorRdfUpdateHypermedia_default_bus"}),P=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-update-quads/^4.0.0/components/ActorRdfUpdateQuads.jsonld#ActorRdfUpdateQuads_default_bus"}),j=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-bindings-aggregator-factory/^4.0.0/components/ActorBindingsAggregatorFactory.jsonld#ActorBindingsAggregatorFactory_default_bus"}),x=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-expression-evaluator-factory/^4.0.0/components/ActorExpressionEvaluatorFactory.jsonld#ActorExpressionEvaluatorFactory_default_bus"}),A=new(w()).BusFunctionFactory({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-function-factory/^4.0.0/components/ActorFunctionFactory.jsonld#ActorFunctionFactory_default_bus"}),L=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-http/^4.0.0/components/ActorHttp.jsonld#ActorHttp_default_bus"}),z=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-http/^4.0.0/components/ActorHttp.jsonld#ActorHttp_fallback_bus"}),M=new(X()).BusQueryOperation({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-operation/^4.0.0/components/ActorQueryOperation.jsonld#ActorQueryOperation_default_bus"}),R=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-process/^4.0.0/components/ActorQueryProcess.jsonld#ActorQueryProcess_default_bus"}),E=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-source-identify/^4.0.0/components/ActorQuerySourceIdentify.jsonld#ActorQuerySourceIdentify_default_bus"}),D=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-join/^4.0.0/components/ActorRdfJoin.jsonld#ActorRdfJoin_default_bus"}),C=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-term-comparator-factory/^4.0.0/components/ActorTermComparatorFactory.jsonld#ActorTermComparatorFactory_default_bus"}),ce=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-http-invalidate/^4.0.0/components/ActorHttpInvalidate.jsonld#ActorHttpInvalidate_default_bus"}),lo=new(O()).Bus({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-merge-bindings-context/^4.0.0/components/ActorMergeBindingsContext.jsonld#ActorMergeBindingsContext_default_bus"});new(mD()).ActorContextPreprocessConvertShortcuts({contextKeyShortcuts:{baseIRI:"@comunica/actor-init-query:baseIRI",dataFactory:"@comunica/actor-init-query:dataFactory",datetime:"@comunica/actor-http-memento:datetime",destination:"@comunica/bus-rdf-update-quads:destination",distinctConstruct:"@comunica/actor-init-query:distinctConstruct",explain:"@comunica/actor-init-query:explain",extensionFunctionCreator:"@comunica/actor-init-query:extensionFunctionCreator",extensionFunctions:"@comunica/actor-init-query:extensionFunctions",fetch:"@comunica/bus-http:fetch",functionArgumentsCache:"@comunica/actor-init-query:functionArgumentsCache",httpAuth:"@comunica/bus-http:auth",httpBodyTimeout:"@comunica/bus-http:http-body-timeout",httpIncludeCredentials:"@comunica/bus-http:include-credentials",httpProxyHandler:"@comunica/actor-http-proxy:httpProxyHandler",httpRetryCount:"@comunica/bus-http:http-retry-count",httpRetryDelayFallback:"@comunica/bus-http:http-retry-delay-fallback",httpRetryDelayLimit:"@comunica/bus-http:http-retry-delay-limit",httpTimeout:"@comunica/bus-http:http-timeout",initialBindings:"@comunica/actor-init-query:initialBindings",invalidateCache:"@comunica/actor-init-query:invalidateCache",lenient:"@comunica/actor-init-query:lenient",log:"@comunica/core:log",queryFormat:"@comunica/actor-init-query:queryFormat",queryTimestamp:"@comunica/actor-init-query:queryTimestamp",queryTimestampHighResolution:"@comunica/actor-init-query:queryTimestampHighResolution",readOnly:"@comunica/bus-query-operation:readOnly",recoverBrokenLinks:"@comunica/bus-http-wayback:recover-broken-links",sources:"@comunica/actor-init-query:querySourcesUnidentified",traverse:"@comunica/bus-query-source-identify:traverse",unionDefaultGraph:"@comunica/bus-query-operation:unionDefaultGraph"},name:"urn:comunica:default:context-preprocess/actors#convert-shortcuts",bus:a,busFailMessage:"Context preprocessing failed"}),new(gD()).ActorContextPreprocessSetDefaults({logger:o,name:"urn:comunica:default:context-preprocess/actors#set-defaults",bus:a,busFailMessage:"Context preprocessing failed"}),new(vD()).ActorContextPreprocessSourceToDestination({name:"urn:comunica:default:context-preprocess/actors#source-to-destination",bus:a,busFailMessage:"Context preprocessing failed"});const $e=new(Sj()).ActorContextPreprocessQuerySourceSkolemize({name:"urn:comunica:default:context-preprocess/actors#query-source-skolemize",bus:a,busFailMessage:"Context preprocessing failed"}),fo=new(cg()).MediatorCombinePipeline({name:"urn:comunica:default:context-preprocess/mediators#main",bus:a});new(PD()).ActorHashBindingsMurmur({name:"urn:comunica:default:hash-bindings/actors#murmur",bus:t,busFailMessage:"Failed to obtaining hash functions for bindings"});const je=new(re()).MediatorRace({name:"urn:comunica:default:hash-bindings/mediators#main",bus:t});new(DD()).ActorHashQuadsMurmur({name:"urn:comunica:default:hash-quads/actors#murmur",bus:e,busFailMessage:"Failed to obtaining hash functions for quads"}),new(ID()).ActorOptimizeQueryOperationRewriteCopy({name:"urn:comunica:default:optimize-query-operation/actors#rewrite-copy",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize"}),new(BD()).ActorOptimizeQueryOperationRewriteMove({name:"urn:comunica:default:optimize-query-operation/actors#rewrite-move",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize"}),new(ND()).ActorOptimizeQueryOperationRewriteAdd({name:"urn:comunica:default:optimize-query-operation/actors#rewrite-add",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize"});const Fo=new(XD()).ActorOptimizeQueryOperationGroupSources({name:"urn:comunica:default:optimize-query-operation/actors#group-sources",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize"});new(JD()).ActorOptimizeQueryOperationConstructDistinct({name:"urn:comunica:default:optimize-query-operation/actors#construct-distinct",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize"});const Ky=new(cg()).MediatorCombinePipeline({filterFailures:!0,name:"urn:comunica:default:optimize-query-operation/mediators#main",bus:r});new(WD()).ActorQueryParseSparql({prefixes:{dbpedia:"http://dbpedia.org/resource/","dbpedia-owl":"http://dbpedia.org/ontology/",dbpprop:"http://dbpedia.org/property/",dc:"http://purl.org/dc/terms/",dc11:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",owl:"http://www.w3.org/2002/07/owl#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",schema:"http://schema.org/",skos:"http://www.w3.org/2008/05/skos#",xsd:"http://www.w3.org/2001/XMLSchema#"},name:"urn:comunica:default:query-parse/actors#sparql",bus:n,busFailMessage:'Query parsing failed: none of the configured parsers were able to the query "${action.query}"'}),new(kD()).ActorQueryParseGraphql({name:"urn:comunica:default:query-parse/actors#graphql",bus:n,busFailMessage:'Query parsing failed: none of the configured parsers were able to the query "${action.query}"'});const wo=new(re()).MediatorRace({name:"urn:comunica:default:query-parse/mediators#main",bus:n});new(aE()).ActorQueryResultSerializeJson({mediaTypePriorities:{"application/json":1},mediaTypeFormats:{"application/json":"https://comunica.linkeddatafragments.org/#results_JSON"},name:"urn:comunica:default:query-result-serialize/actors#json",bus:c,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(oE()).ActorQueryResultSerializeSimple({mediaTypePriorities:{simple:.9},mediaTypeFormats:{simple:"https://comunica.linkeddatafragments.org/#results_simple"},name:"urn:comunica:default:query-result-serialize/actors#simple",bus:c,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(cE()).ActorQueryResultSerializeSparqlCsv({mediaTypePriorities:{"text/csv":.75},mediaTypeFormats:{"text/csv":"http://www.w3.org/ns/formats/SPARQL_Results_CSV"},name:"urn:comunica:default:query-result-serialize/actors#csv",bus:c,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(dE()).ActorQueryResultSerializeSparqlTsv({mediaTypePriorities:{"text/tab-separated-values":.75},mediaTypeFormats:{"text/tab-separated-values":"http://www.w3.org/ns/formats/SPARQL_Results_TSV"},name:"urn:comunica:default:query-result-serialize/actors#sparql-tsv",bus:c,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(pE()).ActorQueryResultSerializeSparqlXml({mediaTypePriorities:{"application/sparql-results+xml":.8},mediaTypeFormats:{"application/sparql-results+xml":"http://www.w3.org/ns/formats/SPARQL_Results_XML"},name:"urn:comunica:default:query-result-serialize/actors#sparql-xml",bus:c,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(_E()).ActorQueryResultSerializeTable({columnWidth:50,mediaTypePriorities:{table:.6},mediaTypeFormats:{table:"https://comunica.linkeddatafragments.org/#results_table"},name:"urn:comunica:default:query-result-serialize/actors#table",bus:c,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(mE()).ActorQueryResultSerializeTree({mediaTypePriorities:{tree:.5},mediaTypeFormats:{tree:"https://comunica.linkeddatafragments.org/#results_tree"},name:"urn:comunica:default:query-result-serialize/actors#tree",bus:c,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"});const AM=new(re()).MediatorRace({name:"urn:comunica:default:query-result-serialize/mediators#serialize",bus:c}),SM=new(Me()).MediatorCombineUnion({field:"mediaTypes",name:"urn:comunica:default:query-result-serialize/mediators#mediaType",bus:c}),FM=new(Me()).MediatorCombineUnion({field:"mediaTypeFormats",name:"urn:comunica:default:query-result-serialize/mediators#mediaTypeFormat",bus:c}),wM=new(yo()).MediatorNumber({field:"filterFactor",type:"max",ignoreFailures:!0,name:"urn:comunica:default:query-source-identify-hypermedia/mediators#main",bus:s}),RM=new(OE()).ActorDereferenceFallback({name:"urn:comunica:default:dereference/actors#fallback",bus:l,busFailMessage:"Dereferencing failed: none of the configured actors were able to handle ${action.url}"}),PM=new(re()).MediatorRace({name:"urn:comunica:default:dereference/mediators#main",bus:l}),d_=new(re()).MediatorRace({name:"urn:comunica:default:dereference-rdf/mediators#main",bus:d});new(FE()).ActorRdfJoinEntriesSortCardinality({name:"urn:comunica:default:rdf-join-entries-sort/actors#cardinality",bus:f,busFailMessage:"Sorting join entries failed: none of the configured actors were able to sort"});const Yy=new(yo()).MediatorNumber({field:"accuracy",type:"max",ignoreFailures:!0,name:"urn:comunica:default:rdf-join-entries-sort/mediators#main",bus:f});new(qE()).ActorRdfJoinSelectivityVariableCounting({name:"urn:comunica:default:rdf-join-selectivity/actors#variable-counting",bus:p,busFailMessage:"Determining join selectivity failed: none of the configured actors were able to calculate selectivities"});const W=new(yo()).MediatorNumber({field:"accuracy",type:"max",ignoreFailures:!0,name:"urn:comunica:default:rdf-join-selectivity/mediators#main",bus:p});new(xE()).ActorRdfMetadataPrimaryTopic({metadataToData:!1,dataToMetadataOnInvalidMetadataGraph:!0,name:"urn:comunica:default:rdf-metadata/actors#primary-topic",bus:_,busFailMessage:"Metadata splicing failed: none of the configured actors were able to splice metadata from ${action.url}"}),new(EE()).ActorRdfMetadataAll({name:"urn:comunica:default:rdf-metadata/actors#all",bus:_,busFailMessage:"Metadata splicing failed: none of the configured actors were able to splice metadata from ${action.url}"});const l_=new(re()).MediatorRace({name:"urn:comunica:default:rdf-metadata/mediators#main",bus:_});new($E()).ActorRdfMetadataAccumulateCardinality({name:"urn:comunica:default:rdf-metadata-accumulate/actors#cardinality",bus:y,busFailMessage:"Metadata accumulation failed: none of the configured actors were able to accumulate metadata in mode ${action.mode}"}),new(QE()).ActorRdfMetadataAccumulatePageSize({name:"urn:comunica:default:rdf-metadata-accumulate/actors#pagesize",bus:y,busFailMessage:"Metadata accumulation failed: none of the configured actors were able to accumulate metadata in mode ${action.mode}"}),new(CE()).ActorRdfMetadataAccumulateRequestTime({name:"urn:comunica:default:rdf-metadata-accumulate/actors#requesttime",bus:y,busFailMessage:"Metadata accumulation failed: none of the configured actors were able to accumulate metadata in mode ${action.mode}"});const f_=new(Me()).MediatorCombineUnion({field:"metadata",name:"urn:comunica:default:rdf-metadata-accumulate/mediators#main",bus:y});new(VE()).ActorRdfMetadataExtractHydraControls({name:"urn:comunica:default:rdf-metadata-extract/actors#hydra-controls",bus:m,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(XE()).ActorRdfMetadataExtractHydraCount({predicates:["http://www.w3.org/ns/hydra/core#totalItems","http://rdfs.org/ns/void#triples"],name:"urn:comunica:default:rdf-metadata-extract/actors#hydra-count",bus:m,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(JE()).ActorRdfMetadataExtractHydraPagesize({predicates:["http://www.w3.org/ns/hydra/core#itemsPerPage"],name:"urn:comunica:default:rdf-metadata-extract/actors#hydra-pagesize",bus:m,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(YE()).ActorRdfMetadataExtractRequestTime({name:"urn:comunica:default:rdf-metadata-extract/actors#request-time",bus:m,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(ZE()).ActorRdfMetadataExtractAllowHttpMethods({name:"urn:comunica:default:rdf-metadata-extract/actors#allow-http-methods",bus:m,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(e0()).ActorRdfMetadataExtractPutAccepted({name:"urn:comunica:default:rdf-metadata-extract/actors#put-accepted",bus:m,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(r0()).ActorRdfMetadataExtractPatchSparqlUpdate({name:"urn:comunica:default:rdf-metadata-extract/actors#patch-sparql-update",bus:m,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(a0()).ActorRdfMetadataExtractSparqlService({inferHttpsEndpoint:!0,name:"urn:comunica:default:rdf-metadata-extract/actors#sparql-service",bus:m,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"}),new(u0()).ActorRdfMetadataExtractVoid({name:"urn:comunica:default:rdf-metadata-extract/actors#void",bus:m,busFailMessage:"Metadata extraction failed: none of the configured actors were able to extract metadata from ${action.url}"});const p_=new(Me()).MediatorCombineUnion({filterFailures:!0,field:"metadata",name:"urn:comunica:default:rdf-metadata-extract/mediators#main",bus:m});new(l0()).ActorRdfParseN3({mediaTypePriorities:{"application/n-quads":1,"application/n-triples":.8,"application/trig":.95,"text/n3":.35,"text/turtle":.6},mediaTypeFormats:{"application/n-quads":"http://www.w3.org/ns/formats/N-Quads","application/n-triples":"http://www.w3.org/ns/formats/N-Triples","application/trig":"http://www.w3.org/ns/formats/TriG","text/n3":"http://www.w3.org/ns/formats/N3","text/turtle":"http://www.w3.org/ns/formats/Turtle"},priorityScale:1,name:"urn:comunica:default:rdf-parse/actors#n3",bus:b,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(p0()).ActorRdfParseRdfXml({mediaTypePriorities:{"application/rdf+xml":1},mediaTypeFormats:{"application/rdf+xml":"http://www.w3.org/ns/formats/RDF_XML"},priorityScale:.5,name:"urn:comunica:default:rdf-parse/actors#rdfxml",bus:b,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(_0()).ActorRdfParseXmlRdfa({mediaTypePriorities:{"application/xml":1,"image/svg+xml":1,"text/xml":1},mediaTypeFormats:{"application/xml":"http://www.w3.org/ns/formats/RDFa","image/svg+xml":"http://www.w3.org/ns/formats/RDFa","text/xml":"http://www.w3.org/ns/formats/RDFa"},priorityScale:.3,name:"urn:comunica:default:rdf-parse/actors#xmlrdfa",bus:b,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(g0()).ActorRdfParseShaclc({mediaTypePriorities:{"text/shaclc":1,"text/shaclc-ext":.5},mediaTypeFormats:{"text/shaclc":"http://www.w3.org/ns/formats/Shaclc","text/shaclc-ext":"http://www.w3.org/ns/formats/ShaclcExtended"},priorityScale:.1,name:"urn:comunica:default:rdf-parse/actors#shaclc",bus:b,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"});const y_=new(re()).MediatorRace({name:"urn:comunica:default:rdf-parse/mediators#parse",bus:b}),Tm=new(Me()).MediatorCombineUnion({field:"mediaTypes",name:"urn:comunica:default:rdf-parse/mediators#mediaType",bus:b});new(v0()).ActorRdfParseHtml({busRdfParseHtml:h,mediaTypePriorities:{"application/xhtml+xml":.9,"text/html":1},mediaTypeFormats:{"application/xhtml+xml":"http://www.w3.org/ns/formats/HTML","text/html":"http://www.w3.org/ns/formats/HTML"},priorityScale:.2,name:"urn:comunica:default:rdf-parse/actors#html",bus:b,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(A0()).ActorRdfParseHtmlMicrodata({name:"urn:comunica:default:rdf-parse-html/actors#microdata",bus:h,busFailMessage:"RDF HTML parsing failed: none of the configured parsers were able to parse RDF in HTML"}),new(F0()).ActorRdfParseHtmlRdfa({name:"urn:comunica:default:rdf-parse-html/actors#rdfa",bus:h,busFailMessage:"RDF HTML parsing failed: none of the configured parsers were able to parse RDF in HTML"}),new(q0()).ActorRdfResolveHypermediaLinksNext({name:"urn:comunica:default:rdf-resolve-hypermedia-links/actors#next",bus:g,busFailMessage:"Hypermedia link resolution failed: none of the configured actors were able to resolve links from metadata"});const qM=new(re()).MediatorRace({name:"urn:comunica:default:rdf-resolve-hypermedia-links/mediators#main",bus:g});new(L0()).ActorRdfResolveHypermediaLinksQueueFifo({name:"urn:comunica:default:rdf-resolve-hypermedia-links-queue/actors#fifo",bus:T,busFailMessage:"Link queue creation failed: none of the configured actors were able to create a link queue starting from ${action.firstUrl}"});const jM=new(re()).MediatorRace({name:"urn:comunica:default:rdf-resolve-hypermedia-links-queue/mediators#main",bus:T});new(Q0()).ActorRdfSerializeN3({mediaTypePriorities:{"application/n-quads":1,"application/n-triples":.8,"application/trig":.95,"text/n3":.35,"text/turtle":.6},mediaTypeFormats:{"application/n-quads":"http://www.w3.org/ns/formats/N-Quads","application/n-triples":"http://www.w3.org/ns/formats/N-Triples","application/trig":"http://www.w3.org/ns/formats/TriG","text/n3":"http://www.w3.org/ns/formats/N3","text/turtle":"http://www.w3.org/ns/formats/Turtle"},name:"urn:comunica:default:rdf-serialize/actors#n3",bus:v,busFailMessage:"RDF serialization failed: none of the configured serializers were able to handle media type ${action.handleMediaType}"}),new(C0()).ActorRdfSerializeJsonLd({jsonStringifyIndentSpaces:2,mediaTypePriorities:{"application/ld+json":1},mediaTypeFormats:{"application/ld+json":"http://www.w3.org/ns/formats/JSON-LD"},priorityScale:.9,name:"urn:comunica:default:rdf-serialize/actors#jsonld",bus:v,busFailMessage:"RDF serialization failed: none of the configured serializers were able to handle media type ${action.handleMediaType}"}),new(H0()).ActorRdfSerializeShaclc({mediaTypePriorities:{"text/shaclc":1,"text/shaclc-ext":.5},mediaTypeFormats:{"text/shaclc":"http://www.w3.org/ns/formats/Shaclc","text/shaclc-ext":"http://www.w3.org/ns/formats/ShaclcExtended"},priorityScale:.1,name:"urn:comunica:default:rdf-serialize/actors#shaclc",bus:v,busFailMessage:"RDF serialization failed: none of the configured serializers were able to handle media type ${action.handleMediaType}"});const Om=new(re()).MediatorRace({name:"urn:comunica:default:rdf-serialize/mediators#serialize",bus:v}),Am=new(Me()).MediatorCombineUnion({field:"mediaTypes",name:"urn:comunica:default:rdf-serialize/mediators#mediaType",bus:v}),MM=new(Me()).MediatorCombineUnion({field:"mediaTypeFormats",name:"urn:comunica:default:rdf-serialize/mediators#mediaTypeFormat",bus:v}),xM=new(re()).MediatorRace({name:"urn:comunica:default:rdf-update-hypermedia/mediators#main",bus:F});new(K0()).ActorRdfUpdateQuadsRdfJsStore({name:"urn:comunica:default:rdf-update-quads/actors#rdfjs-store",bus:P,busFailMessage:"RDF updating failed: none of the configured actors were able to handle an update"});const Ro=new(re()).MediatorRace({name:"urn:comunica:default:rdf-update-quads/mediators#main",bus:P}),DM=new(re()).MediatorRace({name:"urn:comunica:default:bindings-aggregator-factory/mediators#main",bus:j}),ye=new(re()).MediatorRace({name:"urn:comunica:default:expression-evaluator-factory/mediators#main",bus:x});new(Z0()).ActorFunctionFactoryExpressionBnode({name:"urn:comunica:default:function-factory/actors#expression-function-bnode",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(tL()).ActorFunctionFactoryExpressionBound({name:"urn:comunica:default:function-factory/actors#expression-function-bound",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(aL()).ActorFunctionFactoryExpressionCoalesce({name:"urn:comunica:default:function-factory/actors#expression-function-coalesce",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(uL()).ActorFunctionFactoryExpressionConcat({name:"urn:comunica:default:function-factory/actors#expression-function-concat",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(dL()).ActorFunctionFactoryExpressionExtensions({name:"urn:comunica:default:function-factory/actors#expression-function-extensions",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(pL()).ActorFunctionFactoryExpressionIf({name:"urn:comunica:default:function-factory/actors#expression-function-if",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(mL()).ActorFunctionFactoryExpressionLogicalAnd({name:"urn:comunica:default:function-factory/actors#expression-function-logical-and",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(hL()).ActorFunctionFactoryExpressionLogicalOr({name:"urn:comunica:default:function-factory/actors#expression-function-logical-or",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(OL()).ActorFunctionFactoryExpressionSameTerm({name:"urn:comunica:default:function-factory/actors#expression-function-same-term",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(FL()).ActorFunctionFactoryTermAbs({name:"urn:comunica:default:function-factory/actors#term-function-abs",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(PL()).ActorFunctionFactoryTermAddition({name:"urn:comunica:default:function-factory/actors#term-function-addition",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(ML()).ActorFunctionFactoryTermCeil({name:"urn:comunica:default:function-factory/actors#term-function-ceil",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(EL()).ActorFunctionFactoryTermContains({name:"urn:comunica:default:function-factory/actors#term-function-contains",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new($L()).ActorFunctionFactoryTermDatatype({name:"urn:comunica:default:function-factory/actors#term-function-datatype",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(NL()).ActorFunctionFactoryTermDay({name:"urn:comunica:default:function-factory/actors#term-function-day",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(HL()).ActorFunctionFactoryTermDivision({name:"urn:comunica:default:function-factory/actors#term-function-division",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(XL()).ActorFunctionFactoryTermEncodeForUri({name:"urn:comunica:default:function-factory/actors#term-function-encode-for-uri",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(KL()).ActorFunctionFactoryTermEquality({name:"urn:comunica:default:function-factory/actors#term-function-equality",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(ZL()).ActorFunctionFactoryTermFloor({name:"urn:comunica:default:function-factory/actors#term-function-floor",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(tI()).ActorFunctionFactoryTermHours({name:"urn:comunica:default:function-factory/actors#term-function-hours",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(aI()).ActorFunctionFactoryTermIri({name:"urn:comunica:default:function-factory/actors#term-function-iri",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(uI()).ActorFunctionFactoryTermIsBlank({name:"urn:comunica:default:function-factory/actors#term-function-is-blank",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(dI()).ActorFunctionFactoryTermIsIri({name:"urn:comunica:default:function-factory/actors#term-function-is-iri",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(pI()).ActorFunctionFactoryTermIsLiteral({name:"urn:comunica:default:function-factory/actors#term-function-is-literal",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(mI()).ActorFunctionFactoryTermIsNumeric({name:"urn:comunica:default:function-factory/actors#term-function-is-numeric",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(hI()).ActorFunctionFactoryTermIsTriple({name:"urn:comunica:default:function-factory/actors#term-function-is-triple",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(OI()).ActorFunctionFactoryTermLang({name:"urn:comunica:default:function-factory/actors#term-function-lang",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(FI()).ActorFunctionFactoryTermLangmatches({name:"urn:comunica:default:function-factory/actors#term-function-langmatches",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(PI()).ActorFunctionFactoryTermLcase({name:"urn:comunica:default:function-factory/actors#term-function-lcase",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(MI()).ActorFunctionFactoryTermMd5({name:"urn:comunica:default:function-factory/actors#term-function-md5",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(EI()).ActorFunctionFactoryTermMinutes({name:"urn:comunica:default:function-factory/actors#term-function-minutes",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new($I()).ActorFunctionFactoryTermMonth({name:"urn:comunica:default:function-factory/actors#term-function-month",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(NI()).ActorFunctionFactoryTermMultiplication({name:"urn:comunica:default:function-factory/actors#term-function-multiplication",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(HI()).ActorFunctionFactoryTermNot({name:"urn:comunica:default:function-factory/actors#term-function-not",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(XI()).ActorFunctionFactoryTermNow({name:"urn:comunica:default:function-factory/actors#term-function-now",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(KI()).ActorFunctionFactoryTermObject({name:"urn:comunica:default:function-factory/actors#term-function-object",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(ZI()).ActorFunctionFactoryTermPredicate({name:"urn:comunica:default:function-factory/actors#term-function-predicate",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(t$()).ActorFunctionFactoryTermRand({name:"urn:comunica:default:function-factory/actors#term-function-rand",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(Ij()).ActorFunctionFactoryTermRegex({name:"urn:comunica:default:function-factory/actors#term-function-regex",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(i$()).ActorFunctionFactoryTermReplace({name:"urn:comunica:default:function-factory/actors#term-function-replace",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(c$()).ActorFunctionFactoryTermRound({name:"urn:comunica:default:function-factory/actors#term-function-round",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(l$()).ActorFunctionFactoryTermSeconds({name:"urn:comunica:default:function-factory/actors#term-function-seconds",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(y$()).ActorFunctionFactoryTermSha1({name:"urn:comunica:default:function-factory/actors#term-function-sha1",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(b$()).ActorFunctionFactoryTermSha256({name:"urn:comunica:default:function-factory/actors#term-function-sha256",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(v$()).ActorFunctionFactoryTermSha384({name:"urn:comunica:default:function-factory/actors#term-function-sha384",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(A$()).ActorFunctionFactoryTermSha512({name:"urn:comunica:default:function-factory/actors#term-function-sha512",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(w$()).ActorFunctionFactoryTermStrAfter({name:"urn:comunica:default:function-factory/actors#term-function-str-after",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(q$()).ActorFunctionFactoryTermStrBefore({name:"urn:comunica:default:function-factory/actors#term-function-str-before",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(x$()).ActorFunctionFactoryTermStrDt({name:"urn:comunica:default:function-factory/actors#term-function-str-dt",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(L$()).ActorFunctionFactoryTermStrEnds({name:"urn:comunica:default:function-factory/actors#term-function-str-ends",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(B$()).ActorFunctionFactoryTermStrLang({name:"urn:comunica:default:function-factory/actors#term-function-str-lang",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(C$()).ActorFunctionFactoryTermStrLen({name:"urn:comunica:default:function-factory/actors#term-function-str-len",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(V$()).ActorFunctionFactoryTermStrStarts({name:"urn:comunica:default:function-factory/actors#term-function-str-starts",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(G$()).ActorFunctionFactoryTermStrUuid({name:"urn:comunica:default:function-factory/actors#term-function-str-uuid",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(Y$()).ActorFunctionFactoryTermStr({name:"urn:comunica:default:function-factory/actors#term-function-str",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(k$()).ActorFunctionFactoryTermSubStr({name:"urn:comunica:default:function-factory/actors#term-function-sub-str",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(rB()).ActorFunctionFactoryTermSubject({name:"urn:comunica:default:function-factory/actors#term-function-subject",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(iB()).ActorFunctionFactoryTermSubtraction({name:"urn:comunica:default:function-factory/actors#term-function-subtraction",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(cB()).ActorFunctionFactoryTermTimezone({name:"urn:comunica:default:function-factory/actors#term-function-timezone",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(lB()).ActorFunctionFactoryTermTriple({name:"urn:comunica:default:function-factory/actors#term-function-triple",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(yB()).ActorFunctionFactoryTermTz({name:"urn:comunica:default:function-factory/actors#term-function-tz",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(bB()).ActorFunctionFactoryTermUcase({name:"urn:comunica:default:function-factory/actors#term-function-ucase",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(vB()).ActorFunctionFactoryTermUnaryMinus({name:"urn:comunica:default:function-factory/actors#term-function-unary-minus",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(AB()).ActorFunctionFactoryTermUnaryPlus({name:"urn:comunica:default:function-factory/actors#term-function-unary-plus",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(wB()).ActorFunctionFactoryTermUuid({name:"urn:comunica:default:function-factory/actors#term-function-uuid",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(qB()).ActorFunctionFactoryTermXsdToBoolean({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-boolean",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(xB()).ActorFunctionFactoryTermXsdToDate({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-date",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(LB()).ActorFunctionFactoryTermXsdToDatetime({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-datetime",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(BB()).ActorFunctionFactoryTermXsdToDayTimeDuration({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-day-time-duration",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(CB()).ActorFunctionFactoryTermXsdToDecimal({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-decimal",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(VB()).ActorFunctionFactoryTermXsdToDouble({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-double",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(GB()).ActorFunctionFactoryTermXsdToDuration({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-duration",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(YB()).ActorFunctionFactoryTermXsdToFloat({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-float",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(kB()).ActorFunctionFactoryTermXsdToInteger({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-integer",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(rQ()).ActorFunctionFactoryTermXsdToString({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-string",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(iQ()).ActorFunctionFactoryTermXsdToTime({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-time",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(cQ()).ActorFunctionFactoryTermXsdToYearMonthDuration({name:"urn:comunica:default:function-factory/actors#term-function-xsd-to-year-month-duration",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(lQ()).ActorFunctionFactoryTermYear({name:"urn:comunica:default:function-factory/actors#term-function-year",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"});const ge=new(re()).MediatorRace({name:"urn:comunica:default:function-factory/mediators#main",bus:A}),EM=new(bQ()).ActorHttpFetch({agentOptions:{keepAlive:!0,maxSockets:5},name:"urn:comunica:default:http/actors#fetch",bus:L,busFailMessage:"HTTP request failed: none of the configured actors were able to handle ${action.input}"}),LM=new(yo()).MediatorNumber({field:"time",type:"min",ignoreFailures:!0,name:"urn:comunica:default:http/mediators#no-fallback",bus:L}),Se=new(yo()).MediatorNumber({field:"time",type:"min",ignoreFailures:!0,name:"urn:comunica:default:http/mediators#main",bus:z});new(hQ()).ActorQueryOperationSource({name:"urn:comunica:default:query-operation/actors#source",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"});const U=new(yo()).MediatorNumber({field:"httpRequests",type:"min",ignoreFailures:!0,name:"urn:comunica:default:query-operation/mediators#main",bus:M}),IM=new(re()).MediatorRace({name:"urn:comunica:default:query-process/mediators#main",bus:R}),Wy=new(re()).MediatorRace({name:"urn:comunica:default:query-source-identify/mediators#main",bus:E}),po=new(TQ()).MediatorJoinCoefficientsFixed({cpuWeight:10,memoryWeight:1,timeWeight:2,ioWeight:10,name:"urn:comunica:default:rdf-join/mediators#main",bus:D}),__=new(re()).MediatorRace({name:"urn:comunica:default:term-comparator-factory/mediators#main",bus:C}),$M=new(_o()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-context-preprocess-query-source-identify/^4.0.0/components/ActorContextPreprocessQuerySourceIdentify.jsonld#IActorContextPreprocessQuerySourceIdentifyArgs_default_invalidator",bus:ce,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),BM=new(SQ()).MediatorAll({name:"urn:comunica:default:http-invalidate/mediators#main",bus:ce}),QM=new(_o()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-rdf-update-quads-hypermedia/^4.0.0/components/ActorRdfUpdateQuadsHypermedia.jsonld#IActorRdfUpdateQuadsHypermediaArgs_default_invalidator",bus:ce,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),NM=new(_o()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-http-retry/^4.0.0/components/ActorHttpRetry.jsonld#IActorHttpQueueArgs_default_invalidator",bus:ce,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),CM=new(_o()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-http-limit-rate/^4.0.0/components/ActorHttpLimitRate.jsonld#IActorHttpLimitRateArgs_default_invalidator",bus:ce,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),UM=new(_o()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-query-result-serialize-sparql-json/^4.0.0/components/ActionObserverHttp.jsonld#IActionObserverHttpArgs_default_invalidator",bus:ce,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),HM=new(_o()).ActorHttpInvalidateListenable({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-query-result-serialize-stats/^4.0.0/components/ActionObserverHttp.jsonld#IActionObserverHttpArgs_default_invalidator",bus:ce,busFailMessage:"HTTP invalidation failed: none of the configured actors were able to invalidate ${action.url}"}),k=new(Me()).MediatorCombineUnion({field:"mergeHandlers",name:"urn:comunica:default:merge-bindings-context/mediators#main",bus:lo});new(wQ()).ActorRdfJoinEntriesSortSelectivity({mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join-entries-sort/actors#selectivity",bus:f,busFailMessage:"Sorting join entries failed: none of the configured actors were able to sort"}),new(DQ()).ActorRdfJoinSingle({mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-single",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(LQ()).ActorRdfJoinMultiEmpty({mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-multi-empty",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"});const m_=new(rw()).ActorRdfJoinHash({mediatorHashBindings:je,canHandleUndefs:!1,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-hash-def",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),b_=new(rw()).ActorRdfJoinHash({mediatorHashBindings:je,canHandleUndefs:!0,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-hash-undef",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),g_=new(CQ()).ActorRdfJoinSymmetricHash({mediatorHashBindings:je,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-symmetric-hash",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),h_=new(HQ()).ActorRdfJoinNestedLoop({mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-nested-loop",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"});new(Zy()).ActorRdfJoinOptionalHash({canHandleUndefs:!1,blocking:!1,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#optional-hash-def-nonblocking",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(Zy()).ActorRdfJoinOptionalHash({canHandleUndefs:!1,blocking:!0,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#optional-hash-def-blocking",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(Zy()).ActorRdfJoinOptionalHash({canHandleUndefs:!0,blocking:!1,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#optional-hash-undef-nonblocking",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(Zy()).ActorRdfJoinOptionalHash({canHandleUndefs:!0,blocking:!0,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#optional-hash-undef-blocking",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(GQ()).ActorRdfJoinOptionalNestedLoop({mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#optional-nested-loop",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(bw()).ActorRdfJoinMinusHash({canHandleUndefs:!1,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#minus-hash-def",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(bw()).ActorRdfJoinMinusHash({canHandleUndefs:!0,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#minus-hash-undef",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(ZQ()).ActorDereferenceRdfParse({mediatorDereference:PM,mediatorParse:y_,mediatorParseMediatypes:Tm,mediaMappings:{htm:"text/html",html:"text/html",json:"application/json",jsonld:"application/ld+json",n3:"text/n3",nq:"application/n-quads",nquads:"application/n-quads",nt:"application/n-triples",ntriples:"application/n-triples",owl:"application/rdf+xml",rdf:"application/rdf+xml",rdfxml:"application/rdf+xml",shaclc:"text/shaclc",shaclce:"text/shaclc-ext",shc:"text/shaclc",shce:"text/shaclc-ext",svg:"image/svg+xml",svgz:"image/svg+xml",trig:"application/trig",ttl:"text/turtle",turtle:"text/turtle",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xml:"application/xml"},name:"urn:comunica:default:dereference-rdf/actors#parse",bus:d,busFailMessage:"RDF dereferencing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(tN()).ActorRdfParseHtmlScript({mediatorRdfParseMediatypes:Tm,mediatorRdfParseHandle:y_,name:"urn:comunica:default:rdf-parse-html/actors#script",bus:h,busFailMessage:"RDF HTML parsing failed: none of the configured parsers were able to parse RDF in HTML"}),new(nN()).ActorQueryResultSerializeRdf({mediatorRdfSerialize:Om,mediatorMediaTypeCombiner:Am,mediatorMediaTypeFormatCombiner:MM,name:"urn:comunica:default:query-result-serialize/actors#rdf",bus:c,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(uN()).ActorBindingsAggregatorFactoryGroupConcat({mediatorExpressionEvaluatorFactory:ye,name:"urn:comunica:default:bindings-aggregator-factory/actors#group-concat",bus:j,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(sN()).ActorBindingsAggregatorFactoryCount({mediatorExpressionEvaluatorFactory:ye,name:"urn:comunica:default:bindings-aggregator-factory/actors#count",bus:j,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(lN()).ActorBindingsAggregatorFactorySample({mediatorExpressionEvaluatorFactory:ye,name:"urn:comunica:default:bindings-aggregator-factory/actors#sample",bus:j,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(pN()).ActorBindingsAggregatorFactoryWildcardCount({mediatorExpressionEvaluatorFactory:ye,name:"urn:comunica:default:bindings-aggregator-factory/actors#wildcard-count",bus:j,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(_N()).ActorBindingsAggregatorFactoryAverage({mediatorFunctionFactory:ge,mediatorExpressionEvaluatorFactory:ye,name:"urn:comunica:default:bindings-aggregator-factory/actors#average",bus:j,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(bN()).ActorBindingsAggregatorFactorySum({mediatorFunctionFactory:ge,mediatorExpressionEvaluatorFactory:ye,name:"urn:comunica:default:bindings-aggregator-factory/actors#sum",bus:j,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(vN()).ActorFunctionFactoryExpressionIn({mediatorFunctionFactory:ge,name:"urn:comunica:default:function-factory/actors#expression-function-in",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(AN()).ActorFunctionFactoryExpressionNotIn({mediatorFunctionFactory:ge,name:"urn:comunica:default:function-factory/actors#expression-function-not-in",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(wN()).ActorFunctionFactoryTermGreaterThanEqual({mediatorFunctionFactory:ge,name:"urn:comunica:default:function-factory/actors#term-function-greater-than-equal",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(qN()).ActorFunctionFactoryTermGreaterThan({mediatorFunctionFactory:ge,name:"urn:comunica:default:function-factory/actors#term-function-greater-than",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(xN()).ActorFunctionFactoryTermInequality({mediatorFunctionFactory:ge,name:"urn:comunica:default:function-factory/actors#term-function-inequality",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(LN()).ActorFunctionFactoryTermLesserThanEqual({mediatorFunctionFactory:ge,name:"urn:comunica:default:function-factory/actors#term-function-lesser-than-equal",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(BN()).ActorFunctionFactoryTermLesserThan({mediatorFunctionFactory:ge,name:"urn:comunica:default:function-factory/actors#term-function-lesser-than",bus:A,busFailMessage:"Creation of function evaluator failed: no configured actor was able to evaluate function ${action.functionName}"}),new(NN()).ActorHttpWayback({mediatorHttp:LM,name:"urn:comunica:default:http/actors#wayback",bus:z,busFailMessage:"HTTP request failed: none of the configured actors were able to handle ${action.input}"}),new(UN()).ActorRdfParseJsonLd({mediatorHttp:Se,mediaTypePriorities:{"application/json":.15,"application/ld+json":1},mediaTypeFormats:{"application/json":"http://www.w3.org/ns/formats/JSON-LD","application/ld+json":"http://www.w3.org/ns/formats/JSON-LD"},priorityScale:.9,name:"urn:comunica:default:rdf-parse/actors#jsonld",bus:b,busFailMessage:"RDF parsing failed: none of the configured parsers were able to handle the media type ${action.handle.mediaType} for ${action.handle.url}"}),new(zN()).ActorRdfUpdateHypermediaPatchSparqlUpdate({mediatorHttp:Se,name:"urn:comunica:default:rdf-update-hypermedia/actors#patch-sparql-update",bus:F,busFailMessage:"RDF hypermedia updating failed: none of the configured actors were able to handle an update for ${action.url}"}),new(GN()).ActorRdfUpdateHypermediaPutLdp({mediatorHttp:Se,mediatorRdfSerializeMediatypes:Am,mediatorRdfSerialize:Om,name:"urn:comunica:default:rdf-update-hypermedia/actors#put-ldp",bus:F,busFailMessage:"RDF hypermedia updating failed: none of the configured actors were able to handle an update for ${action.url}"}),new(KN()).ActorRdfUpdateHypermediaSparql({mediatorHttp:Se,checkUrlSuffixSparql:!0,checkUrlSuffixUpdate:!0,name:"urn:comunica:default:rdf-update-hypermedia/actors#sparql",bus:F,busFailMessage:"RDF hypermedia updating failed: none of the configured actors were able to handle an update for ${action.url}"}),new(WN()).ActorQueryOperationAsk({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#ask",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(kN()).ActorQueryOperationBgpJoin({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#bgp",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(nM()).ActorQueryOperationConstruct({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#construct",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(oC()).ActorQueryOperationDistinctIdentity({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#distinct",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(cC()).ActorQueryOperationExtend({mediatorExpressionEvaluatorFactory:ye,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#extend",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(dC()).ActorQueryOperationFilter({mediatorExpressionEvaluatorFactory:ye,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#filter",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(fC()).ActorQueryOperationFromQuad({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#from",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(yC()).ActorQueryOperationProject({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#project",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(mC()).ActorQueryOperationReducedHash({mediatorHashBindings:je,cacheSize:100,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#reduced",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(gC()).ActorQueryOperationSlice({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#slice",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(sM()).ActorQueryOperationUnion({mediatorRdfMetadataAccumulate:f_,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#union",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(OC()).ActorQueryOperationPathAlt({mediatorRdfMetadataAccumulate:f_,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#path-alt",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(SC()).ActorQueryOperationPathInv({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#path-inv",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(wC()).ActorQueryOperationPathLink({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#path-link",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(PC()).ActorQueryOperationPathNps({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#path-nps",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(jC()).ActorQueryOperationClear({mediatorUpdateQuads:Ro,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#update-clear",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(xC()).ActorQueryOperationUpdateCompositeUpdate({mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#update-composite",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(EC()).ActorQueryOperationCreate({mediatorUpdateQuads:Ro,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#update-create",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(IC()).ActorQueryOperationDrop({mediatorUpdateQuads:Ro,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#update-drop",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(BC()).ActorQueryOperationLoad({mediatorUpdateQuads:Ro,mediatorQuerySourceIdentify:Wy,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#update-load",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(NC()).ActorQueryOperationJoin({mediatorJoin:po,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#join",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(UC()).ActorQueryOperationLeftJoin({mediatorJoin:po,mediatorExpressionEvaluatorFactory:ye,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#leftjoin",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(VC()).ActorQueryOperationMinus({mediatorJoin:po,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#minus",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(XC()).ActorQueryOperationPathSeq({mediatorJoin:po,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#path-seq",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"});const v_=new(JC()).ActorRdfJoinMultiSmallest({mediatorJoinEntriesSort:Yy,mediatorJoin:po,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-multi-smallest",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"});new(YC()).ActorBindingsAggregatorFactoryMax({mediatorTermComparatorFactory:__,mediatorExpressionEvaluatorFactory:ye,name:"urn:comunica:default:bindings-aggregator-factory/actors#max",bus:j,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(ZC()).ActorBindingsAggregatorFactoryMin({mediatorTermComparatorFactory:__,mediatorExpressionEvaluatorFactory:ye,name:"urn:comunica:default:bindings-aggregator-factory/actors#min",bus:j,busFailMessage:"Creation of Aggregator failed: none of the configured actors were able to handle ${action.expr.aggregator}"}),new(tU()).ActorQueryOperationOrderBy({mediatorExpressionEvaluatorFactory:ye,mediatorTermComparatorFactory:__,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#orderby",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"});const VM=new(nU()).ActorOptimizeQueryOperationFilterPushdown({aggressivePushdown:!1,maxIterations:10,splitConjunctive:!0,mergeConjunctive:!0,pushIntoLeftJoins:!0,pushEqualityIntoPatterns:!0,name:"urn:comunica:default:optimize-query-operation/actors#filter-pushdown",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[Fo]});new(iU()).ActorDereferenceHttp({mediatorHttp:Se,maxAcceptHeaderLength:1024,maxAcceptHeaderLengthBrowser:128,name:"urn:comunica:default:dereference/actors#http",bus:l,busFailMessage:"Dereferencing failed: none of the configured actors were able to handle ${action.url}",beforeActors:[RM]});const Sm=new(cU()).ActorHttpProxy({mediatorHttp:Se,name:"urn:comunica:default:http/actors#proxy",bus:L,busFailMessage:"HTTP request failed: none of the configured actors were able to handle ${action.input}",beforeActors:[EM]});new(dU()).ActorContextPreprocessQuerySourceIdentify({cacheSize:100,httpInvalidator:$M,mediatorQuerySourceIdentify:Wy,mediatorContextPreprocess:fo,name:"urn:comunica:default:context-preprocess/actors#query-source-identify",bus:a,busFailMessage:"Context preprocessing failed",beforeActors:[$e]});const zM=new(pj()).ActorInitQuery({mediatorQueryProcess:IM,mediatorQueryResultSerialize:AM,mediatorQueryResultSerializeMediaTypeCombiner:SM,mediatorQueryResultSerializeMediaTypeFormatCombiner:FM,mediatorHttpInvalidate:BM,defaultQueryInputFormat:"sparql",allowNoSources:!1,name:"urn:comunica:default:init/actors#query",bus:u,busFailMessage:"Initialization failed: none of the configured actors were to initialize"});new(fU()).ActorRdfUpdateQuadsHypermedia({cacheSize:100,httpInvalidator:QM,mediatorDereferenceRdf:d_,mediatorMetadata:l_,mediatorMetadataExtract:p_,mediatorRdfUpdateHypermedia:xM,name:"urn:comunica:default:rdf-update-quads/actors#hypermedia",bus:P,busFailMessage:"RDF updating failed: none of the configured actors were able to handle an update"});const XM=new(lP()).ActionObserverHttp({httpInvalidator:UM,observedActors:["urn:comunica:default:http/actors#fetch"],name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-query-result-serialize-sparql-json/^4.0.0/components/ActorQueryResultSerializeSparqlJson.jsonld#ActorQueryResultSerializeSparqlJson_default_observer",bus:L}),GM=new(_P()).ActionObserverHttp({httpInvalidator:HM,observedActors:["urn:comunica:default:http/actors#fetch"],name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-query-result-serialize-stats/^4.0.0/components/ActorQueryResultSerializeStats.jsonld#ActorQueryResultSerializeStats_default_observer",bus:L});new(TU()).ActorQuerySourceIdentifyHypermediaQpf({mediatorMetadata:l_,mediatorMetadataExtract:p_,mediatorDereferenceRdf:d_,mediatorMergeBindingsContext:k,subjectUri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#subject",predicateUri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#predicate",objectUri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#object",graphUri:"http://www.w3.org/ns/sparql-service-description#graph",name:"urn:comunica:default:query-source-identify-hypermedia/actors#qpf",bus:s,busFailMessage:"Query source hypermedia identification failed: none of the configured actors were able to identify ${action.url}"}),new(AU()).ActorQuerySourceIdentifyHypermediaSparql({mediatorHttp:Se,mediatorMergeBindingsContext:k,checkUrlSuffix:!0,forceHttpGet:!1,cacheSize:1024,forceSourceType:!1,bindMethod:"values",countTimeout:3e3,cardinalityCountQueries:!0,cardinalityEstimateConstruction:!1,name:"urn:comunica:default:query-source-identify-hypermedia/actors#sparql",bus:s,busFailMessage:"Query source hypermedia identification failed: none of the configured actors were able to identify ${action.url}"}),new(RU()).ActorQuerySourceIdentifyHypermediaNone({mediatorMergeBindingsContext:k,name:"urn:comunica:default:query-source-identify-hypermedia/actors#none",bus:s,busFailMessage:"Query source hypermedia identification failed: none of the configured actors were able to identify ${action.url}"}),new(xU()).ActorExpressionEvaluatorFactoryDefault({mediatorQueryOperation:U,mediatorFunctionFactory:ge,mediatorMergeBindingsContext:k,name:"urn:comunica:default:expression-evaluator-factory/actors#default",bus:x,busFailMessage:"Creation of Expression Evaluator failed"}),new(LU()).ActorQueryOperationGroup({mediatorMergeBindingsContext:k,mediatorBindingsAggregatorFactory:DM,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#group",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new($U()).ActorQueryOperationNop({mediatorMergeBindingsContext:k,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#nop",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(QU()).ActorQueryOperationService({forceSparqlEndpoint:!1,mediatorMergeBindingsContext:k,mediatorQuerySourceIdentify:Wy,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#service",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(CU()).ActorQueryOperationValues({mediatorMergeBindingsContext:k,name:"urn:comunica:default:query-operation/actors#values",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(HU()).ActorQueryOperationPathOneOrMore({mediatorMergeBindingsContext:k,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#path-one-or-more",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(zU()).ActorQueryOperationPathZeroOrMore({mediatorMergeBindingsContext:k,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#path-zero-or-more",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(GU()).ActorQueryOperationPathZeroOrOne({mediatorMergeBindingsContext:k,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#path-zero-or-one",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"}),new(KU()).ActorQueryOperationUpdateDeleteInsert({mediatorUpdateQuads:Ro,mediatorMergeBindingsContext:k,mediatorQueryOperation:U,name:"urn:comunica:default:query-operation/actors#update-delete-insert",bus:M,busFailMessage:"Query operation processing failed: none of the configured actors were able to handle the operation type ${action.operation.type}"});const T_=new(ZU()).ActorQueryProcessSequential({mediatorContextPreprocess:fo,mediatorQueryParse:wo,mediatorOptimizeQueryOperation:Ky,mediatorQueryOperation:U,mediatorMergeBindingsContext:k,name:"urn:comunica:default:query-process/actors#sequential",bus:R,busFailMessage:'Query processing failed: none of the configured actor were process to the query "${action.query}"'}),Fm=new(nH()).ActorQuerySourceIdentifyHypermedia({cacheSize:100,maxIterators:64,aggregateTraversalStore:!0,mediatorDereferenceRdf:d_,mediatorMetadata:l_,mediatorMetadataExtract:p_,mediatorMetadataAccumulate:f_,mediatorQuerySourceIdentifyHypermedia:wM,mediatorRdfResolveHypermediaLinks:qM,mediatorRdfResolveHypermediaLinksQueue:jM,mediatorMergeBindingsContext:k,name:"urn:comunica:default:query-source-identify/actors#hypermedia",bus:E,busFailMessage:"Query source identification failed: none of the configured actors were able to identify ${action.querySourceUnidentified.value}"});new(iH()).ActorRdfJoinNone({mediatorMergeBindingsContext:k,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-none",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(cH()).ActorRdfJoinOptionalBind({bindOrder:"depth-first",selectivityModifier:1e-6,mediatorQueryOperation:U,mediatorMergeBindingsContext:k,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#optional-bind",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}"}),new(pH()).ActorTermComparatorFactoryExpressionEvaluator({mediatorQueryOperation:U,mediatorFunctionFactory:ge,mediatorMergeBindingsContext:k,name:"urn:comunica:default:term-comparator-factory/actors#expression-evaluator",bus:C,busFailMessage:"Creation of term comparator failed"});const JM=new(TM()).ActorRdfJoinMultiBind({bindOrder:"depth-first",selectivityModifier:1e-4,minMaxCardinalityRatio:60,mediatorJoinEntriesSort:Yy,mediatorQueryOperation:U,mediatorMergeBindingsContext:k,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-multi-bind",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}",beforeActors:[v_,m_,b_,g_,h_]});new(_H()).ActorRdfJoinMultiSmallestFilterBindings({selectivityModifier:1e-4,blockSize:64,mediatorJoinEntriesSort:Yy,mediatorJoin:po,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-multi-smallest-filter-bindings",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}",beforeActors:[v_,m_,b_,g_,h_]}),new(lP()).ActorQueryResultSerializeSparqlJson({emitMetadata:!0,httpObserver:XM,mediaTypePriorities:{"application/sparql-results+json":.8},mediaTypeFormats:{"application/sparql-results+json":"http://www.w3.org/ns/formats/SPARQL_Results_JSON"},name:"urn:comunica:default:query-result-serialize/actors#sparql-json",bus:c,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(_P()).ActorQueryResultSerializeStats({httpObserver:GM,mediaTypePriorities:{stats:.5},mediaTypeFormats:{stats:"https://comunica.linkeddatafragments.org/#results_stats"},name:"urn:comunica:default:query-result-serialize/actors#stats",bus:c,busFailMessage:"Query result serialization failed: none of the configured actors were able to serialize for type ${action.handle.type}"}),new(bH()).ActorQueryProcessExplainLogical({queryProcessor:T_,name:"urn:comunica:default:query-process/actors#explain-logical",bus:R,busFailMessage:'Query processing failed: none of the configured actor were process to the query "${action.query}"'}),new(hH()).ActorQueryProcessExplainParsed({queryProcessor:T_,name:"urn:comunica:default:query-process/actors#explain-parsed",bus:R,busFailMessage:'Query processing failed: none of the configured actor were process to the query "${action.query}"'}),new(TH()).ActorQueryProcessExplainPhysical({queryProcessor:T_,name:"urn:comunica:default:query-process/actors#explain-physical",bus:R,busFailMessage:'Query processing failed: none of the configured actor were process to the query "${action.query}"'});const KM=new(AH()).ActorOptimizeQueryOperationPruneEmptySourceOperations({useAskIfSupported:!1,name:"urn:comunica:default:optimize-query-operation/actors#prune-empty-source-operations",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[VM]});new(FH()).ActorHttpRetry({mediatorHttp:Se,httpInvalidator:NM,name:"urn:comunica:default:http/actors#retry",bus:L,busFailMessage:"HTTP request failed: none of the configured actors were able to handle ${action.input}",beforeActors:[Sm]}),new(RH()).ActorHttpLimitRate({mediatorHttp:Se,httpInvalidator:CM,correctionMultiplier:.1,failureMultiplier:10,limitByDefault:!1,allowOverlap:!1,name:"urn:comunica:default:http/actors#limit-rate",bus:L,busFailMessage:"HTTP request failed: none of the configured actors were able to handle ${action.input}",beforeActors:[Sm]}),new(vm()).ActorQuerySourceIdentifyRdfJs({mediatorMergeBindingsContext:k,name:"urn:comunica:default:query-source-identify/actors#rdfjs",bus:E,busFailMessage:"Query source identification failed: none of the configured actors were able to identify ${action.querySourceUnidentified.value}",beforeActors:[Fm]}),new(qH()).ActorQuerySourceIdentifySerialized({mediatorRdfParse:y_,mediatorQuerySourceIdentify:Wy,name:"urn:comunica:default:query-source-identify/actors#serialized",bus:E,busFailMessage:"Query source identification failed: none of the configured actors were able to identify ${action.querySourceUnidentified.value}",beforeActors:[Fm]}),new(MH()).ActorRdfJoinMultiBindSource({selectivityModifier:1e-4,blockSize:16,mediatorJoinEntriesSort:Yy,mediatorJoinSelectivity:W,name:"urn:comunica:default:rdf-join/actors#inner-multi-bind-source",bus:D,busFailMessage:"RDF joining failed: none of the configured actors were able to handle the join type ${action.type}",beforeActors:[v_,JM,m_,b_,g_,h_]});const YM=new(DH()).ActorOptimizeQueryOperationJoinConnected({name:"urn:comunica:default:optimize-query-operation/actors#join-connected",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[KM]}),WM=new(LH()).ActorOptimizeQueryOperationBgpToJoin({name:"urn:comunica:default:optimize-query-operation/actors#bgp-to-join",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[YM]}),ZM=new($H()).ActorOptimizeQueryOperationJoinBgp({name:"urn:comunica:default:optimize-query-operation/actors#join-bgp",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[WM]}),kM=new(QH()).ActorOptimizeQueryOperationAssignSourcesExhaustive({name:"urn:comunica:default:optimize-query-operation/actors#assign-sources-exhaustive",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[ZM]});return new(CH()).ActorOptimizeQueryOperationDescribeToConstructsSubject({name:"urn:comunica:default:optimize-query-operation/actors#describe-to-constructs-subject",bus:r,busFailMessage:"Query optimization failed: none of the configured actors were able to optimize",beforeActors:[kM]}),zM}),Y_}var ej;function HH(){if(ej)return Po;ej=1,Object.defineProperty(Po,"__esModule",{value:!0}),Po.QueryEngine=void 0;const i=pj(),o=UH();let u=class extends i.QueryEngineBase{constructor(t=o()){super(t)}};return Po.QueryEngine=u,Po}var tj;function VH(){return tj||(tj=1,(function(i){var o=Be&&Be.__createBinding||(Object.create?(function(a,t,e,r){r===void 0&&(r=e);var n=Object.getOwnPropertyDescriptor(t,e);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(a,r,n)}):(function(a,t,e,r){r===void 0&&(r=e),a[r]=t[e]})),u=Be&&Be.__exportStar||function(a,t){for(var e in a)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&o(t,a,e)};Object.defineProperty(i,"__esModule",{value:!0}),u(HH(),i)})(Be)),Be}var s4=VH();export{XH as c,GH as g,s4 as i};
