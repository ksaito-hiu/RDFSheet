import{r as a,j as e,a as se}from"./react-BL4LEYSH.js";import{i as ne,N as re,a as oe}from"./vendor-C8VTLH0V.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function i(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=i(r);fetch(r.href,o)}})();const{handleIncomingRedirect:ie,login:le,logout:ae,fetch:ce}=window.solidClientAuthentication,z=ce;async function ue(t,s,i){return new Promise((n,r)=>{const o={format:"text/turtle",baseIRI:i};new oe(o).parse(t,(u,d,p)=>{u?r(u):d?s.addQuad(d):n(p)})})}const pe=async t=>{await le({oidcIssuer:t})},de=()=>{ae()};let D=null;async function fe(){const t=await ie();t&&t.isLoggedIn?t.webId&&(D=t.webId):D=null}const w=window.luckysheet,T={settings:{sheets:[],fileSettings:{podUrl:""}}},he=()=>({index:"iTha4zah",name:"??????????",status:0,repRange:"",prefixes:"",oneTimeTemplate:"",iterationTemplate:"",additionalImportUrls:"",oneTimeImportSparql:"",iterationImportSparql:"",rdfPodUrl:"https://example.org/my_pod/rdfsheet.ttl"}),H=()=>({sheets:[],fileSettings:{podUrl:"https://example.org/my_pod/rdfsheet.rdfs"}}),k=()=>{const t=w.getAllSheets(),s=T.settings.sheets,i=[];return t.forEach(n=>{const r=s.reduce((o,l)=>o||(l.index===n.index.toString()?l:o),null);if(r!==null)r.name=n.name,r.status=Number(n.status),i.push(r);else{const o=he();o.index=n.index.toString(),o.name=n.name,o.status=Number(n.status),i.push(o)}}),T.settings.sheets=i,T.settings};function _(t){return t instanceof Error?t.message:String(t)}function V(t){const s={container:"luckysheet",data:void 0,showinfobar:!1,showtoolbar:!0,sheetFormulaBar:!0,showsheetbar:!0,showstatisticBar:!0};t.luckysheetfile&&(s.data=t.luckysheetfile),t.settings&&(T.settings=t.settings),w.create(s),k()}async function me(){try{const t={types:[{description:"RDFSheet file",accept:{"application/x-rdfsheet+json":[".rdfs"]}}]},[s]=await window.showOpenFilePicker(t),n=await(await s.getFile()).text(),r=JSON.parse(n);V(r)}catch(t){alert(`ファイルは開かれませんでした。${_(t)}`)}}async function xe(t){try{const i=await(await z(t)).json();V(i)}catch(s){alert(`ファイルの読み込みに失敗しました。${_(s)}`)}}async function ge(){try{const t={luckysheetfile:w.getluckysheetfile(),settings:JSON.parse(JSON.stringify(T.settings))},s={suggestedName:"rdfsheetfile.rdfs",types:[{description:"RDFSheet file",accept:{"application/x-rdfsheet+json":[".rdfs"]}}]},n=await(await window.showSaveFilePicker(s)).createWritable();await n.write(JSON.stringify(t)),await n.close()}catch(t){alert(`ファイルは保存されませんでした。${_(t)}`)}}async function Se(t){try{const s={luckysheetfile:w.getluckysheetfile(),settings:JSON.parse(JSON.stringify(T.settings))};await z(t,{method:"PUT",headers:{"Content-Type":"application/x-rdfsheet+json"},body:JSON.stringify(s)}),alert("ファイルを保存しました。")}catch(s){alert(`ファイルの保存に失敗しました。${_(s)}`)}}async function Z(t,s){const i=T.settings.sheets.reduce((r,o,l)=>r!=-1?r:o.status===1?l:r,-1),n=T.settings.sheets[i];if(n)try{const r=new ne.QueryEngine,o=new re;await ue(t,o,s);const l=[o];for(const m of n.additionalImportUrls.split(`
`))m!==""&&l.push(m);const u=`BASE <${s}>
`+n.oneTimeImportSparql,p=await(await r.queryBindings(u,{sources:l})).toArray(),b={isRefresh:!0};if(p.length>=1)for(const[m,S]of p[0]){console.log(`GAHA: ${m.value}<=${S.value}`);const c=C(m.value);w.setCellValue(c.row,c.col,S.value,b)}else alert("The result of oneTimeSparql is empty.");if(n.repRange!==""){const m=n.repRange.split(":")[0],S=n.repRange.split(":")[1],c=C(m),h=C(S),x=`BASE <${s}>
`+n.iterationImportSparql,y=await r.query(x,{sources:l});if(y.resultType!=="bindings")throw new Error("iterationImportSparql is not SELECT query.");const f=await y.metadata(),A=await(await y.execute()).toArray();alert(`The result count of iterationImportSparql is ${A.length}.`);let R=f.variables;for(let F=c.row+1;F<=h.row+1;F++){const E=A.shift();if(E!=null)for(const[U,N]of E){const q=C(`${U.value}${F}`);w.setCellValue(q.row,q.col,N.value,b)}else for(const U of R){const N=C(`${U.value}${F}`);w.setCellValue(N.row,N.col,"",b)}}}w.refreshFormula()}catch{throw new Error("インポートエラー")}else return alert("アクティブなシートがありません？！"),null}async function je(){k();try{const t={types:[{description:"Turtle(RDF) file",accept:{"text/turtle":[".ttl"]}}]},[s]=await window.showOpenFilePicker(t),i=await s.getFile(),n=await i.text(),r=`file:///C:/Users/me/RDFSheet/${i.name}`;await Z(n,r)}catch(t){alert(`ファイルは開かれませんでした。${_(t)}`)}}async function ve(t){k();try{const i=await(await z(t)).text();await Z(i,t)}catch(s){alert(`ファイルの読み込みに失敗しました。${_(s)}`)}}function K(){const t=T.settings.sheets.reduce((i,n,r)=>i!=-1?i:n.status===1?r:i,-1),s=T.settings.sheets[t];if(s){const i={type:"v",order:t};let n="";n+=s.prefixes;let r=s.oneTimeTemplate.matchAll(/<<([A-Za-z]+)(\d+)>>/g),o=[...r].map(d=>`${d[1]}${d[2]}`),l={};for(const d of o){const p=C(d);l[d]=w.getCellValue(p.row,p.col,i)}let u=s.oneTimeTemplate;for(const d of Object.keys(l))u=u.replace(`<<${d}>>`,l[d]);if(n+=u,s.repRange!==""){r=s.oneTimeTemplate.matchAll(/<<([A-Za-z]+)(\d+)>>/g),o=[...r].map(c=>`${c[1]}${c[2]}`),l={};for(const c of o){const h=C(c);l[c]=w.getCellValue(h.row,h.col,i)}u=s.iterationTemplate;for(const c of Object.keys(l))u=u.replace(`<<${c}>>`,l[c]);r=s.iterationTemplate.matchAll(/<<([A-Za-z]+)>>/g),o=[...r].map(c=>c[1]);const d=s.repRange.split(":")[0],p=s.repRange.split(":")[1],b=C(d),m=C(p);let S=0;e:for(let c=b.row;c<=m.row;c++){let h=u;l={};for(const x of o){const y=X(x);if(l[x]=w.getCellValue(c,y,i),l[x]==null){l={},S++;continue e}}for(const x of Object.keys(l))h=h.replace(`<<${x}>>`,l[x]);n+=h}S!==0&&alert(`繰り返し処理中に必要なデータが無かったためにとばした行が${S}行ありました。`)}return n}else return alert("アクティブなシートがありません？！"),null}async function ye(){k();const t=K();try{const s={suggestedName:"rdfsheetfile.ttl",types:[{description:"Turtle(RDF) file",accept:{"text/turtle":[".ttl"]}}]},n=await(await window.showSaveFilePicker(s)).createWritable();await n.write(t),await n.close()}catch(s){alert(`RDFファイルは保存されませんでした。${_(s)}`)}}async function we(t){k();const s=K();try{await z(t,{method:"PUT",headers:{"Content-Type":"text/turtle"},body:s}),alert("RDFをエクスポートしました。")}catch(i){alert(`RDFのエクスポートに失敗しました。${_(i)}`)}}function Te(){window.open("https://github.com/ksaito-hiu/RDFSheet/tree/main/help","help","width=600,height=400,left=100,top=100,resizable=yes,scrollbars=yes")}function be(){window.open("https://github.com/ksaito-hiu/RDFSheet/","about","width=600,height=400,left=100,top=100,resizable=yes,scrollbars=yes")}const X=t=>{const s=t.toUpperCase();let i=0;for(let n=s.length-1;n>=0;n--)i*=25,i+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(s.charAt(n));return i},C=t=>{const s=t.match(/^([A-Za-z]+)(\d+)$/i);if(!s)throw new Error("無効なセル式です。");const[,i,n]=s,r=X(i),o=Number(n)-1;return{col:r,row:o}},Ce=()=>{const t=w.getRangeAxis(),s=w.getAllSheets();let i;for(const n of s)Number(n.status)===1&&(i=n.index.toString());return{range:t[0],sheetIdx:i}},Q="RDFSheetLocalStorageKey",M=window.localStorage,W={prefixes:"@prefix dc: <http://purl.org/dc/terms/> .",idp:"https://solidcommunity.net"},Y=a.createContext(void 0),Ae=({children:t})=>{const[s,i]=a.useState(()=>{const r=M.getItem(Q);if(r)try{const o=JSON.parse(r);if(o&&typeof o=="object")return{...W,...o}}catch(o){return console.warn("設定の読み込みに失敗しました。",o),console.warn("設定を初期化します。"),W}});a.useEffect(()=>{M.setItem(Q,JSON.stringify(s))},[s]);const n=r=>{i(o=>({...o,...r}))};return e.jsx(Y.Provider,{value:{appData:s,updateAppData:n},children:t})},J=()=>{const t=a.useContext(Y);if(!t)throw new Error("useAppData must be used within a AppDataProvider");return t},O=({isVisible:t,onClose:s,children:i})=>{const n=a.useRef(null),r=()=>{s()};return a.useEffect(()=>{const o=n.current;o&&(t?o.open||(o.showModal(),o.addEventListener("close",r)):o.open&&(o.removeEventListener("close",r),o.close()))},[t]),t?e.jsxs("dialog",{ref:n,style:{zIndex:3e3,width:"80%"},children:[e.jsx("div",{style:{border:"black"},children:i}),e.jsx("button",{onClick:()=>{var o;return(o=n.current)==null?void 0:o.close()},children:"close"})]}):null},_e=()=>{const{appData:t,updateAppData:s}=J(),[i,n]=a.useState(D!==null),[r,o]=a.useState(D===null?"not logged in":D),[l,u]=a.useState("https://solidcommunity.net"),[d,p]=a.useState(!1);a.useEffect(()=>{const c=t&&t.idp?t.idp:"https://solidcommunity.net";u(c)},[t]);const b=c=>{u(c.target.value)},m=async()=>{s({idp:l}),await pe(l),o(D===null?"not logged in":D),p(!1)},S=()=>{de(),n(!1),o("not logged in"),p(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("button",{onClick:()=>{p(!0)},children:i?"logout or relogin":"login"}),e.jsxs("span",{style:{marginLeft:"1em"},children:["WebID: ",r]})]}),e.jsxs(O,{isVisible:d,onClose:()=>p(!1),children:[e.jsx("h4",{children:"ログイン・ログアウト"}),e.jsx("p",{children:"ログインしたい時はidpに認証サーバを直接入力するか、代表的な認証サーバのボタンを押し「Login」ボタンを押して下さい。ログアウトしたい時は「Logout」ボタンを押して下さい。"}),e.jsxs("div",{style:{display:"flex"},children:["idp: ",e.jsx("input",{type:"text",value:l,onChange:b,style:{flexGrow:1}}),e.jsx("button",{onClick:m,children:"Login"})]}),e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>{u("https://solidcommunity.net")},children:"Solid Community"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>{u("https://solidweb.me")},children:"solidweb.me"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>{u("https://solidweb.org")},children:"solidweb.org"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>{u("https://login.inrupt.com")},children:"Inrupt Identity Provider"})})]}),e.jsx("p",{children:e.jsx("button",{onClick:S,children:"Logout"})})]})]})},Re="_menu_div_1540h_2",Ie="_hamburger_1540h_9",De="_menu_close_1540h_23",ke="_menu_open_1540h_35",B={menu_div:Re,hamburger:Ie,menu_close:De,menu_open:ke},Le=({onSelect:t})=>{const[s,i]=a.useState(!1),n=r=>{i(!1),t(r)};return e.jsxs("div",{className:B.menu_div,children:[e.jsx("button",{className:B.hamburger,onClick:()=>i(!s),children:s?"×":"☰"}),e.jsx("nav",{className:s?B.menu_open:B.menu_close,children:e.jsxs("ul",{children:[e.jsxs("li",{children:["画面切り替え",e.jsxs("ul",{children:[e.jsx("li",{onClick:()=>{n("sheets")},children:"Sheet"}),e.jsx("li",{onClick:()=>{n("settings")},children:"Settings"}),e.jsx("li",{onClick:()=>{n("appSettings")},children:"AppSettings"})]})]}),e.jsxs("li",{children:["ファイル",e.jsxs("ul",{children:[e.jsx("li",{onClick:()=>{n("load")},children:"Load"}),e.jsx("li",{onClick:()=>{n("save")},children:"Save"}),e.jsx("li",{onClick:()=>{n("import")},children:"Import"}),e.jsx("li",{onClick:()=>{n("export")},children:"Export"})]})]}),e.jsxs("li",{children:["その他",e.jsxs("ul",{children:[e.jsx("li",{onClick:()=>{n("help")},children:"Help"}),e.jsx("li",{onClick:()=>{n("about")},children:"About"})]})]})]})})]})},Fe=({isVisible:t,children:s})=>(a.useEffect(()=>{t&&window.luckysheet.resize()},[t]),e.jsx("div",{style:{display:t?"block":"none",width:"100vw",height:"100%"},children:s})),Ne=({onLoad:t})=>{const s=a.useRef(!1);a.useEffect(()=>{if(s.current)return;s.current=!0;let n;try{const r=localStorage.getItem("RDFSheetTempFile");r?(n=JSON.parse(r),localStorage.removeItem("RDFSheetTempFile")):n={luckysheetfile:void 0,settings:H()}}catch{n={luckysheetfile:void 0,settings:H()}}V(n),k(),t(n.settings)},[]);const i={margin:"0px",padding:"0px",width:"100%",height:"100%"};return e.jsx("div",{id:"luckysheet",style:i})},Pe="_allSettings_6bzdr_3",Oe="_title_6bzdr_22",Ee="_filePathDiv_6bzdr_27",Ue="_selectedSheetDiv_6bzdr_36",$e="_saveBtn_6bzdr_45",qe="_repRangeDiv_6bzdr_49",Be="_prefixDiv_6bzdr_53",ze="_glue_6bzdr_57",Ve="_prefixTA_6bzdr_61",Je="_importPrefixBtn_6bzdr_68",Ge="_oneTimeTemplateTA_6bzdr_72",He="_iterationTemplateTA_6bzdr_79",Qe="_additionalImportUrlsTA_6bzdr_86",Me="_oneTimeImportSparqlTA_6bzdr_93",We="_iterationImportSparqlTA_6bzdr_100",Ze="_pathDiv_6bzdr_107",v={allSettings:Pe,title:Oe,filePathDiv:Ee,selectedSheetDiv:Ue,saveBtn:$e,repRangeDiv:qe,prefixDiv:Be,glue:ze,prefixTA:Ve,importPrefixBtn:Je,oneTimeTemplateTA:Ge,iterationTemplateTA:He,additionalImportUrlsTA:Qe,oneTimeImportSparqlTA:Me,iterationImportSparqlTA:We,pathDiv:Ze},Ke=({settings:t,onChange:s})=>{const[i,n]=a.useState(!1),[r,o]=a.useState(t.sheets[0]),[l,u]=a.useState("iTha4zah"),[d,p]=a.useState(!1),[b,m]=a.useState(!1),S=a.useRef(null),c=a.useRef(null),h=a.useRef(null),x=a.useRef(null),y=a.useRef(null),f=a.useRef(null),L=a.useRef(null),A=a.useRef(null),R=a.useRef(null),{appData:F}=J();a.useEffect(()=>{const g=t.sheets.reduce((j,P)=>j!==null?j:P.status===1?P.index:j,null);E(g)},[t]);const E=g=>{if(d&&!window.confirm("設定を保存せずにシートを変更しますか？"))return;p(!1);const j=t.sheets.reduce((P,G)=>P!==null?P:G.index===g?G:P,null);j?(o(j),u(j.index),m(j.repRange!==""),c.current&&(c.current.value=j.repRange),h.current&&(h.current.value=j.prefixes),x.current&&(x.current.value=j.oneTimeTemplate),y.current&&(y.current.value=j.iterationTemplate),f.current&&(f.current.value=j.additionalImportUrls),L.current&&(L.current.value=j.oneTimeImportSparql),A.current&&(A.current.value=j.iterationImportSparql),R.current&&(R.current.value=j.rdfPodUrl)):console.log(`GAHA: There is no sheet: index=${g}???`)},U=()=>{const g=Ce();if(g.sheetIdx!==l){alert("設定中のシートと、現在アクティブなシートが異なっているので取り込みを中止します。");return}if(g.range.indexOf(":")<0){alert("範囲が選択されていなかったので取り込みを中止します。");return}c.current&&(c.current.value=g.range),p(!0)},N=g=>{h.current&&(h.current.value.endsWith(`
`)||(h.current.value+=`
`),h.current.value+=g.target.textContent,p(!0),n(!1))},q=()=>{c.current&&(c.current.value===""?m(!1):m(!0),p(!0))},ee=()=>{p(!0)},I=()=>{p(!0)},te=()=>{S.current&&(t.fileSettings.podUrl=S.current.value),c.current&&(r.repRange=c.current.value),h.current&&(r.prefixes=h.current.value),x.current&&(r.oneTimeTemplate=x.current.value),y.current&&(r.iterationTemplate=y.current.value),f.current&&(r.additionalImportUrls=f.current.value),L.current&&(r.oneTimeImportSparql=L.current.value),A.current&&(r.iterationImportSparql=A.current.value),R.current&&(r.rdfPodUrl=R.current.value),s(t),p(!1),alert("シートの設定を変更しました。")};return e.jsxs("div",{className:v.allSettings,children:[e.jsxs("div",{className:v.title,children:[e.jsx("h3",{children:"ファイル設定"}),e.jsxs("div",{className:v.filePathDiv,children:[e.jsx("label",{htmlFor:"fileURLTB",children:"ファイルURL"}),e.jsx("input",{ref:S,type:"text",defaultValue:t.fileSettings.podUrl,onChange:ee})]})]}),e.jsx("div",{className:v.selectedSheetDiv,children:e.jsxs("label",{children:["設定するシート:",e.jsx("select",{value:l,onChange:g=>E(g.target.value),name:"selectedSheet",children:t.sheets.map(g=>e.jsx("option",{value:g.index,children:g.name},g.index))}),e.jsx("span",{style:{color:d?"red":"black"},children:d?"シート設定修正あり":"シート設定修正なし"}),e.jsx("button",{className:v.saveBtn,onClick:te,disabled:!d,children:"設定変更"})]})}),e.jsxs("div",{className:v.repRangeDiv,children:["反復範囲:",e.jsx("input",{ref:c,type:"text",defaultValue:r.repRange,onChange:q}),e.jsx("button",{type:"button",onClick:U,children:"選択範囲から取り込み"})]}),e.jsxs("div",{className:v.prefixDiv,children:[e.jsxs("div",{children:[e.jsx("h4",{children:"プレフィックス"}),e.jsx("span",{className:v.glue}),e.jsx("button",{id:"importPrefixBtn",className:v.importPrefixBtn,onClick:()=>n(!0),children:"プレフィックスを取り込む"})]}),e.jsxs(O,{isVisible:i,onClose:()=>n(!1),children:[e.jsx("p",{children:"取り込みたいプレフィックスをクリックして下さい。"}),F.prefixes.split(`
`).map(g=>e.jsx("p",{onClick:N,children:g}))]}),e.jsx("textarea",{ref:h,defaultValue:r.prefixes,className:v.prefixTA,onChange:I})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"1回テンプレート"}),e.jsx("textarea",{ref:x,defaultValue:r.oneTimeTemplate,className:v.oneTimeTemplateTA,onChange:I})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"反復テンプレート"}),e.jsx("textarea",{ref:y,defaultValue:r.iterationTemplate,className:v.iterationTemplateTA,onChange:I,disabled:!b})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"追加インポートRDFのURL"}),e.jsx("textarea",{ref:f,defaultValue:r.additionalImportUrls,className:v.additionalImportUrlsTA,onChange:I})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"1回インポートSPARQL"}),e.jsx("textarea",{ref:L,defaultValue:r.oneTimeImportSparql,className:v.oneTimeImportSparqlTA,onChange:I})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"反復インポートSPARQL"}),e.jsx("textarea",{ref:A,defaultValue:r.iterationImportSparql,className:v.iterationImportSparqlTA,onChange:I})]}),e.jsxs("div",{className:v.pathDiv,children:[e.jsx("label",{htmlFor:"rdfURLTB",children:"RDF URL"}),e.jsx("input",{ref:R,type:"text",defaultValue:r.rdfPodUrl,onChange:I})]})]})},Xe="_allAppSettings_plc8o_3",Ye="_prefixesDiv_plc8o_10",et="_prefixesTA_plc8o_15",tt="_idpDiv_plc8o_20",st="_idpTB_plc8o_26",$={allAppSettings:Xe,prefixesDiv:Ye,prefixesTA:et,idpDiv:tt,idpTB:st},nt=()=>{const{appData:t,updateAppData:s}=J(),i=a.useRef(null),n=a.useRef(null),r=()=>{var l,u;const o={prefixes:(l=i.current)==null?void 0:l.value,idp:(u=n.current)==null?void 0:u.value};s(o),alert("アプリ設定を保存しました。")};return e.jsxs("div",{className:$.allAppSettings,children:[e.jsx("h3",{children:"AppSettings"}),e.jsx("p",{children:"編集中のファイルではなくアプリの設定をします。"}),e.jsx("h4",{children:"プレフィックス"}),e.jsx("div",{className:$.prefixesDiv,children:e.jsx("textarea",{ref:i,className:$.prefixesTA,defaultValue:t.prefixes})}),e.jsx("h4",{children:"デフォルトのログイン場所"}),e.jsx("div",{className:$.idpDiv,children:e.jsx("input",{ref:n,className:$.idpTB,defaultValue:t.idp})}),e.jsx("button",{onClick:r,children:"変更"})]})},rt=({settings:t,onLoaded:s})=>{const i=a.useRef(null);a.useEffect(()=>{const o=t.fileSettings.podUrl;o&&i.current&&(i.current.value=o)},[t]);const n=async()=>{await me(),s()},r=async()=>{if(!i.current)return;const o=i.current.value;await xe(o),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"LoadComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:n,children:"load from local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:r,children:"load from pod"}),e.jsx("input",{type:"text",ref:i,style:{flexGrow:1}})]})]})},ot=({settings:t,onSaved:s})=>{const i=a.useRef(null);a.useEffect(()=>{const o=t.fileSettings.podUrl;o&&i.current&&(i.current.value=o)},[t]);const n=()=>{ge(),s()},r=()=>{if(!i.current)return;const o=i.current.value;Se(o),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"SaveComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:n,children:"save to local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:r,children:"save to pod"}),e.jsx("input",{type:"text",ref:i,style:{flexGrow:1}})]})]})},it=({settings:t,onImported:s})=>{const i=a.useRef(null);a.useEffect(()=>{const o=t.sheets.reduce((l,u)=>l!==null?l:u.status===1?u.rdfPodUrl:l,null);o&&i.current&&(i.current.value=o)},[t]);const n=()=>{je(),s()},r=()=>{if(!i.current)return;const o=i.current.value;ve(o),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"ImportComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:n,children:"import from local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:r,children:"import from pod"}),e.jsx("input",{type:"text",ref:i,style:{flexGrow:1}})]})]})},lt=({settings:t,onExported:s})=>{const i=a.useRef(null);a.useEffect(()=>{const o=t.sheets.reduce((l,u)=>l!==null?l:u.status===1?u.rdfPodUrl:l,null);o&&i.current&&(i.current.value=o)},[t]);const n=()=>{ye(),s()},r=()=>{if(!i.current)return;const o=i.current.value;we(o),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"ExportComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:n,children:"export to local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:r,children:"export to pod"}),e.jsx("input",{type:"text",ref:i,style:{flexGrow:1}})]})]})},at=()=>{const[t,s]=a.useState(T.settings),[i,n]=a.useState(!0),[r,o]=a.useState(!1),[l,u]=a.useState(!1),[d,p]=a.useState(!1),[b,m]=a.useState(!1),[S,c]=a.useState(!1),[h,x]=a.useState(!1),y=f=>{f==="sheets"?(n(!0),o(!1),u(!1)):f==="settings"?(s(k()),n(!1),o(!0),u(!1)):f==="appSettings"?(n(!1),o(!1),u(!0)):f==="load"?p(!0):f==="save"?m(!0):f==="import"?c(!0):f==="export"?x(!0):f==="help"?Te():f==="about"?be():console.log("GAHA: ????????")};return e.jsxs(Ae,{children:[e.jsxs("header",{children:[e.jsx(Le,{onSelect:y}),e.jsx(_e,{})]}),e.jsxs("main",{children:[e.jsx(Fe,{isVisible:i,children:e.jsx(Ne,{onLoad:f=>s(f)})}),r===!0?e.jsx(Ke,{settings:t,onChange:f=>s(f)}):null,l===!0?e.jsx(nt,{}):null]}),e.jsx(O,{isVisible:d,onClose:()=>p(!1),children:e.jsx(rt,{settings:t,onLoaded:()=>{p(!1),s(T.settings)}})}),e.jsx(O,{isVisible:b,onClose:()=>m(!1),children:e.jsx(ot,{settings:t,onSaved:()=>m(!1)})}),e.jsx(O,{isVisible:S,onClose:()=>c(!1),children:e.jsx(it,{settings:t,onImported:()=>c(!1)})}),e.jsx(O,{isVisible:h,onClose:()=>x(!1),children:e.jsx(lt,{settings:t,onExported:()=>x(!1)})})]})};async function ct(){await fe();const t=window;let s=null;t.launchQueue&&t.launchQueue.setConsumer&&t.launchQueue.setConsumer(async i=>{s||i.files.length&&(s=new Promise(async n=>{const l=await(await i.files[0].getFile()).text();localStorage.setItem("RDFSheetTempFile",l),n()}))}),s&&await s,se.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(at,{})}))}ct();
