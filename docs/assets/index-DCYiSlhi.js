import{r as a,j as e,a as se}from"./react-BL4LEYSH.js";import{i as ne,N as re,a as oe}from"./vendor-C8VTLH0V.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();const{handleIncomingRedirect:ie,login:le,logout:ae,fetch:ce}=window.solidClientAuthentication,U=ce;async function ue(t,s,i){return new Promise((r,n)=>{const o={format:"text/turtle",baseIRI:i};new oe(o).parse(t,(u,p,d)=>{u?n(u):p?s.addQuad(p):r(d)})})}const de=async t=>{await le({oidcIssuer:t})},pe=()=>{ae()};let _=null;async function fe(){const t=await ie();t&&t.isLoggedIn?t.webId&&(_=t.webId):_=null}const b=window.luckysheet,y={settings:{sheets:[],fileSettings:{podUrl:""}}},he=()=>({index:"iTha4zah",name:"??????????",status:0,repRange:"",prefixes:"",oneTimeTemplate:"",iterationTemplate:"",additionalImportUrls:"",oneTimeImportSparql:"",iterationImportSparql:"",rdfPodUrl:"https://example.org/my_pod/rdfsheet.ttl"}),z=()=>({sheets:[],fileSettings:{podUrl:"https://example.org/my_pod/rdfsheet.rdfs"}}),R=()=>{const t=b.getAllSheets(),s=y.settings.sheets,i=[];return t.forEach(r=>{const n=s.reduce((o,l)=>o||(l.index===r.index.toString()?l:o),null);if(n!==null)n.name=r.name,n.status=Number(r.status),i.push(n);else{const o=he();o.index=r.index.toString(),o.name=r.name,o.status=Number(r.status),i.push(o)}}),y.settings.sheets=i,y.settings};function A(t){return t instanceof Error?t.message:String(t)}function E(t){const s={container:"luckysheet",data:void 0,showinfobar:!1,showtoolbar:!0,sheetFormulaBar:!0,showsheetbar:!0,showstatisticBar:!0};t.luckysheetfile&&(s.data=t.luckysheetfile),t.settings&&(y.settings=t.settings),b.create(s),R()}async function me(){try{const t={types:[{description:"RDFSheet file",accept:{"application/x-rdfsheet+json":[".rdfs"]}}]},[s]=await window.showOpenFilePicker(t),r=await(await s.getFile()).text(),n=JSON.parse(r);E(n)}catch(t){alert(`ファイルは開かれませんでした。${A(t)}`)}}async function xe(t){try{const i=await(await U(t)).json();E(i)}catch(s){alert(`ファイルの読み込みに失敗しました。${A(s)}`)}}async function ge(){try{const t={luckysheetfile:b.getluckysheetfile(),settings:JSON.parse(JSON.stringify(y.settings))},s={suggestedName:"rdfsheetfile.rdfs",types:[{description:"RDFSheet file",accept:{"application/x-rdfsheet+json":[".rdfs"]}}]},r=await(await window.showSaveFilePicker(s)).createWritable();await r.write(JSON.stringify(t)),await r.close()}catch(t){alert(`ファイルは保存されませんでした。${A(t)}`)}}async function Se(t){try{const s={luckysheetfile:b.getluckysheetfile(),settings:JSON.parse(JSON.stringify(y.settings))};await U(t,{method:"PUT",headers:{"Content-Type":"application/x-rdfsheet+json"},body:JSON.stringify(s)}),alert("ファイルを保存しました。")}catch(s){alert(`ファイルの保存に失敗しました。${A(s)}`)}}async function H(t,s){const i=y.settings.sheets.reduce((n,o,l)=>n!=-1?n:o.status===1?l:n,-1),r=y.settings.sheets[i];if(r)try{const n=new ne.QueryEngine,o=new re;await ue(t,o,s);const l=[o];for(const c of r.additionalImportUrls.split(`
`))c!==""&&l.push(c);const u=`BASE <${s}>
`+r.oneTimeImportSparql,d=await(await n.queryBindings(u,{sources:l})).toArray();if(d.length>=1)for(const[c,f]of d[0])console.log(`GAHA: ${c.value}<=${f.value}`);else alert("The result of oneTimeSparql is empty.");const T=`BASE <${s}>
`+r.iterationImportSparql,j=await(await n.queryBindings(T,{sources:l})).toArray();alert(`The result count of iterationImportSparql is ${j.length}.`);for(const c of j)for(const[f,m]of c)console.log(`GAHA2: ${f.value}<=${m.value}`)}catch(n){throw n}else return alert("アクティブなシートがありません？！"),null}async function je(){R();try{const t={types:[{description:"Turtle(RDF) file",accept:{"text/turtle":[".ttl"]}}]},[s]=await window.showOpenFilePicker(t),i=await s.getFile(),r=await i.text(),n=`file:///C:/Users/me/RDFSheet/${i.name}`;await H(r,n)}catch(t){alert(`ファイルは開かれませんでした。${A(t)}`)}}async function ve(t){R();try{const i=await(await U(t)).text();await H(i,t)}catch(s){alert(`ファイルの読み込みに失敗しました。${A(s)}`)}}function Q(){const t=y.settings.sheets.reduce((i,r,n)=>i!=-1?i:r.status===1?n:i,-1),s=y.settings.sheets[t];if(s){const i={type:"v",order:t};let r="";r+=s.prefixes;let n=s.oneTimeTemplate.matchAll(/<<([A-Za-z]+)(\d+)>>/g),o=[...n].map(p=>`${p[1]}${p[2]}`),l={};for(const p of o){const d=P(p);l[p]=b.getCellValue(d.row,d.col,i)}let u=s.oneTimeTemplate;for(const p of Object.keys(l))u=u.replace(`<<${p}>>`,l[p]);if(r+=u,s.repRange!==""){n=s.oneTimeTemplate.matchAll(/<<([A-Za-z]+)(\d+)>>/g),o=[...n].map(c=>`${c[1]}${c[2]}`),l={};for(const c of o){const f=P(c);l[c]=b.getCellValue(f.row,f.col,i)}u=s.iterationTemplate;for(const c of Object.keys(l))u=u.replace(`<<${c}>>`,l[c]);n=s.iterationTemplate.matchAll(/<<([A-Za-z]+)>>/g),o=[...n].map(c=>c[1]);const p=s.repRange.split(":")[0],d=s.repRange.split(":")[1],T=P(p),v=P(d);let j=0;e:for(let c=T.row;c<=v.row;c++){let f=u;l={};for(const m of o){const w=M(m);if(l[m]=b.getCellValue(c,w,i),l[m]==null){l={},j++;continue e}}for(const m of Object.keys(l))f=f.replace(`<<${m}>>`,l[m]);r+=f}j!==0&&alert(`繰り返し処理中に必要なデータが無かったためにとばした行が${j}行ありました。`)}return r}else return alert("アクティブなシートがありません？！"),null}async function ye(){R();const t=Q();try{const s={suggestedName:"rdfsheetfile.ttl",types:[{description:"Turtle(RDF) file",accept:{"text/turtle":[".ttl"]}}]},r=await(await window.showSaveFilePicker(s)).createWritable();await r.write(t),await r.close()}catch(s){alert(`RDFファイルは保存されませんでした。${A(s)}`)}}async function Te(t){R();const s=Q();try{await U(t,{method:"PUT",headers:{"Content-Type":"text/turtle"},body:s}),alert("RDFをエクスポートしました。")}catch(i){alert(`RDFのエクスポートに失敗しました。${A(i)}`)}}function we(){window.open("https://github.com/ksaito-hiu/RDFSheet/tree/main/help","help","width=600,height=400,left=100,top=100,resizable=yes,scrollbars=yes")}function be(){window.open("https://github.com/ksaito-hiu/RDFSheet/","about","width=600,height=400,left=100,top=100,resizable=yes,scrollbars=yes")}const M=t=>{const s=t.toUpperCase();let i=0;for(let r=s.length-1;r>=0;r--)i*=25,i+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(s.charAt(r));return i},P=t=>{const s=t.match(/^([A-Za-z]+)(\d+)$/i);if(!s)throw new Error("無効なセル式です。");const[,i,r]=s,n=M(i),o=Number(r)-1;return{col:n,row:o}},Ae=()=>{const t=b.getRangeAxis(),s=b.getAllSheets();let i;for(const r of s)Number(r.status)===1&&(i=r.index.toString());return{range:t[0],sheetIdx:i}},V="RDFSheetLocalStorageKey",J=window.localStorage,G={prefixes:"@prefix dc: <http://purl.org/dc/terms/> .",idp:"https://solidcommunity.net"},W=a.createContext(void 0),Ce=({children:t})=>{const[s,i]=a.useState(()=>{const n=J.getItem(V);if(n)try{const o=JSON.parse(n);if(o&&typeof o=="object")return{...G,...o}}catch(o){return console.warn("設定の読み込みに失敗しました。",o),console.warn("設定を初期化します。"),G}});a.useEffect(()=>{J.setItem(V,JSON.stringify(s))},[s]);const r=n=>{i(o=>({...o,...n}))};return e.jsx(W.Provider,{value:{appData:s,updateAppData:r},children:t})},$=()=>{const t=a.useContext(W);if(!t)throw new Error("useAppData must be used within a AppDataProvider");return t},D=({isVisible:t,onClose:s,children:i})=>{const r=a.useRef(null),n=()=>{s()};return a.useEffect(()=>{const o=r.current;o&&(t?o.open||(o.showModal(),o.addEventListener("close",n)):o.open&&(o.removeEventListener("close",n),o.close()))},[t]),t?e.jsxs("dialog",{ref:r,style:{zIndex:3e3,width:"80%"},children:[e.jsx("div",{style:{border:"black"},children:i}),e.jsx("button",{onClick:()=>{var o;return(o=r.current)==null?void 0:o.close()},children:"close"})]}):null},_e=()=>{const{appData:t,updateAppData:s}=$(),[i,r]=a.useState(_!==null),[n,o]=a.useState(_===null?"not logged in":_),[l,u]=a.useState("https://solidcommunity.net"),[p,d]=a.useState(!1);a.useEffect(()=>{const c=t&&t.idp?t.idp:"https://solidcommunity.net";u(c)},[t]);const T=c=>{u(c.target.value)},v=async()=>{s({idp:l}),await de(l),o(_===null?"not logged in":_),d(!1)},j=()=>{pe(),r(!1),o("not logged in"),d(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("button",{onClick:()=>{d(!0)},children:i?"logout or relogin":"login"}),e.jsxs("span",{style:{marginLeft:"1em"},children:["WebID: ",n]})]}),e.jsxs(D,{isVisible:p,onClose:()=>d(!1),children:[e.jsx("h4",{children:"ログイン・ログアウト"}),e.jsx("p",{children:"ログインしたい時はidpに認証サーバを直接入力するか、代表的な認証サーバのボタンを押し「Login」ボタンを押して下さい。ログアウトしたい時は「Logout」ボタンを押して下さい。"}),e.jsxs("div",{style:{display:"flex"},children:["idp: ",e.jsx("input",{type:"text",value:l,onChange:T,style:{flexGrow:1}}),e.jsx("button",{onClick:v,children:"Login"})]}),e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>{u("https://solidcommunity.net")},children:"Solid Community"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>{u("https://solidweb.me")},children:"solidweb.me"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>{u("https://solidweb.org")},children:"solidweb.org"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>{u("https://login.inrupt.com")},children:"Inrupt Identity Provider"})})]}),e.jsx("p",{children:e.jsx("button",{onClick:j,children:"Logout"})})]})]})},Re="_menu_div_1540h_2",Ie="_hamburger_1540h_9",De="_menu_close_1540h_23",ke="_menu_open_1540h_35",O={menu_div:Re,hamburger:Ie,menu_close:De,menu_open:ke},Le=({onSelect:t})=>{const[s,i]=a.useState(!1),r=n=>{i(!1),t(n)};return e.jsxs("div",{className:O.menu_div,children:[e.jsx("button",{className:O.hamburger,onClick:()=>i(!s),children:s?"×":"☰"}),e.jsx("nav",{className:s?O.menu_open:O.menu_close,children:e.jsxs("ul",{children:[e.jsxs("li",{children:["画面切り替え",e.jsxs("ul",{children:[e.jsx("li",{onClick:()=>{r("sheets")},children:"Sheet"}),e.jsx("li",{onClick:()=>{r("settings")},children:"Settings"}),e.jsx("li",{onClick:()=>{r("appSettings")},children:"AppSettings"})]})]}),e.jsxs("li",{children:["ファイル",e.jsxs("ul",{children:[e.jsx("li",{onClick:()=>{r("load")},children:"Load"}),e.jsx("li",{onClick:()=>{r("save")},children:"Save"}),e.jsx("li",{onClick:()=>{r("import")},children:"Import"}),e.jsx("li",{onClick:()=>{r("export")},children:"Export"})]})]}),e.jsxs("li",{children:["その他",e.jsxs("ul",{children:[e.jsx("li",{onClick:()=>{r("help")},children:"Help"}),e.jsx("li",{onClick:()=>{r("about")},children:"About"})]})]})]})})]})},Fe=({isVisible:t,children:s})=>(a.useEffect(()=>{t&&window.luckysheet.resize()},[t]),e.jsx("div",{style:{display:t?"block":"none",width:"100vw",height:"100%"},children:s})),Ne=({onLoad:t})=>{const s=a.useRef(!1);a.useEffect(()=>{if(s.current)return;s.current=!0;let r;try{const n=localStorage.getItem("RDFSheetTempFile");n?(r=JSON.parse(n),localStorage.removeItem("RDFSheetTempFile")):r={luckysheetfile:void 0,settings:z()}}catch{r={luckysheetfile:void 0,settings:z()}}E(r),R(),t(r.settings)},[]);const i={margin:"0px",padding:"0px",width:"100%",height:"100%"};return e.jsx("div",{id:"luckysheet",style:i})},Pe="_allSettings_6bzdr_3",Oe="_title_6bzdr_22",Ue="_filePathDiv_6bzdr_27",Ee="_selectedSheetDiv_6bzdr_36",$e="_saveBtn_6bzdr_45",Be="_repRangeDiv_6bzdr_49",qe="_prefixDiv_6bzdr_53",ze="_glue_6bzdr_57",Ve="_prefixTA_6bzdr_61",Je="_importPrefixBtn_6bzdr_68",Ge="_oneTimeTemplateTA_6bzdr_72",He="_iterationTemplateTA_6bzdr_79",Qe="_additionalImportUrlsTA_6bzdr_86",Me="_oneTimeImportSparqlTA_6bzdr_93",We="_iterationImportSparqlTA_6bzdr_100",Ze="_pathDiv_6bzdr_107",S={allSettings:Pe,title:Oe,filePathDiv:Ue,selectedSheetDiv:Ee,saveBtn:$e,repRangeDiv:Be,prefixDiv:qe,glue:ze,prefixTA:Ve,importPrefixBtn:Je,oneTimeTemplateTA:Ge,iterationTemplateTA:He,additionalImportUrlsTA:Qe,oneTimeImportSparqlTA:Me,iterationImportSparqlTA:We,pathDiv:Ze},Ke=({settings:t,onChange:s})=>{const[i,r]=a.useState(!1),[n,o]=a.useState(t.sheets[0]),[l,u]=a.useState("iTha4zah"),[p,d]=a.useState(!1),[T,v]=a.useState(!1),j=a.useRef(null),c=a.useRef(null),f=a.useRef(null),m=a.useRef(null),w=a.useRef(null),h=a.useRef(null),k=a.useRef(null),L=a.useRef(null),F=a.useRef(null),{appData:Z}=$();a.useEffect(()=>{const x=t.sheets.reduce((g,I)=>g!==null?g:I.status===1?I.index:g,null);B(x)},[t]);const B=x=>{if(p&&!window.confirm("設定を保存せずにシートを変更しますか？"))return;d(!1);const g=t.sheets.reduce((I,q)=>I!==null?I:q.index===x?q:I,null);g?(o(g),u(g.index),v(g.repRange!==""),c.current&&(c.current.value=g.repRange),f.current&&(f.current.value=g.prefixes),m.current&&(m.current.value=g.oneTimeTemplate),w.current&&(w.current.value=g.iterationTemplate),h.current&&(h.current.value=g.additionalImportUrls),k.current&&(k.current.value=g.oneTimeImportSparql),L.current&&(L.current.value=g.iterationImportSparql),F.current&&(F.current.value=g.rdfPodUrl)):console.log(`GAHA: There is no sheet: index=${x}???`)},K=()=>{const x=Ae();if(x.sheetIdx!==l){alert("設定中のシートと、現在アクティブなシートが異なっているので取り込みを中止します。");return}if(x.range.indexOf(":")<0){alert("範囲が選択されていなかったので取り込みを中止します。");return}c.current&&(c.current.value=x.range),d(!0)},X=x=>{f.current&&(f.current.value.endsWith(`
`)||(f.current.value+=`
`),f.current.value+=x.target.textContent,d(!0),r(!1))},Y=()=>{c.current&&(c.current.value===""?v(!1):v(!0),d(!0))},ee=()=>{d(!0)},C=()=>{d(!0)},te=()=>{j.current&&(t.fileSettings.podUrl=j.current.value),c.current&&(n.repRange=c.current.value),f.current&&(n.prefixes=f.current.value),m.current&&(n.oneTimeTemplate=m.current.value),w.current&&(n.iterationTemplate=w.current.value),h.current&&(n.additionalImportUrls=h.current.value),k.current&&(n.oneTimeImportSparql=k.current.value),L.current&&(n.iterationImportSparql=L.current.value),F.current&&(n.rdfPodUrl=F.current.value),s(t),d(!1),alert("シートの設定を変更しました。")};return e.jsxs("div",{className:S.allSettings,children:[e.jsxs("div",{className:S.title,children:[e.jsx("h3",{children:"ファイル設定"}),e.jsxs("div",{className:S.filePathDiv,children:[e.jsx("label",{htmlFor:"fileURLTB",children:"ファイルURL"}),e.jsx("input",{ref:j,type:"text",defaultValue:t.fileSettings.podUrl,onChange:ee})]})]}),e.jsx("div",{className:S.selectedSheetDiv,children:e.jsxs("label",{children:["設定するシート:",e.jsx("select",{value:l,onChange:x=>B(x.target.value),name:"selectedSheet",children:t.sheets.map(x=>e.jsx("option",{value:x.index,children:x.name},x.index))}),e.jsx("span",{style:{color:p?"red":"black"},children:p?"シート設定修正あり":"シート設定修正なし"}),e.jsx("button",{className:S.saveBtn,onClick:te,disabled:!p,children:"設定変更"})]})}),e.jsxs("div",{className:S.repRangeDiv,children:["反復範囲:",e.jsx("input",{ref:c,type:"text",defaultValue:n.repRange,onChange:Y}),e.jsx("button",{type:"button",onClick:K,children:"選択範囲から取り込み"})]}),e.jsxs("div",{className:S.prefixDiv,children:[e.jsxs("div",{children:[e.jsx("h4",{children:"プレフィックス"}),e.jsx("span",{className:S.glue}),e.jsx("button",{id:"importPrefixBtn",className:S.importPrefixBtn,onClick:()=>r(!0),children:"プレフィックスを取り込む"})]}),e.jsxs(D,{isVisible:i,onClose:()=>r(!1),children:[e.jsx("p",{children:"取り込みたいプレフィックスをクリックして下さい。"}),Z.prefixes.split(`
`).map(x=>e.jsx("p",{onClick:X,children:x}))]}),e.jsx("textarea",{ref:f,defaultValue:n.prefixes,className:S.prefixTA,onChange:C})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"1回テンプレート"}),e.jsx("textarea",{ref:m,defaultValue:n.oneTimeTemplate,className:S.oneTimeTemplateTA,onChange:C})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"反復テンプレート"}),e.jsx("textarea",{ref:w,defaultValue:n.iterationTemplate,className:S.iterationTemplateTA,onChange:C,disabled:!T})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"追加インポートRDFのURL"}),e.jsx("textarea",{ref:h,defaultValue:n.additionalImportUrls,className:S.additionalImportUrlsTA,onChange:C})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"1回インポートSPARQL"}),e.jsx("textarea",{ref:k,defaultValue:n.oneTimeImportSparql,className:S.oneTimeImportSparqlTA,onChange:C})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"反復インポートSPARQL"}),e.jsx("textarea",{ref:L,defaultValue:n.iterationImportSparql,className:S.iterationImportSparqlTA,onChange:C})]}),e.jsxs("div",{className:S.pathDiv,children:[e.jsx("label",{htmlFor:"rdfURLTB",children:"RDF URL"}),e.jsx("input",{ref:F,type:"text",defaultValue:n.rdfPodUrl,onChange:C})]})]})},Xe="_allAppSettings_plc8o_3",Ye="_prefixesDiv_plc8o_10",et="_prefixesTA_plc8o_15",tt="_idpDiv_plc8o_20",st="_idpTB_plc8o_26",N={allAppSettings:Xe,prefixesDiv:Ye,prefixesTA:et,idpDiv:tt,idpTB:st},nt=()=>{const{appData:t,updateAppData:s}=$(),i=a.useRef(null),r=a.useRef(null),n=()=>{var l,u;const o={prefixes:(l=i.current)==null?void 0:l.value,idp:(u=r.current)==null?void 0:u.value};s(o),alert("アプリ設定を保存しました。")};return e.jsxs("div",{className:N.allAppSettings,children:[e.jsx("h3",{children:"AppSettings"}),e.jsx("p",{children:"編集中のファイルではなくアプリの設定をします。"}),e.jsx("h4",{children:"プレフィックス"}),e.jsx("div",{className:N.prefixesDiv,children:e.jsx("textarea",{ref:i,className:N.prefixesTA,defaultValue:t.prefixes})}),e.jsx("h4",{children:"デフォルトのログイン場所"}),e.jsx("div",{className:N.idpDiv,children:e.jsx("input",{ref:r,className:N.idpTB,defaultValue:t.idp})}),e.jsx("button",{onClick:n,children:"変更"})]})},rt=({settings:t,onLoaded:s})=>{const i=a.useRef(null);a.useEffect(()=>{const o=t.fileSettings.podUrl;o&&i.current&&(i.current.value=o)},[t]);const r=async()=>{await me(),s()},n=async()=>{if(!i.current)return;const o=i.current.value;await xe(o),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"LoadComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:r,children:"load from local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:n,children:"load from pod"}),e.jsx("input",{type:"text",ref:i,style:{flexGrow:1}})]})]})},ot=({settings:t,onSaved:s})=>{const i=a.useRef(null);a.useEffect(()=>{const o=t.fileSettings.podUrl;o&&i.current&&(i.current.value=o)},[t]);const r=()=>{ge(),s()},n=()=>{if(!i.current)return;const o=i.current.value;Se(o),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"SaveComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:r,children:"save to local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:n,children:"save to pod"}),e.jsx("input",{type:"text",ref:i,style:{flexGrow:1}})]})]})},it=({settings:t,onImported:s})=>{const i=a.useRef(null);a.useEffect(()=>{const o=t.sheets.reduce((l,u)=>l!==null?l:u.status===1?u.rdfPodUrl:l,null);o&&i.current&&(i.current.value=o)},[t]);const r=()=>{je(),s()},n=()=>{if(!i.current)return;const o=i.current.value;ve(o),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"ImportComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:r,children:"import from local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:n,children:"import from pod"}),e.jsx("input",{type:"text",ref:i,style:{flexGrow:1}})]})]})},lt=({settings:t,onExported:s})=>{const i=a.useRef(null);a.useEffect(()=>{const o=t.sheets.reduce((l,u)=>l!==null?l:u.status===1?u.rdfPodUrl:l,null);o&&i.current&&(i.current.value=o)},[t]);const r=()=>{ye(),s()},n=()=>{if(!i.current)return;const o=i.current.value;Te(o),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"ExportComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:r,children:"export to local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:n,children:"export to pod"}),e.jsx("input",{type:"text",ref:i,style:{flexGrow:1}})]})]})},at=()=>{const[t,s]=a.useState(y.settings),[i,r]=a.useState(!0),[n,o]=a.useState(!1),[l,u]=a.useState(!1),[p,d]=a.useState(!1),[T,v]=a.useState(!1),[j,c]=a.useState(!1),[f,m]=a.useState(!1),w=h=>{h==="sheets"?(r(!0),o(!1),u(!1)):h==="settings"?(s(R()),r(!1),o(!0),u(!1)):h==="appSettings"?(r(!1),o(!1),u(!0)):h==="load"?d(!0):h==="save"?v(!0):h==="import"?c(!0):h==="export"?m(!0):h==="help"?we():h==="about"?be():console.log("GAHA: ????????")};return e.jsxs(Ce,{children:[e.jsxs("header",{children:[e.jsx(Le,{onSelect:w}),e.jsx(_e,{})]}),e.jsxs("main",{children:[e.jsx(Fe,{isVisible:i,children:e.jsx(Ne,{onLoad:h=>s(h)})}),n===!0?e.jsx(Ke,{settings:t,onChange:h=>s(h)}):null,l===!0?e.jsx(nt,{}):null]}),e.jsx(D,{isVisible:p,onClose:()=>d(!1),children:e.jsx(rt,{settings:t,onLoaded:()=>{d(!1),s(y.settings)}})}),e.jsx(D,{isVisible:T,onClose:()=>v(!1),children:e.jsx(ot,{settings:t,onSaved:()=>v(!1)})}),e.jsx(D,{isVisible:j,onClose:()=>c(!1),children:e.jsx(it,{settings:t,onImported:()=>c(!1)})}),e.jsx(D,{isVisible:f,onClose:()=>m(!1),children:e.jsx(lt,{settings:t,onExported:()=>m(!1)})})]})};async function ct(){await fe();const t=window;let s=null;t.launchQueue&&t.launchQueue.setConsumer&&t.launchQueue.setConsumer(async i=>{s||i.files.length&&(s=new Promise(async r=>{const l=await(await i.files[0].getFile()).text();localStorage.setItem("RDFSheetTempFile",l),r()}))}),s&&await s,se.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(at,{})}))}ct();
