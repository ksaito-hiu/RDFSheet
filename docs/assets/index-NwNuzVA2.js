const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/comunica-BdwTORIa.js","assets/vendor-BKZlLRR3.js"])))=>i.map(i=>d[i]);
import{r as c,j as e,c as ne}from"./react-DftWhuyD.js";import{Q as re,R as oe}from"./vendor-BKZlLRR3.js";import"./comunica-BdwTORIa.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}})();const ie="modulepreload",le=function(t){return"/RDFSheet/"+t},z={},ae=function(s,o,i){let r=Promise.resolve();if(o&&o.length>0){let l=function(d){return Promise.all(d.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),p=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=l(o.map(d=>{if(d=le(d),d in z)return;z[d]=!0;const v=d.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${x}`))return;const h=document.createElement("link");if(h.rel=v?"stylesheet":ie,v||(h.as="script"),h.crossOrigin="",h.href=d,p&&h.setAttribute("nonce",p),document.head.appendChild(h),v)return new Promise((u,f)=>{h.addEventListener("load",u),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${d}`)))})}))}function n(l){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=l,window.dispatchEvent(a),!a.defaultPrevented)throw l}return r.then(l=>{for(const a of l||[])a.status==="rejected"&&n(a.reason);return s().catch(n)})},{handleIncomingRedirect:ce,login:ue,logout:de,fetch:pe}=window.solidClientAuthentication,O=pe;async function fe(t,s,o){return new Promise((i,r)=>{const n={format:"text/turtle",baseIRI:o};new oe(n).parse(t,(a,p,d)=>{a?r(a):p?s.addQuad(p):i(d)})})}const he=async t=>{await ue({oidcIssuer:t})},me=()=>{de()};let C=null;async function xe(){const t=await ce();t&&t.isLoggedIn?t.webId&&(C=t.webId):C=null}const b=window.luckysheet,T={settings:{sheets:[],fileSettings:{podUrl:""}}},ge=()=>({index:"iTha4zah",name:"??????????",status:0,repRange:"",prefixes:"",oneTimeTemplate:"",iterationTemplate:"",additionalImportUrls:"",oneTimeImportSparql:"",iterationImportSparql:"",rdfPodUrl:"https://example.org/my_pod/rdfsheet.ttl"}),V=()=>({sheets:[],fileSettings:{podUrl:"https://example.org/my_pod/rdfsheet.rdfs"}}),R=()=>{const t=b.getAllSheets(),s=T.settings.sheets,o=[];return t.forEach(i=>{const r=s.reduce((n,l)=>n||(l.index===i.index.toString()?l:n),null);if(r!==null)r.name=i.name,r.status=Number(i.status),o.push(r);else{const n=ge();n.index=i.index.toString(),n.name=i.name,n.status=Number(i.status),o.push(n)}}),T.settings.sheets=o,T.settings};function A(t){return t instanceof Error?t.message:String(t)}function U(t){const s={container:"luckysheet",data:void 0,showinfobar:!1,showtoolbar:!0,sheetFormulaBar:!0,showsheetbar:!0,showstatisticBar:!0};t.luckysheetfile&&(s.data=t.luckysheetfile),t.settings&&(T.settings=t.settings),b.create(s),R()}async function Se(){try{const t={types:[{description:"RDFSheet file",accept:{"application/x-rdfsheet+json":[".rdfs"]}}]},[s]=await window.showOpenFilePicker(t),i=await(await s.getFile()).text(),r=JSON.parse(i);U(r)}catch(t){alert(`ファイルは開かれませんでした。${A(t)}`)}}async function ve(t){try{const o=await(await O(t)).json();U(o)}catch(s){alert(`ファイルの読み込みに失敗しました。${A(s)}`)}}async function je(){try{const t={luckysheetfile:b.getluckysheetfile(),settings:JSON.parse(JSON.stringify(T.settings))},s={suggestedName:"rdfsheetfile.rdfs",types:[{description:"RDFSheet file",accept:{"application/x-rdfsheet+json":[".rdfs"]}}]},i=await(await window.showSaveFilePicker(s)).createWritable();await i.write(JSON.stringify(t)),await i.close()}catch(t){alert(`ファイルは保存されませんでした。${A(t)}`)}}async function ye(t){try{const s={luckysheetfile:b.getluckysheetfile(),settings:JSON.parse(JSON.stringify(T.settings))};await O(t,{method:"PUT",headers:{"Content-Type":"application/x-rdfsheet+json"},body:JSON.stringify(s)}),alert("ファイルを保存しました。")}catch(s){alert(`ファイルの保存に失敗しました。${A(s)}`)}}async function H(t,s){const{QueryEngine:o}=await ae(async()=>{const{QueryEngine:n}=await import("./comunica-BdwTORIa.js").then(l=>l.i);return{QueryEngine:n}},__vite__mapDeps([0,1])),i=T.settings.sheets.reduce((n,l,a)=>n!=-1?n:l.status===1?a:n,-1),r=T.settings.sheets[i];if(r)try{const n=new o,l=new re;await fe(t,l,s);const a=[l];for(const f of r.additionalImportUrls.split(`
`))f!==""&&a.push(f);const p=`BASE <${s}>
`+r.oneTimeImportSparql,v=await(await n.queryBindings(p,{sources:a})).toArray();if(v.length>=1)for(const[f,m]of v[0])console.log(`GAHA: ${f.value}<=${m.value}`);else alert("The result of oneTimeSparql is empty.");const x=`BASE <${s}>
`+r.iterationImportSparql,u=await(await n.queryBindings(x,{sources:a})).toArray();alert(`The result count of iterationImportSparql is ${u.length}.`);for(const f of u)for(const[m,w]of f)console.log(`GAHA2: ${m.value}<=${w.value}`)}catch(n){throw n}else return alert("アクティブなシートがありません？！"),null}async function Te(){R();try{const t={types:[{description:"Turtle(RDF) file",accept:{"text/turtle":[".ttl"]}}]},[s]=await window.showOpenFilePicker(t),o=await s.getFile(),i=await o.text(),r=`file:///C:/Users/me/RDFSheet/${o.name}`;await H(i,r)}catch(t){alert(`ファイルは開かれませんでした。${A(t)}`)}}async function we(t){R();try{const o=await(await O(t)).text();await H(o,t)}catch(s){alert(`ファイルの読み込みに失敗しました。${A(s)}`)}}function W(){const t=T.settings.sheets.reduce((o,i,r)=>o!=-1?o:i.status===1?r:o,-1),s=T.settings.sheets[t];if(s){const o={type:"v",order:t};let i="";i+=s.prefixes;let r=s.oneTimeTemplate.matchAll(/<<([A-Za-z]+)(\d+)>>/g),n=[...r].map(p=>`${p[1]}${p[2]}`),l={};for(const p of n){const d=N(p);l[p]=b.getCellValue(d.row,d.col,o)}let a=s.oneTimeTemplate;for(const p of Object.keys(l))a=a.replace(`<<${p}>>`,l[p]);if(i+=a,s.repRange!==""){r=s.oneTimeTemplate.matchAll(/<<([A-Za-z]+)(\d+)>>/g),n=[...r].map(u=>`${u[1]}${u[2]}`),l={};for(const u of n){const f=N(u);l[u]=b.getCellValue(f.row,f.col,o)}a=s.iterationTemplate;for(const u of Object.keys(l))a=a.replace(`<<${u}>>`,l[u]);r=s.iterationTemplate.matchAll(/<<([A-Za-z]+)>>/g),n=[...r].map(u=>u[1]);const p=s.repRange.split(":")[0],d=s.repRange.split(":")[1],v=N(p),x=N(d);let h=0;e:for(let u=v.row;u<=x.row;u++){let f=a;l={};for(const m of n){const w=Z(m);if(l[m]=b.getCellValue(u,w,o),l[m]==null){l={},h++;continue e}}for(const m of Object.keys(l))f=f.replace(`<<${m}>>`,l[m]);i+=f}h!==0&&alert(`繰り返し処理中に必要なデータが無かったためにとばした行が${h}行ありました。`)}return i}else return alert("アクティブなシートがありません？！"),null}async function be(){R();const t=W();try{const s={suggestedName:"rdfsheetfile.ttl",types:[{description:"Turtle(RDF) file",accept:{"text/turtle":[".ttl"]}}]},i=await(await window.showSaveFilePicker(s)).createWritable();await i.write(t),await i.close()}catch(s){alert(`RDFファイルは保存されませんでした。${A(s)}`)}}async function Ae(t){R();const s=W();try{await O(t,{method:"PUT",headers:{"Content-Type":"text/turtle"},body:s}),alert("RDFをエクスポートしました。")}catch(o){alert(`RDFのエクスポートに失敗しました。${A(o)}`)}}function _e(){window.open("https://github.com/ksaito-hiu/RDFSheet/tree/main/help","help","width=600,height=400,left=100,top=100,resizable=yes,scrollbars=yes")}function Ce(){window.open("https://github.com/ksaito-hiu/RDFSheet/","about","width=600,height=400,left=100,top=100,resizable=yes,scrollbars=yes")}const Z=t=>{const s=t.toUpperCase();let o=0;for(let i=s.length-1;i>=0;i--)o*=25,o+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(s.charAt(i));return o},N=t=>{const s=t.match(/^([A-Za-z]+)(\d+)$/i);if(!s)throw new Error("無効なセル式です。");const[,o,i]=s,r=Z(o),n=Number(i)-1;return{col:r,row:n}},Re=()=>{const t=b.getRangeAxis(),s=b.getAllSheets();let o;for(const i of s)Number(i.status)===1&&(o=i.index.toString());return{range:t[0],sheetIdx:o}},J="RDFSheetLocalStorageKey",G=window.localStorage,Q={prefixes:"@prefix dc: <http://purl.org/dc/terms/> .",idp:"https://solidcommunity.net"},K=c.createContext(void 0),Ie=({children:t})=>{const[s,o]=c.useState(()=>{const r=G.getItem(J);if(r)try{const n=JSON.parse(r);if(n&&typeof n=="object")return{...Q,...n}}catch(n){return console.warn("設定の読み込みに失敗しました。",n),console.warn("設定を初期化します。"),Q}});c.useEffect(()=>{G.setItem(J,JSON.stringify(s))},[s]);const i=r=>{o(n=>({...n,...r}))};return e.jsx(K.Provider,{value:{appData:s,updateAppData:i},children:t})},$=()=>{const t=c.useContext(K);if(!t)throw new Error("useAppData must be used within a AppDataProvider");return t},D=({isVisible:t,onClose:s,children:o})=>{const i=c.useRef(null),r=()=>{s()};return c.useEffect(()=>{const n=i.current;n&&(t?n.open||(n.showModal(),n.addEventListener("close",r)):n.open&&(n.removeEventListener("close",r),n.close()))},[t]),t?e.jsxs("dialog",{ref:i,style:{zIndex:3e3,width:"80%"},children:[e.jsx("div",{style:{border:"black"},children:o}),e.jsx("button",{onClick:()=>{var n;return(n=i.current)==null?void 0:n.close()},children:"close"})]}):null},De=()=>{const{appData:t,updateAppData:s}=$(),[o,i]=c.useState(C!==null),[r,n]=c.useState(C===null?"not logged in":C),[l,a]=c.useState("https://solidcommunity.net"),[p,d]=c.useState(!1);c.useEffect(()=>{const u=t&&t.idp?t.idp:"https://solidcommunity.net";a(u)},[t]);const v=u=>{a(u.target.value)},x=async()=>{s({idp:l}),await he(l),n(C===null?"not logged in":C),d(!1)},h=()=>{me(),i(!1),n("not logged in"),d(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx("button",{onClick:()=>{d(!0)},children:o?"logout or relogin":"login"}),e.jsxs("span",{style:{marginLeft:"1em"},children:["WebID: ",r]})]}),e.jsxs(D,{isVisible:p,onClose:()=>d(!1),children:[e.jsx("h4",{children:"ログイン・ログアウト"}),e.jsx("p",{children:"ログインしたい時はidpに認証サーバを直接入力するか、代表的な認証サーバのボタンを押し「Login」ボタンを押して下さい。ログアウトしたい時は「Logout」ボタンを押して下さい。"}),e.jsxs("div",{style:{display:"flex"},children:["idp: ",e.jsx("input",{type:"text",value:l,onChange:v,style:{flexGrow:1}}),e.jsx("button",{onClick:x,children:"Login"})]}),e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>{a("https://solidcommunity.net")},children:"Solid Community"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>{a("https://solidweb.me")},children:"solidweb.me"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>{a("https://solidweb.org")},children:"solidweb.org"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>{a("https://login.inrupt.com")},children:"Inrupt Identity Provider"})})]}),e.jsx("p",{children:e.jsx("button",{onClick:h,children:"Logout"})})]})]})},ke="_menu_div_1540h_2",Le="_hamburger_1540h_9",Pe="_menu_close_1540h_23",Fe="_menu_open_1540h_35",E={menu_div:ke,hamburger:Le,menu_close:Pe,menu_open:Fe},Ne=({onSelect:t})=>{const[s,o]=c.useState(!1),i=r=>{o(!1),t(r)};return e.jsxs("div",{className:E.menu_div,children:[e.jsx("button",{className:E.hamburger,onClick:()=>o(!s),children:s?"×":"☰"}),e.jsx("nav",{className:s?E.menu_open:E.menu_close,children:e.jsxs("ul",{children:[e.jsxs("li",{children:["画面切り替え",e.jsxs("ul",{children:[e.jsx("li",{onClick:()=>{i("sheets")},children:"Sheet"}),e.jsx("li",{onClick:()=>{i("settings")},children:"Settings"}),e.jsx("li",{onClick:()=>{i("appSettings")},children:"AppSettings"})]})]}),e.jsxs("li",{children:["ファイル",e.jsxs("ul",{children:[e.jsx("li",{onClick:()=>{i("load")},children:"Load"}),e.jsx("li",{onClick:()=>{i("save")},children:"Save"}),e.jsx("li",{onClick:()=>{i("import")},children:"Import"}),e.jsx("li",{onClick:()=>{i("export")},children:"Export"})]})]}),e.jsxs("li",{children:["その他",e.jsxs("ul",{children:[e.jsx("li",{onClick:()=>{i("help")},children:"Help"}),e.jsx("li",{onClick:()=>{i("about")},children:"About"})]})]})]})})]})},Ee=({isVisible:t,children:s})=>(c.useEffect(()=>{t&&window.luckysheet.resize()},[t]),e.jsx("div",{style:{display:t?"block":"none",width:"100vw",height:"100%"},children:s})),Oe=({onLoad:t})=>{const s=c.useRef(!1);c.useEffect(()=>{if(s.current)return;s.current=!0;let i;try{const r=localStorage.getItem("RDFSheetTempFile");r?(i=JSON.parse(r),localStorage.removeItem("RDFSheetTempFile")):i={luckysheetfile:void 0,settings:V()}}catch{i={luckysheetfile:void 0,settings:V()}}U(i),R(),t(i.settings)},[]);const o={margin:"0px",padding:"0px",width:"100%",height:"100%"};return e.jsx("div",{id:"luckysheet",style:o})},Ue="_allSettings_6bzdr_3",$e="_title_6bzdr_22",qe="_filePathDiv_6bzdr_27",Be="_selectedSheetDiv_6bzdr_36",ze="_saveBtn_6bzdr_45",Ve="_repRangeDiv_6bzdr_49",Je="_prefixDiv_6bzdr_53",Ge="_glue_6bzdr_57",Qe="_prefixTA_6bzdr_61",He="_importPrefixBtn_6bzdr_68",We="_oneTimeTemplateTA_6bzdr_72",Ze="_iterationTemplateTA_6bzdr_79",Ke="_additionalImportUrlsTA_6bzdr_86",Me="_oneTimeImportSparqlTA_6bzdr_93",Xe="_iterationImportSparqlTA_6bzdr_100",Ye="_pathDiv_6bzdr_107",y={allSettings:Ue,title:$e,filePathDiv:qe,selectedSheetDiv:Be,saveBtn:ze,repRangeDiv:Ve,prefixDiv:Je,glue:Ge,prefixTA:Qe,importPrefixBtn:He,oneTimeTemplateTA:We,iterationTemplateTA:Ze,additionalImportUrlsTA:Ke,oneTimeImportSparqlTA:Me,iterationImportSparqlTA:Xe,pathDiv:Ye},et=({settings:t,onChange:s})=>{const[o,i]=c.useState(!1),[r,n]=c.useState(t.sheets[0]),[l,a]=c.useState("iTha4zah"),[p,d]=c.useState(!1),[v,x]=c.useState(!1),h=c.useRef(null),u=c.useRef(null),f=c.useRef(null),m=c.useRef(null),w=c.useRef(null),g=c.useRef(null),k=c.useRef(null),L=c.useRef(null),P=c.useRef(null),{appData:M}=$();c.useEffect(()=>{const S=t.sheets.reduce((j,I)=>j!==null?j:I.status===1?I.index:j,null);q(S)},[t]);const q=S=>{if(p&&!window.confirm("設定を保存せずにシートを変更しますか？"))return;d(!1);const j=t.sheets.reduce((I,B)=>I!==null?I:B.index===S?B:I,null);j?(n(j),a(j.index),x(j.repRange!==""),u.current&&(u.current.value=j.repRange),f.current&&(f.current.value=j.prefixes),m.current&&(m.current.value=j.oneTimeTemplate),w.current&&(w.current.value=j.iterationTemplate),g.current&&(g.current.value=j.additionalImportUrls),k.current&&(k.current.value=j.oneTimeImportSparql),L.current&&(L.current.value=j.iterationImportSparql),P.current&&(P.current.value=j.rdfPodUrl)):console.log(`GAHA: There is no sheet: index=${S}???`)},X=()=>{const S=Re();if(S.sheetIdx!==l){alert("設定中のシートと、現在アクティブなシートが異なっているので取り込みを中止します。");return}if(S.range.indexOf(":")<0){alert("範囲が選択されていなかったので取り込みを中止します。");return}u.current&&(u.current.value=S.range),d(!0)},Y=S=>{f.current&&(f.current.value.endsWith(`
`)||(f.current.value+=`
`),f.current.value+=S.target.textContent,d(!0),i(!1))},ee=()=>{u.current&&(u.current.value===""?x(!1):x(!0),d(!0))},te=()=>{d(!0)},_=()=>{d(!0)},se=()=>{h.current&&(t.fileSettings.podUrl=h.current.value),u.current&&(r.repRange=u.current.value),f.current&&(r.prefixes=f.current.value),m.current&&(r.oneTimeTemplate=m.current.value),w.current&&(r.iterationTemplate=w.current.value),g.current&&(r.additionalImportUrls=g.current.value),k.current&&(r.oneTimeImportSparql=k.current.value),L.current&&(r.iterationImportSparql=L.current.value),P.current&&(r.rdfPodUrl=P.current.value),s(t),d(!1),alert("シートの設定を変更しました。")};return e.jsxs("div",{className:y.allSettings,children:[e.jsxs("div",{className:y.title,children:[e.jsx("h3",{children:"ファイル設定"}),e.jsxs("div",{className:y.filePathDiv,children:[e.jsx("label",{htmlFor:"fileURLTB",children:"ファイルURL"}),e.jsx("input",{ref:h,type:"text",defaultValue:t.fileSettings.podUrl,onChange:te})]})]}),e.jsx("div",{className:y.selectedSheetDiv,children:e.jsxs("label",{children:["設定するシート:",e.jsx("select",{value:l,onChange:S=>q(S.target.value),name:"selectedSheet",children:t.sheets.map(S=>e.jsx("option",{value:S.index,children:S.name},S.index))}),e.jsx("span",{style:{color:p?"red":"black"},children:p?"シート設定修正あり":"シート設定修正なし"}),e.jsx("button",{className:y.saveBtn,onClick:se,disabled:!p,children:"設定変更"})]})}),e.jsxs("div",{className:y.repRangeDiv,children:["反復範囲:",e.jsx("input",{ref:u,type:"text",defaultValue:r.repRange,onChange:ee}),e.jsx("button",{type:"button",onClick:X,children:"選択範囲から取り込み"})]}),e.jsxs("div",{className:y.prefixDiv,children:[e.jsxs("div",{children:[e.jsx("h4",{children:"プレフィックス"}),e.jsx("span",{className:y.glue}),e.jsx("button",{id:"importPrefixBtn",className:y.importPrefixBtn,onClick:()=>i(!0),children:"プレフィックスを取り込む"})]}),e.jsxs(D,{isVisible:o,onClose:()=>i(!1),children:[e.jsx("p",{children:"取り込みたいプレフィックスをクリックして下さい。"}),M.prefixes.split(`
`).map(S=>e.jsx("p",{onClick:Y,children:S}))]}),e.jsx("textarea",{ref:f,defaultValue:r.prefixes,className:y.prefixTA,onChange:_})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"1回テンプレート"}),e.jsx("textarea",{ref:m,defaultValue:r.oneTimeTemplate,className:y.oneTimeTemplateTA,onChange:_})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"反復テンプレート"}),e.jsx("textarea",{ref:w,defaultValue:r.iterationTemplate,className:y.iterationTemplateTA,onChange:_,disabled:!v})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"追加インポートRDFのURL"}),e.jsx("textarea",{ref:g,defaultValue:r.additionalImportUrls,className:y.additionalImportUrlsTA,onChange:_})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"1回インポートSPARQL"}),e.jsx("textarea",{ref:k,defaultValue:r.oneTimeImportSparql,className:y.oneTimeImportSparqlTA,onChange:_})]}),e.jsxs("div",{children:[e.jsx("h4",{children:"反復インポートSPARQL"}),e.jsx("textarea",{ref:L,defaultValue:r.iterationImportSparql,className:y.iterationImportSparqlTA,onChange:_})]}),e.jsxs("div",{className:y.pathDiv,children:[e.jsx("label",{htmlFor:"rdfURLTB",children:"RDF URL"}),e.jsx("input",{ref:P,type:"text",defaultValue:r.rdfPodUrl,onChange:_})]})]})},tt="_allAppSettings_plc8o_3",st="_prefixesDiv_plc8o_10",nt="_prefixesTA_plc8o_15",rt="_idpDiv_plc8o_20",ot="_idpTB_plc8o_26",F={allAppSettings:tt,prefixesDiv:st,prefixesTA:nt,idpDiv:rt,idpTB:ot},it=()=>{const{appData:t,updateAppData:s}=$(),o=c.useRef(null),i=c.useRef(null),r=()=>{var l,a;const n={prefixes:(l=o.current)==null?void 0:l.value,idp:(a=i.current)==null?void 0:a.value};s(n),alert("アプリ設定を保存しました。")};return e.jsxs("div",{className:F.allAppSettings,children:[e.jsx("h3",{children:"AppSettings"}),e.jsx("p",{children:"編集中のファイルではなくアプリの設定をします。"}),e.jsx("h4",{children:"プレフィックス"}),e.jsx("div",{className:F.prefixesDiv,children:e.jsx("textarea",{ref:o,className:F.prefixesTA,defaultValue:t.prefixes})}),e.jsx("h4",{children:"デフォルトのログイン場所"}),e.jsx("div",{className:F.idpDiv,children:e.jsx("input",{ref:i,className:F.idpTB,defaultValue:t.idp})}),e.jsx("button",{onClick:r,children:"変更"})]})},lt=({settings:t,onLoaded:s})=>{const o=c.useRef(null);c.useEffect(()=>{const n=t.fileSettings.podUrl;n&&o.current&&(o.current.value=n)},[t]);const i=async()=>{await Se(),s()},r=async()=>{if(!o.current)return;const n=o.current.value;await ve(n),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"LoadComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:i,children:"load from local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:r,children:"load from pod"}),e.jsx("input",{type:"text",ref:o,style:{flexGrow:1}})]})]})},at=({settings:t,onSaved:s})=>{const o=c.useRef(null);c.useEffect(()=>{const n=t.fileSettings.podUrl;n&&o.current&&(o.current.value=n)},[t]);const i=()=>{je(),s()},r=()=>{if(!o.current)return;const n=o.current.value;ye(n),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"SaveComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:i,children:"save to local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:r,children:"save to pod"}),e.jsx("input",{type:"text",ref:o,style:{flexGrow:1}})]})]})},ct=({settings:t,onImported:s})=>{const o=c.useRef(null);c.useEffect(()=>{const n=t.sheets.reduce((l,a)=>l!==null?l:a.status===1?a.rdfPodUrl:l,null);n&&o.current&&(o.current.value=n)},[t]);const i=()=>{Te(),s()},r=()=>{if(!o.current)return;const n=o.current.value;we(n),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"ImportComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:i,children:"import from local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:r,children:"import from pod"}),e.jsx("input",{type:"text",ref:o,style:{flexGrow:1}})]})]})},ut=({settings:t,onExported:s})=>{const o=c.useRef(null);c.useEffect(()=>{const n=t.sheets.reduce((l,a)=>l!==null?l:a.status===1?a.rdfPodUrl:l,null);n&&o.current&&(o.current.value=n)},[t]);const i=()=>{be(),s()},r=()=>{if(!o.current)return;const n=o.current.value;Ae(n),s()};return e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"ExportComponent"}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:i,children:"export to local"})}),e.jsxs("div",{style:{display:"flex",margin:"1em 0"},children:[e.jsx("button",{type:"button",onClick:r,children:"export to pod"}),e.jsx("input",{type:"text",ref:o,style:{flexGrow:1}})]})]})},dt=()=>{const[t,s]=c.useState(T.settings),[o,i]=c.useState(!0),[r,n]=c.useState(!1),[l,a]=c.useState(!1),[p,d]=c.useState(!1),[v,x]=c.useState(!1),[h,u]=c.useState(!1),[f,m]=c.useState(!1),w=g=>{g==="sheets"?(i(!0),n(!1),a(!1)):g==="settings"?(s(R()),i(!1),n(!0),a(!1)):g==="appSettings"?(i(!1),n(!1),a(!0)):g==="load"?d(!0):g==="save"?x(!0):g==="import"?u(!0):g==="export"?m(!0):g==="help"?_e():g==="about"?Ce():console.log("GAHA: ????????")};return e.jsxs(Ie,{children:[e.jsxs("header",{children:[e.jsx(Ne,{onSelect:w}),e.jsx(De,{})]}),e.jsxs("main",{children:[e.jsx(Ee,{isVisible:o,children:e.jsx(Oe,{onLoad:g=>s(g)})}),r===!0?e.jsx(et,{settings:t,onChange:g=>s(g)}):null,l===!0?e.jsx(it,{}):null]}),e.jsx(D,{isVisible:p,onClose:()=>d(!1),children:e.jsx(lt,{settings:t,onLoaded:()=>{d(!1),s(T.settings)}})}),e.jsx(D,{isVisible:v,onClose:()=>x(!1),children:e.jsx(at,{settings:t,onSaved:()=>x(!1)})}),e.jsx(D,{isVisible:h,onClose:()=>u(!1),children:e.jsx(ct,{settings:t,onImported:()=>u(!1)})}),e.jsx(D,{isVisible:f,onClose:()=>m(!1),children:e.jsx(ut,{settings:t,onExported:()=>m(!1)})})]})};async function pt(){await xe();const t=window;let s=null;t.launchQueue&&t.launchQueue.setConsumer&&t.launchQueue.setConsumer(async o=>{s||o.files.length&&(s=new Promise(async i=>{const l=await(await o.files[0].getFile()).text();localStorage.setItem("RDFSheetTempFile",l),i()}))}),s&&await s,ne.createRoot(document.getElementById("root")).render(e.jsx(c.StrictMode,{children:e.jsx(dt,{})}))}pt();
